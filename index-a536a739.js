function Y4(e,t){for(var n=0;n<t.length;n++){const o=t[n];if(typeof o!="string"&&!Array.isArray(o)){for(const c in o)if(c!=="default"&&!(c in e)){const d=Object.getOwnPropertyDescriptor(o,c);d&&Object.defineProperty(e,c,d.get?d:{enumerable:!0,get:()=>o[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const p of d.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function n(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(c){if(c.ep)return;c.ep=!0;const d=n(c);fetch(c.href,d)}})();var pi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function J4(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function o(){if(this instanceof o){var c=[null];c.push.apply(c,arguments);var d=Function.bind.apply(t,c);return new d}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var c=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(n,o,c.get?c:{enumerable:!0,get:function(){return e[o]}})}),n}var Wh={},Q4={get exports(){return Wh},set exports(e){Wh=e}},_0={},P={},e9={get exports(){return P},set exports(e){P=e}},Cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _f=Symbol.for("react.element"),t9=Symbol.for("react.portal"),n9=Symbol.for("react.fragment"),r9=Symbol.for("react.strict_mode"),i9=Symbol.for("react.profiler"),o9=Symbol.for("react.provider"),a9=Symbol.for("react.context"),s9=Symbol.for("react.forward_ref"),l9=Symbol.for("react.suspense"),c9=Symbol.for("react.memo"),u9=Symbol.for("react.lazy"),Iw=Symbol.iterator;function d9(e){return e===null||typeof e!="object"?null:(e=Iw&&e[Iw]||e["@@iterator"],typeof e=="function"?e:null)}var MT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DT=Object.assign,RT={};function yd(e,t,n){this.props=e,this.context=t,this.refs=RT,this.updater=n||MT}yd.prototype.isReactComponent={};yd.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yd.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function LT(){}LT.prototype=yd.prototype;function s1(e,t,n){this.props=e,this.context=t,this.refs=RT,this.updater=n||MT}var l1=s1.prototype=new LT;l1.constructor=s1;DT(l1,yd.prototype);l1.isPureReactComponent=!0;var Mw=Array.isArray,NT=Object.prototype.hasOwnProperty,c1={current:null},OT={key:!0,ref:!0,__self:!0,__source:!0};function $T(e,t,n){var o,c={},d=null,p=null;if(t!=null)for(o in t.ref!==void 0&&(p=t.ref),t.key!==void 0&&(d=""+t.key),t)NT.call(t,o)&&!OT.hasOwnProperty(o)&&(c[o]=t[o]);var s=arguments.length-2;if(s===1)c.children=n;else if(1<s){for(var _=Array(s),v=0;v<s;v++)_[v]=arguments[v+2];c.children=_}if(e&&e.defaultProps)for(o in s=e.defaultProps,s)c[o]===void 0&&(c[o]=s[o]);return{$$typeof:_f,type:e,key:d,ref:p,props:c,_owner:c1.current}}function h9(e,t){return{$$typeof:_f,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function u1(e){return typeof e=="object"&&e!==null&&e.$$typeof===_f}function f9(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Dw=/\/+/g;function ry(e,t){return typeof e=="object"&&e!==null&&e.key!=null?f9(""+e.key):t.toString(36)}function cm(e,t,n,o,c){var d=typeof e;(d==="undefined"||d==="boolean")&&(e=null);var p=!1;if(e===null)p=!0;else switch(d){case"string":case"number":p=!0;break;case"object":switch(e.$$typeof){case _f:case t9:p=!0}}if(p)return p=e,c=c(p),e=o===""?"."+ry(p,0):o,Mw(c)?(n="",e!=null&&(n=e.replace(Dw,"$&/")+"/"),cm(c,t,n,"",function(v){return v})):c!=null&&(u1(c)&&(c=h9(c,n+(!c.key||p&&p.key===c.key?"":(""+c.key).replace(Dw,"$&/")+"/")+e)),t.push(c)),1;if(p=0,o=o===""?".":o+":",Mw(e))for(var s=0;s<e.length;s++){d=e[s];var _=o+ry(d,s);p+=cm(d,t,n,_,c)}else if(_=d9(e),typeof _=="function")for(e=_.call(e),s=0;!(d=e.next()).done;)d=d.value,_=o+ry(d,s++),p+=cm(d,t,n,_,c);else if(d==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return p}function Lp(e,t,n){if(e==null)return e;var o=[],c=0;return cm(e,o,"","",function(d){return t.call(n,d,c++)}),o}function p9(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var no={current:null},um={transition:null},m9={ReactCurrentDispatcher:no,ReactCurrentBatchConfig:um,ReactCurrentOwner:c1};Cn.Children={map:Lp,forEach:function(e,t,n){Lp(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Lp(e,function(){t++}),t},toArray:function(e){return Lp(e,function(t){return t})||[]},only:function(e){if(!u1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Cn.Component=yd;Cn.Fragment=n9;Cn.Profiler=i9;Cn.PureComponent=s1;Cn.StrictMode=r9;Cn.Suspense=l9;Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m9;Cn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=DT({},e.props),c=e.key,d=e.ref,p=e._owner;if(t!=null){if(t.ref!==void 0&&(d=t.ref,p=c1.current),t.key!==void 0&&(c=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(_ in t)NT.call(t,_)&&!OT.hasOwnProperty(_)&&(o[_]=t[_]===void 0&&s!==void 0?s[_]:t[_])}var _=arguments.length-2;if(_===1)o.children=n;else if(1<_){s=Array(_);for(var v=0;v<_;v++)s[v]=arguments[v+2];o.children=s}return{$$typeof:_f,type:e.type,key:c,ref:d,props:o,_owner:p}};Cn.createContext=function(e){return e={$$typeof:a9,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:o9,_context:e},e.Consumer=e};Cn.createElement=$T;Cn.createFactory=function(e){var t=$T.bind(null,e);return t.type=e,t};Cn.createRef=function(){return{current:null}};Cn.forwardRef=function(e){return{$$typeof:s9,render:e}};Cn.isValidElement=u1;Cn.lazy=function(e){return{$$typeof:u9,_payload:{_status:-1,_result:e},_init:p9}};Cn.memo=function(e,t){return{$$typeof:c9,type:e,compare:t===void 0?null:t}};Cn.startTransition=function(e){var t=um.transition;um.transition={};try{e()}finally{um.transition=t}};Cn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Cn.useCallback=function(e,t){return no.current.useCallback(e,t)};Cn.useContext=function(e){return no.current.useContext(e)};Cn.useDebugValue=function(){};Cn.useDeferredValue=function(e){return no.current.useDeferredValue(e)};Cn.useEffect=function(e,t){return no.current.useEffect(e,t)};Cn.useId=function(){return no.current.useId()};Cn.useImperativeHandle=function(e,t,n){return no.current.useImperativeHandle(e,t,n)};Cn.useInsertionEffect=function(e,t){return no.current.useInsertionEffect(e,t)};Cn.useLayoutEffect=function(e,t){return no.current.useLayoutEffect(e,t)};Cn.useMemo=function(e,t){return no.current.useMemo(e,t)};Cn.useReducer=function(e,t,n){return no.current.useReducer(e,t,n)};Cn.useRef=function(e){return no.current.useRef(e)};Cn.useState=function(e){return no.current.useState(e)};Cn.useSyncExternalStore=function(e,t,n){return no.current.useSyncExternalStore(e,t,n)};Cn.useTransition=function(){return no.current.useTransition()};Cn.version="18.2.0";(function(e){e.exports=Cn})(e9);const Un=a1(P),g9=Y4({__proto__:null,default:Un},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y9=P,v9=Symbol.for("react.element"),_9=Symbol.for("react.fragment"),x9=Object.prototype.hasOwnProperty,b9=y9.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,w9={key:!0,ref:!0,__self:!0,__source:!0};function zT(e,t,n){var o,c={},d=null,p=null;n!==void 0&&(d=""+n),t.key!==void 0&&(d=""+t.key),t.ref!==void 0&&(p=t.ref);for(o in t)x9.call(t,o)&&!w9.hasOwnProperty(o)&&(c[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps,t)c[o]===void 0&&(c[o]=t[o]);return{$$typeof:v9,type:e,key:d,ref:p,props:c,_owner:b9.current}}_0.Fragment=_9;_0.jsx=zT;_0.jsxs=zT;(function(e){e.exports=_0})(Q4);const Jo=Wh.Fragment,re=Wh.jsx,vt=Wh.jsxs;function Ko(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(c){return"'"+c+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function nd(e){return!!e&&!!e[jn]}function Is(e){var t;return!!e&&(function(n){if(!n||typeof n!="object")return!1;var o=Object.getPrototypeOf(n);if(o===null)return!0;var c=Object.hasOwnProperty.call(o,"constructor")&&o.constructor;return c===Object||typeof c=="function"&&Function.toString.call(c)===D9}(e)||Array.isArray(e)||!!e[Bw]||!!(!((t=e.constructor)===null||t===void 0)&&t[Bw])||d1(e)||h1(e))}function rd(e,t,n){n===void 0&&(n=!1),vd(e)===0?(n?Object.keys:y1)(e).forEach(function(o){n&&typeof o=="symbol"||t(o,e[o],e)}):e.forEach(function(o,c){return t(c,o,e)})}function vd(e){var t=e[jn];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:d1(e)?2:h1(e)?3:0}function uv(e,t){return vd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function E9(e,t){return vd(e)===2?e.get(t):e[t]}function BT(e,t,n){var o=vd(e);o===2?e.set(t,n):o===3?e.add(n):e[t]=n}function T9(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function d1(e){return I9&&e instanceof Map}function h1(e){return M9&&e instanceof Set}function hi(e){return e.o||e.t}function f1(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=R9(e);delete t[jn];for(var n=y1(t),o=0;o<n.length;o++){var c=n[o],d=t[c];d.writable===!1&&(d.writable=!0,d.configurable=!0),(d.get||d.set)&&(t[c]={configurable:!0,writable:!0,enumerable:d.enumerable,value:e[c]})}return Object.create(Object.getPrototypeOf(e),t)}function p1(e,t){return t===void 0&&(t=!1),m1(e)||nd(e)||!Is(e)||(vd(e)>1&&(e.set=e.add=e.clear=e.delete=S9),Object.freeze(e),t&&rd(e,function(n,o){return p1(o,!0)},!0)),e}function S9(){Ko(2)}function m1(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function ja(e){var t=hv[e];return t||Ko(18,e),t}function k9(e,t){hv[e]||(hv[e]=t)}function Am(){return Zh}function iy(e,t){t&&(ja("Patches"),e.u=[],e.s=[],e.v=t)}function Im(e){dv(e),e.p.forEach(C9),e.p=null}function dv(e){e===Zh&&(Zh=e.l)}function Rw(e){return Zh={p:[],l:Zh,h:e,m:!0,_:0}}function C9(e){var t=e[jn];t.i===0||t.i===1?t.j():t.O=!0}function oy(e,t){t._=t.p.length;var n=t.p[0],o=e!==void 0&&e!==n;return t.h.g||ja("ES5").S(t,e,o),o?(n[jn].P&&(Im(t),Ko(4)),Is(e)&&(e=Mm(t,e),t.l||Dm(t,e)),t.u&&ja("Patches").M(n[jn].t,e,t.u,t.s)):e=Mm(t,n,[]),Im(t),t.u&&t.v(t.u,t.s),e!==FT?e:void 0}function Mm(e,t,n){if(m1(t))return t;var o=t[jn];if(!o)return rd(t,function(s,_){return Lw(e,o,t,s,_,n)},!0),t;if(o.A!==e)return t;if(!o.P)return Dm(e,o.t,!0),o.t;if(!o.I){o.I=!0,o.A._--;var c=o.i===4||o.i===5?o.o=f1(o.k):o.o,d=c,p=!1;o.i===3&&(d=new Set(c),c.clear(),p=!0),rd(d,function(s,_){return Lw(e,o,c,s,_,n,p)}),Dm(e,c,!1),n&&e.u&&ja("Patches").N(o,n,e.u,e.s)}return o.o}function Lw(e,t,n,o,c,d,p){if(nd(c)){var s=Mm(e,c,d&&t&&t.i!==3&&!uv(t.R,o)?d.concat(o):void 0);if(BT(n,o,s),!nd(s))return;e.m=!1}else p&&n.add(c);if(Is(c)&&!m1(c)){if(!e.h.D&&e._<1)return;Mm(e,c),t&&t.A.l||Dm(e,c)}}function Dm(e,t,n){n===void 0&&(n=!1),!e.l&&e.h.D&&e.m&&p1(t,n)}function ay(e,t){var n=e[jn];return(n?hi(n):e)[t]}function Nw(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var o=Object.getOwnPropertyDescriptor(n,t);if(o)return o;n=Object.getPrototypeOf(n)}}function bs(e){e.P||(e.P=!0,e.l&&bs(e.l))}function sy(e){e.o||(e.o=f1(e.t))}function Hh(e,t,n){var o=d1(t)?ja("MapSet").F(t,n):h1(t)?ja("MapSet").T(t,n):e.g?function(c,d){var p=Array.isArray(c),s={i:p?1:0,A:d?d.A:Am(),P:!1,I:!1,R:{},l:d,t:c,k:null,o:null,j:null,C:!1},_=s,v=fv;p&&(_=[s],v=Th);var E=Proxy.revocable(_,v),T=E.revoke,S=E.proxy;return s.k=S,s.j=T,S}(t,n):ja("ES5").J(t,n);return(n?n.A:Am()).p.push(o),o}function P9(e){return nd(e)||Ko(22,e),function t(n){if(!Is(n))return n;var o,c=n[jn],d=vd(n);if(c){if(!c.P&&(c.i<4||!ja("ES5").K(c)))return c.t;c.I=!0,o=Ow(n,d),c.I=!1}else o=Ow(n,d);return rd(o,function(p,s){c&&E9(c.t,p)===s||BT(o,p,t(s))}),d===3?new Set(o):o}(e)}function Ow(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return f1(e)}function A9(){function e(s,_){function v(){this.constructor=s}c(s,_),s.prototype=(v.prototype=_.prototype,new v)}function t(s){s.o||(s.R=new Map,s.o=new Map(s.t))}function n(s){s.o||(s.o=new Set,s.t.forEach(function(_){if(Is(_)){var v=Hh(s.A.h,_,s);s.p.set(_,v),s.o.add(v)}else s.o.add(_)}))}function o(s){s.O&&Ko(3,JSON.stringify(hi(s)))}var c=function(s,_){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,E){v.__proto__=E}||function(v,E){for(var T in E)E.hasOwnProperty(T)&&(v[T]=E[T])})(s,_)},d=function(){function s(v,E){return this[jn]={i:2,l:E,A:E?E.A:Am(),P:!1,I:!1,o:void 0,R:void 0,t:v,k:this,C:!1,O:!1},this}e(s,Map);var _=s.prototype;return Object.defineProperty(_,"size",{get:function(){return hi(this[jn]).size}}),_.has=function(v){return hi(this[jn]).has(v)},_.set=function(v,E){var T=this[jn];return o(T),hi(T).has(v)&&hi(T).get(v)===E||(t(T),bs(T),T.R.set(v,!0),T.o.set(v,E),T.R.set(v,!0)),this},_.delete=function(v){if(!this.has(v))return!1;var E=this[jn];return o(E),t(E),bs(E),E.t.has(v)?E.R.set(v,!1):E.R.delete(v),E.o.delete(v),!0},_.clear=function(){var v=this[jn];o(v),hi(v).size&&(t(v),bs(v),v.R=new Map,rd(v.t,function(E){v.R.set(E,!1)}),v.o.clear())},_.forEach=function(v,E){var T=this;hi(this[jn]).forEach(function(S,D){v.call(E,T.get(D),D,T)})},_.get=function(v){var E=this[jn];o(E);var T=hi(E).get(v);if(E.I||!Is(T)||T!==E.t.get(v))return T;var S=Hh(E.A.h,T,E);return t(E),E.o.set(v,S),S},_.keys=function(){return hi(this[jn]).keys()},_.values=function(){var v,E=this,T=this.keys();return(v={})[Np]=function(){return E.values()},v.next=function(){var S=T.next();return S.done?S:{done:!1,value:E.get(S.value)}},v},_.entries=function(){var v,E=this,T=this.keys();return(v={})[Np]=function(){return E.entries()},v.next=function(){var S=T.next();if(S.done)return S;var D=E.get(S.value);return{done:!1,value:[S.value,D]}},v},_[Np]=function(){return this.entries()},s}(),p=function(){function s(v,E){return this[jn]={i:3,l:E,A:E?E.A:Am(),P:!1,I:!1,o:void 0,t:v,k:this,p:new Map,O:!1,C:!1},this}e(s,Set);var _=s.prototype;return Object.defineProperty(_,"size",{get:function(){return hi(this[jn]).size}}),_.has=function(v){var E=this[jn];return o(E),E.o?!!E.o.has(v)||!(!E.p.has(v)||!E.o.has(E.p.get(v))):E.t.has(v)},_.add=function(v){var E=this[jn];return o(E),this.has(v)||(n(E),bs(E),E.o.add(v)),this},_.delete=function(v){if(!this.has(v))return!1;var E=this[jn];return o(E),n(E),bs(E),E.o.delete(v)||!!E.p.has(v)&&E.o.delete(E.p.get(v))},_.clear=function(){var v=this[jn];o(v),hi(v).size&&(n(v),bs(v),v.o.clear())},_.values=function(){var v=this[jn];return o(v),n(v),v.o.values()},_.entries=function(){var v=this[jn];return o(v),n(v),v.o.entries()},_.keys=function(){return this.values()},_[Np]=function(){return this.values()},_.forEach=function(v,E){for(var T=this.values(),S=T.next();!S.done;)v.call(E,S.value,S.value,this),S=T.next()},s}();k9("MapSet",{F:function(s,_){return new d(s,_)},T:function(s,_){return new p(s,_)}})}var $w,Zh,g1=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",I9=typeof Map<"u",M9=typeof Set<"u",zw=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",FT=g1?Symbol.for("immer-nothing"):(($w={})["immer-nothing"]=!0,$w),Bw=g1?Symbol.for("immer-draftable"):"__$immer_draftable",jn=g1?Symbol.for("immer-state"):"__$immer_state",Np=typeof Symbol<"u"&&Symbol.iterator||"@@iterator",D9=""+Object.prototype.constructor,y1=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,R9=Object.getOwnPropertyDescriptors||function(e){var t={};return y1(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},hv={},fv={get:function(e,t){if(t===jn)return e;var n=hi(e);if(!uv(n,t))return function(c,d,p){var s,_=Nw(d,p);return _?"value"in _?_.value:(s=_.get)===null||s===void 0?void 0:s.call(c.k):void 0}(e,n,t);var o=n[t];return e.I||!Is(o)?o:o===ay(e.t,t)?(sy(e),e.o[t]=Hh(e.A.h,o,e)):o},has:function(e,t){return t in hi(e)},ownKeys:function(e){return Reflect.ownKeys(hi(e))},set:function(e,t,n){var o=Nw(hi(e),t);if(o?.set)return o.set.call(e.k,n),!0;if(!e.P){var c=ay(hi(e),t),d=c?.[jn];if(d&&d.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(T9(n,c)&&(n!==void 0||uv(e.t,t)))return!0;sy(e),bs(e)}return e.o[t]===n&&(n!==void 0||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return ay(e.t,t)!==void 0||t in e.t?(e.R[t]=!1,sy(e),bs(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=hi(e),o=Reflect.getOwnPropertyDescriptor(n,t);return o&&{writable:!0,configurable:e.i!==1||t!=="length",enumerable:o.enumerable,value:n[t]}},defineProperty:function(){Ko(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Ko(12)}},Th={};rd(fv,function(e,t){Th[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Th.deleteProperty=function(e,t){return Th.set.call(this,e,t,void 0)},Th.set=function(e,t,n){return fv.set.call(this,e[0],t,n,e[0])};var L9=function(){function e(n){var o=this;this.g=zw,this.D=!0,this.produce=function(c,d,p){if(typeof c=="function"&&typeof d!="function"){var s=d;d=c;var _=o;return function(M){var U=this;M===void 0&&(M=s);for(var $=arguments.length,L=Array($>1?$-1:0),F=1;F<$;F++)L[F-1]=arguments[F];return _.produce(M,function(J){var V;return(V=d).call.apply(V,[U,J].concat(L))})}}var v;if(typeof d!="function"&&Ko(6),p!==void 0&&typeof p!="function"&&Ko(7),Is(c)){var E=Rw(o),T=Hh(o,c,void 0),S=!0;try{v=d(T),S=!1}finally{S?Im(E):dv(E)}return typeof Promise<"u"&&v instanceof Promise?v.then(function(M){return iy(E,p),oy(M,E)},function(M){throw Im(E),M}):(iy(E,p),oy(v,E))}if(!c||typeof c!="object"){if((v=d(c))===void 0&&(v=c),v===FT&&(v=void 0),o.D&&p1(v,!0),p){var D=[],O=[];ja("Patches").M(c,v,D,O),p(D,O)}return v}Ko(21,c)},this.produceWithPatches=function(c,d){if(typeof c=="function")return function(v){for(var E=arguments.length,T=Array(E>1?E-1:0),S=1;S<E;S++)T[S-1]=arguments[S];return o.produceWithPatches(v,function(D){return c.apply(void 0,[D].concat(T))})};var p,s,_=o.produce(c,d,function(v,E){p=v,s=E});return typeof Promise<"u"&&_ instanceof Promise?_.then(function(v){return[v,p,s]}):[_,p,s]},typeof n?.useProxies=="boolean"&&this.setUseProxies(n.useProxies),typeof n?.autoFreeze=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var t=e.prototype;return t.createDraft=function(n){Is(n)||Ko(8),nd(n)&&(n=P9(n));var o=Rw(this),c=Hh(this,n,void 0);return c[jn].C=!0,dv(o),c},t.finishDraft=function(n,o){var c=n&&n[jn],d=c.A;return iy(d,o),oy(void 0,d)},t.setAutoFreeze=function(n){this.D=n},t.setUseProxies=function(n){n&&!zw&&Ko(20),this.g=n},t.applyPatches=function(n,o){var c;for(c=o.length-1;c>=0;c--){var d=o[c];if(d.path.length===0&&d.op==="replace"){n=d.value;break}}c>-1&&(o=o.slice(c+1));var p=ja("Patches").$;return nd(n)?p(n,o):this.produce(n,function(s){return p(s,o)})},e}(),Mo=new L9,Vn=Mo.produce;Mo.produceWithPatches.bind(Mo);Mo.setAutoFreeze.bind(Mo);Mo.setUseProxies.bind(Mo);Mo.applyPatches.bind(Mo);Mo.createDraft.bind(Mo);Mo.finishDraft.bind(Mo);var yo={},N9={get exports(){return yo},set exports(e){yo=e}},Ro={},pv={},O9={get exports(){return pv},set exports(e){pv=e}},UT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(We,Ae){var He=We.length;We.push(Ae);e:for(;0<He;){var ft=He-1>>>1,Qe=We[ft];if(0<c(Qe,Ae))We[ft]=Ae,We[He]=Qe,He=ft;else break e}}function n(We){return We.length===0?null:We[0]}function o(We){if(We.length===0)return null;var Ae=We[0],He=We.pop();if(He!==Ae){We[0]=He;e:for(var ft=0,Qe=We.length,Rt=Qe>>>1;ft<Rt;){var zt=2*(ft+1)-1,X=We[zt],tt=zt+1,je=We[tt];if(0>c(X,He))tt<Qe&&0>c(je,X)?(We[ft]=je,We[tt]=He,ft=tt):(We[ft]=X,We[zt]=He,ft=zt);else if(tt<Qe&&0>c(je,He))We[ft]=je,We[tt]=He,ft=tt;else break e}}return Ae}function c(We,Ae){var He=We.sortIndex-Ae.sortIndex;return He!==0?He:We.id-Ae.id}if(typeof performance=="object"&&typeof performance.now=="function"){var d=performance;e.unstable_now=function(){return d.now()}}else{var p=Date,s=p.now();e.unstable_now=function(){return p.now()-s}}var _=[],v=[],E=1,T=null,S=3,D=!1,O=!1,M=!1,U=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(We){for(var Ae=n(v);Ae!==null;){if(Ae.callback===null)o(v);else if(Ae.startTime<=We)o(v),Ae.sortIndex=Ae.expirationTime,t(_,Ae);else break;Ae=n(v)}}function J(We){if(M=!1,F(We),!O)if(n(_)!==null)O=!0,ze(V);else{var Ae=n(v);Ae!==null&&rt(J,Ae.startTime-We)}}function V(We,Ae){O=!1,M&&(M=!1,$(W),W=-1),D=!0;var He=S;try{for(F(Ae),T=n(_);T!==null&&(!(T.expirationTime>Ae)||We&&!be());){var ft=T.callback;if(typeof ft=="function"){T.callback=null,S=T.priorityLevel;var Qe=ft(T.expirationTime<=Ae);Ae=e.unstable_now(),typeof Qe=="function"?T.callback=Qe:T===n(_)&&o(_),F(Ae)}else o(_);T=n(_)}if(T!==null)var Rt=!0;else{var zt=n(v);zt!==null&&rt(J,zt.startTime-Ae),Rt=!1}return Rt}finally{T=null,S=He,D=!1}}var Z=!1,G=null,W=-1,le=5,Ie=-1;function be(){return!(e.unstable_now()-Ie<le)}function de(){if(G!==null){var We=e.unstable_now();Ie=We;var Ae=!0;try{Ae=G(!0,We)}finally{Ae?Ne():(Z=!1,G=null)}}else Z=!1}var Ne;if(typeof L=="function")Ne=function(){L(de)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Oe=Ee.port2;Ee.port1.onmessage=de,Ne=function(){Oe.postMessage(null)}}else Ne=function(){U(de,0)};function ze(We){G=We,Z||(Z=!0,Ne())}function rt(We,Ae){W=U(function(){We(e.unstable_now())},Ae)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(We){We.callback=null},e.unstable_continueExecution=function(){O||D||(O=!0,ze(V))},e.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<We?Math.floor(1e3/We):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_getFirstCallbackNode=function(){return n(_)},e.unstable_next=function(We){switch(S){case 1:case 2:case 3:var Ae=3;break;default:Ae=S}var He=S;S=Ae;try{return We()}finally{S=He}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(We,Ae){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var He=S;S=We;try{return Ae()}finally{S=He}},e.unstable_scheduleCallback=function(We,Ae,He){var ft=e.unstable_now();switch(typeof He=="object"&&He!==null?(He=He.delay,He=typeof He=="number"&&0<He?ft+He:ft):He=ft,We){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=He+Qe,We={id:E++,callback:Ae,priorityLevel:We,startTime:He,expirationTime:Qe,sortIndex:-1},He>ft?(We.sortIndex=He,t(v,We),n(_)===null&&We===n(v)&&(M?($(W),W=-1):M=!0,rt(J,He-ft))):(We.sortIndex=Qe,t(_,We),O||D||(O=!0,ze(V))),We},e.unstable_shouldYield=be,e.unstable_wrapCallback=function(We){var Ae=S;return function(){var He=S;S=Ae;try{return We.apply(this,arguments)}finally{S=He}}}})(UT);(function(e){e.exports=UT})(O9);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VT=P,Do=pv;function bt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var jT=new Set,Kh={};function zc(e,t){id(e,t),id(e+"Capture",t)}function id(e,t){for(Kh[e]=t,e=0;e<t.length;e++)jT.add(t[e])}var Ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mv=Object.prototype.hasOwnProperty,$9=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fw={},Uw={};function z9(e){return mv.call(Uw,e)?!0:mv.call(Fw,e)?!1:$9.test(e)?Uw[e]=!0:(Fw[e]=!0,!1)}function B9(e,t,n,o){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return o?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function F9(e,t,n,o){if(t===null||typeof t>"u"||B9(e,t,n,o))return!0;if(o)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ro(e,t,n,o,c,d,p){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=o,this.attributeNamespace=c,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=d,this.removeEmptyString=p}var Ci={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ci[e]=new ro(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ci[t]=new ro(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ci[e]=new ro(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ci[e]=new ro(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ci[e]=new ro(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ci[e]=new ro(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ci[e]=new ro(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ci[e]=new ro(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ci[e]=new ro(e,5,!1,e.toLowerCase(),null,!1,!1)});var v1=/[\-:]([a-z])/g;function _1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v1,_1);Ci[t]=new ro(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v1,_1);Ci[t]=new ro(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v1,_1);Ci[t]=new ro(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ci[e]=new ro(e,1,!1,e.toLowerCase(),null,!1,!1)});Ci.xlinkHref=new ro("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ci[e]=new ro(e,1,!1,e.toLowerCase(),null,!0,!0)});function x1(e,t,n,o){var c=Ci.hasOwnProperty(t)?Ci[t]:null;(c!==null?c.type!==0:o||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(F9(t,n,c,o)&&(n=null),o||c===null?z9(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):c.mustUseProperty?e[c.propertyName]=n===null?c.type===3?!1:"":n:(t=c.attributeName,o=c.attributeNamespace,n===null?e.removeAttribute(t):(c=c.type,n=c===3||c===4&&n===!0?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}var Os=VT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Op=Symbol.for("react.element"),Du=Symbol.for("react.portal"),Ru=Symbol.for("react.fragment"),b1=Symbol.for("react.strict_mode"),gv=Symbol.for("react.profiler"),GT=Symbol.for("react.provider"),qT=Symbol.for("react.context"),w1=Symbol.for("react.forward_ref"),yv=Symbol.for("react.suspense"),vv=Symbol.for("react.suspense_list"),E1=Symbol.for("react.memo"),pl=Symbol.for("react.lazy"),WT=Symbol.for("react.offscreen"),Vw=Symbol.iterator;function dh(e){return e===null||typeof e!="object"?null:(e=Vw&&e[Vw]||e["@@iterator"],typeof e=="function"?e:null)}var kr=Object.assign,ly;function Sh(e){if(ly===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);ly=t&&t[1]||""}return`
`+ly+e}var cy=!1;function uy(e,t){if(!e||cy)return"";cy=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(v){var o=v}Reflect.construct(e,[],t)}else{try{t.call()}catch(v){o=v}e.call(t.prototype)}else{try{throw Error()}catch(v){o=v}e()}}catch(v){if(v&&o&&typeof v.stack=="string"){for(var c=v.stack.split(`
`),d=o.stack.split(`
`),p=c.length-1,s=d.length-1;1<=p&&0<=s&&c[p]!==d[s];)s--;for(;1<=p&&0<=s;p--,s--)if(c[p]!==d[s]){if(p!==1||s!==1)do if(p--,s--,0>s||c[p]!==d[s]){var _=`
`+c[p].replace(" at new "," at ");return e.displayName&&_.includes("<anonymous>")&&(_=_.replace("<anonymous>",e.displayName)),_}while(1<=p&&0<=s);break}}}finally{cy=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Sh(e):""}function U9(e){switch(e.tag){case 5:return Sh(e.type);case 16:return Sh("Lazy");case 13:return Sh("Suspense");case 19:return Sh("SuspenseList");case 0:case 2:case 15:return e=uy(e.type,!1),e;case 11:return e=uy(e.type.render,!1),e;case 1:return e=uy(e.type,!0),e;default:return""}}function _v(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ru:return"Fragment";case Du:return"Portal";case gv:return"Profiler";case b1:return"StrictMode";case yv:return"Suspense";case vv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qT:return(e.displayName||"Context")+".Consumer";case GT:return(e._context.displayName||"Context")+".Provider";case w1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case E1:return t=e.displayName||null,t!==null?t:_v(e.type)||"Memo";case pl:t=e._payload,e=e._init;try{return _v(e(t))}catch{}}return null}function V9(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _v(t);case 8:return t===b1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ml(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function HT(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function j9(e){var t=HT(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var c=n.get,d=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return c.call(this)},set:function(p){o=""+p,d.call(this,p)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(p){o=""+p},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function $p(e){e._valueTracker||(e._valueTracker=j9(e))}function ZT(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=HT(e)?e.checked?"true":"false":e.value),e=o,e!==n?(t.setValue(e),!0):!1}function Rm(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xv(e,t){var n=t.checked;return kr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function jw(e,t){var n=t.defaultValue==null?"":t.defaultValue,o=t.checked!=null?t.checked:t.defaultChecked;n=Ml(t.value!=null?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function KT(e,t){t=t.checked,t!=null&&x1(e,"checked",t,!1)}function bv(e,t){KT(e,t);var n=Ml(t.value),o=t.type;if(n!=null)o==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wv(e,t.type,n):t.hasOwnProperty("defaultValue")&&wv(e,t.type,Ml(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gw(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!(o!=="submit"&&o!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wv(e,t,n){(t!=="number"||Rm(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var kh=Array.isArray;function Hu(e,t,n,o){if(e=e.options,t){t={};for(var c=0;c<n.length;c++)t["$"+n[c]]=!0;for(n=0;n<e.length;n++)c=t.hasOwnProperty("$"+e[n].value),e[n].selected!==c&&(e[n].selected=c),c&&o&&(e[n].defaultSelected=!0)}else{for(n=""+Ml(n),t=null,c=0;c<e.length;c++){if(e[c].value===n){e[c].selected=!0,o&&(e[c].defaultSelected=!0);return}t!==null||e[c].disabled||(t=e[c])}t!==null&&(t.selected=!0)}}function Ev(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(bt(91));return kr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function qw(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(bt(92));if(kh(n)){if(1<n.length)throw Error(bt(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ml(n)}}function XT(e,t){var n=Ml(t.value),o=Ml(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),o!=null&&(e.defaultValue=""+o)}function Ww(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function YT(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?YT(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var zp,JT=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,o,c){MSApp.execUnsafeLocalFunction(function(){return e(t,n,o,c)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(zp=zp||document.createElement("div"),zp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=zp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Xh(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ah={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},G9=["Webkit","ms","Moz","O"];Object.keys(Ah).forEach(function(e){G9.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ah[t]=Ah[e]})});function QT(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ah.hasOwnProperty(e)&&Ah[e]?(""+t).trim():t+"px"}function eS(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var o=n.indexOf("--")===0,c=QT(n,t[n],o);n==="float"&&(n="cssFloat"),o?e.setProperty(n,c):e[n]=c}}var q9=kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sv(e,t){if(t){if(q9[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(bt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(bt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(bt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(bt(62))}}function kv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cv=null;function T1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Pv=null,Zu=null,Ku=null;function Hw(e){if(e=wf(e)){if(typeof Pv!="function")throw Error(bt(280));var t=e.stateNode;t&&(t=T0(t),Pv(e.stateNode,e.type,t))}}function tS(e){Zu?Ku?Ku.push(e):Ku=[e]:Zu=e}function nS(){if(Zu){var e=Zu,t=Ku;if(Ku=Zu=null,Hw(e),t)for(e=0;e<t.length;e++)Hw(t[e])}}function rS(e,t){return e(t)}function iS(){}var dy=!1;function oS(e,t,n){if(dy)return e(t,n);dy=!0;try{return rS(e,t,n)}finally{dy=!1,(Zu!==null||Ku!==null)&&(iS(),nS())}}function Yh(e,t){var n=e.stateNode;if(n===null)return null;var o=T0(n);if(o===null)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(bt(231,t,typeof n));return n}var Av=!1;if(Ms)try{var hh={};Object.defineProperty(hh,"passive",{get:function(){Av=!0}}),window.addEventListener("test",hh,hh),window.removeEventListener("test",hh,hh)}catch{Av=!1}function W9(e,t,n,o,c,d,p,s,_){var v=Array.prototype.slice.call(arguments,3);try{t.apply(n,v)}catch(E){this.onError(E)}}var Ih=!1,Lm=null,Nm=!1,Iv=null,H9={onError:function(e){Ih=!0,Lm=e}};function Z9(e,t,n,o,c,d,p,s,_){Ih=!1,Lm=null,W9.apply(H9,arguments)}function K9(e,t,n,o,c,d,p,s,_){if(Z9.apply(this,arguments),Ih){if(Ih){var v=Lm;Ih=!1,Lm=null}else throw Error(bt(198));Nm||(Nm=!0,Iv=v)}}function Bc(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function aS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Zw(e){if(Bc(e)!==e)throw Error(bt(188))}function X9(e){var t=e.alternate;if(!t){if(t=Bc(e),t===null)throw Error(bt(188));return t!==e?null:e}for(var n=e,o=t;;){var c=n.return;if(c===null)break;var d=c.alternate;if(d===null){if(o=c.return,o!==null){n=o;continue}break}if(c.child===d.child){for(d=c.child;d;){if(d===n)return Zw(c),e;if(d===o)return Zw(c),t;d=d.sibling}throw Error(bt(188))}if(n.return!==o.return)n=c,o=d;else{for(var p=!1,s=c.child;s;){if(s===n){p=!0,n=c,o=d;break}if(s===o){p=!0,o=c,n=d;break}s=s.sibling}if(!p){for(s=d.child;s;){if(s===n){p=!0,n=d,o=c;break}if(s===o){p=!0,o=d,n=c;break}s=s.sibling}if(!p)throw Error(bt(189))}}if(n.alternate!==o)throw Error(bt(190))}if(n.tag!==3)throw Error(bt(188));return n.stateNode.current===n?e:t}function sS(e){return e=X9(e),e!==null?lS(e):null}function lS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lS(e);if(t!==null)return t;e=e.sibling}return null}var cS=Do.unstable_scheduleCallback,Kw=Do.unstable_cancelCallback,Y9=Do.unstable_shouldYield,J9=Do.unstable_requestPaint,Fr=Do.unstable_now,Q9=Do.unstable_getCurrentPriorityLevel,S1=Do.unstable_ImmediatePriority,uS=Do.unstable_UserBlockingPriority,Om=Do.unstable_NormalPriority,e8=Do.unstable_LowPriority,dS=Do.unstable_IdlePriority,x0=null,Ga=null;function t8(e){if(Ga&&typeof Ga.onCommitFiberRoot=="function")try{Ga.onCommitFiberRoot(x0,e,void 0,(e.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:i8,n8=Math.log,r8=Math.LN2;function i8(e){return e>>>=0,e===0?32:31-(n8(e)/r8|0)|0}var Bp=64,Fp=4194304;function Ch(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $m(e,t){var n=e.pendingLanes;if(n===0)return 0;var o=0,c=e.suspendedLanes,d=e.pingedLanes,p=n&268435455;if(p!==0){var s=p&~c;s!==0?o=Ch(s):(d&=p,d!==0&&(o=Ch(d)))}else p=n&~c,p!==0?o=Ch(p):d!==0&&(o=Ch(d));if(o===0)return 0;if(t!==0&&t!==o&&!(t&c)&&(c=o&-o,d=t&-t,c>=d||c===16&&(d&4194240)!==0))return t;if(o&4&&(o|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=o;0<t;)n=31-ya(t),c=1<<n,o|=e[n],t&=~c;return o}function o8(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function a8(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,c=e.expirationTimes,d=e.pendingLanes;0<d;){var p=31-ya(d),s=1<<p,_=c[p];_===-1?(!(s&n)||s&o)&&(c[p]=o8(s,t)):_<=t&&(e.expiredLanes|=s),d&=~s}}function Mv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function hS(){var e=Bp;return Bp<<=1,!(Bp&4194240)&&(Bp=64),e}function hy(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function xf(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ya(t),e[t]=n}function s8(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var c=31-ya(n),d=1<<c;t[c]=0,o[c]=-1,e[c]=-1,n&=~d}}function k1(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-ya(n),c=1<<o;c&t|e[o]&t&&(e[o]|=t),n&=~c}}var Zn=0;function fS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pS,C1,mS,gS,yS,Dv=!1,Up=[],wl=null,El=null,Tl=null,Jh=new Map,Qh=new Map,yl=[],l8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xw(e,t){switch(e){case"focusin":case"focusout":wl=null;break;case"dragenter":case"dragleave":El=null;break;case"mouseover":case"mouseout":Tl=null;break;case"pointerover":case"pointerout":Jh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(t.pointerId)}}function fh(e,t,n,o,c,d){return e===null||e.nativeEvent!==d?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:d,targetContainers:[c]},t!==null&&(t=wf(t),t!==null&&C1(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,c!==null&&t.indexOf(c)===-1&&t.push(c),e)}function c8(e,t,n,o,c){switch(t){case"focusin":return wl=fh(wl,e,t,n,o,c),!0;case"dragenter":return El=fh(El,e,t,n,o,c),!0;case"mouseover":return Tl=fh(Tl,e,t,n,o,c),!0;case"pointerover":var d=c.pointerId;return Jh.set(d,fh(Jh.get(d)||null,e,t,n,o,c)),!0;case"gotpointercapture":return d=c.pointerId,Qh.set(d,fh(Qh.get(d)||null,e,t,n,o,c)),!0}return!1}function vS(e){var t=wc(e.target);if(t!==null){var n=Bc(t);if(n!==null){if(t=n.tag,t===13){if(t=aS(n),t!==null){e.blockedOn=t,yS(e.priority,function(){mS(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function dm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Rv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var o=new n.constructor(n.type,n);Cv=o,n.target.dispatchEvent(o),Cv=null}else return t=wf(n),t!==null&&C1(t),e.blockedOn=n,!1;t.shift()}return!0}function Yw(e,t,n){dm(e)&&n.delete(t)}function u8(){Dv=!1,wl!==null&&dm(wl)&&(wl=null),El!==null&&dm(El)&&(El=null),Tl!==null&&dm(Tl)&&(Tl=null),Jh.forEach(Yw),Qh.forEach(Yw)}function ph(e,t){e.blockedOn===t&&(e.blockedOn=null,Dv||(Dv=!0,Do.unstable_scheduleCallback(Do.unstable_NormalPriority,u8)))}function ef(e){function t(c){return ph(c,e)}if(0<Up.length){ph(Up[0],e);for(var n=1;n<Up.length;n++){var o=Up[n];o.blockedOn===e&&(o.blockedOn=null)}}for(wl!==null&&ph(wl,e),El!==null&&ph(El,e),Tl!==null&&ph(Tl,e),Jh.forEach(t),Qh.forEach(t),n=0;n<yl.length;n++)o=yl[n],o.blockedOn===e&&(o.blockedOn=null);for(;0<yl.length&&(n=yl[0],n.blockedOn===null);)vS(n),n.blockedOn===null&&yl.shift()}var Xu=Os.ReactCurrentBatchConfig,zm=!0;function d8(e,t,n,o){var c=Zn,d=Xu.transition;Xu.transition=null;try{Zn=1,P1(e,t,n,o)}finally{Zn=c,Xu.transition=d}}function h8(e,t,n,o){var c=Zn,d=Xu.transition;Xu.transition=null;try{Zn=4,P1(e,t,n,o)}finally{Zn=c,Xu.transition=d}}function P1(e,t,n,o){if(zm){var c=Rv(e,t,n,o);if(c===null)wy(e,t,o,Bm,n),Xw(e,o);else if(c8(c,e,t,n,o))o.stopPropagation();else if(Xw(e,o),t&4&&-1<l8.indexOf(e)){for(;c!==null;){var d=wf(c);if(d!==null&&pS(d),d=Rv(e,t,n,o),d===null&&wy(e,t,o,Bm,n),d===c)break;c=d}c!==null&&o.stopPropagation()}else wy(e,t,o,null,n)}}var Bm=null;function Rv(e,t,n,o){if(Bm=null,e=T1(o),e=wc(e),e!==null)if(t=Bc(e),t===null)e=null;else if(n=t.tag,n===13){if(e=aS(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Bm=e,null}function _S(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Q9()){case S1:return 1;case uS:return 4;case Om:case e8:return 16;case dS:return 536870912;default:return 16}default:return 16}}var xl=null,A1=null,hm=null;function xS(){if(hm)return hm;var e,t=A1,n=t.length,o,c="value"in xl?xl.value:xl.textContent,d=c.length;for(e=0;e<n&&t[e]===c[e];e++);var p=n-e;for(o=1;o<=p&&t[n-o]===c[d-o];o++);return hm=c.slice(e,1<o?1-o:void 0)}function fm(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vp(){return!0}function Jw(){return!1}function Lo(e){function t(n,o,c,d,p){this._reactName=n,this._targetInst=c,this.type=o,this.nativeEvent=d,this.target=p,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(d):d[s]);return this.isDefaultPrevented=(d.defaultPrevented!=null?d.defaultPrevented:d.returnValue===!1)?Vp:Jw,this.isPropagationStopped=Jw,this}return kr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Vp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Vp)},persist:function(){},isPersistent:Vp}),t}var _d={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},I1=Lo(_d),bf=kr({},_d,{view:0,detail:0}),f8=Lo(bf),fy,py,mh,b0=kr({},bf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:M1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mh&&(mh&&e.type==="mousemove"?(fy=e.screenX-mh.screenX,py=e.screenY-mh.screenY):py=fy=0,mh=e),fy)},movementY:function(e){return"movementY"in e?e.movementY:py}}),Qw=Lo(b0),p8=kr({},b0,{dataTransfer:0}),m8=Lo(p8),g8=kr({},bf,{relatedTarget:0}),my=Lo(g8),y8=kr({},_d,{animationName:0,elapsedTime:0,pseudoElement:0}),v8=Lo(y8),_8=kr({},_d,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),x8=Lo(_8),b8=kr({},_d,{data:0}),e2=Lo(b8),w8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},E8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},T8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function S8(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=T8[e])?!!t[e]:!1}function M1(){return S8}var k8=kr({},bf,{key:function(e){if(e.key){var t=w8[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=fm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?E8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:M1,charCode:function(e){return e.type==="keypress"?fm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?fm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),C8=Lo(k8),P8=kr({},b0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t2=Lo(P8),A8=kr({},bf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:M1}),I8=Lo(A8),M8=kr({},_d,{propertyName:0,elapsedTime:0,pseudoElement:0}),D8=Lo(M8),R8=kr({},b0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),L8=Lo(R8),N8=[9,13,27,32],D1=Ms&&"CompositionEvent"in window,Mh=null;Ms&&"documentMode"in document&&(Mh=document.documentMode);var O8=Ms&&"TextEvent"in window&&!Mh,bS=Ms&&(!D1||Mh&&8<Mh&&11>=Mh),n2=String.fromCharCode(32),r2=!1;function wS(e,t){switch(e){case"keyup":return N8.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ES(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Lu=!1;function $8(e,t){switch(e){case"compositionend":return ES(t);case"keypress":return t.which!==32?null:(r2=!0,n2);case"textInput":return e=t.data,e===n2&&r2?null:e;default:return null}}function z8(e,t){if(Lu)return e==="compositionend"||!D1&&wS(e,t)?(e=xS(),hm=A1=xl=null,Lu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return bS&&t.locale!=="ko"?null:t.data;default:return null}}var B8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!B8[e.type]:t==="textarea"}function TS(e,t,n,o){tS(o),t=Fm(t,"onChange"),0<t.length&&(n=new I1("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var Dh=null,tf=null;function F8(e){NS(e,0)}function w0(e){var t=$u(e);if(ZT(t))return e}function U8(e,t){if(e==="change")return t}var SS=!1;if(Ms){var gy;if(Ms){var yy="oninput"in document;if(!yy){var o2=document.createElement("div");o2.setAttribute("oninput","return;"),yy=typeof o2.oninput=="function"}gy=yy}else gy=!1;SS=gy&&(!document.documentMode||9<document.documentMode)}function a2(){Dh&&(Dh.detachEvent("onpropertychange",kS),tf=Dh=null)}function kS(e){if(e.propertyName==="value"&&w0(tf)){var t=[];TS(t,tf,e,T1(e)),oS(F8,t)}}function V8(e,t,n){e==="focusin"?(a2(),Dh=t,tf=n,Dh.attachEvent("onpropertychange",kS)):e==="focusout"&&a2()}function j8(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return w0(tf)}function G8(e,t){if(e==="click")return w0(t)}function q8(e,t){if(e==="input"||e==="change")return w0(t)}function W8(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xa=typeof Object.is=="function"?Object.is:W8;function nf(e,t){if(xa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var c=n[o];if(!mv.call(t,c)||!xa(e[c],t[c]))return!1}return!0}function s2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function l2(e,t){var n=s2(e);e=0;for(var o;n;){if(n.nodeType===3){if(o=e+n.textContent.length,e<=t&&o>=t)return{node:n,offset:t-e};e=o}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=s2(n)}}function CS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function PS(){for(var e=window,t=Rm();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Rm(e.document)}return t}function R1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function H8(e){var t=PS(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&CS(n.ownerDocument.documentElement,n)){if(o!==null&&R1(n)){if(t=o.start,e=o.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var c=n.textContent.length,d=Math.min(o.start,c);o=o.end===void 0?d:Math.min(o.end,c),!e.extend&&d>o&&(c=o,o=d,d=c),c=l2(n,d);var p=l2(n,o);c&&p&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==p.node||e.focusOffset!==p.offset)&&(t=t.createRange(),t.setStart(c.node,c.offset),e.removeAllRanges(),d>o?(e.addRange(t),e.extend(p.node,p.offset)):(t.setEnd(p.node,p.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Z8=Ms&&"documentMode"in document&&11>=document.documentMode,Nu=null,Lv=null,Rh=null,Nv=!1;function c2(e,t,n){var o=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Nv||Nu==null||Nu!==Rm(o)||(o=Nu,"selectionStart"in o&&R1(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Rh&&nf(Rh,o)||(Rh=o,o=Fm(Lv,"onSelect"),0<o.length&&(t=new I1("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=Nu)))}function jp(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ou={animationend:jp("Animation","AnimationEnd"),animationiteration:jp("Animation","AnimationIteration"),animationstart:jp("Animation","AnimationStart"),transitionend:jp("Transition","TransitionEnd")},vy={},AS={};Ms&&(AS=document.createElement("div").style,"AnimationEvent"in window||(delete Ou.animationend.animation,delete Ou.animationiteration.animation,delete Ou.animationstart.animation),"TransitionEvent"in window||delete Ou.transitionend.transition);function E0(e){if(vy[e])return vy[e];if(!Ou[e])return e;var t=Ou[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in AS)return vy[e]=t[n];return e}var IS=E0("animationend"),MS=E0("animationiteration"),DS=E0("animationstart"),RS=E0("transitionend"),LS=new Map,u2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nl(e,t){LS.set(e,t),zc(t,[e])}for(var _y=0;_y<u2.length;_y++){var xy=u2[_y],K8=xy.toLowerCase(),X8=xy[0].toUpperCase()+xy.slice(1);Nl(K8,"on"+X8)}Nl(IS,"onAnimationEnd");Nl(MS,"onAnimationIteration");Nl(DS,"onAnimationStart");Nl("dblclick","onDoubleClick");Nl("focusin","onFocus");Nl("focusout","onBlur");Nl(RS,"onTransitionEnd");id("onMouseEnter",["mouseout","mouseover"]);id("onMouseLeave",["mouseout","mouseover"]);id("onPointerEnter",["pointerout","pointerover"]);id("onPointerLeave",["pointerout","pointerover"]);zc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));zc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));zc("onBeforeInput",["compositionend","keypress","textInput","paste"]);zc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));zc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));zc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ph="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y8=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ph));function d2(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,K9(o,t,void 0,e),e.currentTarget=null}function NS(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var o=e[n],c=o.event;o=o.listeners;e:{var d=void 0;if(t)for(var p=o.length-1;0<=p;p--){var s=o[p],_=s.instance,v=s.currentTarget;if(s=s.listener,_!==d&&c.isPropagationStopped())break e;d2(c,s,v),d=_}else for(p=0;p<o.length;p++){if(s=o[p],_=s.instance,v=s.currentTarget,s=s.listener,_!==d&&c.isPropagationStopped())break e;d2(c,s,v),d=_}}}if(Nm)throw e=Iv,Nm=!1,Iv=null,e}function fr(e,t){var n=t[Fv];n===void 0&&(n=t[Fv]=new Set);var o=e+"__bubble";n.has(o)||(OS(t,e,2,!1),n.add(o))}function by(e,t,n){var o=0;t&&(o|=4),OS(n,e,o,t)}var Gp="_reactListening"+Math.random().toString(36).slice(2);function rf(e){if(!e[Gp]){e[Gp]=!0,jT.forEach(function(n){n!=="selectionchange"&&(Y8.has(n)||by(n,!1,e),by(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Gp]||(t[Gp]=!0,by("selectionchange",!1,t))}}function OS(e,t,n,o){switch(_S(t)){case 1:var c=d8;break;case 4:c=h8;break;default:c=P1}n=c.bind(null,t,n,e),c=void 0,!Av||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(c=!0),o?c!==void 0?e.addEventListener(t,n,{capture:!0,passive:c}):e.addEventListener(t,n,!0):c!==void 0?e.addEventListener(t,n,{passive:c}):e.addEventListener(t,n,!1)}function wy(e,t,n,o,c){var d=o;if(!(t&1)&&!(t&2)&&o!==null)e:for(;;){if(o===null)return;var p=o.tag;if(p===3||p===4){var s=o.stateNode.containerInfo;if(s===c||s.nodeType===8&&s.parentNode===c)break;if(p===4)for(p=o.return;p!==null;){var _=p.tag;if((_===3||_===4)&&(_=p.stateNode.containerInfo,_===c||_.nodeType===8&&_.parentNode===c))return;p=p.return}for(;s!==null;){if(p=wc(s),p===null)return;if(_=p.tag,_===5||_===6){o=d=p;continue e}s=s.parentNode}}o=o.return}oS(function(){var v=d,E=T1(n),T=[];e:{var S=LS.get(e);if(S!==void 0){var D=I1,O=e;switch(e){case"keypress":if(fm(n)===0)break e;case"keydown":case"keyup":D=C8;break;case"focusin":O="focus",D=my;break;case"focusout":O="blur",D=my;break;case"beforeblur":case"afterblur":D=my;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":D=Qw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":D=m8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":D=I8;break;case IS:case MS:case DS:D=v8;break;case RS:D=D8;break;case"scroll":D=f8;break;case"wheel":D=L8;break;case"copy":case"cut":case"paste":D=x8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":D=t2}var M=(t&4)!==0,U=!M&&e==="scroll",$=M?S!==null?S+"Capture":null:S;M=[];for(var L=v,F;L!==null;){F=L;var J=F.stateNode;if(F.tag===5&&J!==null&&(F=J,$!==null&&(J=Yh(L,$),J!=null&&M.push(of(L,J,F)))),U)break;L=L.return}0<M.length&&(S=new D(S,O,null,n,E),T.push({event:S,listeners:M}))}}if(!(t&7)){e:{if(S=e==="mouseover"||e==="pointerover",D=e==="mouseout"||e==="pointerout",S&&n!==Cv&&(O=n.relatedTarget||n.fromElement)&&(wc(O)||O[Ds]))break e;if((D||S)&&(S=E.window===E?E:(S=E.ownerDocument)?S.defaultView||S.parentWindow:window,D?(O=n.relatedTarget||n.toElement,D=v,O=O?wc(O):null,O!==null&&(U=Bc(O),O!==U||O.tag!==5&&O.tag!==6)&&(O=null)):(D=null,O=v),D!==O)){if(M=Qw,J="onMouseLeave",$="onMouseEnter",L="mouse",(e==="pointerout"||e==="pointerover")&&(M=t2,J="onPointerLeave",$="onPointerEnter",L="pointer"),U=D==null?S:$u(D),F=O==null?S:$u(O),S=new M(J,L+"leave",D,n,E),S.target=U,S.relatedTarget=F,J=null,wc(E)===v&&(M=new M($,L+"enter",O,n,E),M.target=F,M.relatedTarget=U,J=M),U=J,D&&O)t:{for(M=D,$=O,L=0,F=M;F;F=bu(F))L++;for(F=0,J=$;J;J=bu(J))F++;for(;0<L-F;)M=bu(M),L--;for(;0<F-L;)$=bu($),F--;for(;L--;){if(M===$||$!==null&&M===$.alternate)break t;M=bu(M),$=bu($)}M=null}else M=null;D!==null&&h2(T,S,D,M,!1),O!==null&&U!==null&&h2(T,U,O,M,!0)}}e:{if(S=v?$u(v):window,D=S.nodeName&&S.nodeName.toLowerCase(),D==="select"||D==="input"&&S.type==="file")var V=U8;else if(i2(S))if(SS)V=q8;else{V=j8;var Z=V8}else(D=S.nodeName)&&D.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(V=G8);if(V&&(V=V(e,v))){TS(T,V,n,E);break e}Z&&Z(e,S,v),e==="focusout"&&(Z=S._wrapperState)&&Z.controlled&&S.type==="number"&&wv(S,"number",S.value)}switch(Z=v?$u(v):window,e){case"focusin":(i2(Z)||Z.contentEditable==="true")&&(Nu=Z,Lv=v,Rh=null);break;case"focusout":Rh=Lv=Nu=null;break;case"mousedown":Nv=!0;break;case"contextmenu":case"mouseup":case"dragend":Nv=!1,c2(T,n,E);break;case"selectionchange":if(Z8)break;case"keydown":case"keyup":c2(T,n,E)}var G;if(D1)e:{switch(e){case"compositionstart":var W="onCompositionStart";break e;case"compositionend":W="onCompositionEnd";break e;case"compositionupdate":W="onCompositionUpdate";break e}W=void 0}else Lu?wS(e,n)&&(W="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(W="onCompositionStart");W&&(bS&&n.locale!=="ko"&&(Lu||W!=="onCompositionStart"?W==="onCompositionEnd"&&Lu&&(G=xS()):(xl=E,A1="value"in xl?xl.value:xl.textContent,Lu=!0)),Z=Fm(v,W),0<Z.length&&(W=new e2(W,e,null,n,E),T.push({event:W,listeners:Z}),G?W.data=G:(G=ES(n),G!==null&&(W.data=G)))),(G=O8?$8(e,n):z8(e,n))&&(v=Fm(v,"onBeforeInput"),0<v.length&&(E=new e2("onBeforeInput","beforeinput",null,n,E),T.push({event:E,listeners:v}),E.data=G))}NS(T,t)})}function of(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fm(e,t){for(var n=t+"Capture",o=[];e!==null;){var c=e,d=c.stateNode;c.tag===5&&d!==null&&(c=d,d=Yh(e,n),d!=null&&o.unshift(of(e,d,c)),d=Yh(e,t),d!=null&&o.push(of(e,d,c))),e=e.return}return o}function bu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function h2(e,t,n,o,c){for(var d=t._reactName,p=[];n!==null&&n!==o;){var s=n,_=s.alternate,v=s.stateNode;if(_!==null&&_===o)break;s.tag===5&&v!==null&&(s=v,c?(_=Yh(n,d),_!=null&&p.unshift(of(n,_,s))):c||(_=Yh(n,d),_!=null&&p.push(of(n,_,s)))),n=n.return}p.length!==0&&e.push({event:t,listeners:p})}var J8=/\r\n?/g,Q8=/\u0000|\uFFFD/g;function f2(e){return(typeof e=="string"?e:""+e).replace(J8,`
`).replace(Q8,"")}function qp(e,t,n){if(t=f2(t),f2(e)!==t&&n)throw Error(bt(425))}function Um(){}var Ov=null,$v=null;function zv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Bv=typeof setTimeout=="function"?setTimeout:void 0,eM=typeof clearTimeout=="function"?clearTimeout:void 0,p2=typeof Promise=="function"?Promise:void 0,tM=typeof queueMicrotask=="function"?queueMicrotask:typeof p2<"u"?function(e){return p2.resolve(null).then(e).catch(nM)}:Bv;function nM(e){setTimeout(function(){throw e})}function Ey(e,t){var n=t,o=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(o===0){e.removeChild(c),ef(t);return}o--}else n!=="$"&&n!=="$?"&&n!=="$!"||o++;n=c}while(n);ef(t)}function Sl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function m2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var xd=Math.random().toString(36).slice(2),Fa="__reactFiber$"+xd,af="__reactProps$"+xd,Ds="__reactContainer$"+xd,Fv="__reactEvents$"+xd,rM="__reactListeners$"+xd,iM="__reactHandles$"+xd;function wc(e){var t=e[Fa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ds]||n[Fa]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=m2(e);e!==null;){if(n=e[Fa])return n;e=m2(e)}return t}e=n,n=e.parentNode}return null}function wf(e){return e=e[Fa]||e[Ds],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $u(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(bt(33))}function T0(e){return e[af]||null}var Uv=[],zu=-1;function Ol(e){return{current:e}}function pr(e){0>zu||(e.current=Uv[zu],Uv[zu]=null,zu--)}function ur(e,t){zu++,Uv[zu]=e.current,e.current=t}var Dl={},Fi=Ol(Dl),po=Ol(!1),Ic=Dl;function od(e,t){var n=e.type.contextTypes;if(!n)return Dl;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var c={},d;for(d in n)c[d]=t[d];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=c),c}function mo(e){return e=e.childContextTypes,e!=null}function Vm(){pr(po),pr(Fi)}function g2(e,t,n){if(Fi.current!==Dl)throw Error(bt(168));ur(Fi,t),ur(po,n)}function $S(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,typeof o.getChildContext!="function")return n;o=o.getChildContext();for(var c in o)if(!(c in t))throw Error(bt(108,V9(e)||"Unknown",c));return kr({},n,o)}function jm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Dl,Ic=Fi.current,ur(Fi,e),ur(po,po.current),!0}function y2(e,t,n){var o=e.stateNode;if(!o)throw Error(bt(169));n?(e=$S(e,t,Ic),o.__reactInternalMemoizedMergedChildContext=e,pr(po),pr(Fi),ur(Fi,e)):pr(po),ur(po,n)}var ws=null,S0=!1,Ty=!1;function zS(e){ws===null?ws=[e]:ws.push(e)}function oM(e){S0=!0,zS(e)}function $l(){if(!Ty&&ws!==null){Ty=!0;var e=0,t=Zn;try{var n=ws;for(Zn=1;e<n.length;e++){var o=n[e];do o=o(!0);while(o!==null)}ws=null,S0=!1}catch(c){throw ws!==null&&(ws=ws.slice(e+1)),cS(S1,$l),c}finally{Zn=t,Ty=!1}}return null}var Bu=[],Fu=0,Gm=null,qm=0,Ho=[],Zo=0,Mc=null,Ts=1,Ss="";function gc(e,t){Bu[Fu++]=qm,Bu[Fu++]=Gm,Gm=e,qm=t}function BS(e,t,n){Ho[Zo++]=Ts,Ho[Zo++]=Ss,Ho[Zo++]=Mc,Mc=e;var o=Ts;e=Ss;var c=32-ya(o)-1;o&=~(1<<c),n+=1;var d=32-ya(t)+c;if(30<d){var p=c-c%5;d=(o&(1<<p)-1).toString(32),o>>=p,c-=p,Ts=1<<32-ya(t)+c|n<<c|o,Ss=d+e}else Ts=1<<d|n<<c|o,Ss=e}function L1(e){e.return!==null&&(gc(e,1),BS(e,1,0))}function N1(e){for(;e===Gm;)Gm=Bu[--Fu],Bu[Fu]=null,qm=Bu[--Fu],Bu[Fu]=null;for(;e===Mc;)Mc=Ho[--Zo],Ho[Zo]=null,Ss=Ho[--Zo],Ho[Zo]=null,Ts=Ho[--Zo],Ho[Zo]=null}var Io=null,Ao=null,_r=!1,ma=null;function FS(e,t){var n=Yo(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function v2(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Io=e,Ao=Sl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Io=e,Ao=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Mc!==null?{id:Ts,overflow:Ss}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Yo(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Io=e,Ao=null,!0):!1;default:return!1}}function Vv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jv(e){if(_r){var t=Ao;if(t){var n=t;if(!v2(e,t)){if(Vv(e))throw Error(bt(418));t=Sl(n.nextSibling);var o=Io;t&&v2(e,t)?FS(o,n):(e.flags=e.flags&-4097|2,_r=!1,Io=e)}}else{if(Vv(e))throw Error(bt(418));e.flags=e.flags&-4097|2,_r=!1,Io=e}}}function _2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Io=e}function Wp(e){if(e!==Io)return!1;if(!_r)return _2(e),_r=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!zv(e.type,e.memoizedProps)),t&&(t=Ao)){if(Vv(e))throw US(),Error(bt(418));for(;t;)FS(e,t),t=Sl(t.nextSibling)}if(_2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(bt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ao=Sl(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ao=null}}else Ao=Io?Sl(e.stateNode.nextSibling):null;return!0}function US(){for(var e=Ao;e;)e=Sl(e.nextSibling)}function ad(){Ao=Io=null,_r=!1}function O1(e){ma===null?ma=[e]:ma.push(e)}var aM=Os.ReactCurrentBatchConfig;function fa(e,t){if(e&&e.defaultProps){t=kr({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Wm=Ol(null),Hm=null,Uu=null,$1=null;function z1(){$1=Uu=Hm=null}function B1(e){var t=Wm.current;pr(Wm),e._currentValue=t}function Gv(e,t,n){for(;e!==null;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,o!==null&&(o.childLanes|=t)):o!==null&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function Yu(e,t){Hm=e,$1=Uu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ho=!0),e.firstContext=null)}function ea(e){var t=e._currentValue;if($1!==e)if(e={context:e,memoizedValue:t,next:null},Uu===null){if(Hm===null)throw Error(bt(308));Uu=e,Hm.dependencies={lanes:0,firstContext:e}}else Uu=Uu.next=e;return t}var Ec=null;function F1(e){Ec===null?Ec=[e]:Ec.push(e)}function VS(e,t,n,o){var c=t.interleaved;return c===null?(n.next=n,F1(t)):(n.next=c.next,c.next=n),t.interleaved=n,Rs(e,o)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ml=!1;function U1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function kl(e,t,n){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,Ln&2){var c=o.pending;return c===null?t.next=t:(t.next=c.next,c.next=t),o.pending=t,Rs(e,n)}return c=o.interleaved,c===null?(t.next=t,F1(o)):(t.next=c.next,c.next=t),o.interleaved=t,Rs(e,n)}function pm(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,k1(e,n)}}function x2(e,t){var n=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,n===o)){var c=null,d=null;if(n=n.firstBaseUpdate,n!==null){do{var p={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};d===null?c=d=p:d=d.next=p,n=n.next}while(n!==null);d===null?c=d=t:d=d.next=t}else c=d=t;n={baseState:o.baseState,firstBaseUpdate:c,lastBaseUpdate:d,shared:o.shared,effects:o.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Zm(e,t,n,o){var c=e.updateQueue;ml=!1;var d=c.firstBaseUpdate,p=c.lastBaseUpdate,s=c.shared.pending;if(s!==null){c.shared.pending=null;var _=s,v=_.next;_.next=null,p===null?d=v:p.next=v,p=_;var E=e.alternate;E!==null&&(E=E.updateQueue,s=E.lastBaseUpdate,s!==p&&(s===null?E.firstBaseUpdate=v:s.next=v,E.lastBaseUpdate=_))}if(d!==null){var T=c.baseState;p=0,E=v=_=null,s=d;do{var S=s.lane,D=s.eventTime;if((o&S)===S){E!==null&&(E=E.next={eventTime:D,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var O=e,M=s;switch(S=t,D=n,M.tag){case 1:if(O=M.payload,typeof O=="function"){T=O.call(D,T,S);break e}T=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=M.payload,S=typeof O=="function"?O.call(D,T,S):O,S==null)break e;T=kr({},T,S);break e;case 2:ml=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,S=c.effects,S===null?c.effects=[s]:S.push(s))}else D={eventTime:D,lane:S,tag:s.tag,payload:s.payload,callback:s.callback,next:null},E===null?(v=E=D,_=T):E=E.next=D,p|=S;if(s=s.next,s===null){if(s=c.shared.pending,s===null)break;S=s,s=S.next,S.next=null,c.lastBaseUpdate=S,c.shared.pending=null}}while(1);if(E===null&&(_=T),c.baseState=_,c.firstBaseUpdate=v,c.lastBaseUpdate=E,t=c.shared.interleaved,t!==null){c=t;do p|=c.lane,c=c.next;while(c!==t)}else d===null&&(c.shared.lanes=0);Rc|=p,e.lanes=p,e.memoizedState=T}}function b2(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var o=e[t],c=o.callback;if(c!==null){if(o.callback=null,o=n,typeof c!="function")throw Error(bt(191,c));c.call(o)}}}var GS=new VT.Component().refs;function qv(e,t,n,o){t=e.memoizedState,n=n(o,t),n=n==null?t:kr({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var k0={isMounted:function(e){return(e=e._reactInternals)?Bc(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=eo(),c=Pl(e),d=Cs(o,c);d.payload=t,n!=null&&(d.callback=n),t=kl(e,d,c),t!==null&&(va(t,e,c,o),pm(t,e,c))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=eo(),c=Pl(e),d=Cs(o,c);d.tag=1,d.payload=t,n!=null&&(d.callback=n),t=kl(e,d,c),t!==null&&(va(t,e,c,o),pm(t,e,c))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=eo(),o=Pl(e),c=Cs(n,o);c.tag=2,t!=null&&(c.callback=t),t=kl(e,c,o),t!==null&&(va(t,e,o,n),pm(t,e,o))}};function w2(e,t,n,o,c,d,p){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,d,p):t.prototype&&t.prototype.isPureReactComponent?!nf(n,o)||!nf(c,d):!0}function qS(e,t,n){var o=!1,c=Dl,d=t.contextType;return typeof d=="object"&&d!==null?d=ea(d):(c=mo(t)?Ic:Fi.current,o=t.contextTypes,d=(o=o!=null)?od(e,c):Dl),t=new t(n,d),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=k0,e.stateNode=t,t._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=d),t}function E2(e,t,n,o){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,o),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&k0.enqueueReplaceState(t,t.state,null)}function Wv(e,t,n,o){var c=e.stateNode;c.props=n,c.state=e.memoizedState,c.refs=GS,U1(e);var d=t.contextType;typeof d=="object"&&d!==null?c.context=ea(d):(d=mo(t)?Ic:Fi.current,c.context=od(e,d)),c.state=e.memoizedState,d=t.getDerivedStateFromProps,typeof d=="function"&&(qv(e,t,d,n),c.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(t=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),t!==c.state&&k0.enqueueReplaceState(c,c.state,null),Zm(e,n,c,o),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function gh(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(bt(309));var o=n.stateNode}if(!o)throw Error(bt(147,e));var c=o,d=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===d?t.ref:(t=function(p){var s=c.refs;s===GS&&(s=c.refs={}),p===null?delete s[d]:s[d]=p},t._stringRef=d,t)}if(typeof e!="string")throw Error(bt(284));if(!n._owner)throw Error(bt(290,e))}return e}function Hp(e,t){throw e=Object.prototype.toString.call(t),Error(bt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function T2(e){var t=e._init;return t(e._payload)}function WS(e){function t($,L){if(e){var F=$.deletions;F===null?($.deletions=[L],$.flags|=16):F.push(L)}}function n($,L){if(!e)return null;for(;L!==null;)t($,L),L=L.sibling;return null}function o($,L){for($=new Map;L!==null;)L.key!==null?$.set(L.key,L):$.set(L.index,L),L=L.sibling;return $}function c($,L){return $=Al($,L),$.index=0,$.sibling=null,$}function d($,L,F){return $.index=F,e?(F=$.alternate,F!==null?(F=F.index,F<L?($.flags|=2,L):F):($.flags|=2,L)):($.flags|=1048576,L)}function p($){return e&&$.alternate===null&&($.flags|=2),$}function s($,L,F,J){return L===null||L.tag!==6?(L=My(F,$.mode,J),L.return=$,L):(L=c(L,F),L.return=$,L)}function _($,L,F,J){var V=F.type;return V===Ru?E($,L,F.props.children,J,F.key):L!==null&&(L.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===pl&&T2(V)===L.type)?(J=c(L,F.props),J.ref=gh($,L,F),J.return=$,J):(J=xm(F.type,F.key,F.props,null,$.mode,J),J.ref=gh($,L,F),J.return=$,J)}function v($,L,F,J){return L===null||L.tag!==4||L.stateNode.containerInfo!==F.containerInfo||L.stateNode.implementation!==F.implementation?(L=Dy(F,$.mode,J),L.return=$,L):(L=c(L,F.children||[]),L.return=$,L)}function E($,L,F,J,V){return L===null||L.tag!==7?(L=Pc(F,$.mode,J,V),L.return=$,L):(L=c(L,F),L.return=$,L)}function T($,L,F){if(typeof L=="string"&&L!==""||typeof L=="number")return L=My(""+L,$.mode,F),L.return=$,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Op:return F=xm(L.type,L.key,L.props,null,$.mode,F),F.ref=gh($,null,L),F.return=$,F;case Du:return L=Dy(L,$.mode,F),L.return=$,L;case pl:var J=L._init;return T($,J(L._payload),F)}if(kh(L)||dh(L))return L=Pc(L,$.mode,F,null),L.return=$,L;Hp($,L)}return null}function S($,L,F,J){var V=L!==null?L.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return V!==null?null:s($,L,""+F,J);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case Op:return F.key===V?_($,L,F,J):null;case Du:return F.key===V?v($,L,F,J):null;case pl:return V=F._init,S($,L,V(F._payload),J)}if(kh(F)||dh(F))return V!==null?null:E($,L,F,J,null);Hp($,F)}return null}function D($,L,F,J,V){if(typeof J=="string"&&J!==""||typeof J=="number")return $=$.get(F)||null,s(L,$,""+J,V);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case Op:return $=$.get(J.key===null?F:J.key)||null,_(L,$,J,V);case Du:return $=$.get(J.key===null?F:J.key)||null,v(L,$,J,V);case pl:var Z=J._init;return D($,L,F,Z(J._payload),V)}if(kh(J)||dh(J))return $=$.get(F)||null,E(L,$,J,V,null);Hp(L,J)}return null}function O($,L,F,J){for(var V=null,Z=null,G=L,W=L=0,le=null;G!==null&&W<F.length;W++){G.index>W?(le=G,G=null):le=G.sibling;var Ie=S($,G,F[W],J);if(Ie===null){G===null&&(G=le);break}e&&G&&Ie.alternate===null&&t($,G),L=d(Ie,L,W),Z===null?V=Ie:Z.sibling=Ie,Z=Ie,G=le}if(W===F.length)return n($,G),_r&&gc($,W),V;if(G===null){for(;W<F.length;W++)G=T($,F[W],J),G!==null&&(L=d(G,L,W),Z===null?V=G:Z.sibling=G,Z=G);return _r&&gc($,W),V}for(G=o($,G);W<F.length;W++)le=D(G,$,W,F[W],J),le!==null&&(e&&le.alternate!==null&&G.delete(le.key===null?W:le.key),L=d(le,L,W),Z===null?V=le:Z.sibling=le,Z=le);return e&&G.forEach(function(be){return t($,be)}),_r&&gc($,W),V}function M($,L,F,J){var V=dh(F);if(typeof V!="function")throw Error(bt(150));if(F=V.call(F),F==null)throw Error(bt(151));for(var Z=V=null,G=L,W=L=0,le=null,Ie=F.next();G!==null&&!Ie.done;W++,Ie=F.next()){G.index>W?(le=G,G=null):le=G.sibling;var be=S($,G,Ie.value,J);if(be===null){G===null&&(G=le);break}e&&G&&be.alternate===null&&t($,G),L=d(be,L,W),Z===null?V=be:Z.sibling=be,Z=be,G=le}if(Ie.done)return n($,G),_r&&gc($,W),V;if(G===null){for(;!Ie.done;W++,Ie=F.next())Ie=T($,Ie.value,J),Ie!==null&&(L=d(Ie,L,W),Z===null?V=Ie:Z.sibling=Ie,Z=Ie);return _r&&gc($,W),V}for(G=o($,G);!Ie.done;W++,Ie=F.next())Ie=D(G,$,W,Ie.value,J),Ie!==null&&(e&&Ie.alternate!==null&&G.delete(Ie.key===null?W:Ie.key),L=d(Ie,L,W),Z===null?V=Ie:Z.sibling=Ie,Z=Ie);return e&&G.forEach(function(de){return t($,de)}),_r&&gc($,W),V}function U($,L,F,J){if(typeof F=="object"&&F!==null&&F.type===Ru&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case Op:e:{for(var V=F.key,Z=L;Z!==null;){if(Z.key===V){if(V=F.type,V===Ru){if(Z.tag===7){n($,Z.sibling),L=c(Z,F.props.children),L.return=$,$=L;break e}}else if(Z.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===pl&&T2(V)===Z.type){n($,Z.sibling),L=c(Z,F.props),L.ref=gh($,Z,F),L.return=$,$=L;break e}n($,Z);break}else t($,Z);Z=Z.sibling}F.type===Ru?(L=Pc(F.props.children,$.mode,J,F.key),L.return=$,$=L):(J=xm(F.type,F.key,F.props,null,$.mode,J),J.ref=gh($,L,F),J.return=$,$=J)}return p($);case Du:e:{for(Z=F.key;L!==null;){if(L.key===Z)if(L.tag===4&&L.stateNode.containerInfo===F.containerInfo&&L.stateNode.implementation===F.implementation){n($,L.sibling),L=c(L,F.children||[]),L.return=$,$=L;break e}else{n($,L);break}else t($,L);L=L.sibling}L=Dy(F,$.mode,J),L.return=$,$=L}return p($);case pl:return Z=F._init,U($,L,Z(F._payload),J)}if(kh(F))return O($,L,F,J);if(dh(F))return M($,L,F,J);Hp($,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,L!==null&&L.tag===6?(n($,L.sibling),L=c(L,F),L.return=$,$=L):(n($,L),L=My(F,$.mode,J),L.return=$,$=L),p($)):n($,L)}return U}var sd=WS(!0),HS=WS(!1),Ef={},qa=Ol(Ef),sf=Ol(Ef),lf=Ol(Ef);function Tc(e){if(e===Ef)throw Error(bt(174));return e}function V1(e,t){switch(ur(lf,t),ur(sf,e),ur(qa,Ef),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Tv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Tv(t,e)}pr(qa),ur(qa,t)}function ld(){pr(qa),pr(sf),pr(lf)}function ZS(e){Tc(lf.current);var t=Tc(qa.current),n=Tv(t,e.type);t!==n&&(ur(sf,e),ur(qa,n))}function j1(e){sf.current===e&&(pr(qa),pr(sf))}var Tr=Ol(0);function Km(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sy=[];function G1(){for(var e=0;e<Sy.length;e++)Sy[e]._workInProgressVersionPrimary=null;Sy.length=0}var mm=Os.ReactCurrentDispatcher,ky=Os.ReactCurrentBatchConfig,Dc=0,Sr=null,ni=null,fi=null,Xm=!1,Lh=!1,cf=0,sM=0;function $i(){throw Error(bt(321))}function q1(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!xa(e[n],t[n]))return!1;return!0}function W1(e,t,n,o,c,d){if(Dc=d,Sr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,mm.current=e===null||e.memoizedState===null?dM:hM,e=n(o,c),Lh){d=0;do{if(Lh=!1,cf=0,25<=d)throw Error(bt(301));d+=1,fi=ni=null,t.updateQueue=null,mm.current=fM,e=n(o,c)}while(Lh)}if(mm.current=Ym,t=ni!==null&&ni.next!==null,Dc=0,fi=ni=Sr=null,Xm=!1,t)throw Error(bt(300));return e}function H1(){var e=cf!==0;return cf=0,e}function Ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fi===null?Sr.memoizedState=fi=e:fi=fi.next=e,fi}function ta(){if(ni===null){var e=Sr.alternate;e=e!==null?e.memoizedState:null}else e=ni.next;var t=fi===null?Sr.memoizedState:fi.next;if(t!==null)fi=t,ni=e;else{if(e===null)throw Error(bt(310));ni=e,e={memoizedState:ni.memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},fi===null?Sr.memoizedState=fi=e:fi=fi.next=e}return fi}function uf(e,t){return typeof t=="function"?t(e):t}function Cy(e){var t=ta(),n=t.queue;if(n===null)throw Error(bt(311));n.lastRenderedReducer=e;var o=ni,c=o.baseQueue,d=n.pending;if(d!==null){if(c!==null){var p=c.next;c.next=d.next,d.next=p}o.baseQueue=c=d,n.pending=null}if(c!==null){d=c.next,o=o.baseState;var s=p=null,_=null,v=d;do{var E=v.lane;if((Dc&E)===E)_!==null&&(_=_.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),o=v.hasEagerState?v.eagerState:e(o,v.action);else{var T={lane:E,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};_===null?(s=_=T,p=o):_=_.next=T,Sr.lanes|=E,Rc|=E}v=v.next}while(v!==null&&v!==d);_===null?p=o:_.next=s,xa(o,t.memoizedState)||(ho=!0),t.memoizedState=o,t.baseState=p,t.baseQueue=_,n.lastRenderedState=o}if(e=n.interleaved,e!==null){c=e;do d=c.lane,Sr.lanes|=d,Rc|=d,c=c.next;while(c!==e)}else c===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Py(e){var t=ta(),n=t.queue;if(n===null)throw Error(bt(311));n.lastRenderedReducer=e;var o=n.dispatch,c=n.pending,d=t.memoizedState;if(c!==null){n.pending=null;var p=c=c.next;do d=e(d,p.action),p=p.next;while(p!==c);xa(d,t.memoizedState)||(ho=!0),t.memoizedState=d,t.baseQueue===null&&(t.baseState=d),n.lastRenderedState=d}return[d,o]}function KS(){}function XS(e,t){var n=Sr,o=ta(),c=t(),d=!xa(o.memoizedState,c);if(d&&(o.memoizedState=c,ho=!0),o=o.queue,Z1(QS.bind(null,n,o,e),[e]),o.getSnapshot!==t||d||fi!==null&&fi.memoizedState.tag&1){if(n.flags|=2048,df(9,JS.bind(null,n,o,c,t),void 0,null),mi===null)throw Error(bt(349));Dc&30||YS(n,t,c)}return c}function YS(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Sr.updateQueue,t===null?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function JS(e,t,n,o){t.value=n,t.getSnapshot=o,ek(t)&&tk(e)}function QS(e,t,n){return n(function(){ek(t)&&tk(e)})}function ek(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!xa(e,n)}catch{return!0}}function tk(e){var t=Rs(e,1);t!==null&&va(t,e,1,-1)}function S2(e){var t=Ba();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uf,lastRenderedState:e},t.queue=e,e=e.dispatch=uM.bind(null,Sr,e),[t.memoizedState,e]}function df(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},t=Sr.updateQueue,t===null?(t={lastEffect:null,stores:null},Sr.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e)),e}function nk(){return ta().memoizedState}function gm(e,t,n,o){var c=Ba();Sr.flags|=e,c.memoizedState=df(1|t,n,void 0,o===void 0?null:o)}function C0(e,t,n,o){var c=ta();o=o===void 0?null:o;var d=void 0;if(ni!==null){var p=ni.memoizedState;if(d=p.destroy,o!==null&&q1(o,p.deps)){c.memoizedState=df(t,n,d,o);return}}Sr.flags|=e,c.memoizedState=df(1|t,n,d,o)}function k2(e,t){return gm(8390656,8,e,t)}function Z1(e,t){return C0(2048,8,e,t)}function rk(e,t){return C0(4,2,e,t)}function ik(e,t){return C0(4,4,e,t)}function ok(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ak(e,t,n){return n=n!=null?n.concat([e]):null,C0(4,4,ok.bind(null,t,e),n)}function K1(){}function sk(e,t){var n=ta();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&q1(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function lk(e,t){var n=ta();t=t===void 0?null:t;var o=n.memoizedState;return o!==null&&t!==null&&q1(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function ck(e,t,n){return Dc&21?(xa(n,t)||(n=hS(),Sr.lanes|=n,Rc|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ho=!0),e.memoizedState=n)}function lM(e,t){var n=Zn;Zn=n!==0&&4>n?n:4,e(!0);var o=ky.transition;ky.transition={};try{e(!1),t()}finally{Zn=n,ky.transition=o}}function uk(){return ta().memoizedState}function cM(e,t,n){var o=Pl(e);if(n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},dk(e))hk(t,n);else if(n=VS(e,t,n,o),n!==null){var c=eo();va(n,e,o,c),fk(n,t,o)}}function uM(e,t,n){var o=Pl(e),c={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(dk(e))hk(t,c);else{var d=e.alternate;if(e.lanes===0&&(d===null||d.lanes===0)&&(d=t.lastRenderedReducer,d!==null))try{var p=t.lastRenderedState,s=d(p,n);if(c.hasEagerState=!0,c.eagerState=s,xa(s,p)){var _=t.interleaved;_===null?(c.next=c,F1(t)):(c.next=_.next,_.next=c),t.interleaved=c;return}}catch{}finally{}n=VS(e,t,c,o),n!==null&&(c=eo(),va(n,e,o,c),fk(n,t,o))}}function dk(e){var t=e.alternate;return e===Sr||t!==null&&t===Sr}function hk(e,t){Lh=Xm=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fk(e,t,n){if(n&4194240){var o=t.lanes;o&=e.pendingLanes,n|=o,t.lanes=n,k1(e,n)}}var Ym={readContext:ea,useCallback:$i,useContext:$i,useEffect:$i,useImperativeHandle:$i,useInsertionEffect:$i,useLayoutEffect:$i,useMemo:$i,useReducer:$i,useRef:$i,useState:$i,useDebugValue:$i,useDeferredValue:$i,useTransition:$i,useMutableSource:$i,useSyncExternalStore:$i,useId:$i,unstable_isNewReconciler:!1},dM={readContext:ea,useCallback:function(e,t){return Ba().memoizedState=[e,t===void 0?null:t],e},useContext:ea,useEffect:k2,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,gm(4194308,4,ok.bind(null,t,e),n)},useLayoutEffect:function(e,t){return gm(4194308,4,e,t)},useInsertionEffect:function(e,t){return gm(4,2,e,t)},useMemo:function(e,t){var n=Ba();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=Ba();return t=n!==void 0?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=cM.bind(null,Sr,e),[o.memoizedState,e]},useRef:function(e){var t=Ba();return e={current:e},t.memoizedState=e},useState:S2,useDebugValue:K1,useDeferredValue:function(e){return Ba().memoizedState=e},useTransition:function(){var e=S2(!1),t=e[0];return e=lM.bind(null,e[1]),Ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=Sr,c=Ba();if(_r){if(n===void 0)throw Error(bt(407));n=n()}else{if(n=t(),mi===null)throw Error(bt(349));Dc&30||YS(o,t,n)}c.memoizedState=n;var d={value:n,getSnapshot:t};return c.queue=d,k2(QS.bind(null,o,d,e),[e]),o.flags|=2048,df(9,JS.bind(null,o,d,n,t),void 0,null),n},useId:function(){var e=Ba(),t=mi.identifierPrefix;if(_r){var n=Ss,o=Ts;n=(o&~(1<<32-ya(o)-1)).toString(32)+n,t=":"+t+"R"+n,n=cf++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=sM++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hM={readContext:ea,useCallback:sk,useContext:ea,useEffect:Z1,useImperativeHandle:ak,useInsertionEffect:rk,useLayoutEffect:ik,useMemo:lk,useReducer:Cy,useRef:nk,useState:function(){return Cy(uf)},useDebugValue:K1,useDeferredValue:function(e){var t=ta();return ck(t,ni.memoizedState,e)},useTransition:function(){var e=Cy(uf)[0],t=ta().memoizedState;return[e,t]},useMutableSource:KS,useSyncExternalStore:XS,useId:uk,unstable_isNewReconciler:!1},fM={readContext:ea,useCallback:sk,useContext:ea,useEffect:Z1,useImperativeHandle:ak,useInsertionEffect:rk,useLayoutEffect:ik,useMemo:lk,useReducer:Py,useRef:nk,useState:function(){return Py(uf)},useDebugValue:K1,useDeferredValue:function(e){var t=ta();return ni===null?t.memoizedState=e:ck(t,ni.memoizedState,e)},useTransition:function(){var e=Py(uf)[0],t=ta().memoizedState;return[e,t]},useMutableSource:KS,useSyncExternalStore:XS,useId:uk,unstable_isNewReconciler:!1};function cd(e,t){try{var n="",o=t;do n+=U9(o),o=o.return;while(o);var c=n}catch(d){c=`
Error generating stack: `+d.message+`
`+d.stack}return{value:e,source:t,stack:c,digest:null}}function Ay(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Hv(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pM=typeof WeakMap=="function"?WeakMap:Map;function pk(e,t,n){n=Cs(-1,n),n.tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){Qm||(Qm=!0,r_=o),Hv(e,t)},n}function mk(e,t,n){n=Cs(-1,n),n.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var c=t.value;n.payload=function(){return o(c)},n.callback=function(){Hv(e,t)}}var d=e.stateNode;return d!==null&&typeof d.componentDidCatch=="function"&&(n.callback=function(){Hv(e,t),typeof o!="function"&&(Cl===null?Cl=new Set([this]):Cl.add(this));var p=t.stack;this.componentDidCatch(t.value,{componentStack:p!==null?p:""})}),n}function C2(e,t,n){var o=e.pingCache;if(o===null){o=e.pingCache=new pM;var c=new Set;o.set(t,c)}else c=o.get(t),c===void 0&&(c=new Set,o.set(t,c));c.has(n)||(c.add(n),e=PM.bind(null,e,t,n),t.then(e,e))}function P2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function A2(e,t,n,o,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Cs(-1,1),t.tag=2,kl(n,t,1))),n.lanes|=1),e)}var mM=Os.ReactCurrentOwner,ho=!1;function Yi(e,t,n,o){t.child=e===null?HS(t,null,n,o):sd(t,e.child,n,o)}function I2(e,t,n,o,c){n=n.render;var d=t.ref;return Yu(t,c),o=W1(e,t,n,o,d,c),n=H1(),e!==null&&!ho?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Ls(e,t,c)):(_r&&n&&L1(t),t.flags|=1,Yi(e,t,o,c),t.child)}function M2(e,t,n,o,c){if(e===null){var d=n.type;return typeof d=="function"&&!rx(d)&&d.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=d,gk(e,t,d,o,c)):(e=xm(n.type,null,o,t,t.mode,c),e.ref=t.ref,e.return=t,t.child=e)}if(d=e.child,!(e.lanes&c)){var p=d.memoizedProps;if(n=n.compare,n=n!==null?n:nf,n(p,o)&&e.ref===t.ref)return Ls(e,t,c)}return t.flags|=1,e=Al(d,o),e.ref=t.ref,e.return=t,t.child=e}function gk(e,t,n,o,c){if(e!==null){var d=e.memoizedProps;if(nf(d,o)&&e.ref===t.ref)if(ho=!1,t.pendingProps=o=d,(e.lanes&c)!==0)e.flags&131072&&(ho=!0);else return t.lanes=e.lanes,Ls(e,t,c)}return Zv(e,t,n,o,c)}function yk(e,t,n){var o=t.pendingProps,c=o.children,d=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur(ju,Po),Po|=n;else{if(!(n&1073741824))return e=d!==null?d.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ur(ju,Po),Po|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=d!==null?d.baseLanes:n,ur(ju,Po),Po|=o}else d!==null?(o=d.baseLanes|n,t.memoizedState=null):o=n,ur(ju,Po),Po|=o;return Yi(e,t,c,n),t.child}function vk(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Zv(e,t,n,o,c){var d=mo(n)?Ic:Fi.current;return d=od(t,d),Yu(t,c),n=W1(e,t,n,o,d,c),o=H1(),e!==null&&!ho?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~c,Ls(e,t,c)):(_r&&o&&L1(t),t.flags|=1,Yi(e,t,n,c),t.child)}function D2(e,t,n,o,c){if(mo(n)){var d=!0;jm(t)}else d=!1;if(Yu(t,c),t.stateNode===null)ym(e,t),qS(t,n,o),Wv(t,n,o,c),o=!0;else if(e===null){var p=t.stateNode,s=t.memoizedProps;p.props=s;var _=p.context,v=n.contextType;typeof v=="object"&&v!==null?v=ea(v):(v=mo(n)?Ic:Fi.current,v=od(t,v));var E=n.getDerivedStateFromProps,T=typeof E=="function"||typeof p.getSnapshotBeforeUpdate=="function";T||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(s!==o||_!==v)&&E2(t,p,o,v),ml=!1;var S=t.memoizedState;p.state=S,Zm(t,o,p,c),_=t.memoizedState,s!==o||S!==_||po.current||ml?(typeof E=="function"&&(qv(t,n,E,o),_=t.memoizedState),(s=ml||w2(t,n,s,o,S,_,v))?(T||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(t.flags|=4194308)):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=_),p.props=o,p.state=_,p.context=v,o=s):(typeof p.componentDidMount=="function"&&(t.flags|=4194308),o=!1)}else{p=t.stateNode,jS(e,t),s=t.memoizedProps,v=t.type===t.elementType?s:fa(t.type,s),p.props=v,T=t.pendingProps,S=p.context,_=n.contextType,typeof _=="object"&&_!==null?_=ea(_):(_=mo(n)?Ic:Fi.current,_=od(t,_));var D=n.getDerivedStateFromProps;(E=typeof D=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(s!==T||S!==_)&&E2(t,p,o,_),ml=!1,S=t.memoizedState,p.state=S,Zm(t,o,p,c);var O=t.memoizedState;s!==T||S!==O||po.current||ml?(typeof D=="function"&&(qv(t,n,D,o),O=t.memoizedState),(v=ml||w2(t,n,v,o,S,O,_)||!1)?(E||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(o,O,_),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(o,O,_)),typeof p.componentDidUpdate=="function"&&(t.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof p.componentDidUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=O),p.props=o,p.state=O,p.context=_,o=v):(typeof p.componentDidUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&S===e.memoizedState||(t.flags|=1024),o=!1)}return Kv(e,t,n,o,d,c)}function Kv(e,t,n,o,c,d){vk(e,t);var p=(t.flags&128)!==0;if(!o&&!p)return c&&y2(t,n,!1),Ls(e,t,d);o=t.stateNode,mM.current=t;var s=p&&typeof n.getDerivedStateFromError!="function"?null:o.render();return t.flags|=1,e!==null&&p?(t.child=sd(t,e.child,null,d),t.child=sd(t,null,s,d)):Yi(e,t,s,d),t.memoizedState=o.state,c&&y2(t,n,!0),t.child}function _k(e){var t=e.stateNode;t.pendingContext?g2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&g2(e,t.context,!1),V1(e,t.containerInfo)}function R2(e,t,n,o,c){return ad(),O1(c),t.flags|=256,Yi(e,t,n,o),t.child}var Xv={dehydrated:null,treeContext:null,retryLane:0};function Yv(e){return{baseLanes:e,cachePool:null,transitions:null}}function xk(e,t,n){var o=t.pendingProps,c=Tr.current,d=!1,p=(t.flags&128)!==0,s;if((s=p)||(s=e!==null&&e.memoizedState===null?!1:(c&2)!==0),s?(d=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),ur(Tr,c&1),e===null)return jv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(p=o.children,e=o.fallback,d?(o=t.mode,d=t.child,p={mode:"hidden",children:p},!(o&1)&&d!==null?(d.childLanes=0,d.pendingProps=p):d=I0(p,o,0,null),e=Pc(e,o,n,null),d.return=t,e.return=t,d.sibling=e,t.child=d,t.child.memoizedState=Yv(n),t.memoizedState=Xv,e):X1(t,p));if(c=e.memoizedState,c!==null&&(s=c.dehydrated,s!==null))return gM(e,t,p,o,s,c,n);if(d){d=o.fallback,p=t.mode,c=e.child,s=c.sibling;var _={mode:"hidden",children:o.children};return!(p&1)&&t.child!==c?(o=t.child,o.childLanes=0,o.pendingProps=_,t.deletions=null):(o=Al(c,_),o.subtreeFlags=c.subtreeFlags&14680064),s!==null?d=Al(s,d):(d=Pc(d,p,n,null),d.flags|=2),d.return=t,o.return=t,o.sibling=d,t.child=o,o=d,d=t.child,p=e.child.memoizedState,p=p===null?Yv(n):{baseLanes:p.baseLanes|n,cachePool:null,transitions:p.transitions},d.memoizedState=p,d.childLanes=e.childLanes&~n,t.memoizedState=Xv,o}return d=e.child,e=d.sibling,o=Al(d,{mode:"visible",children:o.children}),!(t.mode&1)&&(o.lanes=n),o.return=t,o.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function X1(e,t){return t=I0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Zp(e,t,n,o){return o!==null&&O1(o),sd(t,e.child,null,n),e=X1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gM(e,t,n,o,c,d,p){if(n)return t.flags&256?(t.flags&=-257,o=Ay(Error(bt(422))),Zp(e,t,p,o)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(d=o.fallback,c=t.mode,o=I0({mode:"visible",children:o.children},c,0,null),d=Pc(d,c,p,null),d.flags|=2,o.return=t,d.return=t,o.sibling=d,t.child=o,t.mode&1&&sd(t,e.child,null,p),t.child.memoizedState=Yv(p),t.memoizedState=Xv,d);if(!(t.mode&1))return Zp(e,t,p,null);if(c.data==="$!"){if(o=c.nextSibling&&c.nextSibling.dataset,o)var s=o.dgst;return o=s,d=Error(bt(419)),o=Ay(d,o,void 0),Zp(e,t,p,o)}if(s=(p&e.childLanes)!==0,ho||s){if(o=mi,o!==null){switch(p&-p){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(o.suspendedLanes|p)?0:c,c!==0&&c!==d.retryLane&&(d.retryLane=c,Rs(e,c),va(o,e,c,-1))}return nx(),o=Ay(Error(bt(421))),Zp(e,t,p,o)}return c.data==="$?"?(t.flags|=128,t.child=e.child,t=AM.bind(null,e),c._reactRetry=t,null):(e=d.treeContext,Ao=Sl(c.nextSibling),Io=t,_r=!0,ma=null,e!==null&&(Ho[Zo++]=Ts,Ho[Zo++]=Ss,Ho[Zo++]=Mc,Ts=e.id,Ss=e.overflow,Mc=t),t=X1(t,o.children),t.flags|=4096,t)}function L2(e,t,n){e.lanes|=t;var o=e.alternate;o!==null&&(o.lanes|=t),Gv(e.return,t,n)}function Iy(e,t,n,o,c){var d=e.memoizedState;d===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:c}:(d.isBackwards=t,d.rendering=null,d.renderingStartTime=0,d.last=o,d.tail=n,d.tailMode=c)}function bk(e,t,n){var o=t.pendingProps,c=o.revealOrder,d=o.tail;if(Yi(e,t,o.children,n),o=Tr.current,o&2)o=o&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&L2(e,n,t);else if(e.tag===19)L2(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(ur(Tr,o),!(t.mode&1))t.memoizedState=null;else switch(c){case"forwards":for(n=t.child,c=null;n!==null;)e=n.alternate,e!==null&&Km(e)===null&&(c=n),n=n.sibling;n=c,n===null?(c=t.child,t.child=null):(c=n.sibling,n.sibling=null),Iy(t,!1,c,n,d);break;case"backwards":for(n=null,c=t.child,t.child=null;c!==null;){if(e=c.alternate,e!==null&&Km(e)===null){t.child=c;break}e=c.sibling,c.sibling=n,n=c,c=e}Iy(t,!0,n,null,d);break;case"together":Iy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ym(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ls(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Rc|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(bt(153));if(t.child!==null){for(e=t.child,n=Al(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Al(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function yM(e,t,n){switch(t.tag){case 3:_k(t),ad();break;case 5:ZS(t);break;case 1:mo(t.type)&&jm(t);break;case 4:V1(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,c=t.memoizedProps.value;ur(Wm,o._currentValue),o._currentValue=c;break;case 13:if(o=t.memoizedState,o!==null)return o.dehydrated!==null?(ur(Tr,Tr.current&1),t.flags|=128,null):n&t.child.childLanes?xk(e,t,n):(ur(Tr,Tr.current&1),e=Ls(e,t,n),e!==null?e.sibling:null);ur(Tr,Tr.current&1);break;case 19:if(o=(n&t.childLanes)!==0,e.flags&128){if(o)return bk(e,t,n);t.flags|=128}if(c=t.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),ur(Tr,Tr.current),o)break;return null;case 22:case 23:return t.lanes=0,yk(e,t,n)}return Ls(e,t,n)}var wk,Jv,Ek,Tk;wk=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Jv=function(){};Ek=function(e,t,n,o){var c=e.memoizedProps;if(c!==o){e=t.stateNode,Tc(qa.current);var d=null;switch(n){case"input":c=xv(e,c),o=xv(e,o),d=[];break;case"select":c=kr({},c,{value:void 0}),o=kr({},o,{value:void 0}),d=[];break;case"textarea":c=Ev(e,c),o=Ev(e,o),d=[];break;default:typeof c.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Um)}Sv(n,o);var p;n=null;for(v in c)if(!o.hasOwnProperty(v)&&c.hasOwnProperty(v)&&c[v]!=null)if(v==="style"){var s=c[v];for(p in s)s.hasOwnProperty(p)&&(n||(n={}),n[p]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(Kh.hasOwnProperty(v)?d||(d=[]):(d=d||[]).push(v,null));for(v in o){var _=o[v];if(s=c?.[v],o.hasOwnProperty(v)&&_!==s&&(_!=null||s!=null))if(v==="style")if(s){for(p in s)!s.hasOwnProperty(p)||_&&_.hasOwnProperty(p)||(n||(n={}),n[p]="");for(p in _)_.hasOwnProperty(p)&&s[p]!==_[p]&&(n||(n={}),n[p]=_[p])}else n||(d||(d=[]),d.push(v,n)),n=_;else v==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,s=s?s.__html:void 0,_!=null&&s!==_&&(d=d||[]).push(v,_)):v==="children"?typeof _!="string"&&typeof _!="number"||(d=d||[]).push(v,""+_):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(Kh.hasOwnProperty(v)?(_!=null&&v==="onScroll"&&fr("scroll",e),d||s===_||(d=[])):(d=d||[]).push(v,_))}n&&(d=d||[]).push("style",n);var v=d;(t.updateQueue=v)&&(t.flags|=4)}};Tk=function(e,t,n,o){n!==o&&(t.flags|=4)};function yh(e,t){if(!_r)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;n!==null;)n.alternate!==null&&(o=n),n=n.sibling;o===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function zi(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,o=0;if(t)for(var c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags&14680064,o|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)n|=c.lanes|c.childLanes,o|=c.subtreeFlags,o|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function vM(e,t,n){var o=t.pendingProps;switch(N1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zi(t),null;case 1:return mo(t.type)&&Vm(),zi(t),null;case 3:return o=t.stateNode,ld(),pr(po),pr(Fi),G1(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Wp(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ma!==null&&(a_(ma),ma=null))),Jv(e,t),zi(t),null;case 5:j1(t);var c=Tc(lf.current);if(n=t.type,e!==null&&t.stateNode!=null)Ek(e,t,n,o,c),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(t.stateNode===null)throw Error(bt(166));return zi(t),null}if(e=Tc(qa.current),Wp(t)){o=t.stateNode,n=t.type;var d=t.memoizedProps;switch(o[Fa]=t,o[af]=d,e=(t.mode&1)!==0,n){case"dialog":fr("cancel",o),fr("close",o);break;case"iframe":case"object":case"embed":fr("load",o);break;case"video":case"audio":for(c=0;c<Ph.length;c++)fr(Ph[c],o);break;case"source":fr("error",o);break;case"img":case"image":case"link":fr("error",o),fr("load",o);break;case"details":fr("toggle",o);break;case"input":jw(o,d),fr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!d.multiple},fr("invalid",o);break;case"textarea":qw(o,d),fr("invalid",o)}Sv(n,d),c=null;for(var p in d)if(d.hasOwnProperty(p)){var s=d[p];p==="children"?typeof s=="string"?o.textContent!==s&&(d.suppressHydrationWarning!==!0&&qp(o.textContent,s,e),c=["children",s]):typeof s=="number"&&o.textContent!==""+s&&(d.suppressHydrationWarning!==!0&&qp(o.textContent,s,e),c=["children",""+s]):Kh.hasOwnProperty(p)&&s!=null&&p==="onScroll"&&fr("scroll",o)}switch(n){case"input":$p(o),Gw(o,d,!0);break;case"textarea":$p(o),Ww(o);break;case"select":case"option":break;default:typeof d.onClick=="function"&&(o.onclick=Um)}o=c,t.updateQueue=o,o!==null&&(t.flags|=4)}else{p=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=YT(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=p.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=p.createElement(n,{is:o.is}):(e=p.createElement(n),n==="select"&&(p=e,o.multiple?p.multiple=!0:o.size&&(p.size=o.size))):e=p.createElementNS(e,n),e[Fa]=t,e[af]=o,wk(e,t,!1,!1),t.stateNode=e;e:{switch(p=kv(n,o),n){case"dialog":fr("cancel",e),fr("close",e),c=o;break;case"iframe":case"object":case"embed":fr("load",e),c=o;break;case"video":case"audio":for(c=0;c<Ph.length;c++)fr(Ph[c],e);c=o;break;case"source":fr("error",e),c=o;break;case"img":case"image":case"link":fr("error",e),fr("load",e),c=o;break;case"details":fr("toggle",e),c=o;break;case"input":jw(e,o),c=xv(e,o),fr("invalid",e);break;case"option":c=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},c=kr({},o,{value:void 0}),fr("invalid",e);break;case"textarea":qw(e,o),c=Ev(e,o),fr("invalid",e);break;default:c=o}Sv(n,c),s=c;for(d in s)if(s.hasOwnProperty(d)){var _=s[d];d==="style"?eS(e,_):d==="dangerouslySetInnerHTML"?(_=_?_.__html:void 0,_!=null&&JT(e,_)):d==="children"?typeof _=="string"?(n!=="textarea"||_!=="")&&Xh(e,_):typeof _=="number"&&Xh(e,""+_):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Kh.hasOwnProperty(d)?_!=null&&d==="onScroll"&&fr("scroll",e):_!=null&&x1(e,d,_,p))}switch(n){case"input":$p(e),Gw(e,o,!1);break;case"textarea":$p(e),Ww(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Ml(o.value));break;case"select":e.multiple=!!o.multiple,d=o.value,d!=null?Hu(e,!!o.multiple,d,!1):o.defaultValue!=null&&Hu(e,!!o.multiple,o.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Um)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return zi(t),null;case 6:if(e&&t.stateNode!=null)Tk(e,t,e.memoizedProps,o);else{if(typeof o!="string"&&t.stateNode===null)throw Error(bt(166));if(n=Tc(lf.current),Tc(qa.current),Wp(t)){if(o=t.stateNode,n=t.memoizedProps,o[Fa]=t,(d=o.nodeValue!==n)&&(e=Io,e!==null))switch(e.tag){case 3:qp(o.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qp(o.nodeValue,n,(e.mode&1)!==0)}d&&(t.flags|=4)}else o=(n.nodeType===9?n:n.ownerDocument).createTextNode(o),o[Fa]=t,t.stateNode=o}return zi(t),null;case 13:if(pr(Tr),o=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_r&&Ao!==null&&t.mode&1&&!(t.flags&128))US(),ad(),t.flags|=98560,d=!1;else if(d=Wp(t),o!==null&&o.dehydrated!==null){if(e===null){if(!d)throw Error(bt(318));if(d=t.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(bt(317));d[Fa]=t}else ad(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;zi(t),d=!1}else ma!==null&&(a_(ma),ma=null),d=!0;if(!d)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(t.child.flags|=8192,t.mode&1&&(e===null||Tr.current&1?ri===0&&(ri=3):nx())),t.updateQueue!==null&&(t.flags|=4),zi(t),null);case 4:return ld(),Jv(e,t),e===null&&rf(t.stateNode.containerInfo),zi(t),null;case 10:return B1(t.type._context),zi(t),null;case 17:return mo(t.type)&&Vm(),zi(t),null;case 19:if(pr(Tr),d=t.memoizedState,d===null)return zi(t),null;if(o=(t.flags&128)!==0,p=d.rendering,p===null)if(o)yh(d,!1);else{if(ri!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(p=Km(e),p!==null){for(t.flags|=128,yh(d,!1),o=p.updateQueue,o!==null&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;n!==null;)d=n,e=o,d.flags&=14680066,p=d.alternate,p===null?(d.childLanes=0,d.lanes=e,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=p.childLanes,d.lanes=p.lanes,d.child=p.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=p.memoizedProps,d.memoizedState=p.memoizedState,d.updateQueue=p.updateQueue,d.type=p.type,e=p.dependencies,d.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ur(Tr,Tr.current&1|2),t.child}e=e.sibling}d.tail!==null&&Fr()>ud&&(t.flags|=128,o=!0,yh(d,!1),t.lanes=4194304)}else{if(!o)if(e=Km(p),e!==null){if(t.flags|=128,o=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yh(d,!0),d.tail===null&&d.tailMode==="hidden"&&!p.alternate&&!_r)return zi(t),null}else 2*Fr()-d.renderingStartTime>ud&&n!==1073741824&&(t.flags|=128,o=!0,yh(d,!1),t.lanes=4194304);d.isBackwards?(p.sibling=t.child,t.child=p):(n=d.last,n!==null?n.sibling=p:t.child=p,d.last=p)}return d.tail!==null?(t=d.tail,d.rendering=t,d.tail=t.sibling,d.renderingStartTime=Fr(),t.sibling=null,n=Tr.current,ur(Tr,o?n&1|2:n&1),t):(zi(t),null);case 22:case 23:return tx(),o=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(t.flags|=8192),o&&t.mode&1?Po&1073741824&&(zi(t),t.subtreeFlags&6&&(t.flags|=8192)):zi(t),null;case 24:return null;case 25:return null}throw Error(bt(156,t.tag))}function _M(e,t){switch(N1(t),t.tag){case 1:return mo(t.type)&&Vm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ld(),pr(po),pr(Fi),G1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return j1(t),null;case 13:if(pr(Tr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(bt(340));ad()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pr(Tr),null;case 4:return ld(),null;case 10:return B1(t.type._context),null;case 22:case 23:return tx(),null;case 24:return null;default:return null}}var Kp=!1,Bi=!1,xM=typeof WeakSet=="function"?WeakSet:Set,Wt=null;function Vu(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(o){Mr(e,t,o)}else n.current=null}function Qv(e,t,n){try{n()}catch(o){Mr(e,t,o)}}var N2=!1;function bM(e,t){if(Ov=zm,e=PS(),R1(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var o=n.getSelection&&n.getSelection();if(o&&o.rangeCount!==0){n=o.anchorNode;var c=o.anchorOffset,d=o.focusNode;o=o.focusOffset;try{n.nodeType,d.nodeType}catch{n=null;break e}var p=0,s=-1,_=-1,v=0,E=0,T=e,S=null;t:for(;;){for(var D;T!==n||c!==0&&T.nodeType!==3||(s=p+c),T!==d||o!==0&&T.nodeType!==3||(_=p+o),T.nodeType===3&&(p+=T.nodeValue.length),(D=T.firstChild)!==null;)S=T,T=D;for(;;){if(T===e)break t;if(S===n&&++v===c&&(s=p),S===d&&++E===o&&(_=p),(D=T.nextSibling)!==null)break;T=S,S=T.parentNode}T=D}n=s===-1||_===-1?null:{start:s,end:_}}else n=null}n=n||{start:0,end:0}}else n=null;for($v={focusedElem:e,selectionRange:n},zm=!1,Wt=t;Wt!==null;)if(t=Wt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Wt=e;else for(;Wt!==null;){t=Wt;try{var O=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var M=O.memoizedProps,U=O.memoizedState,$=t.stateNode,L=$.getSnapshotBeforeUpdate(t.elementType===t.type?M:fa(t.type,M),U);$.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var F=t.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(bt(163))}}catch(J){Mr(t,t.return,J)}if(e=t.sibling,e!==null){e.return=t.return,Wt=e;break}Wt=t.return}return O=N2,N2=!1,O}function Nh(e,t,n){var o=t.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&e)===e){var d=c.destroy;c.destroy=void 0,d!==void 0&&Qv(t,n,d)}c=c.next}while(c!==o)}}function P0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function e_(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Sk(e){var t=e.alternate;t!==null&&(e.alternate=null,Sk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fa],delete t[af],delete t[Fv],delete t[rM],delete t[iM])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kk(e){return e.tag===5||e.tag===3||e.tag===4}function O2(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function t_(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Um));else if(o!==4&&(e=e.child,e!==null))for(t_(e,t,n),e=e.sibling;e!==null;)t_(e,t,n),e=e.sibling}function n_(e,t,n){var o=e.tag;if(o===5||o===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(n_(e,t,n),e=e.sibling;e!==null;)n_(e,t,n),e=e.sibling}var Ti=null,pa=!1;function cl(e,t,n){for(n=n.child;n!==null;)Ck(e,t,n),n=n.sibling}function Ck(e,t,n){if(Ga&&typeof Ga.onCommitFiberUnmount=="function")try{Ga.onCommitFiberUnmount(x0,n)}catch{}switch(n.tag){case 5:Bi||Vu(n,t);case 6:var o=Ti,c=pa;Ti=null,cl(e,t,n),Ti=o,pa=c,Ti!==null&&(pa?(e=Ti,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ti.removeChild(n.stateNode));break;case 18:Ti!==null&&(pa?(e=Ti,n=n.stateNode,e.nodeType===8?Ey(e.parentNode,n):e.nodeType===1&&Ey(e,n),ef(e)):Ey(Ti,n.stateNode));break;case 4:o=Ti,c=pa,Ti=n.stateNode.containerInfo,pa=!0,cl(e,t,n),Ti=o,pa=c;break;case 0:case 11:case 14:case 15:if(!Bi&&(o=n.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){c=o=o.next;do{var d=c,p=d.destroy;d=d.tag,p!==void 0&&(d&2||d&4)&&Qv(n,t,p),c=c.next}while(c!==o)}cl(e,t,n);break;case 1:if(!Bi&&(Vu(n,t),o=n.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(s){Mr(n,t,s)}cl(e,t,n);break;case 21:cl(e,t,n);break;case 22:n.mode&1?(Bi=(o=Bi)||n.memoizedState!==null,cl(e,t,n),Bi=o):cl(e,t,n);break;default:cl(e,t,n)}}function $2(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new xM),t.forEach(function(o){var c=IM.bind(null,e,o);n.has(o)||(n.add(o),o.then(c,c))})}}function da(e,t){var n=t.deletions;if(n!==null)for(var o=0;o<n.length;o++){var c=n[o];try{var d=e,p=t,s=p;e:for(;s!==null;){switch(s.tag){case 5:Ti=s.stateNode,pa=!1;break e;case 3:Ti=s.stateNode.containerInfo,pa=!0;break e;case 4:Ti=s.stateNode.containerInfo,pa=!0;break e}s=s.return}if(Ti===null)throw Error(bt(160));Ck(d,p,c),Ti=null,pa=!1;var _=c.alternate;_!==null&&(_.return=null),c.return=null}catch(v){Mr(c,t,v)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Pk(t,e),t=t.sibling}function Pk(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(da(t,e),za(e),o&4){try{Nh(3,e,e.return),P0(3,e)}catch(M){Mr(e,e.return,M)}try{Nh(5,e,e.return)}catch(M){Mr(e,e.return,M)}}break;case 1:da(t,e),za(e),o&512&&n!==null&&Vu(n,n.return);break;case 5:if(da(t,e),za(e),o&512&&n!==null&&Vu(n,n.return),e.flags&32){var c=e.stateNode;try{Xh(c,"")}catch(M){Mr(e,e.return,M)}}if(o&4&&(c=e.stateNode,c!=null)){var d=e.memoizedProps,p=n!==null?n.memoizedProps:d,s=e.type,_=e.updateQueue;if(e.updateQueue=null,_!==null)try{s==="input"&&d.type==="radio"&&d.name!=null&&KT(c,d),kv(s,p);var v=kv(s,d);for(p=0;p<_.length;p+=2){var E=_[p],T=_[p+1];E==="style"?eS(c,T):E==="dangerouslySetInnerHTML"?JT(c,T):E==="children"?Xh(c,T):x1(c,E,T,v)}switch(s){case"input":bv(c,d);break;case"textarea":XT(c,d);break;case"select":var S=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!d.multiple;var D=d.value;D!=null?Hu(c,!!d.multiple,D,!1):S!==!!d.multiple&&(d.defaultValue!=null?Hu(c,!!d.multiple,d.defaultValue,!0):Hu(c,!!d.multiple,d.multiple?[]:"",!1))}c[af]=d}catch(M){Mr(e,e.return,M)}}break;case 6:if(da(t,e),za(e),o&4){if(e.stateNode===null)throw Error(bt(162));c=e.stateNode,d=e.memoizedProps;try{c.nodeValue=d}catch(M){Mr(e,e.return,M)}}break;case 3:if(da(t,e),za(e),o&4&&n!==null&&n.memoizedState.isDehydrated)try{ef(t.containerInfo)}catch(M){Mr(e,e.return,M)}break;case 4:da(t,e),za(e);break;case 13:da(t,e),za(e),c=e.child,c.flags&8192&&(d=c.memoizedState!==null,c.stateNode.isHidden=d,!d||c.alternate!==null&&c.alternate.memoizedState!==null||(Q1=Fr())),o&4&&$2(e);break;case 22:if(E=n!==null&&n.memoizedState!==null,e.mode&1?(Bi=(v=Bi)||E,da(t,e),Bi=v):da(t,e),za(e),o&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!E&&e.mode&1)for(Wt=e,E=e.child;E!==null;){for(T=Wt=E;Wt!==null;){switch(S=Wt,D=S.child,S.tag){case 0:case 11:case 14:case 15:Nh(4,S,S.return);break;case 1:Vu(S,S.return);var O=S.stateNode;if(typeof O.componentWillUnmount=="function"){o=S,n=S.return;try{t=o,O.props=t.memoizedProps,O.state=t.memoizedState,O.componentWillUnmount()}catch(M){Mr(o,n,M)}}break;case 5:Vu(S,S.return);break;case 22:if(S.memoizedState!==null){B2(T);continue}}D!==null?(D.return=S,Wt=D):B2(T)}E=E.sibling}e:for(E=null,T=e;;){if(T.tag===5){if(E===null){E=T;try{c=T.stateNode,v?(d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none"):(s=T.stateNode,_=T.memoizedProps.style,p=_!=null&&_.hasOwnProperty("display")?_.display:null,s.style.display=QT("display",p))}catch(M){Mr(e,e.return,M)}}}else if(T.tag===6){if(E===null)try{T.stateNode.nodeValue=v?"":T.memoizedProps}catch(M){Mr(e,e.return,M)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===e)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===e)break e;for(;T.sibling===null;){if(T.return===null||T.return===e)break e;E===T&&(E=null),T=T.return}E===T&&(E=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:da(t,e),za(e),o&4&&$2(e);break;case 21:break;default:da(t,e),za(e)}}function za(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(kk(n)){var o=n;break e}n=n.return}throw Error(bt(160))}switch(o.tag){case 5:var c=o.stateNode;o.flags&32&&(Xh(c,""),o.flags&=-33);var d=O2(e);n_(e,d,c);break;case 3:case 4:var p=o.stateNode.containerInfo,s=O2(e);t_(e,s,p);break;default:throw Error(bt(161))}}catch(_){Mr(e,e.return,_)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wM(e,t,n){Wt=e,Ak(e)}function Ak(e,t,n){for(var o=(e.mode&1)!==0;Wt!==null;){var c=Wt,d=c.child;if(c.tag===22&&o){var p=c.memoizedState!==null||Kp;if(!p){var s=c.alternate,_=s!==null&&s.memoizedState!==null||Bi;s=Kp;var v=Bi;if(Kp=p,(Bi=_)&&!v)for(Wt=c;Wt!==null;)p=Wt,_=p.child,p.tag===22&&p.memoizedState!==null?F2(c):_!==null?(_.return=p,Wt=_):F2(c);for(;d!==null;)Wt=d,Ak(d),d=d.sibling;Wt=c,Kp=s,Bi=v}z2(e)}else c.subtreeFlags&8772&&d!==null?(d.return=c,Wt=d):z2(e)}}function z2(e){for(;Wt!==null;){var t=Wt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bi||P0(5,t);break;case 1:var o=t.stateNode;if(t.flags&4&&!Bi)if(n===null)o.componentDidMount();else{var c=t.elementType===t.type?n.memoizedProps:fa(t.type,n.memoizedProps);o.componentDidUpdate(c,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var d=t.updateQueue;d!==null&&b2(t,d,o);break;case 3:var p=t.updateQueue;if(p!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}b2(t,p,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var _=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":_.autoFocus&&n.focus();break;case"img":_.src&&(n.src=_.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var v=t.alternate;if(v!==null){var E=v.memoizedState;if(E!==null){var T=E.dehydrated;T!==null&&ef(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(bt(163))}Bi||t.flags&512&&e_(t)}catch(S){Mr(t,t.return,S)}}if(t===e){Wt=null;break}if(n=t.sibling,n!==null){n.return=t.return,Wt=n;break}Wt=t.return}}function B2(e){for(;Wt!==null;){var t=Wt;if(t===e){Wt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Wt=n;break}Wt=t.return}}function F2(e){for(;Wt!==null;){var t=Wt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{P0(4,t)}catch(_){Mr(t,n,_)}break;case 1:var o=t.stateNode;if(typeof o.componentDidMount=="function"){var c=t.return;try{o.componentDidMount()}catch(_){Mr(t,c,_)}}var d=t.return;try{e_(t)}catch(_){Mr(t,d,_)}break;case 5:var p=t.return;try{e_(t)}catch(_){Mr(t,p,_)}}}catch(_){Mr(t,t.return,_)}if(t===e){Wt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Wt=s;break}Wt=t.return}}var EM=Math.ceil,Jm=Os.ReactCurrentDispatcher,Y1=Os.ReactCurrentOwner,Qo=Os.ReactCurrentBatchConfig,Ln=0,mi=null,Yr=null,ki=0,Po=0,ju=Ol(0),ri=0,hf=null,Rc=0,A0=0,J1=0,Oh=null,co=null,Q1=0,ud=1/0,vs=null,Qm=!1,r_=null,Cl=null,Xp=!1,bl=null,e0=0,$h=0,i_=null,vm=-1,_m=0;function eo(){return Ln&6?Fr():vm!==-1?vm:vm=Fr()}function Pl(e){return e.mode&1?Ln&2&&ki!==0?ki&-ki:aM.transition!==null?(_m===0&&(_m=hS()),_m):(e=Zn,e!==0||(e=window.event,e=e===void 0?16:_S(e.type)),e):1}function va(e,t,n,o){if(50<$h)throw $h=0,i_=null,Error(bt(185));xf(e,n,o),(!(Ln&2)||e!==mi)&&(e===mi&&(!(Ln&2)&&(A0|=n),ri===4&&vl(e,ki)),go(e,o),n===1&&Ln===0&&!(t.mode&1)&&(ud=Fr()+500,S0&&$l()))}function go(e,t){var n=e.callbackNode;a8(e,t);var o=$m(e,e===mi?ki:0);if(o===0)n!==null&&Kw(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(n!=null&&Kw(n),t===1)e.tag===0?oM(U2.bind(null,e)):zS(U2.bind(null,e)),tM(function(){!(Ln&6)&&$l()}),n=null;else{switch(fS(o)){case 1:n=S1;break;case 4:n=uS;break;case 16:n=Om;break;case 536870912:n=dS;break;default:n=Om}n=$k(n,Ik.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ik(e,t){if(vm=-1,_m=0,Ln&6)throw Error(bt(327));var n=e.callbackNode;if(Ju()&&e.callbackNode!==n)return null;var o=$m(e,e===mi?ki:0);if(o===0)return null;if(o&30||o&e.expiredLanes||t)t=t0(e,o);else{t=o;var c=Ln;Ln|=2;var d=Dk();(mi!==e||ki!==t)&&(vs=null,ud=Fr()+500,Cc(e,t));do try{kM();break}catch(s){Mk(e,s)}while(1);z1(),Jm.current=d,Ln=c,Yr!==null?t=0:(mi=null,ki=0,t=ri)}if(t!==0){if(t===2&&(c=Mv(e),c!==0&&(o=c,t=o_(e,c))),t===1)throw n=hf,Cc(e,0),vl(e,o),go(e,Fr()),n;if(t===6)vl(e,o);else{if(c=e.current.alternate,!(o&30)&&!TM(c)&&(t=t0(e,o),t===2&&(d=Mv(e),d!==0&&(o=d,t=o_(e,d))),t===1))throw n=hf,Cc(e,0),vl(e,o),go(e,Fr()),n;switch(e.finishedWork=c,e.finishedLanes=o,t){case 0:case 1:throw Error(bt(345));case 2:yc(e,co,vs);break;case 3:if(vl(e,o),(o&130023424)===o&&(t=Q1+500-Fr(),10<t)){if($m(e,0)!==0)break;if(c=e.suspendedLanes,(c&o)!==o){eo(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Bv(yc.bind(null,e,co,vs),t);break}yc(e,co,vs);break;case 4:if(vl(e,o),(o&4194240)===o)break;for(t=e.eventTimes,c=-1;0<o;){var p=31-ya(o);d=1<<p,p=t[p],p>c&&(c=p),o&=~d}if(o=c,o=Fr()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*EM(o/1960))-o,10<o){e.timeoutHandle=Bv(yc.bind(null,e,co,vs),o);break}yc(e,co,vs);break;case 5:yc(e,co,vs);break;default:throw Error(bt(329))}}}return go(e,Fr()),e.callbackNode===n?Ik.bind(null,e):null}function o_(e,t){var n=Oh;return e.current.memoizedState.isDehydrated&&(Cc(e,t).flags|=256),e=t0(e,t),e!==2&&(t=co,co=n,t!==null&&a_(t)),e}function a_(e){co===null?co=e:co.push.apply(co,e)}function TM(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var o=0;o<n.length;o++){var c=n[o],d=c.getSnapshot;c=c.value;try{if(!xa(d(),c))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function vl(e,t){for(t&=~J1,t&=~A0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ya(t),o=1<<n;e[n]=-1,t&=~o}}function U2(e){if(Ln&6)throw Error(bt(327));Ju();var t=$m(e,0);if(!(t&1))return go(e,Fr()),null;var n=t0(e,t);if(e.tag!==0&&n===2){var o=Mv(e);o!==0&&(t=o,n=o_(e,o))}if(n===1)throw n=hf,Cc(e,0),vl(e,t),go(e,Fr()),n;if(n===6)throw Error(bt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,yc(e,co,vs),go(e,Fr()),null}function ex(e,t){var n=Ln;Ln|=1;try{return e(t)}finally{Ln=n,Ln===0&&(ud=Fr()+500,S0&&$l())}}function Lc(e){bl!==null&&bl.tag===0&&!(Ln&6)&&Ju();var t=Ln;Ln|=1;var n=Qo.transition,o=Zn;try{if(Qo.transition=null,Zn=1,e)return e()}finally{Zn=o,Qo.transition=n,Ln=t,!(Ln&6)&&$l()}}function tx(){Po=ju.current,pr(ju)}function Cc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,eM(n)),Yr!==null)for(n=Yr.return;n!==null;){var o=n;switch(N1(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Vm();break;case 3:ld(),pr(po),pr(Fi),G1();break;case 5:j1(o);break;case 4:ld();break;case 13:pr(Tr);break;case 19:pr(Tr);break;case 10:B1(o.type._context);break;case 22:case 23:tx()}n=n.return}if(mi=e,Yr=e=Al(e.current,null),ki=Po=t,ri=0,hf=null,J1=A0=Rc=0,co=Oh=null,Ec!==null){for(t=0;t<Ec.length;t++)if(n=Ec[t],o=n.interleaved,o!==null){n.interleaved=null;var c=o.next,d=n.pending;if(d!==null){var p=d.next;d.next=c,o.next=p}n.pending=o}Ec=null}return e}function Mk(e,t){do{var n=Yr;try{if(z1(),mm.current=Ym,Xm){for(var o=Sr.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}Xm=!1}if(Dc=0,fi=ni=Sr=null,Lh=!1,cf=0,Y1.current=null,n===null||n.return===null){ri=1,hf=t,Yr=null;break}e:{var d=e,p=n.return,s=n,_=t;if(t=ki,s.flags|=32768,_!==null&&typeof _=="object"&&typeof _.then=="function"){var v=_,E=s,T=E.tag;if(!(E.mode&1)&&(T===0||T===11||T===15)){var S=E.alternate;S?(E.updateQueue=S.updateQueue,E.memoizedState=S.memoizedState,E.lanes=S.lanes):(E.updateQueue=null,E.memoizedState=null)}var D=P2(p);if(D!==null){D.flags&=-257,A2(D,p,s,d,t),D.mode&1&&C2(d,v,t),t=D,_=v;var O=t.updateQueue;if(O===null){var M=new Set;M.add(_),t.updateQueue=M}else O.add(_);break e}else{if(!(t&1)){C2(d,v,t),nx();break e}_=Error(bt(426))}}else if(_r&&s.mode&1){var U=P2(p);if(U!==null){!(U.flags&65536)&&(U.flags|=256),A2(U,p,s,d,t),O1(cd(_,s));break e}}d=_=cd(_,s),ri!==4&&(ri=2),Oh===null?Oh=[d]:Oh.push(d),d=p;do{switch(d.tag){case 3:d.flags|=65536,t&=-t,d.lanes|=t;var $=pk(d,_,t);x2(d,$);break e;case 1:s=_;var L=d.type,F=d.stateNode;if(!(d.flags&128)&&(typeof L.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Cl===null||!Cl.has(F)))){d.flags|=65536,t&=-t,d.lanes|=t;var J=mk(d,s,t);x2(d,J);break e}}d=d.return}while(d!==null)}Lk(n)}catch(V){t=V,Yr===n&&n!==null&&(Yr=n=n.return);continue}break}while(1)}function Dk(){var e=Jm.current;return Jm.current=Ym,e===null?Ym:e}function nx(){(ri===0||ri===3||ri===2)&&(ri=4),mi===null||!(Rc&268435455)&&!(A0&268435455)||vl(mi,ki)}function t0(e,t){var n=Ln;Ln|=2;var o=Dk();(mi!==e||ki!==t)&&(vs=null,Cc(e,t));do try{SM();break}catch(c){Mk(e,c)}while(1);if(z1(),Ln=n,Jm.current=o,Yr!==null)throw Error(bt(261));return mi=null,ki=0,ri}function SM(){for(;Yr!==null;)Rk(Yr)}function kM(){for(;Yr!==null&&!Y9();)Rk(Yr)}function Rk(e){var t=Ok(e.alternate,e,Po);e.memoizedProps=e.pendingProps,t===null?Lk(e):Yr=t,Y1.current=null}function Lk(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=_M(n,t),n!==null){n.flags&=32767,Yr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ri=6,Yr=null;return}}else if(n=vM(n,t,Po),n!==null){Yr=n;return}if(t=t.sibling,t!==null){Yr=t;return}Yr=t=e}while(t!==null);ri===0&&(ri=5)}function yc(e,t,n){var o=Zn,c=Qo.transition;try{Qo.transition=null,Zn=1,CM(e,t,n,o)}finally{Qo.transition=c,Zn=o}return null}function CM(e,t,n,o){do Ju();while(bl!==null);if(Ln&6)throw Error(bt(327));n=e.finishedWork;var c=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(bt(177));e.callbackNode=null,e.callbackPriority=0;var d=n.lanes|n.childLanes;if(s8(e,d),e===mi&&(Yr=mi=null,ki=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xp||(Xp=!0,$k(Om,function(){return Ju(),null})),d=(n.flags&15990)!==0,n.subtreeFlags&15990||d){d=Qo.transition,Qo.transition=null;var p=Zn;Zn=1;var s=Ln;Ln|=4,Y1.current=null,bM(e,n),Pk(n,e),H8($v),zm=!!Ov,$v=Ov=null,e.current=n,wM(n),J9(),Ln=s,Zn=p,Qo.transition=d}else e.current=n;if(Xp&&(Xp=!1,bl=e,e0=c),d=e.pendingLanes,d===0&&(Cl=null),t8(n.stateNode),go(e,Fr()),t!==null)for(o=e.onRecoverableError,n=0;n<t.length;n++)c=t[n],o(c.value,{componentStack:c.stack,digest:c.digest});if(Qm)throw Qm=!1,e=r_,r_=null,e;return e0&1&&e.tag!==0&&Ju(),d=e.pendingLanes,d&1?e===i_?$h++:($h=0,i_=e):$h=0,$l(),null}function Ju(){if(bl!==null){var e=fS(e0),t=Qo.transition,n=Zn;try{if(Qo.transition=null,Zn=16>e?16:e,bl===null)var o=!1;else{if(e=bl,bl=null,e0=0,Ln&6)throw Error(bt(331));var c=Ln;for(Ln|=4,Wt=e.current;Wt!==null;){var d=Wt,p=d.child;if(Wt.flags&16){var s=d.deletions;if(s!==null){for(var _=0;_<s.length;_++){var v=s[_];for(Wt=v;Wt!==null;){var E=Wt;switch(E.tag){case 0:case 11:case 15:Nh(8,E,d)}var T=E.child;if(T!==null)T.return=E,Wt=T;else for(;Wt!==null;){E=Wt;var S=E.sibling,D=E.return;if(Sk(E),E===v){Wt=null;break}if(S!==null){S.return=D,Wt=S;break}Wt=D}}}var O=d.alternate;if(O!==null){var M=O.child;if(M!==null){O.child=null;do{var U=M.sibling;M.sibling=null,M=U}while(M!==null)}}Wt=d}}if(d.subtreeFlags&2064&&p!==null)p.return=d,Wt=p;else e:for(;Wt!==null;){if(d=Wt,d.flags&2048)switch(d.tag){case 0:case 11:case 15:Nh(9,d,d.return)}var $=d.sibling;if($!==null){$.return=d.return,Wt=$;break e}Wt=d.return}}var L=e.current;for(Wt=L;Wt!==null;){p=Wt;var F=p.child;if(p.subtreeFlags&2064&&F!==null)F.return=p,Wt=F;else e:for(p=L;Wt!==null;){if(s=Wt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:P0(9,s)}}catch(V){Mr(s,s.return,V)}if(s===p){Wt=null;break e}var J=s.sibling;if(J!==null){J.return=s.return,Wt=J;break e}Wt=s.return}}if(Ln=c,$l(),Ga&&typeof Ga.onPostCommitFiberRoot=="function")try{Ga.onPostCommitFiberRoot(x0,e)}catch{}o=!0}return o}finally{Zn=n,Qo.transition=t}}return!1}function V2(e,t,n){t=cd(n,t),t=pk(e,t,1),e=kl(e,t,1),t=eo(),e!==null&&(xf(e,1,t),go(e,t))}function Mr(e,t,n){if(e.tag===3)V2(e,e,n);else for(;t!==null;){if(t.tag===3){V2(t,e,n);break}else if(t.tag===1){var o=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Cl===null||!Cl.has(o))){e=cd(n,e),e=mk(t,e,1),t=kl(t,e,1),e=eo(),t!==null&&(xf(t,1,e),go(t,e));break}}t=t.return}}function PM(e,t,n){var o=e.pingCache;o!==null&&o.delete(t),t=eo(),e.pingedLanes|=e.suspendedLanes&n,mi===e&&(ki&n)===n&&(ri===4||ri===3&&(ki&130023424)===ki&&500>Fr()-Q1?Cc(e,0):J1|=n),go(e,t)}function Nk(e,t){t===0&&(e.mode&1?(t=Fp,Fp<<=1,!(Fp&130023424)&&(Fp=4194304)):t=1);var n=eo();e=Rs(e,t),e!==null&&(xf(e,t,n),go(e,n))}function AM(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Nk(e,n)}function IM(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,c=e.memoizedState;c!==null&&(n=c.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(bt(314))}o!==null&&o.delete(t),Nk(e,n)}var Ok;Ok=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||po.current)ho=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ho=!1,yM(e,t,n);ho=!!(e.flags&131072)}else ho=!1,_r&&t.flags&1048576&&BS(t,qm,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;ym(e,t),e=t.pendingProps;var c=od(t,Fi.current);Yu(t,n),c=W1(null,t,o,e,c,n);var d=H1();return t.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,mo(o)?(d=!0,jm(t)):d=!1,t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,U1(t),c.updater=k0,t.stateNode=c,c._reactInternals=t,Wv(t,o,e,n),t=Kv(null,t,o,!0,d,n)):(t.tag=0,_r&&d&&L1(t),Yi(null,t,c,n),t=t.child),t;case 16:o=t.elementType;e:{switch(ym(e,t),e=t.pendingProps,c=o._init,o=c(o._payload),t.type=o,c=t.tag=DM(o),e=fa(o,e),c){case 0:t=Zv(null,t,o,e,n);break e;case 1:t=D2(null,t,o,e,n);break e;case 11:t=I2(null,t,o,e,n);break e;case 14:t=M2(null,t,o,fa(o.type,e),n);break e}throw Error(bt(306,o,""))}return t;case 0:return o=t.type,c=t.pendingProps,c=t.elementType===o?c:fa(o,c),Zv(e,t,o,c,n);case 1:return o=t.type,c=t.pendingProps,c=t.elementType===o?c:fa(o,c),D2(e,t,o,c,n);case 3:e:{if(_k(t),e===null)throw Error(bt(387));o=t.pendingProps,d=t.memoizedState,c=d.element,jS(e,t),Zm(t,o,null,n);var p=t.memoizedState;if(o=p.element,d.isDehydrated)if(d={element:o,isDehydrated:!1,cache:p.cache,pendingSuspenseBoundaries:p.pendingSuspenseBoundaries,transitions:p.transitions},t.updateQueue.baseState=d,t.memoizedState=d,t.flags&256){c=cd(Error(bt(423)),t),t=R2(e,t,o,n,c);break e}else if(o!==c){c=cd(Error(bt(424)),t),t=R2(e,t,o,n,c);break e}else for(Ao=Sl(t.stateNode.containerInfo.firstChild),Io=t,_r=!0,ma=null,n=HS(t,null,o,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ad(),o===c){t=Ls(e,t,n);break e}Yi(e,t,o,n)}t=t.child}return t;case 5:return ZS(t),e===null&&jv(t),o=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,p=c.children,zv(o,c)?p=null:d!==null&&zv(o,d)&&(t.flags|=32),vk(e,t),Yi(e,t,p,n),t.child;case 6:return e===null&&jv(t),null;case 13:return xk(e,t,n);case 4:return V1(t,t.stateNode.containerInfo),o=t.pendingProps,e===null?t.child=sd(t,null,o,n):Yi(e,t,o,n),t.child;case 11:return o=t.type,c=t.pendingProps,c=t.elementType===o?c:fa(o,c),I2(e,t,o,c,n);case 7:return Yi(e,t,t.pendingProps,n),t.child;case 8:return Yi(e,t,t.pendingProps.children,n),t.child;case 12:return Yi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,c=t.pendingProps,d=t.memoizedProps,p=c.value,ur(Wm,o._currentValue),o._currentValue=p,d!==null)if(xa(d.value,p)){if(d.children===c.children&&!po.current){t=Ls(e,t,n);break e}}else for(d=t.child,d!==null&&(d.return=t);d!==null;){var s=d.dependencies;if(s!==null){p=d.child;for(var _=s.firstContext;_!==null;){if(_.context===o){if(d.tag===1){_=Cs(-1,n&-n),_.tag=2;var v=d.updateQueue;if(v!==null){v=v.shared;var E=v.pending;E===null?_.next=_:(_.next=E.next,E.next=_),v.pending=_}}d.lanes|=n,_=d.alternate,_!==null&&(_.lanes|=n),Gv(d.return,n,t),s.lanes|=n;break}_=_.next}}else if(d.tag===10)p=d.type===t.type?null:d.child;else if(d.tag===18){if(p=d.return,p===null)throw Error(bt(341));p.lanes|=n,s=p.alternate,s!==null&&(s.lanes|=n),Gv(p,n,t),p=d.sibling}else p=d.child;if(p!==null)p.return=d;else for(p=d;p!==null;){if(p===t){p=null;break}if(d=p.sibling,d!==null){d.return=p.return,p=d;break}p=p.return}d=p}Yi(e,t,c.children,n),t=t.child}return t;case 9:return c=t.type,o=t.pendingProps.children,Yu(t,n),c=ea(c),o=o(c),t.flags|=1,Yi(e,t,o,n),t.child;case 14:return o=t.type,c=fa(o,t.pendingProps),c=fa(o.type,c),M2(e,t,o,c,n);case 15:return gk(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,c=t.pendingProps,c=t.elementType===o?c:fa(o,c),ym(e,t),t.tag=1,mo(o)?(e=!0,jm(t)):e=!1,Yu(t,n),qS(t,o,c),Wv(t,o,c,n),Kv(null,t,o,!0,e,n);case 19:return bk(e,t,n);case 22:return yk(e,t,n)}throw Error(bt(156,t.tag))};function $k(e,t){return cS(e,t)}function MM(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yo(e,t,n,o){return new MM(e,t,n,o)}function rx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function DM(e){if(typeof e=="function")return rx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w1)return 11;if(e===E1)return 14}return 2}function Al(e,t){var n=e.alternate;return n===null?(n=Yo(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function xm(e,t,n,o,c,d){var p=2;if(o=e,typeof e=="function")rx(e)&&(p=1);else if(typeof e=="string")p=5;else e:switch(e){case Ru:return Pc(n.children,c,d,t);case b1:p=8,c|=8;break;case gv:return e=Yo(12,n,t,c|2),e.elementType=gv,e.lanes=d,e;case yv:return e=Yo(13,n,t,c),e.elementType=yv,e.lanes=d,e;case vv:return e=Yo(19,n,t,c),e.elementType=vv,e.lanes=d,e;case WT:return I0(n,c,d,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case GT:p=10;break e;case qT:p=9;break e;case w1:p=11;break e;case E1:p=14;break e;case pl:p=16,o=null;break e}throw Error(bt(130,e==null?e:typeof e,""))}return t=Yo(p,n,t,c),t.elementType=e,t.type=o,t.lanes=d,t}function Pc(e,t,n,o){return e=Yo(7,e,o,t),e.lanes=n,e}function I0(e,t,n,o){return e=Yo(22,e,o,t),e.elementType=WT,e.lanes=n,e.stateNode={isHidden:!1},e}function My(e,t,n){return e=Yo(6,e,null,t),e.lanes=n,e}function Dy(e,t,n){return t=Yo(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function RM(e,t,n,o,c){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hy(0),this.expirationTimes=hy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hy(0),this.identifierPrefix=o,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function ix(e,t,n,o,c,d,p,s,_){return e=new RM(e,t,n,s,_),t===1?(t=1,d===!0&&(t|=8)):t=0,d=Yo(3,null,null,t),e.current=d,d.stateNode=e,d.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},U1(d),e}function LM(e,t,n){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Du,key:o==null?null:""+o,children:e,containerInfo:t,implementation:n}}function zk(e){if(!e)return Dl;e=e._reactInternals;e:{if(Bc(e)!==e||e.tag!==1)throw Error(bt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(mo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(bt(171))}if(e.tag===1){var n=e.type;if(mo(n))return $S(e,n,t)}return t}function Bk(e,t,n,o,c,d,p,s,_){return e=ix(n,o,!0,e,c,d,p,s,_),e.context=zk(null),n=e.current,o=eo(),c=Pl(n),d=Cs(o,c),d.callback=t??null,kl(n,d,c),e.current.lanes=c,xf(e,c,o),go(e,o),e}function M0(e,t,n,o){var c=t.current,d=eo(),p=Pl(c);return n=zk(n),t.context===null?t.context=n:t.pendingContext=n,t=Cs(d,p),t.payload={element:e},o=o===void 0?null:o,o!==null&&(t.callback=o),e=kl(c,t,p),e!==null&&(va(e,c,p,d),pm(e,c,p)),p}function n0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function j2(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ox(e,t){j2(e,t),(e=e.alternate)&&j2(e,t)}function NM(){return null}var Fk=typeof reportError=="function"?reportError:function(e){console.error(e)};function ax(e){this._internalRoot=e}D0.prototype.render=ax.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(bt(409));M0(e,t,null,null)};D0.prototype.unmount=ax.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Lc(function(){M0(null,e,null,null)}),t[Ds]=null}};function D0(e){this._internalRoot=e}D0.prototype.unstable_scheduleHydration=function(e){if(e){var t=gS();e={blockedOn:null,target:e,priority:t};for(var n=0;n<yl.length&&t!==0&&t<yl[n].priority;n++);yl.splice(n,0,e),n===0&&vS(e)}};function sx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function R0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function G2(){}function OM(e,t,n,o,c){if(c){if(typeof o=="function"){var d=o;o=function(){var v=n0(p);d.call(v)}}var p=Bk(t,o,e,0,null,!1,!1,"",G2);return e._reactRootContainer=p,e[Ds]=p.current,rf(e.nodeType===8?e.parentNode:e),Lc(),p}for(;c=e.lastChild;)e.removeChild(c);if(typeof o=="function"){var s=o;o=function(){var v=n0(_);s.call(v)}}var _=ix(e,0,!1,null,null,!1,!1,"",G2);return e._reactRootContainer=_,e[Ds]=_.current,rf(e.nodeType===8?e.parentNode:e),Lc(function(){M0(t,_,n,o)}),_}function L0(e,t,n,o,c){var d=n._reactRootContainer;if(d){var p=d;if(typeof c=="function"){var s=c;c=function(){var _=n0(p);s.call(_)}}M0(t,p,e,c)}else p=OM(n,t,e,c,o);return n0(p)}pS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ch(t.pendingLanes);n!==0&&(k1(t,n|1),go(t,Fr()),!(Ln&6)&&(ud=Fr()+500,$l()))}break;case 13:Lc(function(){var o=Rs(e,1);if(o!==null){var c=eo();va(o,e,1,c)}}),ox(e,1)}};C1=function(e){if(e.tag===13){var t=Rs(e,134217728);if(t!==null){var n=eo();va(t,e,134217728,n)}ox(e,134217728)}};mS=function(e){if(e.tag===13){var t=Pl(e),n=Rs(e,t);if(n!==null){var o=eo();va(n,e,t,o)}ox(e,t)}};gS=function(){return Zn};yS=function(e,t){var n=Zn;try{return Zn=e,t()}finally{Zn=n}};Pv=function(e,t,n){switch(t){case"input":if(bv(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var c=T0(o);if(!c)throw Error(bt(90));ZT(o),bv(o,c)}}}break;case"textarea":XT(e,n);break;case"select":t=n.value,t!=null&&Hu(e,!!n.multiple,t,!1)}};rS=ex;iS=Lc;var $M={usingClientEntryPoint:!1,Events:[wf,$u,T0,tS,nS,ex]},vh={findFiberByHostInstance:wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},zM={bundleType:vh.bundleType,version:vh.version,rendererPackageName:vh.rendererPackageName,rendererConfig:vh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Os.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sS(e),e===null?null:e.stateNode},findFiberByHostInstance:vh.findFiberByHostInstance||NM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yp.isDisabled&&Yp.supportsFiber)try{x0=Yp.inject(zM),Ga=Yp}catch{}}Ro.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$M;Ro.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sx(t))throw Error(bt(200));return LM(e,t,null,n)};Ro.createRoot=function(e,t){if(!sx(e))throw Error(bt(299));var n=!1,o="",c=Fk;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=ix(e,1,!1,null,null,n,!1,o,c),e[Ds]=t.current,rf(e.nodeType===8?e.parentNode:e),new ax(t)};Ro.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(bt(188)):(e=Object.keys(e).join(","),Error(bt(268,e)));return e=sS(t),e=e===null?null:e.stateNode,e};Ro.flushSync=function(e){return Lc(e)};Ro.hydrate=function(e,t,n){if(!R0(t))throw Error(bt(200));return L0(null,e,t,!0,n)};Ro.hydrateRoot=function(e,t,n){if(!sx(e))throw Error(bt(405));var o=n!=null&&n.hydratedSources||null,c=!1,d="",p=Fk;if(n!=null&&(n.unstable_strictMode===!0&&(c=!0),n.identifierPrefix!==void 0&&(d=n.identifierPrefix),n.onRecoverableError!==void 0&&(p=n.onRecoverableError)),t=Bk(t,null,e,1,n??null,c,!1,d,p),e[Ds]=t.current,rf(e),o)for(e=0;e<o.length;e++)n=o[e],c=n._getVersion,c=c(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,c]:t.mutableSourceEagerHydrationData.push(n,c);return new D0(t)};Ro.render=function(e,t,n){if(!R0(t))throw Error(bt(200));return L0(null,e,t,!1,n)};Ro.unmountComponentAtNode=function(e){if(!R0(e))throw Error(bt(40));return e._reactRootContainer?(Lc(function(){L0(null,null,e,!1,function(){e._reactRootContainer=null,e[Ds]=null})}),!0):!1};Ro.unstable_batchedUpdates=ex;Ro.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!R0(n))throw Error(bt(200));if(e==null||e._reactInternals===void 0)throw Error(bt(38));return L0(e,t,n,!1,o)};Ro.version="18.2.0-next-9e3b772b8-20220608";(function(e){function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}t(),e.exports=Ro})(N9);const Uk=a1(yo);var Vk,q2=yo;Vk=q2.createRoot,q2.hydrateRoot;const BM="modulepreload",FM=function(e){return"/"+e},W2={},UM=function(t,n,o){if(!n||n.length===0)return t();const c=document.getElementsByTagName("link");return Promise.all(n.map(d=>{if(d=FM(d),d in W2)return;W2[d]=!0;const p=d.endsWith(".css"),s=p?'[rel="stylesheet"]':"";if(!!o)for(let E=c.length-1;E>=0;E--){const T=c[E];if(T.href===d&&(!p||T.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${s}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":BM,p||(v.as="script",v.crossOrigin=""),v.href=d,document.head.appendChild(v),p)return new Promise((E,T)=>{v.addEventListener("load",E),v.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${d}`)))})})).then(()=>t())},lx=P.createContext(null),VM=e=>{const[t,n]=P.useState({}),o=P.useCallback((d,p="default")=>{n(s=>{if(p==="current")throw new Error("'current' cannot be used as map id");if(s[p])throw new Error(`Multiple maps with the same id: ${p}`);return{...s,[p]:d}})},[]),c=P.useCallback((d="default")=>{n(p=>{if(p[d]){const s={...p};return delete s[d],s}return p})},[]);return P.createElement(lx.Provider,{value:{maps:t,onMapMount:o,onMapUnmount:c}},e.children)};function jM(){var e;const t=(e=P.useContext(lx))===null||e===void 0?void 0:e.maps,n=P.useContext(Tf);return P.useMemo(()=>({...t,current:n?.map}),[t,n])}function GM(e){const t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}function H2(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function Z2(e,t){const n=t.viewState||t;let o=!1;if("longitude"in n&&"latitude"in n){const c=e.center;e.center=new c.constructor(n.longitude,n.latitude),o=o||c!==e.center}if("zoom"in n){const c=e.zoom;e.zoom=n.zoom,o=o||c!==e.zoom}if("bearing"in n){const c=e.bearing;e.bearing=n.bearing,o=o||c!==e.bearing}if("pitch"in n){const c=e.pitch;e.pitch=n.pitch,o=o||c!==e.pitch}return n.padding&&!e.isPaddingEqual(n.padding)&&(o=!0,e.padding=n.padding),o}const qM=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function K2(e){if(!e)return null;if(typeof e=="string"||("toJS"in e&&(e=e.toJS()),!e.layers))return e;const t={};for(const o of e.layers)t[o.id]=o;const n=e.layers.map(o=>{const c=t[o.ref];let d=null;if("interactive"in o&&(d={...o},delete d.interactive),c){d=d||{...o},delete d.ref;for(const p of qM)p in c&&(d[p]=c[p])}return d||o});return{...e,layers:n}}function WM(e,t){const n=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0,c=Array.isArray(t)?t[0]:t?t.x:0,d=Array.isArray(t)?t[1]:t?t.y:0;return n===c&&o===d}function _l(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!_l(e[n],t[n]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(const c of n)if(!t.hasOwnProperty(c)||!_l(e[c],t[c]))return!1;return!0}return!1}const X2={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Ry={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Y2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},HM=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],ZM=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class dd{constructor(t,n,o){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=c=>{const d=this.props[Y2[c.type]];d&&d(c)},this._onPointerEvent=c=>{(c.type==="mousemove"||c.type==="mouseout")&&this._updateHover(c);const d=this.props[X2[c.type]];if(d){if(this.props.interactiveLayerIds&&c.type!=="mouseover"&&c.type!=="mouseout"){const p=this._hoveredFeatures||this._map.queryRenderedFeatures(c.point,{layers:this.props.interactiveLayerIds});c.features=p}d(c),delete c.features}},this._onCameraEvent=c=>{if(!this._internalUpdate){const d=this.props[Ry[c.type]];d&&d(c)}c.type in this._deferredEvents&&(this._deferredEvents[c.type]=!1)},this._MapClass=t,this.props=n,this._initialize(o)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const n=this.props;this.props=t;const o=this._updateSettings(t,n);o&&this._createShadowTransform(this._map);const c=this._updateSize(t),d=this._updateViewState(t,!0);this._updateStyle(t,n),this._updateStyleComponents(t,n),this._updateHandlers(t,n),(o||c||d&&!this._map.isMoving())&&this.redraw()}static reuse(t,n){const o=dd.savedMaps.pop();if(!o)return null;const c=o.map,d=c.getContainer();for(n.className=d.className;d.childNodes.length>0;)n.appendChild(d.childNodes[0]);c._container=n,o.setProps({...t,styleDiffing:!1}),c.resize();const{initialViewState:p}=t;return p&&(p.bounds?c.fitBounds(p.bounds,{...p.fitBoundsOptions,duration:0}):o._updateViewState(p,!1)),c.isStyleLoaded()?c.fire("load"):c.once("styledata",()=>c.fire("load")),o}_initialize(t){const{props:n}=this,o={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||KM()||null,container:t,style:K2(n.mapStyle)},c=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[c.longitude||0,c.latitude||0],zoom:c.zoom||0,pitch:c.pitch||0,bearing:c.bearing||0}),n.gl){const v=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=v,n.gl)}const d=new this._MapClass(o);c.padding&&d.setPadding(c.padding),n.cursor&&(d.getCanvas().style.cursor=n.cursor),this._createShadowTransform(d);const p=d._render;d._render=v=>{this._inRender=!0,p.call(d,v),this._inRender=!1};const s=d._renderTaskQueue.run;d._renderTaskQueue.run=v=>{s.call(d._renderTaskQueue,v),this._onBeforeRepaint()},d.on("render",()=>this._onAfterRepaint());const _=d.fire;d.fire=this._fireEvent.bind(this,_),d.on("resize",()=>{this._renderTransform.resize(d.transform.width,d.transform.height)}),d.on("styledata",()=>this._updateStyleComponents(this.props,{})),d.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const v in X2)d.on(v,this._onPointerEvent);for(const v in Ry)d.on(v,this._onCameraEvent);for(const v in Y2)d.on(v,this._onEvent);this._map=d}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n?.remove(),dd.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const n=GM(t.transform);t.painter.transform=n,this._renderTransform=n}_updateSize(t){const{viewState:n}=t;if(n){const o=this._map;if(n.width!==o.transform.width||n.height!==o.transform.height)return o.resize(),!0}return!1}_updateViewState(t,n){if(this._internalUpdate)return!1;const o=this._map,c=this._renderTransform,{zoom:d,pitch:p,bearing:s}=c,_=o.isMoving();_&&(c.cameraElevationReference="sea");const v=Z2(c,{...H2(o.transform),...t});if(_&&(c.cameraElevationReference="ground"),v&&n){const E=this._deferredEvents;E.move=!0,E.zoom||(E.zoom=d!==c.zoom),E.rotate||(E.rotate=s!==c.bearing),E.pitch||(E.pitch=p!==c.pitch)}return _||Z2(o.transform,t),v}_updateSettings(t,n){const o=this._map;let c=!1;for(const d of HM)d in t&&!_l(t[d],n[d])&&(c=!0,o[`set${d[0].toUpperCase()}${d.slice(1)}`](t[d]));return c}_updateStyle(t,n){if(t.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=t.cursor),t.mapStyle!==n.mapStyle){const o={diff:t.styleDiffing};return"localIdeographFontFamily"in t&&(o.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(K2(t.mapStyle),o),!0}return!1}_updateStyleComponents(t,n){const o=this._map;let c=!1;return o.style.loaded()&&("light"in t&&!_l(t.light,n.light)&&(c=!0,o.setLight(t.light)),"fog"in t&&!_l(t.fog,n.fog)&&(c=!0,o.setFog(t.fog)),"terrain"in t&&!_l(t.terrain,n.terrain)&&(!t.terrain||o.getSource(t.terrain.source))&&(c=!0,o.setTerrain(t.terrain))),c}_updateHandlers(t,n){const o=this._map;let c=!1;for(const d of ZM){const p=t[d];_l(p,n[d])||(c=!0,p?o[d].enable(p):o[d].disable())}return c}_updateHover(t){var n;const{props:o}=this;if(o.interactiveLayerIds&&(o.onMouseMove||o.onMouseEnter||o.onMouseLeave)){const d=t.type,p=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0;let s;if(d==="mousemove")try{s=this._map.queryRenderedFeatures(t.point,{layers:o.interactiveLayerIds})}catch{s=[]}else s=[];const _=s.length>0;!_&&p&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=s,_&&!p&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=d}else this._hoveredFeatures=null}_fireEvent(t,n,o){const c=this._map,d=c.transform,p=typeof n=="string"?n:n.type;return p==="move"&&this._updateViewState(this.props,!1),p in Ry&&(typeof n=="object"&&(n.viewState=H2(d)),this._map.isMoving())?(c.transform=this._renderTransform,t.call(c,n,o),c.transform=d,c):(t.call(c,n,o),c)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const o in this._deferredEvents)this._deferredEvents[o]&&t.fire(o);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}dd.savedMaps=[];function KM(){let e=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{}.MapboxAccessToken}catch{}try{e=e||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return e}const XM=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function YM(e,t){if(!e)return null;const n=e.map,o={getMap:()=>n,getCenter:()=>e.transform.center,getZoom:()=>e.transform.zoom,getBearing:()=>e.transform.bearing,getPitch:()=>e.transform.pitch,getPadding:()=>e.transform.padding,getBounds:()=>e.transform.getBounds(),project:c=>e.transform.locationPoint(t.LngLat.convert(c)),unproject:c=>e.transform.pointLocation(t.Point.convert(c)),queryTerrainElevation:(c,d)=>{const p=n.transform;n.transform=e.transform;const s=n.queryTerrainElevation(c,d);return n.transform=p,s}};for(const c of JM(n))!(c in o)&&!XM.includes(c)&&(o[c]=n[c].bind(n));return o}function JM(e){const t=new Set;let n=e;for(;n;){for(const o of Object.getOwnPropertyNames(n))o[0]!=="_"&&typeof e[o]=="function"&&o!=="fire"&&o!=="setEventedParent"&&t.add(o);n=Object.getPrototypeOf(n)}return Array.from(t)}const QM=typeof document<"u"?P.useLayoutEffect:P.useEffect,e5=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function t5(e,t){for(const n of e5)n in t&&(e[n]=t[n]);t.RTLTextPlugin&&e.getRTLTextPluginStatus&&e.getRTLTextPluginStatus()==="unavailable"&&e.setRTLTextPlugin(t.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const Tf=P.createContext(null),n5={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:e=>console.error(e.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},cx=P.forwardRef((e,t)=>{const n=P.useContext(lx),[o,c]=P.useState(null),d=P.useRef(),{current:p}=P.useRef({mapLib:null,map:null});P.useEffect(()=>{const _=e.mapLib;let v=!0,E;return Promise.resolve(_||UM(()=>import("./index-fc2e9253.js").then(T=>T.i),[])).then(T=>{if(v){if(T.Map||(T=T.default),!T||!T.Map)throw new Error("Invalid mapLib");if(T.supported(e))t5(T,e),e.reuseMaps&&(E=dd.reuse(e,d.current)),E||(E=new dd(T.Map,e,d.current)),p.map=YM(E,T),p.mapLib=T,c(E),n?.onMapMount(p.map,e.id);else throw new Error("Map is not supported by this browser")}}).catch(T=>{e.onError({type:"error",target:null,originalEvent:null,error:T})}),()=>{v=!1,E&&(n?.onMapUnmount(e.id),e.reuseMaps?E.recycle():E.destroy())}},[]),QM(()=>{o&&o.setProps(e)}),P.useImperativeHandle(t,()=>p.map,[o]);const s=P.useMemo(()=>({position:"relative",width:"100%",height:"100%",...e.style}),[e.style]);return P.createElement("div",{id:e.id,ref:d,style:s},o&&P.createElement(Tf.Provider,{value:p},P.createElement("div",{"mapboxgl-children":""},e.children)))});cx.displayName="Map";cx.defaultProps=n5;const r5=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Fc(e,t){if(!e||!t)return;const n=e.style;for(const o in t){const c=t[o];Number.isFinite(c)&&!r5.test(o)?n[o]=`${c}px`:n[o]=c}}const i5={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function jk(e){const{map:t,mapLib:n}=P.useContext(Tf),o=P.useRef({props:e});o.current.props=e;const c=P.useMemo(()=>{let d=!1;P.Children.forEach(e.children,_=>{_&&(d=!0)});const p={...e,element:d?document.createElement("div"):null},s=new n.Marker(p).setLngLat([e.longitude,e.latitude]);return s.getElement().addEventListener("click",_=>{var v,E;(E=(v=o.current.props).onClick)===null||E===void 0||E.call(v,{type:"click",target:s,originalEvent:_})}),s.on("dragstart",_=>{var v,E;const T=_;T.lngLat=c.getLngLat(),(E=(v=o.current.props).onDragStart)===null||E===void 0||E.call(v,T)}),s.on("drag",_=>{var v,E;const T=_;T.lngLat=c.getLngLat(),(E=(v=o.current.props).onDrag)===null||E===void 0||E.call(v,T)}),s.on("dragend",_=>{var v,E;const T=_;T.lngLat=c.getLngLat(),(E=(v=o.current.props).onDragEnd)===null||E===void 0||E.call(v,T)}),s},[]);return P.useEffect(()=>(c.addTo(t.getMap()),()=>{c.remove()}),[]),P.useEffect(()=>{Fc(c.getElement(),e.style)},[e.style]),(c.getLngLat().lng!==e.longitude||c.getLngLat().lat!==e.latitude)&&c.setLngLat([e.longitude,e.latitude]),e.offset&&!WM(c.getOffset(),e.offset)&&c.setOffset(e.offset),c.isDraggable()!==e.draggable&&c.setDraggable(e.draggable),c.getRotation()!==e.rotation&&c.setRotation(e.rotation),c.getRotationAlignment()!==e.rotationAlignment&&c.setRotationAlignment(e.rotationAlignment),c.getPitchAlignment()!==e.pitchAlignment&&c.setPitchAlignment(e.pitchAlignment),c.getPopup()!==e.popup&&c.setPopup(e.popup),yo.createPortal(e.children,c.getElement())}jk.defaultProps=i5;const J2=P.memo(jk);function Q2(e){return new Set(e?e.trim().split(/\s+/):[])}function o5(e){const{map:t,mapLib:n}=P.useContext(Tf),o=P.useMemo(()=>document.createElement("div"),[]),c=P.useRef({props:e});c.current.props=e;const d=P.useMemo(()=>{const p={...e},s=new n.Popup(p).setLngLat([e.longitude,e.latitude]);return s.once("open",_=>{var v,E;(E=(v=c.current.props).onOpen)===null||E===void 0||E.call(v,_)}),s},[]);if(P.useEffect(()=>{const p=s=>{var _,v;(v=(_=c.current.props).onClose)===null||v===void 0||v.call(_,s)};return d.on("close",p),d.setDOMContent(o).addTo(t.getMap()),()=>{d.off("close",p),d.isOpen()&&d.remove()}},[]),P.useEffect(()=>{Fc(d.getElement(),e.style)},[e.style]),d.isOpen()&&((d.getLngLat().lng!==e.longitude||d.getLngLat().lat!==e.latitude)&&d.setLngLat([e.longitude,e.latitude]),e.offset&&!_l(d.options.offset,e.offset)&&d.setOffset(e.offset),(d.options.anchor!==e.anchor||d.options.maxWidth!==e.maxWidth)&&(d.options.anchor=e.anchor,d.setMaxWidth(e.maxWidth)),d.options.className!==e.className)){const p=Q2(d.options.className),s=Q2(e.className);for(const _ of p)s.has(_)||d.removeClassName(_);for(const _ of s)p.has(_)||d.addClassName(_);d.options.className=e.className}return yo.createPortal(e.children,o)}P.memo(o5);function Sf(e,t,n,o){const c=P.useContext(Tf),d=P.useMemo(()=>e(c),[]);return P.useEffect(()=>{const p=o||n||t,s=typeof t=="function"&&typeof n=="function"?t:null,_=typeof n=="function"?n:typeof t=="function"?t:null,{map:v}=c;return v.hasControl(d)||(v.addControl(d,p?.position),s&&s(c)),()=>{_&&_(c),v.hasControl(d)&&v.removeControl(d)}},[]),d}function a5(e){const t=Sf(({mapLib:n})=>new n.AttributionControl(e),{position:e.position});return P.useEffect(()=>{Fc(t._container,e.style)},[e.style]),null}P.memo(a5);function s5(e){const t=Sf(({mapLib:n})=>new n.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)}),{position:e.position});return P.useEffect(()=>{Fc(t._controlContainer,e.style)},[e.style]),null}P.memo(s5);const Gk=P.forwardRef((e,t)=>{const n=P.useRef({props:e}),o=Sf(({mapLib:c})=>{const d=new c.GeolocateControl(e),p=d._setupUI;return d._setupUI=s=>{d._container.hasChildNodes()||p(s)},d.on("geolocate",s=>{var _,v;(v=(_=n.current.props).onGeolocate)===null||v===void 0||v.call(_,s)}),d.on("error",s=>{var _,v;(v=(_=n.current.props).onError)===null||v===void 0||v.call(_,s)}),d.on("outofmaxbounds",s=>{var _,v;(v=(_=n.current.props).onOutOfMaxBounds)===null||v===void 0||v.call(_,s)}),d.on("trackuserlocationstart",s=>{var _,v;(v=(_=n.current.props).onTrackUserLocationStart)===null||v===void 0||v.call(_,s)}),d.on("trackuserlocationend",s=>{var _,v;(v=(_=n.current.props).onTrackUserLocationEnd)===null||v===void 0||v.call(_,s)}),d},{position:e.position});return n.current.props=e,P.useImperativeHandle(t,()=>({trigger:()=>o.trigger()}),[]),P.useEffect(()=>{Fc(o._container,e.style)},[e.style]),null});Gk.displayName="GeolocateControl";P.memo(Gk);function l5(e){const t=Sf(({mapLib:n})=>new n.NavigationControl(e),{position:e.position});return P.useEffect(()=>{Fc(t._container,e.style)},[e.style]),null}P.memo(l5);const c5={unit:"metric",maxWidth:100};function qk(e){const t=Sf(({mapLib:n})=>new n.ScaleControl(e),{position:e.position});return(t.options.unit!==e.unit||t.options.maxWidth!==e.maxWidth)&&(t.options.maxWidth=e.maxWidth,t.setUnit(e.unit)),P.useEffect(()=>{Fc(t._container,e.style)},[e.style]),null}qk.defaultProps=c5;P.memo(qk);const eE=e=>{let t;const n=new Set,o=(_,v)=>{const E=typeof _=="function"?_(t):_;if(!Object.is(E,t)){const T=t;t=v??typeof E!="object"?E:Object.assign({},t,E),n.forEach(S=>S(t,T))}},c=()=>t,s={setState:o,getState:c,subscribe:_=>(n.add(_),()=>n.delete(_)),destroy:()=>{var _;((_={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})==null?void 0:_.MODE)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(o,c,s),s},u5=e=>e?eE(e):eE;var s_={},d5={get exports(){return s_},set exports(e){s_=e}},Wk={},l_={},h5={get exports(){return l_},set exports(e){l_=e}},Hk={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hd=P;function f5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var p5=typeof Object.is=="function"?Object.is:f5,m5=hd.useState,g5=hd.useEffect,y5=hd.useLayoutEffect,v5=hd.useDebugValue;function _5(e,t){var n=t(),o=m5({inst:{value:n,getSnapshot:t}}),c=o[0].inst,d=o[1];return y5(function(){c.value=n,c.getSnapshot=t,Ly(c)&&d({inst:c})},[e,n,t]),g5(function(){return Ly(c)&&d({inst:c}),e(function(){Ly(c)&&d({inst:c})})},[e]),v5(n),n}function Ly(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!p5(e,n)}catch{return!0}}function x5(e,t){return t()}var b5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?x5:_5;Hk.useSyncExternalStore=hd.useSyncExternalStore!==void 0?hd.useSyncExternalStore:b5;(function(e){e.exports=Hk})(h5);/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N0=P,w5=l_;function E5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var T5=typeof Object.is=="function"?Object.is:E5,S5=w5.useSyncExternalStore,k5=N0.useRef,C5=N0.useEffect,P5=N0.useMemo,A5=N0.useDebugValue;Wk.useSyncExternalStoreWithSelector=function(e,t,n,o,c){var d=k5(null);if(d.current===null){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=P5(function(){function _(D){if(!v){if(v=!0,E=D,D=o(D),c!==void 0&&p.hasValue){var O=p.value;if(c(O,D))return T=O}return T=D}if(O=T,T5(E,D))return O;var M=o(D);return c!==void 0&&c(O,M)?O:(E=D,T=M)}var v=!1,E,T,S=n===void 0?null:n;return[function(){return _(t())},S===null?void 0:function(){return _(S())}]},[t,n,o,c]);var s=S5(e,d[0],d[1]);return C5(function(){p.hasValue=!0,p.value=s},[s]),A5(s),s};(function(e){e.exports=Wk})(d5);const I5=a1(s_),{useSyncExternalStoreWithSelector:M5}=I5;function D5(e,t=e.getState,n){const o=M5(e.subscribe,e.getState,e.getServerState||e.getState,t,n);return P.useDebugValue(o),o}const tE=e=>{var t;((t={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})==null?void 0:t.MODE)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const n=typeof e=="function"?u5(e):e,o=(c,d)=>D5(n,c,d);return Object.assign(o,n),o},Zk=e=>e?tE(e):tE,$s=Zk()(e=>({selectedDevice:0,devices:[],currentPage:"messages",rasterSources:[],commandPaletteOpen:!1,darkMode:window.matchMedia("(prefers-color-scheme: dark)").matches,accent:"orange",connectDialogOpen:!1,setRasterSources:t=>{e(Vn(n=>{n.rasterSources=t}))},addRasterSource:t=>{e(Vn(n=>{n.rasterSources.push(t)}))},removeRasterSource:t=>{e(Vn(n=>{n.rasterSources.splice(t,1)}))},setSelectedDevice:t=>e(()=>({selectedDevice:t})),addDevice:t=>e(n=>({devices:[...n.devices,t]})),removeDevice:t=>e(n=>({devices:n.devices.filter(o=>o.id!==t)})),setCommandPaletteOpen:t=>{e(Vn(n=>{n.commandPaletteOpen=t}))},setDarkMode:t=>{e(Vn(n=>{n.darkMode=t}))},setAccent(t){e(Vn(n=>{n.accent=t}))},setConnectDialogOpen:t=>{e(Vn(n=>{n.connectDialogOpen=t}))}})),nE="f75c76d2-129e-4dad-a1dd-7866124401e7",rE="2c55e69e-4993-11ed-b878-0242ac120002",iE="ed9da18c-a800-4f66-a670-aa7547e34453",c_="6ba1b218-15a8-461f-9fa8-5dcae273eafd",oE=4294967295,aE=2,u_={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]};function d_(e,t,n,o=!1){const c=String(t),d=(s,_)=>`\x1B[${_[0]}m${s}\x1B[${_[1]}m`,p=(s,_)=>_!=null&&typeof _=="string"?d(s,u_[_]):_!=null&&Array.isArray(_)?_.reduce((v,E)=>p(v,E),s):_!=null&&_[s.trim()]!=null?p(s,_[s.trim()]):_!=null&&_["*"]!=null?p(s,_["*"]):s;return c.replace(/{{(.+?)}}/g,(s,_)=>{const v=n[_]!=null?n[_]:o?"":s;return e.stylePrettyLogs?p(v,e?.prettyLogStyles?.[_])+d("",u_.reset):v})}function Kk(e){const t=new Set;return JSON.stringify(e,(n,o)=>{if(typeof o=="object"&&o!==null){if(t.has(o))return"[Circular]";t.add(o)}return o})}function Xo(e,t){const n={seen:[],stylize:Xk};return t!=null&&eC(n,t),Gu(n.showHidden)&&(n.showHidden=!1),Gu(n.depth)&&(n.depth=2),Gu(n.colors)&&(n.colors=!0),Gu(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=L5),r0(n,e,n.depth)}Xo.colors=u_;Xo.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function R5(e){return typeof e=="boolean"}function Gu(e){return e==null}function Xk(e){return e}function L5(e,t){const n=Xo.styles[t];return n!=null&&Xo?.colors?.[n]?.[0]!=null&&Xo?.colors?.[n]?.[1]!=null?"\x1B["+Xo.colors[n][0]+"m"+e+"\x1B["+Xo.colors[n][1]+"m":e}function Jp(e){return typeof e=="function"}function Yk(e){return typeof e=="string"}function N5(e){return typeof e=="number"}function Jk(e){return e===null}function Qk(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Ny(e){return O0(e)&&ux(e)==="[object RegExp]"}function O0(e){return typeof e=="object"&&e!==null}function Oy(e){return O0(e)&&(ux(e)==="[object Error]"||e instanceof Error)}function sE(e){return O0(e)&&ux(e)==="[object Date]"}function ux(e){return Object.prototype.toString.call(e)}function O5(e){const t={};return e.forEach(n=>{t[n]=!0}),t}function $5(e,t,n,o,c){const d=[];for(let p=0,s=t.length;p<s;++p)Qk(t,String(p))?d.push(h_(e,t,n,o,String(p),!0)):d.push("");return c.forEach(p=>{p.match(/^\d+$/)||d.push(h_(e,t,n,o,p,!0))}),d}function $y(e){return"["+Error.prototype.toString.call(e)+"]"}function r0(e,t,n=0){if(e.customInspect&&t!=null&&Jp(t)&&t?.inspect!==Xo&&!(t?.constructor&&t?.constructor.prototype===t)){if(typeof t.inspect!="function"&&t.toString!=null)return t.toString();let E=t?.inspect(n,e);return Yk(E)||(E=r0(e,E,n)),E}const o=hl(e,t);if(o)return o;let c=Object.keys(t);const d=O5(c);try{e.showHidden&&Object.getOwnPropertyNames&&(c=Object.getOwnPropertyNames(t))}catch{}if(Oy(t)&&(c.indexOf("message")>=0||c.indexOf("description")>=0))return $y(t);if(c.length===0)if(Jp(e.stylize)){if(Jp(t)){const E=t.name?": "+t.name:"";return e.stylize("[Function"+E+"]","special")}if(Ny(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(sE(t))return e.stylize(Date.prototype.toString.call(t),"date");if(Oy(t))return $y(t)}else return t;let p="",s=!1,_=[`{
`,`
}`];if(Array.isArray(t)&&(s=!0,_=[`[
`,`
]`]),Jp(t)&&(p=" [Function"+(t.name?": "+t.name:"")+"]"),Ny(t)&&(p=" "+RegExp.prototype.toString.call(t)),sE(t)&&(p=" "+Date.prototype.toUTCString.call(t)),Oy(t)&&(p=" "+$y(t)),c.length===0&&(!s||t.length==0))return _[0]+p+_[1];if(n<0)return Ny(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);let v;return s?v=$5(e,t,n,d,c):v=c.map(E=>h_(e,t,n,d,E,s)),e.seen.pop(),z5(v,p,_)}function h_(e,t,n,o,c,d){let p,s,_;_={value:void 0};try{_.value=t[c]}catch{}try{Object.getOwnPropertyDescriptor&&(_=Object.getOwnPropertyDescriptor(t,c)||_)}catch{}if(_.get?_.set?s=e.stylize("[Getter/Setter]","special"):s=e.stylize("[Getter]","special"):_.set&&(s=e.stylize("[Setter]","special")),Qk(o,c)||(p="["+c+"]"),s||(e.seen.indexOf(_.value)<0?(Jk(n)?s=r0(e,_.value,void 0):s=r0(e,_.value,n-1),s.indexOf(`
`)>-1&&(d?s=s.split(`
`).map(v=>"  "+v).join(`
`).substr(2):s=`
`+s.split(`
`).map(v=>"   "+v).join(`
`))):s=e.stylize("[Circular]","special")),Gu(p)){if(d&&c.match(/^\d+$/))return s;p=JSON.stringify(""+c),p.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(p=p.substr(1,p.length-2),p=e.stylize(p,"name")):(p=p.replace(/'/g,"\\'").replace(/\\"/g,"\\'").replace(/(^"|"$)/g,"'"),p=e.stylize(p,"string"))}return p+": "+s}function hl(e,t){if(Gu(t))return e.stylize("undefined","undefined");if(Yk(t)){const n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,"\\'")+"'";return e.stylize(n,"string")}if(N5(t))return e.stylize(""+t,"number");if(R5(t))return e.stylize(""+t,"boolean");if(Jk(t))return e.stylize("null","null")}function z5(e,t,n){return n[0]+(t===""?"":t+`
`)+"  "+e.join(`,
  `)+" "+n[1]}function eC(e,t){if(!t||!O0(t))return e;const n=Object.keys(t);let o=n.length;for(;o--;)e[n[o]]=t[n[o]];return e}function B5(e,...t){const n={seen:[],stylize:Xk};e!=null&&eC(n,e);const o=t[0];let c=0,d="",p="";if(typeof o=="string"){if(t.length===1)return o;let s,_=0;for(let v=0;v<o.length-1;v++)if(o.charCodeAt(v)===37){const E=o.charCodeAt(++v);if(c+1!==t.length){switch(E){case 115:{const T=t[++c];typeof T=="number"||typeof T=="bigint"?s=hl(n,T):typeof T!="object"||T===null?s=String(T):s=Xo(T,{...e,compact:3,colors:!1,depth:0});break}case 106:s=Kk(t[++c]);break;case 100:{const T=t[++c];typeof T=="bigint"?s=hl(n,T):typeof T=="symbol"?s="NaN":s=hl(n,T);break}case 79:s=Xo(t[++c],e);break;case 111:s=Xo(t[++c],{...e,showHidden:!0,showProxy:!0,depth:4});break;case 105:{const T=t[++c];typeof T=="bigint"?s=hl(n,T):typeof T=="symbol"?s="NaN":s=hl(n,parseInt(s));break}case 102:{const T=t[++c];typeof T=="symbol"?s="NaN":s=hl(n,parseInt(T));break}case 99:c+=1,s="";break;case 37:d+=o.slice(_,v),_=v+1;continue;default:continue}_!==v-1&&(d+=o.slice(_,v-1)),d+=s,_=v+1}else E===37&&(d+=o.slice(_,v),_=v+1)}_!==0&&(c++,p=" ",_<o.length&&(d+=o.slice(_)))}for(;c<t.length;){const s=t[c];d+=p,d+=typeof s!="string"?Xo(s,e):s,p=" ",c++}return d}const F5={runtime:"Browser",browser:window?.navigator.userAgent},U5=/(?:(?:file|https?|global code|[^@]+)@)?(?:file:)?((?:\/[^:/]+){2,})(?::(\d+))?(?::(\d+))?/;function V5(e,t,n,o,c,d){return Object.assign({},F5,{name:c,parentNames:d,date:new Date,logLevelId:e,logLevelName:t,path:o?void 0:j5(n)})}function j5(e,t=Error()){return nC(t?.stack?.split(`
`)?.filter(n=>!n.includes("Error: "))?.[e])}function tC(e){return e?.stack?.split(`
`)?.filter(t=>!t.includes("Error: "))?.reduce((t,n)=>(t.push(nC(n)),t),[])}function nC(e){const t=window.location.origin,n={fullFilePath:void 0,fileName:void 0,fileNameWithLine:void 0,fileColumn:void 0,fileLine:void 0,filePath:void 0,filePathWithLine:void 0,method:void 0};if(e!=null){const o=e.match(U5);if(o){n.filePath=o[1].replace(/\?.*$/,""),n.fullFilePath=`${t}${n.filePath}`;const c=n.filePath.split("/");n.fileName=c[c.length-1],n.fileLine=o[2],n.fileColumn=o[3],n.filePathWithLine=`${n.filePath}:${n.fileLine}`,n.fileNameWithLine=`${n.fileName}:${n.fileLine}`}}return n}function f_(e){return e instanceof Error}function G5(e,t){return e.reduce((n,o)=>(f_(o)?n.errors.push(q5(o,t)):n.args.push(o),n),{args:[],errors:[]})}function q5(e,t){const n=tC(e).map(c=>d_(t,t.prettyErrorStackTemplate,{...c},!0)),o={errorName:` ${e.name} `,errorMessage:e.message,errorStack:n.join(`
`)};return d_(t,t.prettyErrorTemplate,o)}function W5(e,t,n,o){const c=(n.length>0&&t.length>0?`
`:"")+n.join(`
`);o.prettyInspectOptions.colors=o.stylePrettyLogs,console.log(e+B5(o.prettyInspectOptions,...t)+c)}function H5(e){console.log(Kk(e))}function Go(e,t=2,n=0){return e!=null&&isNaN(e)?"":(e=e!=null?e+n:e,t===2?e==null?"--":e<10?"0"+e:e.toString():e==null?"---":e<10?"00"+e:e<100?"0"+e:e.toString())}class Z5{constructor(t,n,o=4){this.logObj=n,this.stackDepthLevel=o;const c=![typeof window,typeof document].includes("undefined"),d=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";this.runtime=c?"browser":d?"nodejs":"unknown";const p=c?((window?.chrome||window.Intl&&Intl?.v8BreakIterator)&&"CSS"in window)!=null:!1,s=c?/^((?!chrome|android).)*safari/i.test(navigator.userAgent):!1;this.stackDepthLevel=s?4:this.stackDepthLevel,this.settings={type:t?.type??"pretty",name:t?.name,parentNames:t?.parentNames,minLevel:t?.minLevel??0,argumentsArrayName:t?.argumentsArrayName,hideLogPositionForProduction:t?.hideLogPositionForProduction??!1,prettyLogTemplate:t?.prettyLogTemplate??"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}	{{logLevelName}}	{{filePathWithLine}}{{nameWithDelimiterPrefix}}	",prettyErrorTemplate:t?.prettyErrorTemplate??`
{{errorName}} {{errorMessage}}
error stack:
{{errorStack}}`,prettyErrorStackTemplate:t?.prettyErrorStackTemplate??`   {{fileName}}	{{method}}
	{{filePathWithLine}}`,prettyErrorParentNamesSeparator:t?.prettyErrorParentNamesSeparator??":",prettyErrorLoggerNameDelimiter:t?.prettyErrorLoggerNameDelimiter??"	",stylePrettyLogs:t?.stylePrettyLogs??!0,prettyLogTimeZone:t?.prettyLogTimeZone??"UTC",prettyLogStyles:t?.prettyLogStyles??{logLevelName:{"*":["bold","black","bgWhiteBright","dim"],SILLY:["bold","white"],TRACE:["bold","whiteBright"],DEBUG:["bold","green"],INFO:["bold","blue"],WARN:["bold","yellow"],ERROR:["bold","red"],FATAL:["bold","redBright"]},dateIsoStr:"white",filePathWithLine:"white",name:["white","bold"],nameWithDelimiterPrefix:["white","bold"],nameWithDelimiterSuffix:["white","bold"],errorName:["bold","bgRedBright","whiteBright"],fileName:["yellow"],fileNameWithLine:"white"},prettyInspectOptions:t?.prettyInspectOptions??{colors:!0,compact:!1,depth:1/0},metaProperty:t?.metaProperty??"_meta",maskPlaceholder:t?.maskPlaceholder??"[***]",maskValuesOfKeys:t?.maskValuesOfKeys??["password"],maskValuesOfKeysCaseInsensitive:t?.maskValuesOfKeysCaseInsensitive??!1,maskValuesRegEx:t?.maskValuesRegEx,prefix:[...t?.prefix??[]],attachedTransports:[...t?.attachedTransports??[]],overwrite:{mask:t?.overwrite?.mask,toLogObj:t?.overwrite?.toLogObj,addMeta:t?.overwrite?.addMeta,formatMeta:t?.overwrite?.formatMeta,formatLogObj:t?.overwrite?.formatLogObj,transportFormatted:t?.overwrite?.transportFormatted,transportJSON:t?.overwrite?.transportJSON}},this.settings.stylePrettyLogs=this.settings.stylePrettyLogs&&c&&!p?!1:this.settings.stylePrettyLogs}log(t,n,...o){if(t<this.settings.minLevel)return;const c=[...this.settings.prefix,...o],d=this.settings.overwrite?.mask!=null?this.settings.overwrite?.mask(c):this.settings.maskValuesOfKeys!=null&&this.settings.maskValuesOfKeys.length>0?this._mask(c):c,p=this.logObj!=null?this._recursiveCloneAndExecuteFunctions(this.logObj):void 0,s=this.settings.overwrite?.toLogObj!=null?this.settings.overwrite?.toLogObj(d,p):this._toLogObj(d,p),_=this.settings.overwrite?.addMeta!=null?this.settings.overwrite?.addMeta(s,t,n):this._addMetaToLogObj(s,t,n);let v,E;return this.settings.overwrite?.formatMeta!=null&&(v=this.settings.overwrite?.formatMeta(_?.[this.settings.metaProperty])),this.settings.overwrite?.formatLogObj!=null&&(E=this.settings.overwrite?.formatLogObj(d,this.settings)),this.settings.type==="pretty"&&(v=v??this._prettyFormatLogObjMeta(_?.[this.settings.metaProperty]),E=E??G5(d,this.settings)),v!=null&&E!=null?this.settings.overwrite?.transportFormatted!=null?this.settings.overwrite?.transportFormatted(v,E.args,E.errors,this.settings):W5(v,E.args,E.errors,this.settings):this.settings.overwrite?.transportJSON!=null?this.settings.overwrite?.transportJSON(_):this.settings.type!=="hidden"&&H5(_),this.settings.attachedTransports!=null&&this.settings.attachedTransports.length>0&&this.settings.attachedTransports.forEach(T=>{T(_)}),_}attachTransport(t){this.settings.attachedTransports.push(t)}getSubLogger(t,n){const o={...this.settings,...t,parentNames:this.settings?.parentNames!=null&&this.settings?.name!=null?[...this.settings.parentNames,this.settings.name]:this.settings?.name!=null?[this.settings.name]:void 0,prefix:[...this.settings.prefix,...t?.prefix??[]]};return new this.constructor(o,n??this.logObj,this.stackDepthLevel)}_mask(t){const n=this.settings.maskValuesOfKeysCaseInsensitive!==!0?this.settings.maskValuesOfKeys:this.settings.maskValuesOfKeys.map(o=>o.toLowerCase());return t?.map(o=>this._recursiveCloneAndMaskValuesOfKeys(o,n))}_recursiveCloneAndMaskValuesOfKeys(t,n,o=[]){return o.includes(t)?{...t}:(typeof t=="object"&&t!=null&&o.push(t),void 0?t:t instanceof Map?new Map(t):t instanceof Set?new Set(t):Array.isArray(t)?t.map(c=>this._recursiveCloneAndMaskValuesOfKeys(c,n,o)):t instanceof Date?new Date(t.getTime()):f_(t)?Object.getOwnPropertyNames(t).reduce((c,d)=>(c[d]=n.includes(this.settings?.maskValuesOfKeysCaseInsensitive!==!0?d:d.toLowerCase())?this.settings.maskPlaceholder:this._recursiveCloneAndMaskValuesOfKeys(t[d],n,o),c),this._cloneError(t)):t!=null&&typeof t=="object"?Object.getOwnPropertyNames(t).reduce((c,d)=>(c[d]=n.includes(this.settings?.maskValuesOfKeysCaseInsensitive!==!0?d:d.toLowerCase())?this.settings.maskPlaceholder:this._recursiveCloneAndMaskValuesOfKeys(t[d],n,o),c),Object.create(Object.getPrototypeOf(t))):(c=>(this.settings?.maskValuesRegEx?.forEach(d=>{c=c?.toString()?.replace(d,this.settings.maskPlaceholder)}),c))(t))}_recursiveCloneAndExecuteFunctions(t,n=[]){return n.includes(t)?{...t}:(typeof t=="object"&&n.push(t),Array.isArray(t)?t.map(o=>this._recursiveCloneAndExecuteFunctions(o,n)):t instanceof Date?new Date(t.getTime()):t&&typeof t=="object"?Object.getOwnPropertyNames(t).reduce((o,c)=>(Object.defineProperty(o,c,Object.getOwnPropertyDescriptor(t,c)),o[c]=typeof t[c]=="function"?t[c]():this._recursiveCloneAndExecuteFunctions(t[c],n),o),Object.create(Object.getPrototypeOf(t))):t)}_toLogObj(t,n={}){return t=t?.map(o=>f_(o)?this._toErrorObject(o):o),this.settings.argumentsArrayName==null?t.length===1&&!Array.isArray(t[0])&&(t[0],void 0)!==!0&&!(t[0]instanceof Date)?n=typeof t[0]=="object"&&t[0]!=null?{...t[0],...n}:{0:t[0],...n}:n={...n,...t}:n={...n,[this.settings.argumentsArrayName]:t},n}_cloneError(t){const n=t.constructor,o=new n(t.message);Object.assign(o,t);const c=Object.getOwnPropertyNames(o);for(const d of c){const p=Object.getOwnPropertyDescriptor(o,d);p&&(p.writable=!0,Object.defineProperty(o,d,p))}return o}_toErrorObject(t){return{nativeError:t,name:t.name??"Error",message:t.message,stack:tC(t)}}_addMetaToLogObj(t,n,o){return{...t,[this.settings.metaProperty]:V5(n,o,this.stackDepthLevel,this.settings.hideLogPositionForProduction,this.settings.name,this.settings.parentNames)}}_prettyFormatLogObjMeta(t){if(t==null)return"";let n=this.settings.prettyLogTemplate;const o={};n.includes("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}")?n=n.replace("{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}","{{dateIsoStr}}"):this.settings.prettyLogTimeZone==="UTC"?(o.yyyy=t?.date?.getUTCFullYear()??"----",o.mm=Go(t?.date?.getUTCMonth(),2,1),o.dd=Go(t?.date?.getUTCDate(),2),o.hh=Go(t?.date?.getUTCHours(),2),o.MM=Go(t?.date?.getUTCMinutes(),2),o.ss=Go(t?.date?.getUTCSeconds(),2),o.ms=Go(t?.date?.getUTCMilliseconds(),3)):(o.yyyy=t?.date?.getFullYear()??"----",o.mm=Go(t?.date?.getMonth(),2,1),o.dd=Go(t?.date?.getDate(),2),o.hh=Go(t?.date?.getHours(),2),o.MM=Go(t?.date?.getMinutes(),2),o.ss=Go(t?.date?.getSeconds(),2),o.ms=Go(t?.date?.getMilliseconds(),3));const c=this.settings.prettyLogTimeZone==="UTC"?t?.date:new Date(t?.date?.getTime()-t?.date?.getTimezoneOffset()*6e4);o.rawIsoStr=c?.toISOString(),o.dateIsoStr=c?.toISOString().replace("T"," ").replace("Z",""),o.logLevelName=t?.logLevelName,o.fileNameWithLine=t?.path?.fileNameWithLine??"",o.filePathWithLine=t?.path?.filePathWithLine??"",o.fullFilePath=t?.path?.fullFilePath??"";let d=this.settings.parentNames?.join(this.settings.prettyErrorParentNamesSeparator);return d=d!=null&&t?.name!=null?d+this.settings.prettyErrorParentNamesSeparator:void 0,o.name=t?.name!=null||d!=null?(d??"")+t?.name:"",o.nameWithDelimiterPrefix=o.name.length>0?this.settings.prettyErrorLoggerNameDelimiter+o.name:"",o.nameWithDelimiterSuffix=o.name.length>0?o.name+this.settings.prettyErrorLoggerNameDelimiter:"",d_(this.settings,n,o)}}class K5 extends Z5{constructor(t,n){super(t,n,5)}log(t,n,...o){return super.log(t,n,...o)}silly(...t){return super.log(0,"SILLY",...t)}trace(...t){return super.log(1,"TRACE",...t)}debug(...t){return super.log(2,"DEBUG",...t)}info(...t){return super.log(3,"INFO",...t)}warn(...t){return super.log(4,"WARN",...t)}error(...t){return super.log(5,"ERROR",...t)}fatal(...t){return super.log(6,"FATAL",...t)}getSubLogger(t,n){return super.getSubLogger(t,n)}}var $n={},kf={};Object.defineProperty(kf,"__esModule",{value:!0});kf.Subscription=void 0;var X5=function(){function e(t){var n=this;this._cancel=t.cancel,this.name=t.sub.name;var o=t.sub.cancel;t.sub.cancel=function(){n._cancel=null,o()}}return Object.defineProperty(e.prototype,"live",{get:function(){return!!this._cancel},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){return this._cancel?(this._cancel(),this._cancel=null,!0):!1},e}();kf.Subscription=X5;var dx={},p_=function(e,t){return p_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(n[c]=o[c])},p_(e,t)};function Y5(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");p_(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Si=function(){return Si=Object.assign||function(t){for(var n,o=1,c=arguments.length;o<c;o++){n=arguments[o];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(t[d]=n[d])}return t},Si.apply(this,arguments)};function $0(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(e);c<o.length;c++)t.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(e,o[c])&&(n[o[c]]=e[o[c]]);return n}function J5(e,t,n,o){var c=arguments.length,d=c<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,n):o,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(p=e[s])&&(d=(c<3?p(d):c>3?p(t,n,d):p(t,n))||d);return c>3&&d&&Object.defineProperty(t,n,d),d}function Q5(e,t){return function(n,o){t(n,o,e)}}function e6(e,t,n,o,c,d){function p($){if($!==void 0&&typeof $!="function")throw new TypeError("Function expected");return $}for(var s=o.kind,_=s==="getter"?"get":s==="setter"?"set":"value",v=!t&&e?o.static?e:e.prototype:null,E=t||(v?Object.getOwnPropertyDescriptor(v,o.name):{}),T,S=!1,D=n.length-1;D>=0;D--){var O={};for(var M in o)O[M]=M==="access"?{}:o[M];for(var M in o.access)O.access[M]=o.access[M];O.addInitializer=function($){if(S)throw new TypeError("Cannot add initializers after decoration has completed");d.push(p($||null))};var U=(0,n[D])(s==="accessor"?{get:E.get,set:E.set}:E[_],O);if(s==="accessor"){if(U===void 0)continue;if(U===null||typeof U!="object")throw new TypeError("Object expected");(T=p(U.get))&&(E.get=T),(T=p(U.set))&&(E.set=T),(T=p(U.init))&&c.push(T)}else(T=p(U))&&(s==="field"?c.push(T):E[_]=T)}v&&Object.defineProperty(v,o.name,E),S=!0}function t6(e,t,n){for(var o=arguments.length>2,c=0;c<t.length;c++)n=o?t[c].call(e,n):t[c].call(e);return o?n:void 0}function n6(e){return typeof e=="symbol"?e:"".concat(e)}function r6(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function i6(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function o6(e,t,n,o){function c(d){return d instanceof n?d:new n(function(p){p(d)})}return new(n||(n=Promise))(function(d,p){function s(E){try{v(o.next(E))}catch(T){p(T)}}function _(E){try{v(o.throw(E))}catch(T){p(T)}}function v(E){E.done?d(E.value):c(E.value).then(s,_)}v((o=o.apply(e,t||[])).next())})}function a6(e,t){var n={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},o,c,d,p;return p={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function s(v){return function(E){return _([v,E])}}function _(v){if(o)throw new TypeError("Generator is already executing.");for(;p&&(p=0,v[0]&&(n=0)),n;)try{if(o=1,c&&(d=v[0]&2?c.return:v[0]?c.throw||((d=c.return)&&d.call(c),0):c.next)&&!(d=d.call(c,v[1])).done)return d;switch(c=0,d&&(v=[v[0]&2,d.value]),v[0]){case 0:case 1:d=v;break;case 4:return n.label++,{value:v[1],done:!1};case 5:n.label++,c=v[1],v=[0];continue;case 7:v=n.ops.pop(),n.trys.pop();continue;default:if(d=n.trys,!(d=d.length>0&&d[d.length-1])&&(v[0]===6||v[0]===2)){n=0;continue}if(v[0]===3&&(!d||v[1]>d[0]&&v[1]<d[3])){n.label=v[1];break}if(v[0]===6&&n.label<d[1]){n.label=d[1],d=v;break}if(d&&n.label<d[2]){n.label=d[2],n.ops.push(v);break}d[2]&&n.ops.pop(),n.trys.pop();continue}v=t.call(e,n)}catch(E){v=[6,E],c=0}finally{o=d=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}var hx=Object.create?function(e,t,n,o){o===void 0&&(o=n);var c=Object.getOwnPropertyDescriptor(t,n);(!c||("get"in c?!t.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,c)}:function(e,t,n,o){o===void 0&&(o=n),e[o]=t[n]};function s6(e,t){for(var n in e)n!=="default"&&!Object.prototype.hasOwnProperty.call(t,n)&&hx(t,e,n)}function m_(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function rC(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),c,d=[],p;try{for(;(t===void 0||t-- >0)&&!(c=o.next()).done;)d.push(c.value)}catch(s){p={error:s}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(p)throw p.error}}return d}function l6(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(rC(arguments[t]));return e}function c6(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var o=Array(e),c=0,t=0;t<n;t++)for(var d=arguments[t],p=0,s=d.length;p<s;p++,c++)o[c]=d[p];return o}function fx(e,t,n){if(n||arguments.length===2)for(var o=0,c=t.length,d;o<c;o++)(d||!(o in t))&&(d||(d=Array.prototype.slice.call(t,0,o)),d[o]=t[o]);return e.concat(d||Array.prototype.slice.call(t))}function ff(e){return this instanceof ff?(this.v=e,this):new ff(e)}function u6(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(e,t||[]),c,d=[];return c={},p("next"),p("throw"),p("return"),c[Symbol.asyncIterator]=function(){return this},c;function p(S){o[S]&&(c[S]=function(D){return new Promise(function(O,M){d.push([S,D,O,M])>1||s(S,D)})})}function s(S,D){try{_(o[S](D))}catch(O){T(d[0][3],O)}}function _(S){S.value instanceof ff?Promise.resolve(S.value.v).then(v,E):T(d[0][2],S)}function v(S){s("next",S)}function E(S){s("throw",S)}function T(S,D){S(D),d.shift(),d.length&&s(d[0][0],d[0][1])}}function d6(e){var t,n;return t={},o("next"),o("throw",function(c){throw c}),o("return"),t[Symbol.iterator]=function(){return this},t;function o(c,d){t[c]=e[c]?function(p){return(n=!n)?{value:ff(e[c](p)),done:!1}:d?d(p):p}:d}}function h6(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof m_=="function"?m_(e):e[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(d){n[d]=e[d]&&function(p){return new Promise(function(s,_){p=e[d](p),c(s,_,p.done,p.value)})}}function c(d,p,s,_){Promise.resolve(_).then(function(v){d({value:v,done:s})},p)}}function f6(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var p6=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function m6(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)n!=="default"&&Object.prototype.hasOwnProperty.call(e,n)&&hx(t,e,n);return p6(t,e),t}function g6(e){return e&&e.__esModule?e:{default:e}}function y6(e,t,n,o){if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?o:n==="a"?o.call(e):o?o.value:t.get(e)}function v6(e,t,n,o,c){if(o==="m")throw new TypeError("Private method is not writable");if(o==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!c:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return o==="a"?c.call(e,n):c?c.value=n:t.set(e,n),n}function _6(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}const x6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Si},__asyncDelegator:d6,__asyncGenerator:u6,__asyncValues:h6,__await:ff,__awaiter:o6,__classPrivateFieldGet:y6,__classPrivateFieldIn:_6,__classPrivateFieldSet:v6,__createBinding:hx,__decorate:J5,__esDecorate:e6,__exportStar:s6,__extends:Y5,__generator:a6,__importDefault:g6,__importStar:m6,__makeTemplateObject:f6,__metadata:i6,__param:Q5,__propKey:n6,__read:rC,__rest:$0,__runInitializers:t6,__setFunctionName:r6,__spread:l6,__spreadArray:fx,__spreadArrays:c6,__values:m_},Symbol.toStringTag,{value:"Module"})),iC=J4(x6);var Cf={},oC={},z0={};Object.defineProperty(z0,"__esModule",{value:!0});z0.Private=void 0;var b6=function(){function e(){this.propMap=new WeakMap}return e.prototype.get=function(t){return this.propMap.get(t)},e.prototype.set=function(t,n){this.propMap.set(t,n)},e}();z0.Private=b6;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Private=void 0;var t=z0;Object.defineProperty(e,"Private",{enumerable:!0,get:function(){return t.Private}})})(oC);Object.defineProperty(Cf,"__esModule",{value:!0});Cf.EventConsumer=void 0;var w6=oC,mc=new w6.Private,E6=function(){function e(t){mc.set(this,t)}return Object.defineProperty(e.prototype,"count",{get:function(){return mc.get(this).count},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxSubs",{get:function(){return mc.get(this).maxSubs},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(t,n){return mc.get(this).subscribe(t,n)},e.prototype.once=function(t,n){return mc.get(this).once(t,n)},e.prototype.toPromise=function(t){return mc.get(this).toPromise(t)},e.prototype.getStat=function(t){return mc.get(this).getStat(t)},e}();Cf.EventConsumer=E6;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SubEvent=e.EmitSchedule=void 0;var t=iC,n=kf,o=Cf,c;(function(s){s.sync="sync",s.async="async",s.next="next"})(c=e.EmitSchedule||(e.EmitSchedule={}));var d=function(){function s(_){if(this._subs=[],typeof(_??{})!="object")throw new TypeError(p.errInvalidOptions);this.options=_??{}}return s.prototype.toConsumer=function(){return new o.EventConsumer(this)},s.prototype.subscribe=function(_,v){if(typeof(v??{})!="object")throw new TypeError(p.errInvalidOptions);_=v&&"thisArg"in v?_.bind(v.thisArg):_;var E=function(){v&&typeof v.onCancel=="function"&&v.onCancel()},T=v&&v.name,S={event:this,cb:_,name:T,cancel:E};if(typeof this.options.onSubscribe=="function"){var D={event:S.event,name:S.name,data:S.data};this.options.onSubscribe(D),S.data=D.data}return this._subs.push(S),new n.Subscription({cancel:this._createCancel(S),sub:S})},s.prototype.once=function(_,v){var E=this.subscribe(function(T){return E.cancel(),_.call(v&&v.thisArg,T)},v);return E},s.prototype.emit=function(_,v){var E=this,T;if(typeof(v??{})!="object")throw new TypeError(p.errInvalidOptions);var S=(T=v&&v.schedule)!==null&&T!==void 0?T:c.sync,D=v&&typeof v.onFinished=="function"&&v.onFinished,O=v&&typeof v.onError=="function"&&v.onError,M=S===c.sync?p.callNow:p.callNext,U=S===c.async?p.callNext:p.callNow;return M(function(){var $=E._getRecipients();$.forEach(function(L,F){return U(function(){if(O)try{var J=L.cb&&L.cb(_);J&&typeof J.catch=="function"&&J.catch(function(V){return O(V,L.name)})}catch(V){O(V,L.name)}else L.cb&&L.cb(_);D&&F===$.length-1&&D($.length)})})}),this},Object.defineProperty(s.prototype,"count",{get:function(){return this._subs.length},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"maxSubs",{get:function(){var _;return(_=this.options.maxSubs)!==null&&_!==void 0?_:0},enumerable:!1,configurable:!0}),s.prototype.getStat=function(_){var v,E={named:{},unnamed:0};this._subs.forEach(function(D){D.name?D.name in E.named?E.named[D.name]++:E.named[D.name]=1:E.unnamed++});var T=(v=_&&_.minUse)!==null&&v!==void 0?v:0;if(T>1)for(var S in E.named)E.named[S]<T&&delete E.named[S];return E},s.prototype.cancelAll=function(){var _=typeof this.options.onCancel=="function"&&this.options.onCancel,v=_?t.__spreadArray([],this._subs):[],E=this._subs.length;return this._subs.forEach(function(T){T.cancel(),T.cb=void 0}),this._subs.length=0,_&&v.forEach(function(T){_({event:T.event,name:T.name,data:T.data})}),E},s.prototype.toPromise=function(_){var v=this;if(typeof(_??{})!="object")throw new TypeError(p.errInvalidOptions);var E=_||{},T=E.name,S=E.timeout,D=S===void 0?-1:S,O,M=!1;return new Promise(function(U,$){var L=function(){M||(O&&clearTimeout(O),$(new Error(T?'Event "'+T+'" cancelled.':"Event cancelled.")))},F=v.subscribe(function(J){O&&clearTimeout(O),M=!0,F.cancel(),U(J)},{name:T,onCancel:L});Number.isInteger(D)&&D>=0&&(O=setTimeout(function(){M=!0,F.cancel(),$(new Error(T?'Event "'+T+'" timed out.':"Event timed out."))},D))})},s.prototype._getRecipients=function(){var _=this.maxSubs>0?this.maxSubs:this._subs.length;return this._subs.slice(0,_)},s.prototype._createCancel=function(_){var v=this;return function(){v._cancelSub(_)}},s.prototype._cancelSub=function(_){if(this._subs.splice(this._subs.indexOf(_),1),_.cancel(),_.cb=void 0,typeof this.options.onCancel=="function"){var v={event:_.event,name:_.name,data:_.data};this.options.onCancel(v)}},s}();e.SubEvent=d;var p=function(){function s(){}return s.errInvalidOptions='Invalid "options" parameter.',s.callNext=typeof process>"u"?setTimeout:process.nextTick,s.callNow=function(_){return _()},s}()})(dx);var B0={};Object.defineProperty(B0,"__esModule",{value:!0});B0.SubEventCount=void 0;var T6=iC,lE=dx,S6=function(e){T6.__extends(t,e);function t(n){var o=e.call(this,n)||this;o.onCount=new lE.SubEvent;var c=n&&n.emitOptions;return o._notify=function(d){return o.onCount.emit(d,c)},o}return t.prototype.cancelAll=function(){var n=this.count;return n&&(e.prototype.cancelAll.call(this),this._notify({newCount:0,prevCount:n})),n},t.prototype._createCancel=function(n){var o=this,c=this._subs;return this._notify({newCount:c.length,prevCount:c.length-1}),function(){o._cancelSub(n),o._notify({newCount:c.length,prevCount:c.length+1})}},t}(lE.SubEvent);B0.SubEventCount=S6;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.EventConsumer=e.SubEventCount=e.EmitSchedule=e.SubEvent=e.Subscription=void 0;var t=kf;Object.defineProperty(e,"Subscription",{enumerable:!0,get:function(){return t.Subscription}});var n=dx;Object.defineProperty(e,"SubEvent",{enumerable:!0,get:function(){return n.SubEvent}}),Object.defineProperty(e,"EmitSchedule",{enumerable:!0,get:function(){return n.EmitSchedule}});var o=B0;Object.defineProperty(e,"SubEventCount",{enumerable:!0,get:function(){return o.SubEventCount}});var c=Cf;Object.defineProperty(e,"EventConsumer",{enumerable:!0,get:function(){return c.EventConsumer}})})($n);class k6{onLogEvent=new $n.SubEvent;onFromRadio=new $n.SubEvent;onMeshPacket=new $n.SubEvent;onMyNodeInfo=new $n.SubEvent;onNodeInfoPacket=new $n.SubEvent;onUserPacket=new $n.SubEvent;onChannelPacket=new $n.SubEvent;onConfigPacket=new $n.SubEvent;onModuleConfigPacket=new $n.SubEvent;onPingPacket=new $n.SubEvent;onIpTunnelPacket=new $n.SubEvent;onSerialPacket=new $n.SubEvent;onStoreForwardPacket=new $n.SubEvent;onRangeTestPacket=new $n.SubEvent;onTelemetryPacket=new $n.SubEvent;onPrivatePacket=new $n.SubEvent;onAtakPacket=new $n.SubEvent;onRoutingPacket=new $n.SubEvent;onPositionPacket=new $n.SubEvent;onMessagePacket=new $n.SubEvent;onRemoteHardwarePacket=new $n.SubEvent;onWaypointPacket=new $n.SubEvent;onDeviceStatus=new $n.SubEvent;onLogRecord=new $n.SubEvent;onMeshHeartbeat=new $n.SubEvent;onDeviceDebugLog=new $n.SubEvent;onDeviceMetadataPacket=new $n.SubEvent;onPendingSettingsChange=new $n.SubEvent}class C6{queue=[];lock=!1;ackNotifier=new $n.SubEvent;errorNotifier=new $n.SubEvent;timeout;constructor(){this.timeout=6e4}clear(){this.queue=[]}push(t){const n={...t,sent:!1,promise:new Promise((o,c)=>{this.ackNotifier.subscribe(d=>{t.id===d&&(this.remove(t.id),o(d))}),this.errorNotifier.subscribe(d=>{t.id===d.id&&(this.remove(t.id),c(d))}),setTimeout(()=>{this.queue.findIndex(d=>d.id===t.id)!==-1&&(this.remove(t.id),console.warn(`Packet ${t.id} timed out`),c({id:t.id,error:U0.TIMEOUT}))},this.timeout)})};this.queue.push(n)}remove(t){if(this.lock){setTimeout(()=>this.remove(t),100);return}this.queue=this.queue.filter(n=>n.id!==t)}processAck(t){this.ackNotifier.emit(t)}processError(t){console.error(`Error received for packet ${t.id}: ${t.error}`),this.errorNotifier.emit(t)}async wait(t){const n=this.queue.find(o=>o.id===t);if(!n)throw new Error("Packet does not exist");return n.promise}async processQueue(t){if(!this.lock){for(this.lock=!0;this.queue.filter(n=>!n.sent).length>0;){const n=this.queue.filter(o=>!o.sent)[0];if(n){await new Promise(o=>setTimeout(o,200));try{await t(n.data),n.sent=!0}catch(o){console.error(`Error sending packet ${n.id}`,o)}}}this.lock=!1}}}let g_=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];typeof Int32Array<"u"&&(g_=new Int32Array(g_));const P6=(e,t)=>{let n=typeof t<"u"?~~t:65535;for(let o=0;o<e.length;o++)n=(g_[(n>>8^e[o])&255]^n<<8)&65535;return n},zy=P6;let A6=class{sendRaw;rxBuffer;txBuffer;textEncoder;counter;constructor(t){this.sendRaw=t,this.rxBuffer=[],this.txBuffer=[],this.textEncoder=new TextEncoder,this.counter=0}async downloadFile(t){return console.log("XModem - getFile"),console.log(t),this.sendCommand(wi.STX,this.textEncoder.encode(t),0)}async uploadFile(t,n){for(let o=0;o<n.length;o+=128)this.txBuffer.push(n.slice(o,o+128));return await this.sendCommand(wi.SOH,this.textEncoder.encode(t),0)}async sendCommand(t,n,o,c){const d=new E_({payloadVariant:{case:"xmodemPacket",value:{buffer:n,control:t,seq:o,crc16:c}}});return this.sendRaw(d.toBinary())}async handlePacket(t){switch(console.log(`${wi[t.control]} - ${t.seq}`),await new Promise(n=>setTimeout(n,100)),t.control){case wi.NUL:break;case wi.SOH:return this.counter=t.seq,this.validateCRC16(t)?(this.rxBuffer[this.counter]=t.buffer,this.sendCommand(wi.ACK)):this.sendCommand(wi.NAK,void 0,t.seq);case wi.STX:break;case wi.EOT:console.log(this.rxBuffer.reduce((n,o)=>new Uint8Array([...n,...o])));break;case wi.ACK:if(this.counter++,this.txBuffer[this.counter-1])return this.sendCommand(wi.SOH,this.txBuffer[this.counter-1],this.counter,zy(this.txBuffer[this.counter-1]??new Uint8Array));if(this.counter===this.txBuffer.length+1)return this.sendCommand(wi.EOT);this.clear();break;case wi.NAK:return this.sendCommand(wi.SOH,this.txBuffer[this.counter],this.counter,zy(this.txBuffer[this.counter-1]??new Uint8Array));case wi.CAN:this.clear();break;case wi.CTRLZ:break}return Promise.resolve(0)}validateCRC16(t){return zy(t.buffer)===t.crc16}clear(){this.counter=0,this.rxBuffer=[],this.txBuffer=[]}};class px{log;deviceStatus;isConfigured;pendingSettingsChanges;myNodeInfo;configId;queue;events;XModem;constructor(t){this.log=new K5({name:"iMeshDevice",prettyLogTemplate:"{{hh}}:{{MM}}:{{ss}}:{{ms}}	{{logLevelName}}	[{{name}}]	"}),this.deviceStatus=or.DEVICE_DISCONNECTED,this.isConfigured=!1,this.pendingSettingsChanges=!1,this.myNodeInfo=new bx,this.configId=t??this.generateRandId(),this.queue=new C6,this.events=new k6,this.XModem=new A6(this.sendRaw.bind(this)),this.events.onDeviceStatus.subscribe(n=>{this.deviceStatus=n,n===or.DEVICE_CONFIGURED?this.isConfigured=!0:n===or.DEVICE_CONFIGURING&&(this.isConfigured=!1)}),this.events.onMyNodeInfo.subscribe(n=>{this.myNodeInfo=n}),this.events.onPendingSettingsChange.subscribe(n=>{this.pendingSettingsChanges=n})}async sendText(t,n,o,c){this.log.debug(mt[mt.sendText],` Sending message to ${n??"broadcast"} on channel ${c?.toString()??0}`);const d=new TextEncoder;return this.sendPacket(d.encode(t),gn.TEXT_MESSAGE_APP,n??"broadcast",c,o,!1,!0)}sendWaypoint(t,n,o){return this.log.debug(mt[mt.sendWaypoint],` Sending waypoint to ${n} on channel ${o?.toString()??0}`),t.id=this.generateRandId(),this.sendPacket(t.toBinary(),gn.WAYPOINT_APP,n,o,!0,!1)}async sendPacket(t,n,o,c=ks.PRIMARY,d=!0,p=!0,s=!1,_,v){this.log.trace(mt[mt.sendPacket],` Sending ${gn[n]} to ${o}`);const E=new xx({payloadVariant:{case:"decoded",value:{payload:t,portnum:n,wantResponse:p,emoji:v,replyId:_,dest:0,requestId:0,source:0}},from:this.myNodeInfo.myNodeNum,to:o==="broadcast"?oE:o==="self"?this.myNodeInfo.myNodeNum:o,id:this.generateRandId(),wantAck:d,channel:c}),T=new E_({payloadVariant:{case:"packet",value:E}});return s&&(E.rxTime=Math.trunc(new Date().getTime()/1e3),this.handleMeshPacket(E)),this.sendRaw(T.toBinary(),E.id)}async sendRaw(t,n=this.generateRandId()){if(t.length>512)throw new Error("Message longer than 512 bytes, it will not be sent!");return this.queue.push({id:n,data:t}),await this.queue.processQueue(async o=>{await this.writeToRadio(o)}),this.queue.wait(n)}async setConfig(t){this.log.debug(mt[mt.setConfig],`Setting config, Variant: ${t.payloadVariant.case??"Unknown"}`),this.pendingSettingsChanges||await this.beginEditSettings();const n=new di({payloadVariant:{case:"setConfig",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async setModuleConfig(t){this.log.debug(mt[mt.setModuleConfig],"Setting module config");const n=new di({payloadVariant:{case:"setModuleConfig",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async setOwner(t){this.log.debug(mt[mt.setOwner],"Setting owner");const n=new di({payloadVariant:{case:"setOwner",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async setChannel(t){this.log.debug(mt[mt.setChannel],` Setting Channel: ${t.index}`);const n=new di({payloadVariant:{case:"setChannel",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async setPosition(t){return this.sendPacket(t.toBinary(),gn.POSITION_APP,"self")}async getChannel(t){this.log.debug(mt[mt.getChannel],` Requesting Channel: ${t}`);const n=new di({payloadVariant:{case:"getChannelRequest",value:t+1}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async getConfig(t){this.log.debug(mt[mt.getConfig],"Requesting config");const n=new di({payloadVariant:{case:"getConfigRequest",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async getModuleConfig(t){this.log.debug(mt[mt.getModuleConfig],"Requesting module config");const n=new di({payloadVariant:{case:"getModuleConfigRequest",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async getOwner(){this.log.debug(mt[mt.getOwner],"Requesting owner");const t=new di({payloadVariant:{case:"getOwnerRequest",value:!0}});return this.sendPacket(t.toBinary(),gn.ADMIN_APP,"self")}async getMetadata(t){this.log.debug(mt[mt.getMetadata],`Requesting metadata from ${t}`);const n=new di({payloadVariant:{case:"getDeviceMetadataRequest",value:!0}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,t,ks.ADMIN)}async clearChannel(t){this.log.debug(mt[mt.clearChannel],` Clearing Channel ${t}`);const n=new fd({index:t,role:Nc.DISABLED}),o=new di({payloadVariant:{case:"setChannel",value:n}});return this.sendPacket(o.toBinary(),gn.ADMIN_APP,"self")}async beginEditSettings(){this.events.onPendingSettingsChange.emit(!0);const t=new di({payloadVariant:{case:"beginEditSettings",value:!0}});return this.sendPacket(t.toBinary(),gn.ADMIN_APP,"self")}async commitEditSettings(){this.events.onPendingSettingsChange.emit(!1);const t=new di({payloadVariant:{case:"commitEditSettings",value:!0}});return this.sendPacket(t.toBinary(),gn.ADMIN_APP,"self")}async resetPeers(){this.log.debug(mt[mt.resetPeers]," Resetting Peers");const t=new di({payloadVariant:{case:"nodedbReset",value:1}});return this.sendPacket(t.toBinary(),gn.ADMIN_APP,"self")}async shutdown(t){this.log.debug(mt[mt.shutdown],` Shutting down ${t>2?"now":`in ${t} seconds`}`);const n=new di({payloadVariant:{case:"shutdownSeconds",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async reboot(t){this.log.debug(mt[mt.reboot],` Rebooting node ${t>0?"now":`in ${t} seconds`}`);const n=new di({payloadVariant:{case:"rebootSeconds",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async rebootOTA(t){this.log.debug(mt[mt.rebootOTA],` Rebooting into OTA mode ${t>0?"now":`in ${t} seconds`}`);const n=new di({payloadVariant:{case:"rebootOtaSeconds",value:t}});return this.sendPacket(n.toBinary(),gn.ADMIN_APP,"self")}async factoryReset(){this.log.debug(mt[mt.factoryReset]," Factory resetting node");const t=new di({payloadVariant:{case:"factoryReset",value:1}});return this.sendPacket(t.toBinary(),gn.ADMIN_APP,"self")}configure(){this.log.debug(mt[mt.configure]," Requesting device configuration"),this.updateDeviceStatus(or.DEVICE_CONFIGURING);const t=new E_({payloadVariant:{case:"wantConfigId",value:this.configId}});return this.sendRaw(t.toBinary())}async traceRoute(t){const n=new w_({route:[]});return this.sendPacket(n.toBinary(),gn.ROUTING_APP,t)}async requestPosition(t){return this.sendPacket(new Uint8Array,gn.POSITION_APP,t)}updateDeviceStatus(t){t!==this.deviceStatus&&this.events.onDeviceStatus.emit(t)}generateRandId(){const t=crypto.getRandomValues(new Uint32Array(1));if(!t[0])throw new Error("Cannot generate CSPRN");return Math.floor(t[0]*Math.pow(2,-32)*1e9)}handleFromRadio(t){const n=ID.fromBinary(t);switch(this.events.onFromRadio.emit(n),n.payloadVariant.case){case"packet":this.handleMeshPacket(n.payloadVariant.value);break;case"myInfo":parseFloat(n.payloadVariant.value.firmwareVersion)<aE&&this.log.fatal(mt[mt.handleFromRadio],`Device firmware outdated. Min supported: ${aE} got : ${n.payloadVariant.value.firmwareVersion}`),this.events.onMyNodeInfo.emit(n.payloadVariant.value),this.log.info(mt[mt.handleFromRadio]," Received Node info for this device");break;case"nodeInfo":this.log.info(mt[mt.handleFromRadio],` Received Node Info packet for node: ${n.payloadVariant.value.num}`),this.events.onNodeInfoPacket.emit(n.payloadVariant.value),n.payloadVariant.value.position&&this.events.onPositionPacket.emit({id:n.id,rxTime:new Date,from:n.payloadVariant.value.num,to:n.payloadVariant.value.num,type:"direct",channel:ks.PRIMARY,data:n.payloadVariant.value.position}),n.payloadVariant.value.user&&this.events.onUserPacket.emit({id:n.id,rxTime:new Date,from:n.payloadVariant.value.num,to:n.payloadVariant.value.num,type:"direct",channel:ks.PRIMARY,data:n.payloadVariant.value.user});break;case"config":n.payloadVariant.value.payloadVariant.case?this.log.trace(mt[mt.handleFromRadio],` Received Config packet of variant: ${n.payloadVariant.value.payloadVariant.case}`):this.log.warn(mt[mt.handleFromRadio]," Received Config packet of variant: UNK"),this.events.onConfigPacket.emit(n.payloadVariant.value);break;case"logRecord":this.log.trace(mt[mt.handleFromRadio],"Received onLogRecord"),this.events.onLogRecord.emit(n.payloadVariant.value);break;case"configCompleteId":n.payloadVariant.value!==this.configId&&this.log.error(mt[mt.handleFromRadio],` Invalid config id reveived from device, exptected ${this.configId} but received ${n.payloadVariant.value}`),this.log.info(mt[mt.handleFromRadio],` Valid config id reveived from device: ${this.configId}`),this.updateDeviceStatus(or.DEVICE_CONFIGURED);break;case"rebooted":this.configure().catch(()=>{});break;case"moduleConfig":n.payloadVariant.value.payloadVariant.case?this.log.trace(mt[mt.handleFromRadio],` Received Module Config packet of variant: ${n.payloadVariant.value.payloadVariant.case}`):this.log.warn(mt[mt.handleFromRadio]," Received Module Config packet of variant: UNK"),this.events.onModuleConfigPacket.emit(n.payloadVariant.value);break;case"channel":this.log.trace(mt[mt.handleFromRadio],` Received Channel: ${n.payloadVariant.value.index}`),this.events.onChannelPacket.emit(n.payloadVariant.value);break;case"queueStatus":break;case"xmodemPacket":this.XModem.handlePacket(n.payloadVariant.value);break}}complete(){this.events.onLogEvent.cancelAll(),this.events.onFromRadio.cancelAll(),this.events.onMeshPacket.cancelAll(),this.events.onMyNodeInfo.cancelAll(),this.events.onNodeInfoPacket.cancelAll(),this.events.onUserPacket.cancelAll(),this.events.onChannelPacket.cancelAll(),this.events.onConfigPacket.cancelAll(),this.events.onModuleConfigPacket.cancelAll(),this.events.onPingPacket.cancelAll(),this.events.onIpTunnelPacket.cancelAll(),this.events.onSerialPacket.cancelAll(),this.events.onStoreForwardPacket.cancelAll(),this.events.onRangeTestPacket.cancelAll(),this.events.onTelemetryPacket.cancelAll(),this.events.onPrivatePacket.cancelAll(),this.events.onAtakPacket.cancelAll(),this.events.onRoutingPacket.cancelAll(),this.events.onPositionPacket.cancelAll(),this.events.onMessagePacket.cancelAll(),this.events.onRemoteHardwarePacket.cancelAll(),this.events.onWaypointPacket.cancelAll(),this.events.onDeviceStatus.cancelAll(),this.events.onLogRecord.cancelAll(),this.events.onMeshHeartbeat.cancelAll(),this.events.onDeviceDebugLog.cancelAll(),this.events.onDeviceMetadataPacket.cancelAll(),this.events.onPendingSettingsChange.cancelAll(),this.queue.clear()}handleMeshPacket(t){switch(this.events.onMeshPacket.emit(t),t.from!==this.myNodeInfo.myNodeNum&&this.events.onMeshHeartbeat.emit(new Date),t.payloadVariant.case){case"decoded":this.handleDecodedPacket(t.payloadVariant.value,t);break;case"encrypted":this.log.debug(mt[mt.handleMeshPacket],"Device received encrypted data packet, ignoring.");break}}handleDecodedPacket(t,n){let o,c;const d={id:n.id,rxTime:new Date(n.rxTime*1e3),type:n.to===oE?"broadcast":"direct",from:n.from,to:n.to,channel:n.channel};switch(this.log.trace(mt[mt.handleMeshPacket],` Received ${gn[t.portnum]} packet`),t.portnum){case gn.TEXT_MESSAGE_APP:this.events.onMessagePacket.emit({...d,data:new TextDecoder().decode(t.payload)});break;case gn.REMOTE_HARDWARE_APP:this.events.onRemoteHardwarePacket.emit({...d,data:UD.fromBinary(t.payload)});break;case gn.POSITION_APP:this.events.onPositionPacket.emit({...d,data:HC.fromBinary(t.payload)});break;case gn.NODEINFO_APP:this.events.onUserPacket.emit({...d,data:pf.fromBinary(t.payload)});break;case gn.ROUTING_APP:switch(c=ED.fromBinary(t.payload),this.events.onRoutingPacket.emit({...d,data:c}),c.variant.case){case"errorReason":c.variant.value===U0.NONE?this.queue.processAck(t.requestId):this.queue.processError({id:t.requestId,error:c.variant.value});break;case"routeReply":console.log("routeReply"),console.log(c.variant.value);break;case"routeRequest":console.log("routeRequest"),console.log(c.variant.value);break}break;case gn.ADMIN_APP:switch(o=di.fromBinary(t.payload),o.payloadVariant.case){case"getChannelResponse":this.events.onChannelPacket.emit(o.payloadVariant.value);break;case"getOwnerResponse":this.events.onUserPacket.emit({...d,data:o.payloadVariant.value});break;case"getConfigResponse":this.events.onConfigPacket.emit(o.payloadVariant.value);break;case"getModuleConfigResponse":this.events.onModuleConfigPacket.emit(o.payloadVariant.value);break;case"getDeviceMetadataResponse":this.events.onDeviceMetadataPacket.emit({...d,data:o.payloadVariant.value});break;default:this.log.warn(mt[mt.handleMeshPacket],` Received unhandled AdminMessage, type ${o.payloadVariant.case??"undefined"}`,t.payload)}break;case gn.TEXT_MESSAGE_COMPRESSED_APP:break;case gn.WAYPOINT_APP:this.events.onWaypointPacket.emit({...d,data:SD.fromBinary(t.payload)});break;case gn.REPLY_APP:this.events.onPingPacket.emit({...d,data:t.payload});break;case gn.IP_TUNNEL_APP:this.events.onIpTunnelPacket.emit({...d,data:t.payload});break;case gn.SERIAL_APP:this.events.onSerialPacket.emit({...d,data:t.payload});break;case gn.STORE_FORWARD_APP:this.events.onStoreForwardPacket.emit({...d,data:t.payload});break;case gn.RANGE_TEST_APP:this.events.onRangeTestPacket.emit({...d,data:t.payload});break;case gn.TELEMETRY_APP:this.events.onTelemetryPacket.emit({...d,data:vD.fromBinary(t.payload)});break;case gn.PRIVATE_APP:this.events.onPrivatePacket.emit({...d,data:t.payload});break;case gn.ATAK_FORWARDER:this.events.onAtakPacket.emit({...d,data:t.payload});break}}}const aC=e=>e.buffer.slice(e.byteOffset,e.byteLength+e.byteOffset);class I6 extends px{connType;device;GATTServer;service;toRadioCharacteristic;fromRadioCharacteristic;fromNumCharacteristic;userInitiatedDisconnect;constructor(t){super(t),this.log=this.log.getSubLogger({name:"iHttpConnection"}),this.connType="ble",this.device=void 0,this.service=void 0,this.GATTServer=void 0,this.toRadioCharacteristic=void 0,this.fromRadioCharacteristic=void 0,this.fromNumCharacteristic=void 0,this.userInitiatedDisconnect=!1,this.log.debug(mt[mt.constructor]," iBleConnection instantiated")}supported(){return navigator.bluetooth.getAvailability()}getDevices(){return navigator.bluetooth.getDevices()}getDevice(t){return navigator.bluetooth.requestDevice(t??{filters:[{services:[c_]}]})}async connect({device:t,deviceFilter:n}){this.updateDeviceStatus(or.DEVICE_CONNECTING),this.device=t??await this.getDevice(n),this.device.addEventListener("gattserverdisconnected",()=>{this.log.info(mt[mt.connect],"Device disconnected"),this.updateDeviceStatus(or.DEVICE_DISCONNECTED),this.complete()}),await this.device.gatt?.connect().then(o=>{this.log.info(mt[mt.connect],` Got GATT Server for device: ${o.device.id}`),this.GATTServer=o}).catch(o=>{this.log.error(mt[mt.connect],` Failed to connect: ${o.message}`)}),await this.GATTServer?.getPrimaryService(c_).then(o=>{this.log.info(mt[mt.connect],` Got GATT Service for device: ${o.device.id}`),this.service=o}).catch(o=>{this.log.error(mt[mt.connect],` Failed to get primary service: q${o.message}`)}),[nE,rE,iE].map(async o=>{await this.service?.getCharacteristic(o).then(c=>{switch(this.log.info(mt[mt.connect],` Got Characteristic ${c.uuid} for device: ${c.uuid}`),o){case nE:this.toRadioCharacteristic=c;break;case rE:this.fromRadioCharacteristic=c;break;case iE:this.fromNumCharacteristic=c;break}}).catch(c=>{this.log.error(mt[mt.connect],` Failed to get toRadio characteristic: q${c.message}`)})}),await this.fromNumCharacteristic?.startNotifications(),this.fromNumCharacteristic?.addEventListener("characteristicvaluechanged",()=>{this.readFromRadio()}),this.updateDeviceStatus(or.DEVICE_CONNECTED),this.configure().catch(()=>{})}disconnect(){this.userInitiatedDisconnect=!0,this.device?.gatt?.disconnect(),this.updateDeviceStatus(or.DEVICE_DISCONNECTED),this.complete()}async ping(){return Promise.resolve(!0)}async readFromRadio(){let t=new ArrayBuffer(1);for(;t.byteLength>0&&this.fromRadioCharacteristic;)await this.fromRadioCharacteristic.readValue().then(n=>{t=n.buffer,n.byteLength>0&&this.handleFromRadio(new Uint8Array(t)),this.updateDeviceStatus(or.DEVICE_CONNECTED)}).catch(n=>{t=new ArrayBuffer(0),this.log.error(mt[mt.readFromRadio],` ${n.message}`)})}async writeToRadio(t){await this.toRadioCharacteristic?.writeValue(aC(t)),await this.readFromRadio()}}class M6 extends px{connType;url;receiveBatchRequests;readLoop;peningRequest;abortController;constructor(t){super(t),this.log=this.log.getSubLogger({name:"iHttpConnection"}),this.connType="http",this.url="http://meshtastic.local",this.receiveBatchRequests=!1,this.readLoop=null,this.peningRequest=!1,this.abortController=new AbortController,this.log.debug(mt[mt.constructor]," iHttpConnection instantiated")}async connect({address:t,fetchInterval:n=3e3,receiveBatchRequests:o=!1,tls:c=!1}){this.updateDeviceStatus(or.DEVICE_CONNECTING),this.receiveBatchRequests=o,this.url=`${c?"https://":"http://"}${t}`,this.deviceStatus===or.DEVICE_CONNECTING&&await this.ping()?(this.log.debug(mt[mt.connect],"Ping succeeded, starting configuration and request timer."),this.configure().catch(()=>{}),this.readLoop=setInterval(()=>{this.readFromRadio().catch(d=>{this.log.error(mt[mt.connect],` ${d.message}`)})},n)):this.deviceStatus!==or.DEVICE_DISCONNECTED&&setTimeout(()=>{this.connect({address:t,fetchInterval:n,receiveBatchRequests:o,tls:c})},1e4)}disconnect(){this.abortController.abort(),this.updateDeviceStatus(or.DEVICE_DISCONNECTED),this.readLoop&&(clearInterval(this.readLoop),this.complete())}async ping(){this.log.debug(mt[mt.ping],"Attempting device ping.");const{signal:t}=this.abortController;let n=!1;return await fetch(`${this.url}/hotspot-detect.html`,{signal:t,mode:"no-cors"}).then(()=>{n=!0,this.updateDeviceStatus(or.DEVICE_CONNECTED)}).catch(o=>{n=!1,this.log.error(mt[mt.ping],` ${o.message}`),this.updateDeviceStatus(or.DEVICE_RECONNECTING)}),n}async readFromRadio(){if(this.peningRequest)return;let t=new ArrayBuffer(1);const{signal:n}=this.abortController;for(;t.byteLength>0;)this.peningRequest=!0,await fetch(`${this.url}/api/v1/fromradio?all=${this.receiveBatchRequests?"true":"false"}`,{signal:n,method:"GET",headers:{Accept:"application/x-protobuf"}}).then(async o=>{this.peningRequest=!1,this.updateDeviceStatus(or.DEVICE_CONNECTED),t=await o.arrayBuffer(),t.byteLength>0&&this.handleFromRadio(new Uint8Array(t))}).catch(o=>{this.peningRequest=!1,this.log.error(mt[mt.readFromRadio],` ${o.message}`),this.updateDeviceStatus(or.DEVICE_RECONNECTING)})}async writeToRadio(t){const{signal:n}=this.abortController;await fetch(`${this.url}/api/v1/toradio`,{signal:n,method:"PUT",headers:{"Content-Type":"application/x-protobuf"},body:aC(t)}).then(async()=>{this.updateDeviceStatus(or.DEVICE_CONNECTED),await this.readFromRadio().catch(o=>{this.log.error(mt[mt.writeToRadio],` ${o.message}`)})}).catch(o=>{this.log.error(mt[mt.writeToRadio],` ${o.message}`),this.updateDeviceStatus(or.DEVICE_RECONNECTING)})}}const D6=(e,t,n,o)=>{let c=new Uint8Array([]);return new TransformStream({transform(d,p){e=e.getSubLogger({name:"streamTransformer"}),t.subscribe(()=>{p.terminate()}),c=new Uint8Array([...c,...d]);let s=!1;for(;c.length!==0&&!s;){const _=c.findIndex(E=>E===148);if(c[_+1]===195){c.subarray(0,_).length&&(o?n.emit(c.subarray(0,_)):e.warn(i0.iSerialConnection,mt.connect,` Found unneccesary message padding, removing: ${c.subarray(0,_).toString()}`),c=c.subarray(_));const E=c[2],T=c[3];if(E!==void 0&&T!==void 0&&c.length>=4+(E<<8)+T){const S=c.subarray(4,4+(E<<8)+T),D=S.findIndex(O=>O===148);D!==-1&&S[D+1]==195?(e.warn(i0.iSerialConnection,mt.connect,` Malformed packet found, discarding: ${c.subarray(0,D-1).toString()}`,ZC.WARNING),c=c.subarray(D)):(c=c.subarray(3+(E<<8)+T+1),p.enqueue(S))}else s=!0}else s=!0}}})};class R6 extends px{connType;port;transformer;preventLock;onReleaseEvent;constructor(t){super(t),this.log=this.log.getSubLogger({name:"iSerialConnection"}),this.connType="serial",this.port=void 0,this.transformer=void 0,this.onReleaseEvent=new $n.SubEvent,this.preventLock=!1,this.log.debug(mt[mt.constructor]," iSerialConnection instantiated")}async readFromRadio(t){for(this.onReleaseEvent.subscribe(async()=>{this.preventLock=!0,await t.cancel(),t.releaseLock(),await this.port?.close()});this.port?.readable&&!this.preventLock;)await t.read().then(({value:n})=>{n&&this.handleFromRadio(n)}).catch(()=>{this.log.debug(mt[mt.readFromRadio],"Releasing reader")})}async getPorts(){return navigator.serial.getPorts()}async getPort(t){return navigator.serial.requestPort(t)}async connect({port:t,baudRate:n=115200,concurrentLogOutput:o=!1}){this.updateDeviceStatus(or.DEVICE_CONNECTING),this.port=t??await this.getPort(),this.port.addEventListener("disconnect",()=>{this.log.info(mt[mt.connect],"Device disconnected"),this.updateDeviceStatus(or.DEVICE_DISCONNECTED),this.complete()}),await this.port.open({baudRate:n}).then(()=>{if(this.port?.readable&&this.port.writable){this.transformer=D6(this.log,this.onReleaseEvent,this.events.onDeviceDebugLog,o);const c=this.port.readable.pipeThrough(this.transformer);this.readFromRadio(c.getReader()),this.updateDeviceStatus(or.DEVICE_CONNECTED),this.configure().catch(()=>{})}else console.log("not readable or writable")}).catch(c=>{this.log.error(mt[mt.connect],` ${c.message}`)})}async reconnect(){await this.connect({port:this.port,concurrentLogOutput:!1})}async disconnect(){return this.onReleaseEvent.emit(!0),this.updateDeviceStatus(or.DEVICE_DISCONNECTED),this.complete(),await this.port?.close()}async ping(){return Promise.resolve(!0)}async writeToRadio(t){for(;this.port?.writable?.locked;)await new Promise(o=>setTimeout(o,100));const n=this.port?.writable?.getWriter();await n?.write(new Uint8Array([148,195,0,t.length,...t])),n?.releaseLock()}}function uo(e,t){if(!e)throw new Error(t)}const L6=34028234663852886e22,N6=-34028234663852886e22,O6=4294967295,$6=2147483647,z6=-2147483648;function bm(e){if(typeof e!="number")throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>$6||e<z6)throw new Error("invalid int 32: "+e)}function y_(e){if(typeof e!="number")throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>O6||e<0)throw new Error("invalid uint 32: "+e)}function sC(e){if(typeof e!="number")throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>L6||e<N6))throw new Error("invalid float 32: "+e)}const lC=Symbol("@bufbuild/protobuf/enum-type");function B6(e){const t=e[lC];return uo(t,"missing enum type on enum object"),t}function cC(e,t,n,o){e[lC]=uC(t,n.map(c=>({no:c.no,name:c.name,localName:e[c.no]})))}function uC(e,t,n){const o=Object.create(null),c=Object.create(null),d=[];for(const p of t){const s=dC(p);d.push(s),o[p.name]=s,c[p.no]=s}return{typeName:e,values:d,findName(p){return o[p]},findNumber(p){return c[p]}}}function F6(e,t,n){const o={};for(const c of t){const d=dC(c);o[d.localName]=d.no,o[d.no]=d.localName}return cC(o,e,t),o}function dC(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}let Pf=class{equals(t){return this.getType().runtime.util.equals(this.getType(),this,t)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(t,n){const o=this.getType(),c=o.runtime.bin,d=c.makeReadOptions(n);return c.readMessage(this,d.readerFactory(t),t.byteLength,d),this}fromJson(t,n){const o=this.getType(),c=o.runtime.json,d=c.makeReadOptions(n);return c.readMessage(o,t,d,this),this}fromJsonString(t,n){let o;try{o=JSON.parse(t)}catch(c){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${c instanceof Error?c.message:String(c)}`)}return this.fromJson(o,n)}toBinary(t){const n=this.getType(),o=n.runtime.bin,c=o.makeWriteOptions(t),d=c.writerFactory();return o.writeMessage(this,d,c),d.finish()}toJson(t){const n=this.getType(),o=n.runtime.json,c=o.makeWriteOptions(t);return o.writeMessage(this,c)}toJsonString(t){var n;const o=this.toJson(t);return JSON.stringify(o,null,(n=t?.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function U6(e,t,n,o){var c;const d=(c=o?.localName)!==null&&c!==void 0?c:t.substring(t.lastIndexOf(".")+1),p={[d]:function(s){e.util.initFields(this),e.util.initPartial(s,this)}}[d];return Object.setPrototypeOf(p.prototype,new Pf),Object.assign(p,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary(s,_){return new p().fromBinary(s,_)},fromJson(s,_){return new p().fromJson(s,_)},fromJsonString(s,_){return new p().fromJsonString(s,_)},equals(s,_){return e.util.equals(p,s,_)}}),p}function V6(e,t,n,o){return{syntax:e,json:t,bin:n,util:o,makeMessageType(c,d,p){return U6(this,c,d,p)},makeEnum:F6,makeEnumType:uC,getEnumType:B6}}var Et;(function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"})(Et||(Et={}));function j6(){let e=0,t=0;for(let o=0;o<28;o+=7){let c=this.buf[this.pos++];if(e|=(c&127)<<o,!(c&128))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(n&15)<<28,t=(n&112)>>4,!(n&128))return this.assertBounds(),[e,t];for(let o=3;o<=31;o+=7){let c=this.buf[this.pos++];if(t|=(c&127)<<o,!(c&128))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function By(e,t,n){for(let d=0;d<28;d=d+7){const p=e>>>d,s=!(!(p>>>7)&&t==0),_=(s?p|128:p)&255;if(n.push(_),!s)return}const o=e>>>28&15|(t&7)<<4,c=!!(t>>3);if(n.push((c?o|128:o)&255),!!c){for(let d=3;d<31;d=d+7){const p=t>>>d,s=!!(p>>>7),_=(s?p|128:p)&255;if(n.push(_),!s)return}n.push(t>>>31&1)}}const wm=4294967296;function cE(e){const t=e[0]==="-";t&&(e=e.slice(1));const n=1e6;let o=0,c=0;function d(p,s){const _=Number(e.slice(p,s));c*=n,o=o*n+_,o>=wm&&(c=c+(o/wm|0),o=o%wm)}return d(-24,-18),d(-18,-12),d(-12,-6),d(-6),t?fC(o,c):mx(o,c)}function G6(e,t){let n=mx(e,t);const o=n.hi&2147483648;o&&(n=fC(n.lo,n.hi));const c=hC(n.lo,n.hi);return o?"-"+c:c}function hC(e,t){if({lo:e,hi:t}=q6(e,t),t<=2097151)return String(wm*t+e);const n=e&16777215,o=(e>>>24|t<<8)&16777215,c=t>>16&65535;let d=n+o*6777216+c*6710656,p=o+c*8147497,s=c*2;const _=1e7;return d>=_&&(p+=Math.floor(d/_),d%=_),p>=_&&(s+=Math.floor(p/_),p%=_),s.toString()+uE(p)+uE(d)}function q6(e,t){return{lo:e>>>0,hi:t>>>0}}function mx(e,t){return{lo:e|0,hi:t|0}}function fC(e,t){return t=~t,e?e=~e+1:t+=1,mx(e,t)}const uE=e=>{const t=String(e);return"0000000".slice(t.length)+t};function dE(e,t){if(e>=0){for(;e>127;)t.push(e&127|128),e=e>>>7;t.push(e)}else{for(let n=0;n<9;n++)t.push(e&127|128),e=e>>7;t.push(1)}}function W6(){let e=this.buf[this.pos++],t=e&127;if(!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<7,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<14,!(e&128))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(e&127)<<21,!(e&128))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(e&15)<<28;for(let n=5;e&128&&n<10;n++)e=this.buf[this.pos++];if(e&128)throw new Error("invalid varint");return this.assertBounds(),t>>>0}function H6(){const e=new DataView(new ArrayBuffer(8));if(globalThis.BigInt!==void 0&&typeof e.getBigInt64=="function"&&typeof e.getBigUint64=="function"&&typeof e.setBigInt64=="function"&&typeof e.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const c=BigInt("-9223372036854775808"),d=BigInt("9223372036854775807"),p=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(_){const v=typeof _=="bigint"?_:BigInt(_);if(v>d||v<c)throw new Error(`int64 invalid: ${_}`);return v},uParse(_){const v=typeof _=="bigint"?_:BigInt(_);if(v>s||v<p)throw new Error(`uint64 invalid: ${_}`);return v},enc(_){return e.setBigInt64(0,this.parse(_),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(_){return e.setBigInt64(0,this.uParse(_),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec(_,v){return e.setInt32(0,_,!0),e.setInt32(4,v,!0),e.getBigInt64(0,!0)},uDec(_,v){return e.setInt32(0,_,!0),e.setInt32(4,v,!0),e.getBigUint64(0,!0)}}}const n=c=>uo(/^-?[0-9]+$/.test(c),`int64 invalid: ${c}`),o=c=>uo(/^[0-9]+$/.test(c),`uint64 invalid: ${c}`);return{zero:"0",supported:!1,parse(c){return typeof c!="string"&&(c=c.toString()),n(c),c},uParse(c){return typeof c!="string"&&(c=c.toString()),o(c),c},enc(c){return typeof c!="string"&&(c=c.toString()),n(c),cE(c)},uEnc(c){return typeof c!="string"&&(c=c.toString()),o(c),cE(c)},dec(c,d){return G6(c,d)},uDec(c,d){return hC(c,d)}}}const Qi=H6();var Br;(function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"})(Br||(Br={}));class Z6{constructor(t){this.stack=[],this.textEncoder=t??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let t=0;for(let c=0;c<this.chunks.length;c++)t+=this.chunks[c].length;let n=new Uint8Array(t),o=0;for(let c=0;c<this.chunks.length;c++)n.set(this.chunks[c],o),o+=this.chunks[c].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let t=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(t.byteLength),this.raw(t)}tag(t,n){return this.uint32((t<<3|n)>>>0)}raw(t){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(t),this}uint32(t){for(y_(t);t>127;)this.buf.push(t&127|128),t=t>>>7;return this.buf.push(t),this}int32(t){return bm(t),dE(t,this.buf),this}bool(t){return this.buf.push(t?1:0),this}bytes(t){return this.uint32(t.byteLength),this.raw(t)}string(t){let n=this.textEncoder.encode(t);return this.uint32(n.byteLength),this.raw(n)}float(t){sC(t);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,t,!0),this.raw(n)}double(t){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,t,!0),this.raw(n)}fixed32(t){y_(t);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t,!0),this.raw(n)}sfixed32(t){bm(t);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,t,!0),this.raw(n)}sint32(t){return bm(t),t=(t<<1^t>>31)>>>0,dE(t,this.buf),this}sfixed64(t){let n=new Uint8Array(8),o=new DataView(n.buffer),c=Qi.enc(t);return o.setInt32(0,c.lo,!0),o.setInt32(4,c.hi,!0),this.raw(n)}fixed64(t){let n=new Uint8Array(8),o=new DataView(n.buffer),c=Qi.uEnc(t);return o.setInt32(0,c.lo,!0),o.setInt32(4,c.hi,!0),this.raw(n)}int64(t){let n=Qi.enc(t);return By(n.lo,n.hi,this.buf),this}sint64(t){let n=Qi.enc(t),o=n.hi>>31,c=n.lo<<1^o,d=(n.hi<<1|n.lo>>>31)^o;return By(c,d,this.buf),this}uint64(t){let n=Qi.uEnc(t);return By(n.lo,n.hi,this.buf),this}}class K6{constructor(t,n){this.varint64=j6,this.uint32=W6,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=n??new TextDecoder}tag(){let t=this.uint32(),n=t>>>3,o=t&7;if(n<=0||o<0||o>5)throw new Error("illegal tag: field no "+n+" wire type "+o);return[n,o]}skip(t){let n=this.pos;switch(t){case Br.Varint:for(;this.buf[this.pos++]&128;);break;case Br.Bit64:this.pos+=4;case Br.Bit32:this.pos+=4;break;case Br.LengthDelimited:let o=this.uint32();this.pos+=o;break;case Br.StartGroup:let c;for(;(c=this.tag()[1])!==Br.EndGroup;)this.skip(c);break;default:throw new Error("cant skip wire type "+t)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)}int64(){return Qi.dec(...this.varint64())}uint64(){return Qi.uDec(...this.varint64())}sint64(){let[t,n]=this.varint64(),o=-(t&1);return t=(t>>>1|(n&1)<<31)^o,n=n>>>1^o,Qi.dec(t,n)}bool(){let[t,n]=this.varint64();return t!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Qi.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Qi.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let t=this.uint32(),n=this.pos;return this.pos+=t,this.assertBounds(),this.buf.subarray(n,n+t)}string(){return this.textDecoder.decode(this.bytes())}}function v_(e,t){return t instanceof Pf||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Et.DOUBLE,Et.FLOAT,Et.INT64,Et.UINT64,Et.INT32,Et.UINT32,Et.BOOL,Et.STRING,Et.BYTES;function ul(e,t,n){if(t===n)return!0;if(e==Et.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array)||t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==n[o])return!1;return!0}switch(e){case Et.UINT64:case Et.FIXED64:case Et.INT64:case Et.SFIXED64:case Et.SINT64:return t==n}return!1}function __(e){switch(e){case Et.BOOL:return!1;case Et.UINT64:case Et.FIXED64:case Et.INT64:case Et.SFIXED64:case Et.SINT64:return Qi.zero;case Et.DOUBLE:case Et.FLOAT:return 0;case Et.BYTES:return new Uint8Array(0);case Et.STRING:return"";default:return 0}}function gx(e,t){const n=t===void 0;let o=Br.Varint,c=t===0;switch(e){case Et.STRING:c=n||!t.length,o=Br.LengthDelimited;break;case Et.BOOL:c=t===!1;break;case Et.DOUBLE:o=Br.Bit64;break;case Et.FLOAT:o=Br.Bit32;break;case Et.INT64:c=n||t==0;break;case Et.UINT64:c=n||t==0;break;case Et.FIXED64:c=n||t==0,o=Br.Bit64;break;case Et.BYTES:c=n||!t.byteLength,o=Br.LengthDelimited;break;case Et.FIXED32:o=Br.Bit32;break;case Et.SFIXED32:o=Br.Bit32;break;case Et.SFIXED64:c=n||t==0,o=Br.Bit64;break;case Et.SINT64:c=n||t==0;break}const d=Et[e].toLowerCase();return[o,d,n||c]}const wu=Symbol("@bufbuild/protobuf/unknown-fields"),hE={readUnknownFields:!0,readerFactory:e=>new K6(e)},fE={writeUnknownFields:!0,writerFactory:()=>new Z6};function X6(e){return e?Object.assign(Object.assign({},hE),e):hE}function Y6(e){return e?Object.assign(Object.assign({},fE),e):fE}function J6(){return{makeReadOptions:X6,makeWriteOptions:Y6,listUnknownFields(e){var t;return(t=e[wu])!==null&&t!==void 0?t:[]},discardUnknownFields(e){delete e[wu]},writeUnknownFields(e,t){const o=e[wu];if(o)for(const c of o)t.tag(c.no,c.wireType).raw(c.data)},onUnknownField(e,t,n,o){const c=e;Array.isArray(c[wu])||(c[wu]=[]),c[wu].push({no:t,wireType:n,data:o})},readMessage(e,t,n,o){const c=e.getType(),d=n===void 0?t.len:t.pos+n;for(;t.pos<d;){const[p,s]=t.tag(),_=c.fields.find(p);if(!_){const S=t.skip(s);o.readUnknownFields&&this.onUnknownField(e,p,s,S);continue}let v=e,E=_.repeated,T=_.localName;switch(_.oneof&&(v=v[_.oneof.localName],v.case!=T&&delete v.value,v.case=T,T="value"),_.kind){case"scalar":case"enum":const S=_.kind=="enum"?Et.INT32:_.T;if(E){let U=v[T];if(s==Br.LengthDelimited&&S!=Et.STRING&&S!=Et.BYTES){let $=t.uint32()+t.pos;for(;t.pos<$;)U.push(zh(t,S))}else U.push(zh(t,S))}else v[T]=zh(t,S);break;case"message":const D=_.T;E?v[T].push(D.fromBinary(t.bytes(),o)):v[T]instanceof Pf?v[T].fromBinary(t.bytes(),o):(v[T]=D.fromBinary(t.bytes(),o),D.fieldWrapper&&!_.oneof&&!_.repeated&&(v[T]=D.fieldWrapper.unwrapField(v[T])));break;case"map":let[O,M]=Q6(_,t,o);v[T][O]=M;break}}}}}function Q6(e,t,n){const o=t.uint32(),c=t.pos+o;let d,p;for(;t.pos<c;){let[s]=t.tag();switch(s){case 1:d=zh(t,e.K);break;case 2:switch(e.V.kind){case"scalar":p=zh(t,e.V.T);break;case"enum":p=t.int32();break;case"message":p=e.V.T.fromBinary(t.bytes(),n);break}break}}if(d===void 0){let s=__(e.K);d=e.K==Et.BOOL?s.toString():s}if(typeof d!="string"&&typeof d!="number"&&(d=d.toString()),p===void 0)switch(e.V.kind){case"scalar":p=__(e.V.T);break;case"enum":p=0;break;case"message":p=new e.V.T;break}return[d,p]}function zh(e,t){let[,n]=gx(t);return e[n]()}function eD(e,t,n,o,c){e.tag(n.no,Br.LengthDelimited),e.fork();let d=o;switch(n.K){case Et.INT32:case Et.FIXED32:case Et.UINT32:case Et.SFIXED32:case Et.SINT32:d=Number.parseInt(o);break;case Et.BOOL:uo(o=="true"||o=="false"),d=o=="true";break}switch(Bh(e,n.K,1,d,!0),n.V.kind){case"scalar":Bh(e,n.V.T,2,c,!0);break;case"enum":Bh(e,Et.INT32,2,c,!0);break;case"message":x_(e,t,n.V.T,2,c);break}e.join()}function x_(e,t,n,o,c){if(c!==void 0){const d=v_(n,c);e.tag(o,Br.LengthDelimited).bytes(d.toBinary(t))}}function Bh(e,t,n,o,c){let[d,p,s]=gx(t,o);(!s||c)&&e.tag(n,d)[p](o)}function tD(e,t,n,o){if(!o.length)return;e.tag(n,Br.LengthDelimited).fork();let[,c]=gx(t);for(let d=0;d<o.length;d++)e[c](o[d]);e.join()}function nD(){return Object.assign(Object.assign({},J6()),{writeMessage(e,t,n){const o=e.getType();for(const c of o.fields.byNumber()){let d,p=c.repeated,s=c.localName;if(c.oneof){const _=e[c.oneof.localName];if(_.case!==s)continue;d=_.value}else d=e[s];switch(c.kind){case"scalar":case"enum":let _=c.kind=="enum"?Et.INT32:c.T;if(p)if(c.packed)tD(t,_,c.no,d);else for(const v of d)Bh(t,_,c.no,v,!0);else d!==void 0&&Bh(t,_,c.no,d,!!c.oneof||c.opt);break;case"message":if(p)for(const v of d)x_(t,n,c.T,c.no,v);else x_(t,n,c.T,c.no,d);break;case"map":for(const[v,E]of Object.entries(d))eD(t,n,c,v,E);break}}return n.writeUnknownFields&&this.writeUnknownFields(e,t),t}})}let Es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),F0=[];for(let e=0;e<Es.length;e++)F0[Es[e].charCodeAt(0)]=e;F0["-".charCodeAt(0)]=Es.indexOf("+");F0["_".charCodeAt(0)]=Es.indexOf("/");const pC={dec(e){let t=e.length*3/4;e[e.length-2]=="="?t-=2:e[e.length-1]=="="&&(t-=1);let n=new Uint8Array(t),o=0,c=0,d,p=0;for(let s=0;s<e.length;s++){if(d=F0[e.charCodeAt(s)],d===void 0)switch(e[s]){case"=":c=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(c){case 0:p=d,c=1;break;case 1:n[o++]=p<<2|(d&48)>>4,p=d,c=2;break;case 2:n[o++]=(p&15)<<4|(d&60)>>2,p=d,c=3;break;case 3:n[o++]=(p&3)<<6|d,c=0;break}}if(c==1)throw Error("invalid base64 string.");return n.subarray(0,o)},enc(e){let t="",n=0,o,c=0;for(let d=0;d<e.length;d++)switch(o=e[d],n){case 0:t+=Es[o>>2],c=(o&3)<<4,n=1;break;case 1:t+=Es[c|o>>4],c=(o&15)<<2,n=2;break;case 2:t+=Es[c|o>>6],t+=Es[o&63],n=0;break}return n&&(t+=Es[c],t+="=",n==1&&(t+="=")),t}},pE={ignoreUnknownFields:!1},mE={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function rD(e){return e?Object.assign(Object.assign({},pE),e):pE}function iD(e){return e?Object.assign(Object.assign({},mE),e):mE}function oD(e){const t=e(aD,gE);return{makeReadOptions:rD,makeWriteOptions:iD,readMessage(n,o,c,d){if(o==null||Array.isArray(o)||typeof o!="object")throw new Error(`cannot decode message ${n.typeName} from JSON: ${this.debug(o)}`);d=d??new n;const p={};for(const[s,_]of Object.entries(o)){const v=n.fields.findJsonName(s);if(!v){if(!c.ignoreUnknownFields)throw new Error(`cannot decode message ${n.typeName} from JSON: key "${s}" is unknown`);continue}let E=v.localName,T=d;if(v.oneof){if(_===null&&v.kind=="scalar")continue;const S=p[v.oneof.localName];if(S)throw new Error(`cannot decode message ${n.typeName} from JSON: multiple keys for oneof "${v.oneof.name}" present: "${S}", "${s}"`);p[v.oneof.localName]=s,T=T[v.oneof.localName]={case:E},E="value"}if(v.repeated){if(_===null)continue;if(!Array.isArray(_))throw new Error(`cannot decode field ${n.typeName}.${v.name} from JSON: ${this.debug(_)}`);const S=T[E];for(const D of _){if(D===null)throw new Error(`cannot decode field ${n.typeName}.${v.name} from JSON: ${this.debug(D)}`);let O;switch(v.kind){case"message":O=v.T.fromJson(D,c);break;case"enum":if(O=Fy(v.T,D,c.ignoreUnknownFields),O===void 0)continue;break;case"scalar":try{O=_h(v.T,D)}catch(M){let U=`cannot decode field ${n.typeName}.${v.name} from JSON: ${this.debug(D)}`;throw M instanceof Error&&M.message.length>0&&(U+=`: ${M.message}`),new Error(U)}break}S.push(O)}}else if(v.kind=="map"){if(_===null)continue;if(Array.isArray(_)||typeof _!="object")throw new Error(`cannot decode field ${n.typeName}.${v.name} from JSON: ${this.debug(_)}`);const S=T[E];for(const[D,O]of Object.entries(_)){if(O===null)throw new Error(`cannot decode field ${n.typeName}.${v.name} from JSON: map value null`);let M;switch(v.V.kind){case"message":M=v.V.T.fromJson(O,c);break;case"enum":if(M=Fy(v.V.T,O,c.ignoreUnknownFields),M===void 0)continue;break;case"scalar":try{M=_h(v.V.T,O)}catch(U){let $=`cannot decode map value for field ${n.typeName}.${v.name} from JSON: ${this.debug(_)}`;throw U instanceof Error&&U.message.length>0&&($+=`: ${U.message}`),new Error($)}break}try{S[_h(v.K,v.K==Et.BOOL?D=="true"?!0:D=="false"?!1:D:D).toString()]=M}catch(U){let $=`cannot decode map key for field ${n.typeName}.${v.name} from JSON: ${this.debug(_)}`;throw U instanceof Error&&U.message.length>0&&($+=`: ${U.message}`),new Error($)}}}else switch(v.kind){case"message":const S=v.T;if(_===null&&S.typeName!="google.protobuf.Value"){if(v.oneof)throw new Error(`cannot decode field ${n.typeName}.${v.name} from JSON: null is invalid for oneof field "${s}"`);continue}T[E]instanceof Pf?T[E].fromJson(_,c):(T[E]=S.fromJson(_,c),S.fieldWrapper&&!v.oneof&&(T[E]=S.fieldWrapper.unwrapField(T[E])));break;case"enum":const D=Fy(v.T,_,c.ignoreUnknownFields);D!==void 0&&(T[E]=D);break;case"scalar":try{T[E]=_h(v.T,_)}catch(O){let M=`cannot decode field ${n.typeName}.${v.name} from JSON: ${this.debug(_)}`;throw O instanceof Error&&O.message.length>0&&(M+=`: ${O.message}`),new Error(M)}break}}return d},writeMessage(n,o){const c=n.getType(),d={};let p;try{for(const s of c.fields.byMember()){let _;if(s.kind=="oneof"){const v=n[s.localName];if(v.value===void 0)continue;if(p=s.findField(v.case),!p)throw"oneof case not found: "+v.case;_=t(p,v.value,o)}else p=s,_=t(p,n[p.localName],o);_!==void 0&&(d[o.useProtoFieldName?p.name:p.jsonName]=_)}}catch(s){const _=p?`cannot encode field ${c.typeName}.${p.name} to JSON`:`cannot encode message ${c.typeName} to JSON`,v=s instanceof Error?s.message:String(s);throw new Error(_+(v.length>0?`: ${v}`:""))}return d},readScalar:_h,writeScalar:gE,debug:mC}}function mC(e){if(e===null)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return e.toString()}}function _h(e,t){switch(e){case Et.DOUBLE:case Et.FLOAT:if(t===null)return 0;if(t==="NaN")return Number.NaN;if(t==="Infinity")return Number.POSITIVE_INFINITY;if(t==="-Infinity")return Number.NEGATIVE_INFINITY;if(t===""||typeof t=="string"&&t.trim().length!==t.length||typeof t!="string"&&typeof t!="number")break;const n=Number(t);if(Number.isNaN(n)||!Number.isFinite(n))break;return e==Et.FLOAT&&sC(n),n;case Et.INT32:case Et.FIXED32:case Et.SFIXED32:case Et.SINT32:case Et.UINT32:if(t===null)return 0;let o;if(typeof t=="number"?o=t:typeof t=="string"&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),o===void 0)break;return e==Et.UINT32?y_(o):bm(o),o;case Et.INT64:case Et.SFIXED64:case Et.SINT64:if(t===null)return Qi.zero;if(typeof t!="number"&&typeof t!="string")break;return Qi.parse(t);case Et.FIXED64:case Et.UINT64:if(t===null)return Qi.zero;if(typeof t!="number"&&typeof t!="string")break;return Qi.uParse(t);case Et.BOOL:if(t===null)return!1;if(typeof t!="boolean")break;return t;case Et.STRING:if(t===null)return"";if(typeof t!="string")break;try{encodeURIComponent(t)}catch{throw new Error("invalid UTF8")}return t;case Et.BYTES:if(t===null||t==="")return new Uint8Array(0);if(typeof t!="string")break;return pC.dec(t)}throw new Error}function Fy(e,t,n){if(t===null)return 0;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const o=e.findName(t);if(o||n)return o?.no;break}throw new Error(`cannot decode enum ${e.typeName} from JSON: ${mC(t)}`)}function aD(e,t,n,o){var c;if(t===void 0)return t;if(t===0&&!n)return;if(o)return t;if(e.typeName=="google.protobuf.NullValue")return null;const d=e.findNumber(t);return(c=d?.name)!==null&&c!==void 0?c:t}function gE(e,t,n){if(t!==void 0)switch(e){case Et.INT32:case Et.SFIXED32:case Et.SINT32:case Et.FIXED32:case Et.UINT32:return uo(typeof t=="number"),t!=0||n?t:void 0;case Et.FLOAT:case Et.DOUBLE:return uo(typeof t=="number"),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t!==0||n?t:void 0;case Et.STRING:return uo(typeof t=="string"),t.length>0||n?t:void 0;case Et.BOOL:return uo(typeof t=="boolean"),t||n?t:void 0;case Et.UINT64:case Et.FIXED64:case Et.INT64:case Et.SFIXED64:case Et.SINT64:return uo(typeof t=="bigint"||typeof t=="string"||typeof t=="number"),n||t!=0?t.toString(10):void 0;case Et.BYTES:return uo(t instanceof Uint8Array),n||t.byteLength>0?pC.enc(t):void 0}}function sD(){return oD((e,t)=>function(o,c,d){if(o.kind=="map"){const p={};switch(o.V.kind){case"scalar":for(const[_,v]of Object.entries(c)){const E=t(o.V.T,v,!0);uo(E!==void 0),p[_.toString()]=E}break;case"message":for(const[_,v]of Object.entries(c))p[_.toString()]=v.toJson(d);break;case"enum":const s=o.V.T;for(const[_,v]of Object.entries(c)){uo(v===void 0||typeof v=="number");const E=e(s,v,!0,d.enumAsInteger);uo(E!==void 0),p[_.toString()]=E}break}return d.emitDefaultValues||Object.keys(p).length>0?p:void 0}else if(o.repeated){const p=[];switch(o.kind){case"scalar":for(let s=0;s<c.length;s++)p.push(t(o.T,c[s],!0));break;case"enum":for(let s=0;s<c.length;s++)p.push(e(o.T,c[s],!0,d.enumAsInteger));break;case"message":for(let s=0;s<c.length;s++)p.push(v_(o.T,c[s]).toJson(d));break}return d.emitDefaultValues||p.length>0?p:void 0}else switch(o.kind){case"scalar":return t(o.T,c,!!o.oneof||o.opt||d.emitDefaultValues);case"enum":return e(o.T,c,!!o.oneof||o.opt||d.emitDefaultValues,d.enumAsInteger);case"message":return c!==void 0?v_(o.T,c).toJson(d):void 0}})}function lD(){return{setEnumType:cC,initPartial(e,t){if(e===void 0)return;const n=t.getType();for(const o of n.fields.byMember()){const c=o.localName,d=t,p=e;if(p[c]!==void 0)switch(o.kind){case"oneof":const s=p[c].case;if(s===void 0)continue;const _=o.findField(s);let v=p[c].value;_&&_.kind=="message"&&!(v instanceof _.T)&&(v=new _.T(v)),d[c]={case:s,value:v};break;case"scalar":case"enum":d[c]=p[c];break;case"map":switch(o.V.kind){case"scalar":case"enum":Object.assign(d[c],p[c]);break;case"message":const T=o.V.T;for(const S of Object.keys(p[c])){let D=p[c][S];T.fieldWrapper||(D=new T(D)),d[c][S]=D}break}break;case"message":const E=o.T;if(o.repeated)d[c]=p[c].map(T=>T instanceof E?T:new E(T));else if(p[c]!==void 0){const T=p[c];E.fieldWrapper?d[c]=T:d[c]=T instanceof E?T:new E(T)}break}}},equals(e,t,n){return t===n?!0:!t||!n?!1:e.fields.byMember().every(o=>{const c=t[o.localName],d=n[o.localName];if(o.repeated){if(c.length!==d.length)return!1;switch(o.kind){case"message":return c.every((p,s)=>o.T.equals(p,d[s]));case"scalar":return c.every((p,s)=>ul(o.T,p,d[s]));case"enum":return c.every((p,s)=>ul(Et.INT32,p,d[s]))}throw new Error(`repeated cannot contain ${o.kind}`)}switch(o.kind){case"message":return o.T.equals(c,d);case"enum":return ul(Et.INT32,c,d);case"scalar":return ul(o.T,c,d);case"oneof":if(c.case!==d.case)return!1;const p=c.case,s=o.findField(p);if(s===void 0)return!0;switch(s.kind){case"message":return s.T.equals(c[p],d[p]);case"enum":return ul(Et.INT32,c,d);case"scalar":return ul(s.T,c,d)}throw new Error(`oneof cannot contain ${s.kind}`);case"map":const _=Object.keys(c).concat(Object.keys(d));switch(o.V.kind){case"message":const v=o.V.T;return _.every(T=>v.equals(c[T],d[T]));case"enum":return _.every(T=>ul(Et.INT32,c[T],d[T]));case"scalar":const E=o.V.T;return _.every(T=>ul(E,c[T],d[T]))}break}})},clone(e){const t=e.getType(),n=new t,o=n;for(const c of t.fields.byMember()){const d=e[c.localName];let p;if(c.repeated)p=d.map(s=>Qp(c,s));else if(c.kind=="map"){p=o[c.localName];for(const[s,_]of Object.entries(d))p[s]=Qp(c.V,_)}else if(c.kind=="oneof"){const s=c.findField(d.case);p=s?{case:d.case,value:Qp(s,d.value)}:{case:void 0}}else p=Qp(c,d);o[c.localName]=p}return n}}}function Qp(e,t){if(t===void 0)return t;if(t instanceof Pf)return t.clone();if(t instanceof Uint8Array){const n=new Uint8Array(t.byteLength);return n.set(t),n}return t}class cD{constructor(t,n){this._fields=t,this._normalizer=n}findJsonName(t){if(!this.jsonNames){const n={};for(const o of this.list())n[o.jsonName]=n[o.name]=o;this.jsonNames=n}return this.jsonNames[t]}find(t){if(!this.numbers){const n={};for(const o of this.list())n[o.no]=o;this.numbers=n}return this.numbers[t]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((t,n)=>t.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const t=this.members;let n;for(const o of this.list())o.oneof?o.oneof!==n&&(n=o.oneof,t.push(n)):t.push(o)}return this.members}}function gC(e,t){let n=yC(e);return t||(hD[n]||fD[n])&&(n=n+"$"),n}function uD(e){return gC(e,!1)}const dD=yC;function yC(e){let t=!1;const n=[];for(let o=0;o<e.length;o++){let c=e.charAt(o);switch(c){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(c),t=!1;break;default:t&&(t=!1,c=c.toUpperCase()),n.push(c);break}}return n.join("")}const hD={constructor:!0,toString:!0,toJSON:!0,valueOf:!0},fD={getType:!0,clone:!0,equals:!0,fromBinary:!0,fromJson:!0,fromJsonString:!0,toBinary:!0,toJson:!0,toJsonString:!0,toObject:!0};class pD{constructor(t){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=t,this.localName=uD(t)}addField(t){uo(t.oneof===this,`field ${t.name} not one of ${this.name}`),this.fields.push(t)}findField(t){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[t]}}const ht=V6("proto3",sD(),nD(),Object.assign(Object.assign({},lD()),{newFieldList(e){return new cD(e,mD)},initFields(e){for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,o=e;if(t.repeated){o[n]=[];continue}switch(t.kind){case"oneof":o[n]={case:void 0};break;case"enum":o[n]=0;break;case"map":o[n]={};break;case"scalar":o[n]=__(t.T);break}}}}));function mD(e){var t,n,o;const c=[];let d;for(const p of typeof e=="function"?e():e){const s=p;if(s.localName=gC(p.name,p.oneof!==void 0),s.jsonName=(t=p.jsonName)!==null&&t!==void 0?t:dD(p.name),s.repeated=(n=p.repeated)!==null&&n!==void 0?n:!1,s.packed=(o=p.packed)!==null&&o!==void 0?o:p.kind=="enum"||p.kind=="scalar"&&p.T!=Et.BYTES&&p.T!=Et.STRING,p.oneof!==void 0){const _=typeof p.oneof=="string"?p.oneof:p.oneof.name;(!d||d.name!=_)&&(d=new pD(_)),s.oneof=d,d.addField(s)}c.push(s)}return c}const vC=ht.makeMessageType("meshtastic.ChannelSettings",()=>[{no:1,name:"channel_num",kind:"scalar",T:13},{no:2,name:"psk",kind:"scalar",T:12},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"id",kind:"scalar",T:7},{no:5,name:"uplink_enabled",kind:"scalar",T:8},{no:6,name:"downlink_enabled",kind:"scalar",T:8}]),fd=ht.makeMessageType("meshtastic.Channel",()=>[{no:1,name:"index",kind:"scalar",T:5},{no:2,name:"settings",kind:"message",T:vC},{no:3,name:"role",kind:"enum",T:ht.getEnumType(Nc)}]),Nc=ht.makeEnum("meshtastic.Channel.Role",[{no:0,name:"DISABLED"},{no:1,name:"PRIMARY"},{no:2,name:"SECONDARY"}]),gn=ht.makeEnum("meshtastic.PortNum",[{no:0,name:"UNKNOWN_APP"},{no:1,name:"TEXT_MESSAGE_APP"},{no:2,name:"REMOTE_HARDWARE_APP"},{no:3,name:"POSITION_APP"},{no:4,name:"NODEINFO_APP"},{no:5,name:"ROUTING_APP"},{no:6,name:"ADMIN_APP"},{no:7,name:"TEXT_MESSAGE_COMPRESSED_APP"},{no:8,name:"WAYPOINT_APP"},{no:9,name:"AUDIO_APP"},{no:32,name:"REPLY_APP"},{no:33,name:"IP_TUNNEL_APP"},{no:64,name:"SERIAL_APP"},{no:65,name:"STORE_FORWARD_APP"},{no:66,name:"RANGE_TEST_APP"},{no:67,name:"TELEMETRY_APP"},{no:68,name:"ZPS_APP"},{no:69,name:"SIMULATOR_APP"},{no:70,name:"TRACEROUTE_APP"},{no:256,name:"PRIVATE_APP"},{no:257,name:"ATAK_FORWARDER"},{no:511,name:"MAX"}]);ht.makeEnum("meshtastic.TelemetrySensorType",[{no:0,name:"SENSOR_UNSET"},{no:1,name:"BME280"},{no:2,name:"BME680"},{no:3,name:"MCP9808"},{no:4,name:"INA260"},{no:5,name:"INA219"},{no:6,name:"BMP280"},{no:7,name:"SHTC3"},{no:8,name:"LPS22"},{no:9,name:"QMC6310"},{no:10,name:"QMI8658"},{no:11,name:"QMC5883L"},{no:12,name:"SHT31"},{no:13,name:"PMSA003I"}]);const _C=ht.makeMessageType("meshtastic.DeviceMetrics",()=>[{no:1,name:"battery_level",kind:"scalar",T:13},{no:2,name:"voltage",kind:"scalar",T:2},{no:3,name:"channel_utilization",kind:"scalar",T:2},{no:4,name:"air_util_tx",kind:"scalar",T:2}]),gD=ht.makeMessageType("meshtastic.EnvironmentMetrics",()=>[{no:1,name:"temperature",kind:"scalar",T:2},{no:2,name:"relative_humidity",kind:"scalar",T:2},{no:3,name:"barometric_pressure",kind:"scalar",T:2},{no:4,name:"gas_resistance",kind:"scalar",T:2},{no:5,name:"voltage",kind:"scalar",T:2},{no:6,name:"current",kind:"scalar",T:2}]),yD=ht.makeMessageType("meshtastic.AirQualityMetrics",()=>[{no:1,name:"pm10_standard",kind:"scalar",T:13},{no:2,name:"pm25_standard",kind:"scalar",T:13},{no:3,name:"pm100_standard",kind:"scalar",T:13},{no:4,name:"pm10_environmental",kind:"scalar",T:13},{no:5,name:"pm25_environmental",kind:"scalar",T:13},{no:6,name:"pm100_environmental",kind:"scalar",T:13},{no:7,name:"particles_03um",kind:"scalar",T:13},{no:8,name:"particles_05um",kind:"scalar",T:13},{no:9,name:"particles_10um",kind:"scalar",T:13},{no:10,name:"particles_25um",kind:"scalar",T:13},{no:11,name:"particles_50um",kind:"scalar",T:13},{no:12,name:"particles_100um",kind:"scalar",T:13}]),vD=ht.makeMessageType("meshtastic.Telemetry",()=>[{no:1,name:"time",kind:"scalar",T:7},{no:2,name:"device_metrics",kind:"message",T:_C,oneof:"variant"},{no:3,name:"environment_metrics",kind:"message",T:gD,oneof:"variant"},{no:4,name:"air_quality_metrics",kind:"message",T:yD,oneof:"variant"}]),ba=ht.makeMessageType("meshtastic.Config",()=>[{no:1,name:"device",kind:"message",T:xC,oneof:"payload_variant"},{no:2,name:"position",kind:"message",T:wC,oneof:"payload_variant"},{no:3,name:"power",kind:"message",T:EC,oneof:"payload_variant"},{no:4,name:"network",kind:"message",T:TC,oneof:"payload_variant"},{no:5,name:"display",kind:"message",T:kC,oneof:"payload_variant"},{no:6,name:"lora",kind:"message",T:vx,oneof:"payload_variant"},{no:7,name:"bluetooth",kind:"message",T:RC,oneof:"payload_variant"}]),xC=ht.makeMessageType("meshtastic.Config.DeviceConfig",()=>[{no:1,name:"role",kind:"enum",T:ht.getEnumType(yx)},{no:2,name:"serial_enabled",kind:"scalar",T:8},{no:3,name:"debug_log_enabled",kind:"scalar",T:8},{no:4,name:"button_gpio",kind:"scalar",T:13},{no:5,name:"buzzer_gpio",kind:"scalar",T:13},{no:6,name:"rebroadcast_mode",kind:"enum",T:ht.getEnumType(bC)},{no:7,name:"node_info_broadcast_secs",kind:"scalar",T:13}],{localName:"Config_DeviceConfig"}),yx=ht.makeEnum("meshtastic.Config.DeviceConfig.Role",[{no:0,name:"CLIENT"},{no:1,name:"CLIENT_MUTE"},{no:2,name:"ROUTER"},{no:3,name:"ROUTER_CLIENT"},{no:4,name:"REPEATER"},{no:5,name:"TRACKER"}]),bC=ht.makeEnum("meshtastic.Config.DeviceConfig.RebroadcastMode",[{no:0,name:"ALL"},{no:1,name:"ALL_SKIP_DECODING"},{no:2,name:"LOCAL_ONLY"}]),wC=ht.makeMessageType("meshtastic.Config.PositionConfig",()=>[{no:1,name:"position_broadcast_secs",kind:"scalar",T:13},{no:2,name:"position_broadcast_smart_enabled",kind:"scalar",T:8},{no:3,name:"fixed_position",kind:"scalar",T:8},{no:4,name:"gps_enabled",kind:"scalar",T:8},{no:5,name:"gps_update_interval",kind:"scalar",T:13},{no:6,name:"gps_attempt_time",kind:"scalar",T:13},{no:7,name:"position_flags",kind:"scalar",T:13},{no:8,name:"rx_gpio",kind:"scalar",T:13},{no:9,name:"tx_gpio",kind:"scalar",T:13}],{localName:"Config_PositionConfig"}),_D=ht.makeEnum("meshtastic.Config.PositionConfig.PositionFlags",[{no:0,name:"UNSET"},{no:1,name:"ALTITUDE"},{no:2,name:"ALTITUDE_MSL"},{no:4,name:"GEOIDAL_SEPARATION"},{no:8,name:"DOP"},{no:16,name:"HVDOP"},{no:32,name:"SATINVIEW"},{no:64,name:"SEQ_NO"},{no:128,name:"TIMESTAMP"},{no:256,name:"HEADING"},{no:512,name:"SPEED"}]),EC=ht.makeMessageType("meshtastic.Config.PowerConfig",()=>[{no:1,name:"is_power_saving",kind:"scalar",T:8},{no:2,name:"on_battery_shutdown_after_secs",kind:"scalar",T:13},{no:3,name:"adc_multiplier_override",kind:"scalar",T:2},{no:4,name:"wait_bluetooth_secs",kind:"scalar",T:13},{no:5,name:"mesh_sds_timeout_secs",kind:"scalar",T:13},{no:6,name:"sds_secs",kind:"scalar",T:13},{no:7,name:"ls_secs",kind:"scalar",T:13},{no:8,name:"min_wake_secs",kind:"scalar",T:13}],{localName:"Config_PowerConfig"}),TC=ht.makeMessageType("meshtastic.Config.NetworkConfig",()=>[{no:1,name:"wifi_enabled",kind:"scalar",T:8},{no:3,name:"wifi_ssid",kind:"scalar",T:9},{no:4,name:"wifi_psk",kind:"scalar",T:9},{no:5,name:"ntp_server",kind:"scalar",T:9},{no:6,name:"eth_enabled",kind:"scalar",T:8},{no:7,name:"address_mode",kind:"enum",T:ht.getEnumType(Iu)},{no:8,name:"ipv4_config",kind:"message",T:SC},{no:9,name:"rsyslog_server",kind:"scalar",T:9}],{localName:"Config_NetworkConfig"}),Iu=ht.makeEnum("meshtastic.Config.NetworkConfig.AddressMode",[{no:0,name:"DHCP"},{no:1,name:"STATIC"}]),SC=ht.makeMessageType("meshtastic.Config.NetworkConfig.IpV4Config",()=>[{no:1,name:"ip",kind:"scalar",T:7},{no:2,name:"gateway",kind:"scalar",T:7},{no:3,name:"subnet",kind:"scalar",T:7},{no:4,name:"dns",kind:"scalar",T:7}],{localName:"Config_NetworkConfig_IpV4Config"}),kC=ht.makeMessageType("meshtastic.Config.DisplayConfig",()=>[{no:1,name:"screen_on_secs",kind:"scalar",T:13},{no:2,name:"gps_format",kind:"enum",T:ht.getEnumType(CC)},{no:3,name:"auto_screen_carousel_secs",kind:"scalar",T:13},{no:4,name:"compass_north_top",kind:"scalar",T:8},{no:5,name:"flip_screen",kind:"scalar",T:8},{no:6,name:"units",kind:"enum",T:ht.getEnumType(PC)},{no:7,name:"oled",kind:"enum",T:ht.getEnumType(AC)},{no:8,name:"displaymode",kind:"enum",T:ht.getEnumType(IC)},{no:9,name:"heading_bold",kind:"scalar",T:8}],{localName:"Config_DisplayConfig"}),CC=ht.makeEnum("meshtastic.Config.DisplayConfig.GpsCoordinateFormat",[{no:0,name:"DEC"},{no:1,name:"DMS"},{no:2,name:"UTM"},{no:3,name:"MGRS"},{no:4,name:"OLC"},{no:5,name:"OSGR"}]),PC=ht.makeEnum("meshtastic.Config.DisplayConfig.DisplayUnits",[{no:0,name:"METRIC"},{no:1,name:"IMPERIAL"}]),AC=ht.makeEnum("meshtastic.Config.DisplayConfig.OledType",[{no:0,name:"OLED_AUTO"},{no:1,name:"OLED_SSD1306"},{no:2,name:"OLED_SH1106"},{no:3,name:"OLED_SH1107"}]),IC=ht.makeEnum("meshtastic.Config.DisplayConfig.DisplayMode",[{no:0,name:"DEFAULT"},{no:1,name:"TWOCOLOR"},{no:2,name:"INVERTED"},{no:3,name:"COLOR"}]),vx=ht.makeMessageType("meshtastic.Config.LoRaConfig",()=>[{no:1,name:"use_preset",kind:"scalar",T:8},{no:2,name:"modem_preset",kind:"enum",T:ht.getEnumType(DC)},{no:3,name:"bandwidth",kind:"scalar",T:13},{no:4,name:"spread_factor",kind:"scalar",T:13},{no:5,name:"coding_rate",kind:"scalar",T:13},{no:6,name:"frequency_offset",kind:"scalar",T:2},{no:7,name:"region",kind:"enum",T:ht.getEnumType(MC)},{no:8,name:"hop_limit",kind:"scalar",T:13},{no:9,name:"tx_enabled",kind:"scalar",T:8},{no:10,name:"tx_power",kind:"scalar",T:5},{no:11,name:"channel_num",kind:"scalar",T:13},{no:12,name:"override_duty_cycle",kind:"scalar",T:8},{no:13,name:"sx126x_rx_boosted_gain",kind:"scalar",T:8},{no:14,name:"override_frequency",kind:"scalar",T:2},{no:103,name:"ignore_incoming",kind:"scalar",T:13,repeated:!0}],{localName:"Config_LoRaConfig"}),MC=ht.makeEnum("meshtastic.Config.LoRaConfig.RegionCode",[{no:0,name:"UNSET"},{no:1,name:"US"},{no:2,name:"EU_433"},{no:3,name:"EU_868"},{no:4,name:"CN"},{no:5,name:"JP"},{no:6,name:"ANZ"},{no:7,name:"KR"},{no:8,name:"TW"},{no:9,name:"RU"},{no:10,name:"IN"},{no:11,name:"NZ_865"},{no:12,name:"TH"},{no:13,name:"LORA_24"},{no:14,name:"UA_433"},{no:15,name:"UA_868"}]),DC=ht.makeEnum("meshtastic.Config.LoRaConfig.ModemPreset",[{no:0,name:"LONG_FAST"},{no:1,name:"LONG_SLOW"},{no:2,name:"VERY_LONG_SLOW"},{no:3,name:"MEDIUM_SLOW"},{no:4,name:"MEDIUM_FAST"},{no:5,name:"SHORT_SLOW"},{no:6,name:"SHORT_FAST"},{no:7,name:"LONG_MODERATE"}]),RC=ht.makeMessageType("meshtastic.Config.BluetoothConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"mode",kind:"enum",T:ht.getEnumType(b_)},{no:3,name:"fixed_pin",kind:"scalar",T:13}],{localName:"Config_BluetoothConfig"}),b_=ht.makeEnum("meshtastic.Config.BluetoothConfig.PairingMode",[{no:0,name:"RANDOM_PIN"},{no:1,name:"FIXED_PIN"},{no:2,name:"NO_PIN"}]),wa=ht.makeMessageType("meshtastic.ModuleConfig",()=>[{no:1,name:"mqtt",kind:"message",T:LC,oneof:"payload_variant"},{no:2,name:"serial",kind:"message",T:zC,oneof:"payload_variant"},{no:3,name:"external_notification",kind:"message",T:UC,oneof:"payload_variant"},{no:4,name:"store_forward",kind:"message",T:VC,oneof:"payload_variant"},{no:5,name:"range_test",kind:"message",T:jC,oneof:"payload_variant"},{no:6,name:"telemetry",kind:"message",T:GC,oneof:"payload_variant"},{no:7,name:"canned_message",kind:"message",T:qC,oneof:"payload_variant"},{no:8,name:"audio",kind:"message",T:OC,oneof:"payload_variant"},{no:9,name:"remote_hardware",kind:"message",T:NC,oneof:"payload_variant"}]),LC=ht.makeMessageType("meshtastic.ModuleConfig.MQTTConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"address",kind:"scalar",T:9},{no:3,name:"username",kind:"scalar",T:9},{no:4,name:"password",kind:"scalar",T:9},{no:5,name:"encryption_enabled",kind:"scalar",T:8},{no:6,name:"json_enabled",kind:"scalar",T:8}],{localName:"ModuleConfig_MQTTConfig"}),NC=ht.makeMessageType("meshtastic.ModuleConfig.RemoteHardwareConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8}],{localName:"ModuleConfig_RemoteHardwareConfig"}),OC=ht.makeMessageType("meshtastic.ModuleConfig.AudioConfig",()=>[{no:1,name:"codec2_enabled",kind:"scalar",T:8},{no:2,name:"ptt_pin",kind:"scalar",T:13},{no:3,name:"bitrate",kind:"enum",T:ht.getEnumType($C)},{no:4,name:"i2s_ws",kind:"scalar",T:13},{no:5,name:"i2s_sd",kind:"scalar",T:13},{no:6,name:"i2s_din",kind:"scalar",T:13},{no:7,name:"i2s_sck",kind:"scalar",T:13}],{localName:"ModuleConfig_AudioConfig"}),$C=ht.makeEnum("meshtastic.ModuleConfig.AudioConfig.Audio_Baud",[{no:0,name:"CODEC2_DEFAULT"},{no:1,name:"CODEC2_3200"},{no:2,name:"CODEC2_2400"},{no:3,name:"CODEC2_1600"},{no:4,name:"CODEC2_1400"},{no:5,name:"CODEC2_1300"},{no:6,name:"CODEC2_1200"},{no:7,name:"CODEC2_700"},{no:8,name:"CODEC2_700B"}]),zC=ht.makeMessageType("meshtastic.ModuleConfig.SerialConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"echo",kind:"scalar",T:8},{no:3,name:"rxd",kind:"scalar",T:13},{no:4,name:"txd",kind:"scalar",T:13},{no:5,name:"baud",kind:"enum",T:ht.getEnumType(BC)},{no:6,name:"timeout",kind:"scalar",T:13},{no:7,name:"mode",kind:"enum",T:ht.getEnumType(FC)}],{localName:"ModuleConfig_SerialConfig"}),BC=ht.makeEnum("meshtastic.ModuleConfig.SerialConfig.Serial_Baud",[{no:0,name:"BAUD_DEFAULT"},{no:1,name:"BAUD_110"},{no:2,name:"BAUD_300"},{no:3,name:"BAUD_600"},{no:4,name:"BAUD_1200"},{no:5,name:"BAUD_2400"},{no:6,name:"BAUD_4800"},{no:7,name:"BAUD_9600"},{no:8,name:"BAUD_19200"},{no:9,name:"BAUD_38400"},{no:10,name:"BAUD_57600"},{no:11,name:"BAUD_115200"},{no:12,name:"BAUD_230400"},{no:13,name:"BAUD_460800"},{no:14,name:"BAUD_576000"},{no:15,name:"BAUD_921600"}]),FC=ht.makeEnum("meshtastic.ModuleConfig.SerialConfig.Serial_Mode",[{no:0,name:"DEFAULT"},{no:1,name:"SIMPLE"},{no:2,name:"PROTO"},{no:3,name:"TEXTMSG"},{no:4,name:"NMEA"}]),UC=ht.makeMessageType("meshtastic.ModuleConfig.ExternalNotificationConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"output_ms",kind:"scalar",T:13},{no:3,name:"output",kind:"scalar",T:13},{no:8,name:"output_vibra",kind:"scalar",T:13},{no:9,name:"output_buzzer",kind:"scalar",T:13},{no:4,name:"active",kind:"scalar",T:8},{no:5,name:"alert_message",kind:"scalar",T:8},{no:10,name:"alert_message_vibra",kind:"scalar",T:8},{no:11,name:"alert_message_buzzer",kind:"scalar",T:8},{no:6,name:"alert_bell",kind:"scalar",T:8},{no:12,name:"alert_bell_vibra",kind:"scalar",T:8},{no:13,name:"alert_bell_buzzer",kind:"scalar",T:8},{no:7,name:"use_pwm",kind:"scalar",T:8},{no:14,name:"nag_timeout",kind:"scalar",T:13}],{localName:"ModuleConfig_ExternalNotificationConfig"}),VC=ht.makeMessageType("meshtastic.ModuleConfig.StoreForwardConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"heartbeat",kind:"scalar",T:8},{no:3,name:"records",kind:"scalar",T:13},{no:4,name:"history_return_max",kind:"scalar",T:13},{no:5,name:"history_return_window",kind:"scalar",T:13}],{localName:"ModuleConfig_StoreForwardConfig"}),jC=ht.makeMessageType("meshtastic.ModuleConfig.RangeTestConfig",()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"sender",kind:"scalar",T:13},{no:3,name:"save",kind:"scalar",T:8}],{localName:"ModuleConfig_RangeTestConfig"}),GC=ht.makeMessageType("meshtastic.ModuleConfig.TelemetryConfig",()=>[{no:1,name:"device_update_interval",kind:"scalar",T:13},{no:2,name:"environment_update_interval",kind:"scalar",T:13},{no:3,name:"environment_measurement_enabled",kind:"scalar",T:8},{no:4,name:"environment_screen_enabled",kind:"scalar",T:8},{no:5,name:"environment_display_fahrenheit",kind:"scalar",T:8}],{localName:"ModuleConfig_TelemetryConfig"}),qC=ht.makeMessageType("meshtastic.ModuleConfig.CannedMessageConfig",()=>[{no:1,name:"rotary1_enabled",kind:"scalar",T:8},{no:2,name:"inputbroker_pin_a",kind:"scalar",T:13},{no:3,name:"inputbroker_pin_b",kind:"scalar",T:13},{no:4,name:"inputbroker_pin_press",kind:"scalar",T:13},{no:5,name:"inputbroker_event_cw",kind:"enum",T:ht.getEnumType(Qu)},{no:6,name:"inputbroker_event_ccw",kind:"enum",T:ht.getEnumType(Qu)},{no:7,name:"inputbroker_event_press",kind:"enum",T:ht.getEnumType(Qu)},{no:8,name:"updown1_enabled",kind:"scalar",T:8},{no:9,name:"enabled",kind:"scalar",T:8},{no:10,name:"allow_input_source",kind:"scalar",T:9},{no:11,name:"send_bell",kind:"scalar",T:8}],{localName:"ModuleConfig_CannedMessageConfig"}),Qu=ht.makeEnum("meshtastic.ModuleConfig.CannedMessageConfig.InputEventChar",[{no:0,name:"NONE"},{no:17,name:"UP"},{no:18,name:"DOWN"},{no:19,name:"LEFT"},{no:20,name:"RIGHT"},{no:10,name:"SELECT"},{no:27,name:"BACK"},{no:24,name:"CANCEL"}]),WC=ht.makeMessageType("meshtastic.XModem",()=>[{no:1,name:"control",kind:"enum",T:ht.getEnumType(wi)},{no:2,name:"seq",kind:"scalar",T:13},{no:3,name:"crc16",kind:"scalar",T:13},{no:4,name:"buffer",kind:"scalar",T:12}]),wi=ht.makeEnum("meshtastic.XModem.Control",[{no:0,name:"NUL"},{no:1,name:"SOH"},{no:2,name:"STX"},{no:4,name:"EOT"},{no:6,name:"ACK"},{no:21,name:"NAK"},{no:24,name:"CAN"},{no:26,name:"CTRLZ"}]),_x=ht.makeEnum("meshtastic.HardwareModel",[{no:0,name:"UNSET"},{no:1,name:"TLORA_V2"},{no:2,name:"TLORA_V1"},{no:3,name:"TLORA_V2_1_1P6"},{no:4,name:"TBEAM"},{no:5,name:"HELTEC_V2_0"},{no:6,name:"TBEAM_V0P7"},{no:7,name:"T_ECHO"},{no:8,name:"TLORA_V1_1P3"},{no:9,name:"RAK4631"},{no:10,name:"HELTEC_V2_1"},{no:11,name:"HELTEC_V1"},{no:12,name:"LILYGO_TBEAM_S3_CORE"},{no:13,name:"RAK11200"},{no:14,name:"NANO_G1"},{no:15,name:"TLORA_V2_1_1P8"},{no:16,name:"TLORA_T3_S3"},{no:17,name:"NANO_G1_EXPLORER"},{no:25,name:"STATION_G1"},{no:32,name:"LORA_RELAY_V1"},{no:33,name:"NRF52840DK"},{no:34,name:"PPR"},{no:35,name:"GENIEBLOCKS"},{no:36,name:"NRF52_UNKNOWN"},{no:37,name:"PORTDUINO"},{no:38,name:"ANDROID_SIM"},{no:39,name:"DIY_V1"},{no:40,name:"NRF52840_PCA10059"},{no:41,name:"DR_DEV"},{no:42,name:"M5STACK"},{no:43,name:"HELTEC_V3"},{no:44,name:"HELTEC_WSL_V3"},{no:45,name:"BETAFPV_2400_TX"},{no:46,name:"BETAFPV_900_NANO_TX"},{no:255,name:"PRIVATE_HW"}]);ht.makeEnum("meshtastic.Constants",[{no:0,name:"ZERO"},{no:237,name:"DATA_PAYLOAD_LEN"}]);const xD=ht.makeEnum("meshtastic.CriticalErrorCode",[{no:0,name:"NONE"},{no:1,name:"TX_WATCHDOG"},{no:2,name:"SLEEP_ENTER_WAIT"},{no:3,name:"NO_RADIO"},{no:4,name:"UNSPECIFIED"},{no:5,name:"UBLOX_UNIT_FAILED"},{no:6,name:"NO_AXP192"},{no:7,name:"INVALID_RADIO_SETTING"},{no:8,name:"TRANSMIT_FAILED"},{no:9,name:"BROWNOUT"},{no:10,name:"SX1262_FAILURE"},{no:11,name:"RADIO_SPI_BUG"}]),HC=ht.makeMessageType("meshtastic.Position",()=>[{no:1,name:"latitude_i",kind:"scalar",T:15},{no:2,name:"longitude_i",kind:"scalar",T:15},{no:3,name:"altitude",kind:"scalar",T:5},{no:4,name:"time",kind:"scalar",T:7},{no:5,name:"location_source",kind:"enum",T:ht.getEnumType(bD)},{no:6,name:"altitude_source",kind:"enum",T:ht.getEnumType(wD)},{no:7,name:"timestamp",kind:"scalar",T:7},{no:8,name:"timestamp_millis_adjust",kind:"scalar",T:5},{no:9,name:"altitude_hae",kind:"scalar",T:17},{no:10,name:"altitude_geoidal_separation",kind:"scalar",T:17},{no:11,name:"PDOP",kind:"scalar",T:13},{no:12,name:"HDOP",kind:"scalar",T:13},{no:13,name:"VDOP",kind:"scalar",T:13},{no:14,name:"gps_accuracy",kind:"scalar",T:13},{no:15,name:"ground_speed",kind:"scalar",T:13},{no:16,name:"ground_track",kind:"scalar",T:13},{no:17,name:"fix_quality",kind:"scalar",T:13},{no:18,name:"fix_type",kind:"scalar",T:13},{no:19,name:"sats_in_view",kind:"scalar",T:13},{no:20,name:"sensor_id",kind:"scalar",T:13},{no:21,name:"next_update",kind:"scalar",T:13},{no:22,name:"seq_number",kind:"scalar",T:13}]),bD=ht.makeEnum("meshtastic.Position.LocSource",[{no:0,name:"LOC_UNSET"},{no:1,name:"LOC_MANUAL"},{no:2,name:"LOC_INTERNAL"},{no:3,name:"LOC_EXTERNAL"}]),wD=ht.makeEnum("meshtastic.Position.AltSource",[{no:0,name:"ALT_UNSET"},{no:1,name:"ALT_MANUAL"},{no:2,name:"ALT_INTERNAL"},{no:3,name:"ALT_EXTERNAL"},{no:4,name:"ALT_BAROMETRIC"}]),pf=ht.makeMessageType("meshtastic.User",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"long_name",kind:"scalar",T:9},{no:3,name:"short_name",kind:"scalar",T:9},{no:4,name:"macaddr",kind:"scalar",T:12},{no:5,name:"hw_model",kind:"enum",T:ht.getEnumType(_x)},{no:6,name:"is_licensed",kind:"scalar",T:8}]),w_=ht.makeMessageType("meshtastic.RouteDiscovery",()=>[{no:1,name:"route",kind:"scalar",T:7,repeated:!0}]),ED=ht.makeMessageType("meshtastic.Routing",()=>[{no:1,name:"route_request",kind:"message",T:w_,oneof:"variant"},{no:2,name:"route_reply",kind:"message",T:w_,oneof:"variant"},{no:3,name:"error_reason",kind:"enum",T:ht.getEnumType(U0),oneof:"variant"}]),U0=ht.makeEnum("meshtastic.Routing.Error",[{no:0,name:"NONE"},{no:1,name:"NO_ROUTE"},{no:2,name:"GOT_NAK"},{no:3,name:"TIMEOUT"},{no:4,name:"NO_INTERFACE"},{no:5,name:"MAX_RETRANSMIT"},{no:6,name:"NO_CHANNEL"},{no:7,name:"TOO_LARGE"},{no:8,name:"NO_RESPONSE"},{no:9,name:"DUTY_CYCLE_LIMIT"},{no:32,name:"BAD_REQUEST"},{no:33,name:"NOT_AUTHORIZED"}]),TD=ht.makeMessageType("meshtastic.Data",()=>[{no:1,name:"portnum",kind:"enum",T:ht.getEnumType(gn)},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"want_response",kind:"scalar",T:8},{no:4,name:"dest",kind:"scalar",T:7},{no:5,name:"source",kind:"scalar",T:7},{no:6,name:"request_id",kind:"scalar",T:7},{no:7,name:"reply_id",kind:"scalar",T:7},{no:8,name:"emoji",kind:"scalar",T:7}]),SD=ht.makeMessageType("meshtastic.Waypoint",()=>[{no:1,name:"id",kind:"scalar",T:13},{no:2,name:"latitude_i",kind:"scalar",T:15},{no:3,name:"longitude_i",kind:"scalar",T:15},{no:4,name:"expire",kind:"scalar",T:13},{no:5,name:"locked_to",kind:"scalar",T:13},{no:6,name:"name",kind:"scalar",T:9},{no:7,name:"description",kind:"scalar",T:9},{no:8,name:"icon",kind:"scalar",T:7}]),xx=ht.makeMessageType("meshtastic.MeshPacket",()=>[{no:1,name:"from",kind:"scalar",T:7},{no:2,name:"to",kind:"scalar",T:7},{no:3,name:"channel",kind:"scalar",T:13},{no:4,name:"decoded",kind:"message",T:TD,oneof:"payload_variant"},{no:5,name:"encrypted",kind:"scalar",T:12,oneof:"payload_variant"},{no:6,name:"id",kind:"scalar",T:7},{no:7,name:"rx_time",kind:"scalar",T:7},{no:8,name:"rx_snr",kind:"scalar",T:2},{no:9,name:"hop_limit",kind:"scalar",T:13},{no:10,name:"want_ack",kind:"scalar",T:8},{no:11,name:"priority",kind:"enum",T:ht.getEnumType(kD)},{no:12,name:"rx_rssi",kind:"scalar",T:5},{no:13,name:"delayed",kind:"enum",T:ht.getEnumType(CD)}]),kD=ht.makeEnum("meshtastic.MeshPacket.Priority",[{no:0,name:"UNSET"},{no:1,name:"MIN"},{no:10,name:"BACKGROUND"},{no:64,name:"DEFAULT"},{no:70,name:"RELIABLE"},{no:120,name:"ACK"},{no:127,name:"MAX"}]),CD=ht.makeEnum("meshtastic.MeshPacket.Delayed",[{no:0,name:"NO_DELAY"},{no:1,name:"DELAYED_BROADCAST"},{no:2,name:"DELAYED_DIRECT"}]),Em=ht.makeMessageType("meshtastic.NodeInfo",()=>[{no:1,name:"num",kind:"scalar",T:13},{no:2,name:"user",kind:"message",T:pf},{no:3,name:"position",kind:"message",T:HC},{no:4,name:"snr",kind:"scalar",T:2},{no:5,name:"last_heard",kind:"scalar",T:7},{no:6,name:"device_metrics",kind:"message",T:_C}]),bx=ht.makeMessageType("meshtastic.MyNodeInfo",()=>[{no:1,name:"my_node_num",kind:"scalar",T:13},{no:2,name:"has_gps",kind:"scalar",T:8},{no:3,name:"max_channels",kind:"scalar",T:13},{no:4,name:"firmware_version",kind:"scalar",T:9},{no:5,name:"error_code",kind:"enum",T:ht.getEnumType(xD)},{no:6,name:"error_address",kind:"scalar",T:13},{no:7,name:"error_count",kind:"scalar",T:13},{no:8,name:"reboot_count",kind:"scalar",T:13},{no:9,name:"bitrate",kind:"scalar",T:2},{no:10,name:"message_timeout_msec",kind:"scalar",T:13},{no:11,name:"min_app_version",kind:"scalar",T:13},{no:12,name:"air_period_tx",kind:"scalar",T:13,repeated:!0},{no:13,name:"air_period_rx",kind:"scalar",T:13,repeated:!0},{no:14,name:"has_wifi",kind:"scalar",T:8},{no:15,name:"channel_utilization",kind:"scalar",T:2},{no:16,name:"air_util_tx",kind:"scalar",T:2}]),PD=ht.makeMessageType("meshtastic.LogRecord",()=>[{no:1,name:"message",kind:"scalar",T:9},{no:2,name:"time",kind:"scalar",T:7},{no:3,name:"source",kind:"scalar",T:9},{no:4,name:"level",kind:"enum",T:ht.getEnumType(ZC)}]),ZC=ht.makeEnum("meshtastic.LogRecord.Level",[{no:0,name:"UNSET"},{no:50,name:"CRITICAL"},{no:40,name:"ERROR"},{no:30,name:"WARNING"},{no:20,name:"INFO"},{no:10,name:"DEBUG"},{no:5,name:"TRACE"}]),AD=ht.makeMessageType("meshtastic.QueueStatus",()=>[{no:1,name:"res",kind:"scalar",T:5},{no:2,name:"free",kind:"scalar",T:13},{no:3,name:"maxlen",kind:"scalar",T:13},{no:4,name:"mesh_packet_id",kind:"scalar",T:13}]),ID=ht.makeMessageType("meshtastic.FromRadio",()=>[{no:1,name:"id",kind:"scalar",T:13},{no:2,name:"packet",kind:"message",T:xx,oneof:"payload_variant"},{no:3,name:"my_info",kind:"message",T:bx,oneof:"payload_variant"},{no:4,name:"node_info",kind:"message",T:Em,oneof:"payload_variant"},{no:5,name:"config",kind:"message",T:ba,oneof:"payload_variant"},{no:6,name:"log_record",kind:"message",T:PD,oneof:"payload_variant"},{no:7,name:"config_complete_id",kind:"scalar",T:13,oneof:"payload_variant"},{no:8,name:"rebooted",kind:"scalar",T:8,oneof:"payload_variant"},{no:9,name:"moduleConfig",kind:"message",T:wa,oneof:"payload_variant"},{no:10,name:"channel",kind:"message",T:fd,oneof:"payload_variant"},{no:11,name:"queueStatus",kind:"message",T:AD,oneof:"payload_variant"},{no:12,name:"xmodemPacket",kind:"message",T:WC,oneof:"payload_variant"},{no:13,name:"metadata",kind:"message",T:KC,oneof:"payload_variant"}]),E_=ht.makeMessageType("meshtastic.ToRadio",()=>[{no:1,name:"packet",kind:"message",T:xx,oneof:"payload_variant"},{no:3,name:"want_config_id",kind:"scalar",T:13,oneof:"payload_variant"},{no:4,name:"disconnect",kind:"scalar",T:8,oneof:"payload_variant"},{no:5,name:"xmodemPacket",kind:"message",T:WC,oneof:"payload_variant"}]);ht.makeMessageType("meshtastic.Compressed",()=>[{no:1,name:"portnum",kind:"enum",T:ht.getEnumType(gn)},{no:2,name:"data",kind:"scalar",T:12}]);const KC=ht.makeMessageType("meshtastic.DeviceMetadata",()=>[{no:1,name:"firmware_version",kind:"scalar",T:9},{no:2,name:"device_state_version",kind:"scalar",T:13},{no:3,name:"canShutdown",kind:"scalar",T:8},{no:4,name:"hasWifi",kind:"scalar",T:8},{no:5,name:"hasBluetooth",kind:"scalar",T:8},{no:6,name:"hasEthernet",kind:"scalar",T:8},{no:7,name:"role",kind:"enum",T:ht.getEnumType(yx)},{no:8,name:"position_flags",kind:"scalar",T:13},{no:9,name:"hw_model",kind:"enum",T:ht.getEnumType(_x)}]),MD=ht.makeMessageType("meshtastic.DeviceConnectionStatus",()=>[{no:1,name:"wifi",kind:"message",T:DD,opt:!0},{no:2,name:"ethernet",kind:"message",T:RD,opt:!0},{no:3,name:"bluetooth",kind:"message",T:LD,opt:!0},{no:4,name:"serial",kind:"message",T:ND,opt:!0}]),DD=ht.makeMessageType("meshtastic.WifiConnectionStatus",()=>[{no:1,name:"status",kind:"message",T:XC},{no:2,name:"ssid",kind:"scalar",T:9},{no:3,name:"rssi",kind:"scalar",T:5}]),RD=ht.makeMessageType("meshtastic.EthernetConnectionStatus",()=>[{no:1,name:"status",kind:"message",T:XC}]),XC=ht.makeMessageType("meshtastic.NetworkConnectionStatus",()=>[{no:1,name:"ip_address",kind:"scalar",T:7},{no:2,name:"is_connected",kind:"scalar",T:8},{no:3,name:"is_mqtt_connected",kind:"scalar",T:8},{no:4,name:"is_syslog_connected",kind:"scalar",T:8}]),LD=ht.makeMessageType("meshtastic.BluetoothConnectionStatus",()=>[{no:1,name:"pin",kind:"scalar",T:13},{no:2,name:"rssi",kind:"scalar",T:5},{no:3,name:"is_connected",kind:"scalar",T:8}]),ND=ht.makeMessageType("meshtastic.SerialConnectionStatus",()=>[{no:1,name:"baud",kind:"scalar",T:13},{no:2,name:"is_connected",kind:"scalar",T:8}]),di=ht.makeMessageType("meshtastic.AdminMessage",()=>[{no:1,name:"get_channel_request",kind:"scalar",T:13,oneof:"payload_variant"},{no:2,name:"get_channel_response",kind:"message",T:fd,oneof:"payload_variant"},{no:3,name:"get_owner_request",kind:"scalar",T:8,oneof:"payload_variant"},{no:4,name:"get_owner_response",kind:"message",T:pf,oneof:"payload_variant"},{no:5,name:"get_config_request",kind:"enum",T:ht.getEnumType(OD),oneof:"payload_variant"},{no:6,name:"get_config_response",kind:"message",T:ba,oneof:"payload_variant"},{no:7,name:"get_module_config_request",kind:"enum",T:ht.getEnumType($D),oneof:"payload_variant"},{no:8,name:"get_module_config_response",kind:"message",T:wa,oneof:"payload_variant"},{no:10,name:"get_canned_message_module_messages_request",kind:"scalar",T:8,oneof:"payload_variant"},{no:11,name:"get_canned_message_module_messages_response",kind:"scalar",T:9,oneof:"payload_variant"},{no:12,name:"get_device_metadata_request",kind:"scalar",T:8,oneof:"payload_variant"},{no:13,name:"get_device_metadata_response",kind:"message",T:KC,oneof:"payload_variant"},{no:14,name:"get_ringtone_request",kind:"scalar",T:8,oneof:"payload_variant"},{no:15,name:"get_ringtone_response",kind:"scalar",T:9,oneof:"payload_variant"},{no:16,name:"get_device_connection_status_request",kind:"scalar",T:8,oneof:"payload_variant"},{no:17,name:"get_device_connection_status_response",kind:"message",T:MD,oneof:"payload_variant"},{no:18,name:"set_ham_mode",kind:"message",T:zD,oneof:"payload_variant"},{no:32,name:"set_owner",kind:"message",T:pf,oneof:"payload_variant"},{no:33,name:"set_channel",kind:"message",T:fd,oneof:"payload_variant"},{no:34,name:"set_config",kind:"message",T:ba,oneof:"payload_variant"},{no:35,name:"set_module_config",kind:"message",T:wa,oneof:"payload_variant"},{no:36,name:"set_canned_message_module_messages",kind:"scalar",T:9,oneof:"payload_variant"},{no:37,name:"set_ringtone_message",kind:"scalar",T:9,oneof:"payload_variant"},{no:64,name:"begin_edit_settings",kind:"scalar",T:8,oneof:"payload_variant"},{no:65,name:"commit_edit_settings",kind:"scalar",T:8,oneof:"payload_variant"},{no:95,name:"reboot_ota_seconds",kind:"scalar",T:5,oneof:"payload_variant"},{no:96,name:"exit_simulator",kind:"scalar",T:8,oneof:"payload_variant"},{no:97,name:"reboot_seconds",kind:"scalar",T:5,oneof:"payload_variant"},{no:98,name:"shutdown_seconds",kind:"scalar",T:5,oneof:"payload_variant"},{no:99,name:"factory_reset",kind:"scalar",T:5,oneof:"payload_variant"},{no:100,name:"nodedb_reset",kind:"scalar",T:5,oneof:"payload_variant"}]),OD=ht.makeEnum("meshtastic.AdminMessage.ConfigType",[{no:0,name:"DEVICE_CONFIG"},{no:1,name:"POSITION_CONFIG"},{no:2,name:"POWER_CONFIG"},{no:3,name:"NETWORK_CONFIG"},{no:4,name:"DISPLAY_CONFIG"},{no:5,name:"LORA_CONFIG"},{no:6,name:"BLUETOOTH_CONFIG"}]),$D=ht.makeEnum("meshtastic.AdminMessage.ModuleConfigType",[{no:0,name:"MQTT_CONFIG"},{no:1,name:"SERIAL_CONFIG"},{no:2,name:"EXTNOTIF_CONFIG"},{no:3,name:"STOREFORWARD_CONFIG"},{no:4,name:"RANGETEST_CONFIG"},{no:5,name:"TELEMETRY_CONFIG"},{no:6,name:"CANNEDMSG_CONFIG"},{no:7,name:"AUDIO_CONFIG"},{no:8,name:"REMOTEHARDWARE_CONFIG"}]),zD=ht.makeMessageType("meshtastic.HamParameters",()=>[{no:1,name:"call_sign",kind:"scalar",T:9},{no:2,name:"tx_power",kind:"scalar",T:5},{no:3,name:"frequency",kind:"scalar",T:2},{no:4,name:"short_name",kind:"scalar",T:9}]),T_=ht.makeMessageType("meshtastic.ChannelSet",()=>[{no:1,name:"settings",kind:"message",T:vC,repeated:!0},{no:2,name:"lora_config",kind:"message",T:vx}]),BD=ht.makeMessageType("meshtastic.LocalConfig",()=>[{no:1,name:"device",kind:"message",T:xC},{no:2,name:"position",kind:"message",T:wC},{no:3,name:"power",kind:"message",T:EC},{no:4,name:"network",kind:"message",T:TC},{no:5,name:"display",kind:"message",T:kC},{no:6,name:"lora",kind:"message",T:vx},{no:7,name:"bluetooth",kind:"message",T:RC},{no:8,name:"version",kind:"scalar",T:13}]),FD=ht.makeMessageType("meshtastic.LocalModuleConfig",()=>[{no:1,name:"mqtt",kind:"message",T:LC},{no:2,name:"serial",kind:"message",T:zC},{no:3,name:"external_notification",kind:"message",T:UC},{no:4,name:"store_forward",kind:"message",T:VC},{no:5,name:"range_test",kind:"message",T:jC},{no:6,name:"telemetry",kind:"message",T:GC},{no:7,name:"canned_message",kind:"message",T:qC},{no:9,name:"audio",kind:"message",T:OC},{no:10,name:"remote_hardware",kind:"message",T:NC},{no:8,name:"version",kind:"scalar",T:13}]),UD=ht.makeMessageType("meshtastic.HardwareMessage",()=>[{no:1,name:"type",kind:"enum",T:ht.getEnumType(VD)},{no:2,name:"gpio_mask",kind:"scalar",T:4},{no:3,name:"gpio_value",kind:"scalar",T:4}]),VD=ht.makeEnum("meshtastic.HardwareMessage.Type",[{no:0,name:"UNSET"},{no:1,name:"WRITE_GPIOS"},{no:2,name:"WATCH_GPIOS"},{no:3,name:"GPIOS_CHANGED"},{no:4,name:"READ_GPIOS"},{no:5,name:"READ_GPIOS_REPLY"}]);var or;(function(e){e[e.DEVICE_RESTARTING=0]="DEVICE_RESTARTING",e[e.DEVICE_DISCONNECTED=1]="DEVICE_DISCONNECTED",e[e.DEVICE_CONNECTING=2]="DEVICE_CONNECTING",e[e.DEVICE_RECONNECTING=3]="DEVICE_RECONNECTING",e[e.DEVICE_CONNECTED=4]="DEVICE_CONNECTED",e[e.DEVICE_CONFIGURING=5]="DEVICE_CONFIGURING",e[e.DEVICE_CONFIGURED=6]="DEVICE_CONFIGURED"})(or||(or={}));var i0;(function(e){e[e.iMeshDevice=0]="iMeshDevice",e[e.iSerialConnection=1]="iSerialConnection",e[e.iNodeSerialConnection=2]="iNodeSerialConnection",e[e.iBleConnection=3]="iBleConnection",e[e.iHttpConnection=4]="iHttpConnection"})(i0||(i0={}));var mt;(function(e){e[e.constructor=0]="constructor",e[e.sendText=1]="sendText",e[e.sendWaypoint=2]="sendWaypoint",e[e.sendPacket=3]="sendPacket",e[e.sendRaw=4]="sendRaw",e[e.setConfig=5]="setConfig",e[e.setModuleConfig=6]="setModuleConfig",e[e.confirmSetConfig=7]="confirmSetConfig",e[e.setOwner=8]="setOwner",e[e.setChannel=9]="setChannel",e[e.confirmSetChannel=10]="confirmSetChannel",e[e.clearChannel=11]="clearChannel",e[e.getChannel=12]="getChannel",e[e.getAllChannels=13]="getAllChannels",e[e.getConfig=14]="getConfig",e[e.getModuleConfig=15]="getModuleConfig",e[e.getOwner=16]="getOwner",e[e.configure=17]="configure",e[e.handleFromRadio=18]="handleFromRadio",e[e.handleMeshPacket=19]="handleMeshPacket",e[e.connect=20]="connect",e[e.ping=21]="ping",e[e.readFromRadio=22]="readFromRadio",e[e.writeToRadio=23]="writeToRadio",e[e.setDebugMode=24]="setDebugMode",e[e.getMetadata=25]="getMetadata",e[e.resetPeers=26]="resetPeers",e[e.shutdown=27]="shutdown",e[e.reboot=28]="reboot",e[e.rebootOTA=29]="rebootOTA",e[e.factoryReset=30]="factoryReset"})(mt||(mt={}));var ks;(function(e){e[e.PRIMARY=0]="PRIMARY",e[e.CHANNEL1=1]="CHANNEL1",e[e.CHANNEL2=2]="CHANNEL2",e[e.CHANNEL3=3]="CHANNEL3",e[e.CHANNEL4=4]="CHANNEL4",e[e.CHANNEL5=5]="CHANNEL5",e[e.CHANNEL6=6]="CHANNEL6",e[e.ADMIN=7]="ADMIN"})(ks||(ks={}));const Uc=Zk((e,t)=>({devices:new Map,remoteDevices:new Map,addDevice:n=>{e(Vn(c=>{c.devices.set(n,{id:n,status:or.DEVICE_DISCONNECTED,channels:new Map,config:new BD,moduleConfig:new FD,workingConfig:[],workingModuleConfig:[],hardware:new bx,nodes:new Map,metadata:new Map,messages:{direct:new Map,broadcast:new Map},connection:void 0,activePage:"messages",activePeer:0,waypoints:[],dialog:{import:!1,QR:!1,shutdown:!1,reboot:!1,deviceName:!1},pendingSettingsChanges:!1,messageDraft:"",setStatus:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.status=d)}))},setConfig:d=>{e(Vn(p=>{const s=p.devices.get(n);if(s)switch(d.payloadVariant.case){case"device":s.config.device=d.payloadVariant.value;break;case"position":s.config.position=d.payloadVariant.value;break;case"power":s.config.power=d.payloadVariant.value;break;case"network":s.config.network=d.payloadVariant.value;break;case"display":s.config.display=d.payloadVariant.value;break;case"lora":s.config.lora=d.payloadVariant.value;break;case"bluetooth":s.config.bluetooth=d.payloadVariant.value;break}}))},setModuleConfig:d=>{e(Vn(p=>{const s=p.devices.get(n);if(s)switch(d.payloadVariant.case){case"mqtt":s.moduleConfig.mqtt=d.payloadVariant.value;break;case"serial":s.moduleConfig.serial=d.payloadVariant.value;break;case"externalNotification":s.moduleConfig.externalNotification=d.payloadVariant.value;break;case"storeForward":s.moduleConfig.storeForward=d.payloadVariant.value;break;case"rangeTest":s.moduleConfig.rangeTest=d.payloadVariant.value;break;case"telemetry":s.moduleConfig.telemetry=d.payloadVariant.value;break;case"cannedMessage":s.moduleConfig.cannedMessage=d.payloadVariant.value;break;case"audio":s.moduleConfig.audio=d.payloadVariant.value}}))},setWorkingConfig:d=>{e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s?.workingConfig.findIndex(v=>v.payloadVariant.case===d.payloadVariant.case);_!==-1?s.workingConfig[_]=d:s?.workingConfig.push(d)}))},setWorkingModuleConfig:d=>{e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s?.workingModuleConfig.findIndex(v=>v.payloadVariant.case===d.payloadVariant.case);_!==-1?s.workingModuleConfig[_]=d:s?.workingModuleConfig.push(d)}))},setHardware:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.hardware=d)}))},setActivePage:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.activePage=d)}))},setPendingSettingsChanges:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.pendingSettingsChanges=d)}))},addChannel:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&s.channels.set(d.index,d)}))},addWaypoint:d=>{e(Vn(p=>{const s=p.devices.get(n);if(s){const _=s.waypoints.findIndex(v=>v.id===d.id);_!==-1?s.waypoints[_]=d:s.waypoints.push(d)}}))},addNodeInfo:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&s.nodes.set(d.num,d)}))},setActivePeer:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.activePeer=d)}))},addUser:d=>{e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s.nodes.get(d.from)??new Em;_.user=d.data,s.nodes.set(d.from,_)}))},addPosition:d=>{e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s.nodes.get(d.from)??new Em;_.position=d.data,s.nodes.set(d.from,_)}))},addConnection:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.connection=d)}))},addMessage:d=>{e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s.messages[d.type],v=d.type==="direct"?d.from===s.hardware.myNodeNum?d.to:d.from:d.channel,E=_.get(v);E?(E.push(d),_.set(v,E)):_.set(v,[d])}))},addMetadata:(d,p)=>{e(Vn(s=>{const _=s.devices.get(n);_&&_.metadata.set(d,p)}))},setMessageState:(d,p,s,_,v,E)=>{e(Vn(T=>{console.log("setMessageState called");const S=T.devices.get(n);if(!S){console.log("no device found for id");return}const D=S.messages[d],O=d==="direct"?_===S.hardware.myNodeNum?s:_:p,M=D.get(O);if(!M){console.log("no messages found for id");return}D.set(O,M.map(U=>(U.id===v&&(U.state=E),U)))}))},setDialogOpen:(d,p)=>{e(Vn(s=>{const _=s.devices.get(n);_&&(_.dialog[d]=p)}))},processPacket(d){e(Vn(p=>{const s=p.devices.get(n);if(!s)return;const _=s.nodes.get(d.from);_?s.nodes.set(d.from,{..._,lastHeard:d.time,snr:d.snr}):s.nodes.set(d.from,new Em({num:d.from,lastHeard:d.time,snr:d.snr}))}))},setMessageDraft:d=>{e(Vn(p=>{const s=p.devices.get(n);s&&(s.messageDraft=d)}))}})}));const o=t().devices.get(n);if(!o)throw new Error("Device not found");return o},removeDevice:n=>{e(Vn(o=>{o.devices.delete(n)}))},getDevices:()=>Array.from(t().devices.values()),getDevice:n=>t().devices.get(n)})),YC=P.createContext(void 0),In=()=>{const e=P.useContext(YC);if(e===void 0)throw new Error("useDevice must be used within a DeviceProvider");return e},jD=({children:e,device:t})=>re(YC.Provider,{value:t,children:e});var GD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const qD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),nn=(e,t)=>{const n=P.forwardRef(({color:o="currentColor",size:c=24,strokeWidth:d=2,children:p,...s},_)=>P.createElement("svg",{ref:_,...GD,width:c,height:c,stroke:o,strokeWidth:d,className:`lucide lucide-${qD(e)}`,...s},[...t.map(([v,E])=>P.createElement(v,E)),...(Array.isArray(p)?p:[p])||[]]));return n.displayName=`${e}`,n},yE=nn("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",y1:"8",x2:"12",y2:"12",key:"1grbh0"}],["line",{x1:"12",y1:"16",x2:"12.01",y2:"16",key:"1w440g"}]]),WD=nn("AlignLeft",[["line",{x1:"21",y1:"6",x2:"3",y2:"6",key:"1e448z"}],["line",{x1:"15",y1:"12",x2:"3",y2:"12",key:"80e4vw"}],["line",{x1:"17",y1:"18",x2:"3",y2:"18",key:"1771gn"}]]),HD=nn("ArrowLeftRight",[["polyline",{points:"17 11 21 7 17 3",key:"l3l6r3"}],["line",{x1:"21",y1:"7",x2:"9",y2:"7",key:"17x2jj"}],["polyline",{points:"7 21 3 17 7 13",key:"lfumnw"}],["line",{x1:"15",y1:"17",x2:"3",y2:"17",key:"gusd5o"}]]),ZD=nn("Bluetooth",[["path",{d:"m7 7 10 10-5 5V2l5 5L7 17",key:"1q5490"}]]),JC=nn("BoxSelect",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]),KD=nn("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]),XD=nn("Bug",[["rect",{width:"8",height:"14",x:"8",y:"6",rx:"4",key:"hq8nra"}],["path",{d:"m19 7-3 2",key:"fmg8ec"}],["path",{d:"m5 7 3 2",key:"dkxqes"}],["path",{d:"m19 19-3-2",key:"1hbhi4"}],["path",{d:"m5 19 3-2",key:"dvt2ee"}],["path",{d:"M20 13h-4",key:"1agfp2"}],["path",{d:"M4 13h4",key:"1bwh8b"}],["path",{d:"m10 4 1 2",key:"1pot59"}],["path",{d:"m14 4-1 2",key:"m8sn0o"}]]),vE=nn("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),QC=nn("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),YD=nn("ChevronDown",[["polyline",{points:"6 9 12 15 18 9",key:"1do0m2"}]]),JD=nn("ChevronUp",[["polyline",{points:"18 15 12 9 6 15",key:"1uugdp"}]]),_E=nn("CircleEllipsis",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M7 12h.01",key:"eqddd0"}]]),QD=nn("Clipboard",[["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",ry:"1",key:"wz2j3u"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),e3=nn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),eR=nn("Edit",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z",key:"1cs3r3"}]]),tR=nn("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]),nR=nn("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]),rR=nn("Hash",[["line",{x1:"4",y1:"9",x2:"20",y2:"9",key:"vg9vz1"}],["line",{x1:"4",y1:"15",x2:"20",y2:"15",key:"12vs86"}],["line",{x1:"10",y1:"3",x2:"8",y2:"21",key:"18wc2u"}],["line",{x1:"16",y1:"3",x2:"14",y2:"21",key:"ohqwl5"}]]),iR=nn("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),oR=nn("Import",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]]),aR=nn("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]),sR=nn("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]),t3=nn("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),lR=nn("Layout",[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2",key:"maln0c"}],["line",{x1:"3",y1:"9",x2:"21",y2:"9",key:"1uch6j"}],["line",{x1:"9",y1:"21",x2:"9",y2:"9",key:"97zt75"}]]),cR=nn("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),uR=nn("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]),dR=nn("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),n3=nn("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",y1:"3",x2:"9",y2:"18",key:"3zqglt"}],["line",{x1:"15",y1:"6",x2:"15",y2:"21",key:"1c9xoo"}]]),r3=nn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),i3=nn("Moon",[["path",{d:"M12 3a6.364 6.364 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"1rit1i"}]]),hR=nn("Network",[["rect",{x:"9",y:"2",width:"6",height:"6",key:"1iwon9"}],["rect",{x:"16",y:"16",width:"6",height:"6",key:"gonbwd"}],["rect",{x:"2",y:"16",width:"6",height:"6",key:"1q0lzr"}],["path",{d:"M5 16v-4h14v4",key:"8njgxx"}],["path",{d:"M12 12V8",key:"2874zd"}]]),fR=nn("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),wx=nn("Plus",[["line",{x1:"12",y1:"5",x2:"12",y2:"19",key:"myz83a"}],["line",{x1:"5",y1:"12",x2:"19",y2:"12",key:"1smlys"}]]),o3=nn("Power",[["path",{d:"M18.36 6.64a9 9 0 1 1-12.73 0",key:"phirl6"}],["line",{x1:"12",y1:"2",x2:"12",y2:"12",key:"1d1p48"}]]),Tm=nn("QrCode",[["rect",{x:"3",y:"3",width:"5",height:"5",rx:"1",key:"fue5ao"}],["rect",{x:"16",y:"3",width:"5",height:"5",rx:"1",key:"1narh3"}],["rect",{x:"3",y:"16",width:"5",height:"5",rx:"1",key:"1ovwlo"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),S_=nn("RefreshCw",[["path",{d:"M21 2v6h-6",key:"1lwg0q"}],["path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8",key:"vaktt2"}],["path",{d:"M3 22v-6h6",key:"6llvyv"}],["path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16",key:"i52hsp"}]]),pR=nn("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),mR=nn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65",key:"1p50m8"}]]),gR=nn("Send",[["line",{x1:"22",y1:"2",x2:"11",y2:"13",key:"10auo0"}],["polygon",{points:"22 2 15 22 11 13 2 9 22 2",key:"12uapv"}]]),Ex=nn("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),yR=nn("Smartphone",[["rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2",key:"1gcc4z"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),vR=nn("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),_R=nn("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",y1:"19",x2:"20",y2:"19",key:"fyyrwq"}]]),xR=nn("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),bR=nn("Usb",[["circle",{cx:"4",cy:"20",r:"1",key:"22iqad"}],["circle",{cx:"10",cy:"7",r:"1",key:"dypaad"}],["path",{d:"M4 20 19 5",key:"15hogs"}],["path",{d:"m21 3-3 1 2 2 1-3Z",key:"ew8vct"}],["path",{d:"m10 7-5 5 2 5",key:"148pqf"}],["path",{d:"m10 14 5 2 4-4",key:"1ivjwr"}],["path",{d:"m18 12 1-1 1 1-1 1-1-1Z",key:"tus6kn"}]]),Tx=nn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),wR=nn("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"15",y1:"9",x2:"9",y2:"15",key:"19zs77"}],["line",{x1:"9",y1:"9",x2:"15",y2:"15",key:"10u9bu"}]]),a3=nn("X",[["line",{x1:"18",y1:"6",x2:"6",y2:"18",key:"1o5bob"}],["line",{x1:"6",y1:"6",x2:"18",y2:"18",key:"z4dcbv"}]]),ER=nn("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65",key:"1p50m8"}],["line",{x1:"11",y1:"8",x2:"11",y2:"14",key:"jw7mvq"}],["line",{x1:"8",y1:"11",x2:"14",y2:"11",key:"1nivud"}]]),TR=nn("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65",key:"1p50m8"}],["line",{x1:"8",y1:"11",x2:"14",y2:"11",key:"1nivud"}]]);function s3(e){var t,n,o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=s3(e[t]))&&(o&&(o+=" "),o+=n);else for(t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function SR(){for(var e,t,n=0,o="";n<arguments.length;)(e=arguments[n++])&&(t=s3(e))&&(o&&(o+=" "),o+=t);return o}function kR(){for(var e=0,t,n,o="";e<arguments.length;)(t=arguments[e++])&&(n=l3(t))&&(o&&(o+=" "),o+=n);return o}function l3(e){if(typeof e=="string")return e;for(var t,n="",o=0;o<e.length;o++)e[o]&&(t=l3(e[o]))&&(n&&(n+=" "),n+=t);return n}function k_(){return k_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},k_.apply(this,arguments)}var Sx="-";function CR(e){var t=AR(e);function n(c){var d=c.split(Sx);return d[0]===""&&d.length!==1&&d.shift(),c3(d,t)||PR(c)}function o(c){return e.conflictingClassGroups[c]||[]}return{getClassGroupId:n,getConflictingClassGroupIds:o}}function c3(e,t){var n;if(e.length===0)return t.classGroupId;var o=e[0],c=t.nextPart.get(o),d=c?c3(e.slice(1),c):void 0;if(d)return d;if(t.validators.length!==0){var p=e.join(Sx);return(n=t.validators.find(function(s){var _=s.validator;return _(p)}))==null?void 0:n.classGroupId}}var xE=/^\[(.+)\]$/;function PR(e){if(xE.test(e)){var t=xE.exec(e)[1],n=t?.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}}function AR(e){var t=e.theme,n=e.prefix,o={nextPart:new Map,validators:[]},c=MR(Object.entries(e.classGroups),n);return c.forEach(function(d){var p=d[0],s=d[1];C_(s,o,p,t)}),o}function C_(e,t,n,o){e.forEach(function(c){if(typeof c=="string"){var d=c===""?t:bE(t,c);d.classGroupId=n;return}if(typeof c=="function"){if(IR(c)){C_(c(o),t,n,o);return}t.validators.push({validator:c,classGroupId:n});return}Object.entries(c).forEach(function(p){var s=p[0],_=p[1];C_(_,bE(t,s),n,o)})})}function bE(e,t){var n=e;return t.split(Sx).forEach(function(o){n.nextPart.has(o)||n.nextPart.set(o,{nextPart:new Map,validators:[]}),n=n.nextPart.get(o)}),n}function IR(e){return e.isThemeGetter}function MR(e,t){return t?e.map(function(n){var o=n[0],c=n[1],d=c.map(function(p){return typeof p=="string"?t+p:typeof p=="object"?Object.fromEntries(Object.entries(p).map(function(s){var _=s[0],v=s[1];return[t+_,v]})):p});return[o,d]}):e}function DR(e){if(e<1)return{get:function(){},set:function(){}};var t=0,n=new Map,o=new Map;function c(d,p){n.set(d,p),t++,t>e&&(t=0,o=n,n=new Map)}return{get:function(p){var s=n.get(p);if(s!==void 0)return s;if((s=o.get(p))!==void 0)return c(p,s),s},set:function(p,s){n.has(p)?n.set(p,s):c(p,s)}}}var u3="!";function RR(e){var t=e.separator||":";return function(o){for(var c=0,d=[],p=0,s=0;s<o.length;s++){var _=o[s];c===0&&_===t[0]&&(t.length===1||o.slice(s,s+t.length)===t)&&(d.push(o.slice(p,s)),p=s+t.length),_==="["?c++:_==="]"&&c--}var v=d.length===0?o:o.substring(p),E=v.startsWith(u3),T=E?v.substring(1):v;return{modifiers:d,hasImportantModifier:E,baseClassName:T}}}function LR(e){if(e.length<=1)return e;var t=[],n=[];return e.forEach(function(o){var c=o[0]==="[";c?(t.push.apply(t,n.sort().concat([o])),n=[]):n.push(o)}),t.push.apply(t,n.sort()),t}function NR(e){return k_({cache:DR(e.cacheSize),splitModifiers:RR(e)},CR(e))}var OR=/\s+/;function $R(e,t){var n=t.splitModifiers,o=t.getClassGroupId,c=t.getConflictingClassGroupIds,d=new Set;return e.trim().split(OR).map(function(p){var s=n(p),_=s.modifiers,v=s.hasImportantModifier,E=s.baseClassName,T=o(E);if(!T)return{isTailwindClass:!1,originalClassName:p};var S=LR(_).join(":"),D=v?S+u3:S;return{isTailwindClass:!0,modifierId:D,classGroupId:T,originalClassName:p}}).reverse().filter(function(p){if(!p.isTailwindClass)return!0;var s=p.modifierId,_=p.classGroupId,v=s+_;return d.has(v)?!1:(d.add(v),c(_).forEach(function(E){return d.add(s+E)}),!0)}).reverse().map(function(p){return p.originalClassName}).join(" ")}function zR(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var o,c,d,p=s;function s(v){var E=t[0],T=t.slice(1),S=T.reduce(function(D,O){return O(D)},E());return o=NR(S),c=o.cache.get,d=o.cache.set,p=_,_(v)}function _(v){var E=c(v);if(E)return E;var T=$R(v,o);return d(v,T),T}return function(){return p(kR.apply(null,arguments))}}function yr(e){var t=function(o){return o[e]||[]};return t.isThemeGetter=!0,t}var d3=/^\[(?:([a-z-]+):)?(.+)\]$/i,BR=/^\d+\/\d+$/,FR=new Set(["px","full","screen"]),UR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,VR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))/,jR=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function ha(e){return Fh(e)||FR.has(e)||BR.test(e)||vc(e)}function vc(e){return Vc(e,"length",ZR)}function GR(e){return Vc(e,"size",h3)}function qR(e){return Vc(e,"position",h3)}function WR(e){return Vc(e,"url",KR)}function Uy(e){return Vc(e,"number",Fh)}function Fh(e){return!Number.isNaN(Number(e))}function xh(e){return wE(e)||Vc(e,"number",wE)}function Kr(e){return d3.test(e)}function bh(){return!0}function dl(e){return UR.test(e)}function HR(e){return Vc(e,"",XR)}function Vc(e,t,n){var o=d3.exec(e);return o?o[1]?o[1]===t:n(o[2]):!1}function ZR(e){return VR.test(e)}function h3(){return!1}function KR(e){return e.startsWith("url(")}function wE(e){return Number.isInteger(Number(e))}function XR(e){return jR.test(e)}function YR(){var e=yr("colors"),t=yr("spacing"),n=yr("blur"),o=yr("brightness"),c=yr("borderColor"),d=yr("borderRadius"),p=yr("borderSpacing"),s=yr("borderWidth"),_=yr("contrast"),v=yr("grayscale"),E=yr("hueRotate"),T=yr("invert"),S=yr("gap"),D=yr("gradientColorStops"),O=yr("inset"),M=yr("margin"),U=yr("opacity"),$=yr("padding"),L=yr("saturate"),F=yr("scale"),J=yr("sepia"),V=yr("skew"),Z=yr("space"),G=yr("translate"),W=function(){return["auto","contain","none"]},le=function(){return["auto","hidden","clip","visible","scroll"]},Ie=function(){return["auto",t]},be=function(){return["",ha]},de=function(){return["auto",Fh,Kr]},Ne=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},Ee=function(){return["solid","dashed","dotted","double","none"]},Oe=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},ze=function(){return["start","end","center","between","around","evenly"]},rt=function(){return["","0",Kr]},We=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},Ae=function(){return[Fh,Uy]},He=function(){return[Fh,Kr]};return{cacheSize:500,theme:{colors:[bh],spacing:[ha],blur:["none","",dl,vc],brightness:Ae(),borderColor:[e],borderRadius:["none","","full",dl,vc],borderSpacing:[t],borderWidth:be(),contrast:Ae(),grayscale:rt(),hueRotate:He(),invert:rt(),gap:[t],gradientColorStops:[e],inset:Ie(),margin:Ie(),opacity:Ae(),padding:[t],saturate:Ae(),scale:Ae(),sepia:rt(),skew:He(),space:[t],translate:[t]},classGroups:{aspect:[{aspect:["auto","square","video",Kr]}],container:["container"],columns:[{columns:[dl]}],"break-after":[{"break-after":We()}],"break-before":[{"break-before":We()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(Ne(),[Kr])}],overflow:[{overflow:le()}],"overflow-x":[{"overflow-x":le()}],"overflow-y":[{"overflow-y":le()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[O]}],"inset-x":[{"inset-x":[O]}],"inset-y":[{"inset-y":[O]}],top:[{top:[O]}],right:[{right:[O]}],bottom:[{bottom:[O]}],left:[{left:[O]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",xh]}],basis:[{basis:[t]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Kr]}],grow:[{grow:rt()}],shrink:[{shrink:rt()}],order:[{order:["first","last","none",xh]}],"grid-cols":[{"grid-cols":[bh]}],"col-start-end":[{col:["auto",{span:[xh]},Kr]}],"col-start":[{"col-start":de()}],"col-end":[{"col-end":de()}],"grid-rows":[{"grid-rows":[bh]}],"row-start-end":[{row:["auto",{span:[xh]},Kr]}],"row-start":[{"row-start":de()}],"row-end":[{"row-end":de()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Kr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Kr]}],gap:[{gap:[S]}],"gap-x":[{"gap-x":[S]}],"gap-y":[{"gap-y":[S]}],"justify-content":[{justify:ze()}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:[].concat(ze(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(ze(),["baseline","stretch"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[$]}],px:[{px:[$]}],py:[{py:[$]}],pt:[{pt:[$]}],pr:[{pr:[$]}],pb:[{pb:[$]}],pl:[{pl:[$]}],m:[{m:[M]}],mx:[{mx:[M]}],my:[{my:[M]}],mt:[{mt:[M]}],mr:[{mr:[M]}],mb:[{mb:[M]}],ml:[{ml:[M]}],"space-x":[{"space-x":[Z]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[Z]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",t]}],"min-w":[{"min-w":["min","max","fit",ha]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[dl]},dl,vc]}],h:[{h:[t,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",ha]}],"max-h":[{"max-h":[t,"min","max","fit"]}],"font-size":[{text:["base",dl,vc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Uy]}],"font-family":[{font:[bh]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",vc]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ha]}],"list-style-type":[{list:["none","disc","decimal",Kr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[U]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[U]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(Ee(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",ha]}],"underline-offset":[{"underline-offset":["auto",ha]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:[t]}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",vc]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap"]}],break:[{break:["normal","words","all","keep"]}],content:[{content:["none",Kr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[U]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(Ne(),[qR])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",GR]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},WR]}],"bg-color":[{bg:[e]}],"gradient-from":[{from:[D]}],"gradient-via":[{via:[D]}],"gradient-to":[{to:[D]}],rounded:[{rounded:[d]}],"rounded-t":[{"rounded-t":[d]}],"rounded-r":[{"rounded-r":[d]}],"rounded-b":[{"rounded-b":[d]}],"rounded-l":[{"rounded-l":[d]}],"rounded-tl":[{"rounded-tl":[d]}],"rounded-tr":[{"rounded-tr":[d]}],"rounded-br":[{"rounded-br":[d]}],"rounded-bl":[{"rounded-bl":[d]}],"border-w":[{border:[s]}],"border-w-x":[{"border-x":[s]}],"border-w-y":[{"border-y":[s]}],"border-w-t":[{"border-t":[s]}],"border-w-r":[{"border-r":[s]}],"border-w-b":[{"border-b":[s]}],"border-w-l":[{"border-l":[s]}],"border-opacity":[{"border-opacity":[U]}],"border-style":[{border:[].concat(Ee(),["hidden"])}],"divide-x":[{"divide-x":[s]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[s]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[U]}],"divide-style":[{divide:Ee()}],"border-color":[{border:[c]}],"border-color-x":[{"border-x":[c]}],"border-color-y":[{"border-y":[c]}],"border-color-t":[{"border-t":[c]}],"border-color-r":[{"border-r":[c]}],"border-color-b":[{"border-b":[c]}],"border-color-l":[{"border-l":[c]}],"divide-color":[{divide:[c]}],"outline-style":[{outline:[""].concat(Ee())}],"outline-offset":[{"outline-offset":[ha]}],"outline-w":[{outline:[ha]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:be()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[U]}],"ring-offset-w":[{"ring-offset":[ha]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",dl,HR]}],"shadow-color":[{shadow:[bh]}],opacity:[{opacity:[U]}],"mix-blend":[{"mix-blend":Oe()}],"bg-blend":[{"bg-blend":Oe()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[o]}],contrast:[{contrast:[_]}],"drop-shadow":[{"drop-shadow":["","none",dl,Kr]}],grayscale:[{grayscale:[v]}],"hue-rotate":[{"hue-rotate":[E]}],invert:[{invert:[T]}],saturate:[{saturate:[L]}],sepia:[{sepia:[J]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[o]}],"backdrop-contrast":[{"backdrop-contrast":[_]}],"backdrop-grayscale":[{"backdrop-grayscale":[v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[E]}],"backdrop-invert":[{"backdrop-invert":[T]}],"backdrop-opacity":[{"backdrop-opacity":[U]}],"backdrop-saturate":[{"backdrop-saturate":[L]}],"backdrop-sepia":[{"backdrop-sepia":[J]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[p]}],"border-spacing-x":[{"border-spacing-x":[p]}],"border-spacing-y":[{"border-spacing-y":[p]}],"table-layout":[{table:["auto","fixed"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Kr]}],duration:[{duration:He()}],ease:[{ease:["linear","in","out","in-out",Kr]}],delay:[{delay:He()}],animate:[{animate:["none","spin","ping","pulse","bounce",Kr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[F]}],"scale-x":[{"scale-x":[F]}],"scale-y":[{"scale-y":[F]}],rotate:[{rotate:[xh,Kr]}],"translate-x":[{"translate-x":[G]}],"translate-y":[{"translate-y":[G]}],"skew-x":[{"skew-x":[V]}],"skew-y":[{"skew-y":[V]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Kr]}],accent:[{accent:["auto",e]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Kr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":[t]}],"scroll-mx":[{"scroll-mx":[t]}],"scroll-my":[{"scroll-my":[t]}],"scroll-mt":[{"scroll-mt":[t]}],"scroll-mr":[{"scroll-mr":[t]}],"scroll-mb":[{"scroll-mb":[t]}],"scroll-ml":[{"scroll-ml":[t]}],"scroll-p":[{"scroll-p":[t]}],"scroll-px":[{"scroll-px":[t]}],"scroll-py":[{"scroll-py":[t]}],"scroll-pt":[{"scroll-pt":[t]}],"scroll-pr":[{"scroll-pr":[t]}],"scroll-pb":[{"scroll-pb":[t]}],"scroll-pl":[{"scroll-pl":[t]}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Kr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ha,Uy]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-t","rounded-r","rounded-b","rounded-l","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]}}}var JR=zR(YR);function En(...e){return JR(SR(e))}const Rl=({className:e,children:t})=>re("p",{className:En("text-sm text-slate-500 dark:text-slate-400",e),children:t}),f3=({className:e,children:t})=>re("h4",{className:En("scroll-m-20 text-xl font-semibold tracking-tight",e),children:t}),mf=({label:e,children:t})=>vt("div",{className:"px-4 py-2",children:[re(f3,{className:"mb-2 ml-2",children:e}),re("div",{className:"space-y-1",children:t})]}),EE=e=>typeof e=="boolean"?"".concat(e):e===0?"0":e,TE=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.flat(1/0).filter(Boolean).join(" ")},p3=(e,t)=>n=>{var o;if(t?.variants==null)return TE(e,n?.class,n?.className);const{variants:c,defaultVariants:d}=t,p=Object.keys(c).map(v=>{const E=n?.[v],T=d?.[v];if(E===null)return null;const S=EE(E)||EE(T);return c[v][S]}),s=n&&Object.entries(n).reduce((v,E)=>{let[T,S]=E;return S===void 0||(v[T]=S),v},{}),_=t==null||(o=t.compoundVariants)===null||o===void 0?void 0:o.reduce((v,E)=>{let{class:T,className:S,...D}=E;return Object.entries(D).every(O=>{let[M,U]=O;return Array.isArray(U)?U.includes({...d,...s}[M]):{...d,...s}[M]===U})?[...v,T,S]:v},[]);return TE(e,p,_,n?.class,n?.className)},QR=p3("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 dark:hover:bg-slate-800 dark:hover:text-slate-100 disabled:opacity-50 dark:focus:ring-slate-400 disabled:pointer-events-none dark:focus:ring-offset-slate-900 data-[state=open]:bg-slate-100 dark:data-[state=open]:bg-slate-800",{variants:{variant:{default:"bg-slate-900 text-white hover:bg-slate-700 dark:bg-slate-50 dark:text-slate-900",destructive:"bg-red-500 text-white hover:bg-red-600 dark:hover:bg-red-600",outline:"bg-transparent border border-slate-200 hover:bg-slate-100 dark:border-slate-700 dark:text-slate-100",subtle:"bg-slate-100 text-slate-900 hover:bg-slate-200 dark:bg-slate-700 dark:text-slate-100",ghost:"bg-transparent hover:bg-slate-100 dark:hover:bg-slate-800 dark:text-slate-100 dark:hover:text-slate-100 data-[state=open]:bg-transparent dark:data-[state=open]:bg-transparent",link:"bg-transparent underline-offset-4 hover:underline text-slate-900 dark:text-slate-100 hover:bg-transparent dark:hover:bg-transparent"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-2 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),to=P.forwardRef(({className:e,variant:t,size:n,...o},c)=>re("button",{className:En(QR({variant:t,size:n,className:e})),ref:c,...o}));to.displayName="Button";const pd=({label:e,active:t,icon:n,element:o,onClick:c})=>vt(to,{onClick:c,variant:t?"subtle":"ghost",size:"sm",className:"w-full justify-start gap-2",children:[n&&re(n,{size:16}),o&&o,e]}),Af=({children:e})=>{const{hardware:t,nodes:n}=In(),o=n.get(t.myNodeNum),{activePage:c,setActivePage:d,setDialogOpen:p}=In(),s=[{name:"Messages",icon:r3,page:"messages"},{name:"Map",icon:n3,page:"map"},{name:"Config",icon:Ex,page:"config"},{name:"Channels",icon:t3,page:"channels"},{name:"Peers",icon:Tx,page:"peers"}];return vt("div",{className:"min-w-[280px] max-w-min flex-col overflow-y-auto border-r-[0.5px] border-slate-300 bg-transparent dark:border-slate-700",children:[vt("div",{className:"flex justify-between px-8 py-6",children:[vt("div",{children:[re("span",{className:"text-lg font-medium",children:o?.user?.shortName??"UNK"}),re(Rl,{children:o?.user?.longName??"UNK"})]}),re("button",{className:"transition-all hover:text-accent",onClick:()=>p("deviceName",!0),children:re(eR,{size:16})})]}),re(mf,{label:"Navigation",children:s.map((_,v)=>re(pd,{label:_.name,icon:_.icon,onClick:()=>{d(_.page)},active:_.page===c},v))}),e]})},V0=({label:e,noPadding:t,actions:n,children:o})=>vt("div",{className:"relative flex h-full w-full flex-col",children:[vt("div",{className:"flex h-14 shrink-0 border-b-[0.5px] border-slate-300 dark:border-slate-700 md:h-16 md:px-4",children:[re("button",{className:"pl-4 transition-all hover:text-accent md:hidden",children:re(WD,{})}),re("div",{className:"flex flex-1 items-center justify-between px-4 md:px-0",children:vt("div",{className:"flex w-full items-center",children:[re("span",{className:"w-full text-lg font-medium",children:e}),re("div",{className:"flex justify-end space-x-4",children:n?.map((c,d)=>re("button",{className:"transition-all hover:text-accent",onClick:c.onClick,children:re(c.icon,{})},d))})]})})]}),re("div",{className:En("flex h-full w-full flex-col overflow-y-auto",!t&&"p-3"),children:o})]});var m3=iL,g3=sL,Ua=[],qo=[],eL=typeof Uint8Array<"u"?Uint8Array:Array,Vy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Eu=0,tL=Vy.length;Eu<tL;++Eu)Ua[Eu]=Vy[Eu],qo[Vy.charCodeAt(Eu)]=Eu;qo["-".charCodeAt(0)]=62;qo["_".charCodeAt(0)]=63;function nL(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var o=n===t?0:4-n%4;return[n,o]}function rL(e,t,n){return(t+n)*3/4-n}function iL(e){var t,n=nL(e),o=n[0],c=n[1],d=new eL(rL(e,o,c)),p=0,s=c>0?o-4:o,_;for(_=0;_<s;_+=4)t=qo[e.charCodeAt(_)]<<18|qo[e.charCodeAt(_+1)]<<12|qo[e.charCodeAt(_+2)]<<6|qo[e.charCodeAt(_+3)],d[p++]=t>>16&255,d[p++]=t>>8&255,d[p++]=t&255;return c===2&&(t=qo[e.charCodeAt(_)]<<2|qo[e.charCodeAt(_+1)]>>4,d[p++]=t&255),c===1&&(t=qo[e.charCodeAt(_)]<<10|qo[e.charCodeAt(_+1)]<<4|qo[e.charCodeAt(_+2)]>>2,d[p++]=t>>8&255,d[p++]=t&255),d}function oL(e){return Ua[e>>18&63]+Ua[e>>12&63]+Ua[e>>6&63]+Ua[e&63]}function aL(e,t,n){for(var o,c=[],d=t;d<n;d+=3)o=(e[d]<<16&16711680)+(e[d+1]<<8&65280)+(e[d+2]&255),c.push(oL(o));return c.join("")}function sL(e){for(var t,n=e.length,o=n%3,c=[],d=16383,p=0,s=n-o;p<s;p+=d)c.push(aL(e,p,p+d>s?s:p+d));return o===1?(t=e[n-1],c.push(Ua[t>>2]+Ua[t<<4&63]+"==")):o===2&&(t=(e[n-2]<<8)+e[n-1],c.push(Ua[t>>10]+Ua[t>>4&63]+Ua[t<<2&63]+"=")),c.join("")}var If=e=>e.type==="checkbox",qu=e=>e instanceof Date,Ji=e=>e==null;const y3=e=>typeof e=="object";var ii=e=>!Ji(e)&&!Array.isArray(e)&&y3(e)&&!qu(e),v3=e=>ii(e)&&e.target?If(e.target)?e.target.checked:e.target.value:e,lL=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,_3=(e,t)=>e.has(lL(t)),Mf=e=>Array.isArray(e)?e.filter(Boolean):[],Xr=e=>e===void 0,qt=(e,t,n)=>{if(!t||!ii(e))return n;const o=Mf(t.split(/[,[\].]+?/)).reduce((c,d)=>Ji(c)?c:c[d],e);return Xr(o)||o===e?Xr(e[t])?n:e[t]:o};const o0={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ga={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ys={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},cL=Un.createContext(null),kx=()=>Un.useContext(cL);var x3=(e,t,n,o=!0)=>{const c={defaultValues:t._defaultValues};for(const d in e)Object.defineProperty(c,d,{get:()=>{const p=d;return t._proxyFormState[p]!==ga.all&&(t._proxyFormState[p]=!o||ga.all),n&&(n[p]=!0),e[p]}});return c},Wo=e=>ii(e)&&!Object.keys(e).length,b3=(e,t,n,o)=>{n(e);const{name:c,...d}=e;return Wo(d)||Object.keys(d).length>=Object.keys(t).length||Object.keys(d).find(p=>t[p]===(!o||ga.all))},Sm=e=>Array.isArray(e)?e:[e],w3=(e,t,n)=>n&&t?e===t:!e||!t||e===t||Sm(e).some(o=>o&&(o.startsWith(t)||t.startsWith(o)));function Cx(e){const t=Un.useRef(e);t.current=e,Un.useEffect(()=>{const n=!e.disabled&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function uL(e){const t=kx(),{control:n=t.control,disabled:o,name:c,exact:d}=e||{},[p,s]=Un.useState(n._formState),_=Un.useRef(!0),v=Un.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),E=Un.useRef(c);return E.current=c,Cx({disabled:o,next:T=>_.current&&w3(E.current,T.name,d)&&b3(T,v.current,n._updateFormState)&&s({...n._formState,...T}),subject:n._subjects.state}),Un.useEffect(()=>{_.current=!0;const T=n._proxyFormState.isDirty&&n._getDirty();return T!==n._formState.isDirty&&n._subjects.state.next({isDirty:T}),v.current.isValid&&n._updateValid(!0),()=>{_.current=!1}},[n]),x3(p,n,v.current,!1)}var Va=e=>typeof e=="string",E3=(e,t,n,o,c)=>Va(e)?(o&&t.watch.add(e),qt(n,e,c)):Array.isArray(e)?e.map(d=>(o&&t.watch.add(d),qt(n,d))):(o&&(t.watchAll=!0),n),dL=e=>{const t=e.constructor&&e.constructor.prototype;return ii(t)&&t.hasOwnProperty("isPrototypeOf")},Px=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function gl(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Px&&(e instanceof Blob||e instanceof FileList))&&(n||ii(e)))if(t=n?[]:{},!Array.isArray(e)&&!dL(e))t=e;else for(const o in e)t[o]=gl(e[o]);else return e;return t}function T3(e){const t=kx(),{control:n=t.control,name:o,defaultValue:c,disabled:d,exact:p}=e||{},s=Un.useRef(o);s.current=o,Cx({disabled:d,subject:n._subjects.watch,next:E=>{w3(s.current,E.name,p)&&v(gl(E3(s.current,n._names,E.values||n._formValues,!1,c)))}});const[_,v]=Un.useState(n._getWatch(o,c));return Un.useEffect(()=>n._removeUnmounted()),_}function hL(e){const t=kx(),{name:n,control:o=t.control,shouldUnregister:c}=e,d=_3(o._names.array,n),p=T3({control:o,name:n,defaultValue:qt(o._formValues,n,qt(o._defaultValues,n,e.defaultValue)),exact:!0}),s=uL({control:o,name:n}),_=Un.useRef(o.register(n,{...e.rules,value:p}));return Un.useEffect(()=>{const v=(E,T)=>{const S=qt(o._fields,E);S&&(S._f.mount=T)};return v(n,!0),()=>{const E=o._options.shouldUnregister||c;(d?E&&!o._stateFlags.action:E)?o.unregister(n):v(n,!1)}},[n,o,d,c]),{field:{name:n,value:p,onChange:Un.useCallback(v=>_.current.onChange({target:{value:v3(v),name:n},type:o0.CHANGE}),[n]),onBlur:Un.useCallback(()=>_.current.onBlur({target:{value:qt(o._formValues,n),name:n},type:o0.BLUR}),[n,o]),ref:v=>{const E=qt(o._fields,n);E&&v&&(E._f.ref={focus:()=>v.focus(),select:()=>v.select(),setCustomValidity:T=>v.setCustomValidity(T),reportValidity:()=>v.reportValidity()})}},formState:s,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!qt(s.errors,n)},isDirty:{enumerable:!0,get:()=>!!qt(s.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!qt(s.touchedFields,n)},error:{enumerable:!0,get:()=>qt(s.errors,n)}})}}const j0=e=>e.render(hL(e));var fL=(e,t,n,o,c)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[o]:c||!0}}:{},Ax=e=>/^\w*$/.test(e),S3=e=>Mf(e.replace(/["|']|\]/g,"").split(/\.|\[/));function vr(e,t,n){let o=-1;const c=Ax(t)?[t]:S3(t),d=c.length,p=d-1;for(;++o<d;){const s=c[o];let _=n;if(o!==p){const v=e[s];_=ii(v)||Array.isArray(v)?v:isNaN(+c[o+1])?{}:[]}e[s]=_,e=e[s]}return e}const P_=(e,t,n)=>{for(const o of n||Object.keys(e)){const c=qt(e,o);if(c){const{_f:d,...p}=c;if(d&&t(d.name)){if(d.ref.focus){d.ref.focus();break}else if(d.refs&&d.refs[0].focus){d.refs[0].focus();break}}else ii(p)&&P_(p,t)}}};var SE=e=>({isOnSubmit:!e||e===ga.onSubmit,isOnBlur:e===ga.onBlur,isOnChange:e===ga.onChange,isOnAll:e===ga.all,isOnTouch:e===ga.onTouched}),kE=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(o=>e.startsWith(o)&&/^\.\w+/.test(e.slice(o.length)))),pL=(e,t,n)=>{const o=Mf(qt(e,n));return vr(o,"root",t[n]),vr(e,n,o),e},ed=e=>typeof e=="boolean",Ix=e=>e.type==="file",td=e=>typeof e=="function",a0=e=>{if(!Px)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},km=e=>Va(e),Mx=e=>e.type==="radio",s0=e=>e instanceof RegExp;const CE={value:!1,isValid:!1},PE={value:!0,isValid:!0};var k3=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!Xr(e[0].attributes.value)?Xr(e[0].value)||e[0].value===""?PE:{value:e[0].value,isValid:!0}:PE:CE}return CE};const AE={isValid:!1,value:null};var C3=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,AE):AE;function IE(e,t,n="validate"){if(km(e)||Array.isArray(e)&&e.every(km)||ed(e)&&!e)return{type:n,message:km(e)?e:"",ref:t}}var Tu=e=>ii(e)&&!s0(e)?e:{value:e,message:""},ME=async(e,t,n,o,c)=>{const{ref:d,refs:p,required:s,maxLength:_,minLength:v,min:E,max:T,pattern:S,validate:D,name:O,valueAsNumber:M,mount:U,disabled:$}=e._f,L=qt(t,O);if(!U||$)return{};const F=p?p[0]:d,J=de=>{o&&F.reportValidity&&(F.setCustomValidity(ed(de)?"":de||""),F.reportValidity())},V={},Z=Mx(d),G=If(d),W=Z||G,le=(M||Ix(d))&&Xr(d.value)&&Xr(L)||a0(d)&&d.value===""||L===""||Array.isArray(L)&&!L.length,Ie=fL.bind(null,O,n,V),be=(de,Ne,Ee,Oe=ys.maxLength,ze=ys.minLength)=>{const rt=de?Ne:Ee;V[O]={type:de?Oe:ze,message:rt,ref:d,...Ie(de?Oe:ze,rt)}};if(c?!Array.isArray(L)||!L.length:s&&(!W&&(le||Ji(L))||ed(L)&&!L||G&&!k3(p).isValid||Z&&!C3(p).isValid)){const{value:de,message:Ne}=km(s)?{value:!!s,message:s}:Tu(s);if(de&&(V[O]={type:ys.required,message:Ne,ref:F,...Ie(ys.required,Ne)},!n))return J(Ne),V}if(!le&&(!Ji(E)||!Ji(T))){let de,Ne;const Ee=Tu(T),Oe=Tu(E);if(!Ji(L)&&!isNaN(L)){const ze=d.valueAsNumber||L&&+L;Ji(Ee.value)||(de=ze>Ee.value),Ji(Oe.value)||(Ne=ze<Oe.value)}else{const ze=d.valueAsDate||new Date(L),rt=He=>new Date(new Date().toDateString()+" "+He),We=d.type=="time",Ae=d.type=="week";Va(Ee.value)&&L&&(de=We?rt(L)>rt(Ee.value):Ae?L>Ee.value:ze>new Date(Ee.value)),Va(Oe.value)&&L&&(Ne=We?rt(L)<rt(Oe.value):Ae?L<Oe.value:ze<new Date(Oe.value))}if((de||Ne)&&(be(!!de,Ee.message,Oe.message,ys.max,ys.min),!n))return J(V[O].message),V}if((_||v)&&!le&&(Va(L)||c&&Array.isArray(L))){const de=Tu(_),Ne=Tu(v),Ee=!Ji(de.value)&&L.length>de.value,Oe=!Ji(Ne.value)&&L.length<Ne.value;if((Ee||Oe)&&(be(Ee,de.message,Ne.message),!n))return J(V[O].message),V}if(S&&!le&&Va(L)){const{value:de,message:Ne}=Tu(S);if(s0(de)&&!L.match(de)&&(V[O]={type:ys.pattern,message:Ne,ref:d,...Ie(ys.pattern,Ne)},!n))return J(Ne),V}if(D){if(td(D)){const de=await D(L,t),Ne=IE(de,F);if(Ne&&(V[O]={...Ne,...Ie(ys.validate,Ne.message)},!n))return J(Ne.message),V}else if(ii(D)){let de={};for(const Ne in D){if(!Wo(de)&&!n)break;const Ee=IE(await D[Ne](L,t),F,Ne);Ee&&(de={...Ee,...Ie(Ne,Ee.message)},J(Ee.message),n&&(V[O]=de))}if(!Wo(de)&&(V[O]={ref:F,...de},!n))return V}}return J(!0),V};function mL(e,t){const n=t.slice(0,-1).length;let o=0;for(;o<n;)e=Xr(e)?o++:e[t[o++]];return e}function gL(e){for(const t in e)if(!Xr(e[t]))return!1;return!0}function Ei(e,t){const n=Array.isArray(t)?t:Ax(t)?[t]:S3(t),o=n.length===1?e:mL(e,n),c=n.length-1,d=n[c];return o&&delete o[d],c!==0&&(ii(o)&&Wo(o)||Array.isArray(o)&&gL(o))&&Ei(e,n.slice(0,-1)),e}function jy(){let e=[];return{get observers(){return e},next:c=>{let d=0;const p=e.length;for(;d<p;)e[d].next(c),++d},subscribe:c=>(e.push(c),{unsubscribe:()=>{e=e.filter(d=>d!==c)}}),unsubscribe:()=>{e=[]}}}var l0=e=>Ji(e)||!y3(e);function Sc(e,t){if(l0(e)||l0(t))return e===t;if(qu(e)&&qu(t))return e.getTime()===t.getTime();const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(const c of n){const d=e[c];if(!o.includes(c))return!1;if(c!=="ref"){const p=t[c];if(qu(d)&&qu(p)||ii(d)&&ii(p)||Array.isArray(d)&&Array.isArray(p)?!Sc(d,p):d!==p)return!1}}return!0}var P3=e=>e.type==="select-multiple",yL=e=>Mx(e)||If(e),Gy=e=>a0(e)&&e.isConnected,A3=e=>{for(const t in e)if(td(e[t]))return!0;return!1};function c0(e,t={}){const n=Array.isArray(e);if(ii(e)||n)for(const o in e)Array.isArray(e[o])||ii(e[o])&&!A3(e[o])?(t[o]=Array.isArray(e[o])?[]:{},c0(e[o],t[o])):Ji(e[o])||(t[o]=!0);return t}function I3(e,t,n){const o=Array.isArray(e);if(ii(e)||o)for(const c in e)Array.isArray(e[c])||ii(e[c])&&!A3(e[c])?Xr(t)||l0(n[c])?n[c]=Array.isArray(e[c])?c0(e[c],[]):{...c0(e[c])}:I3(e[c],Ji(t)?{}:t[c],n[c]):Sc(e[c],t[c])?delete n[c]:n[c]=!0;return n}var qy=(e,t)=>I3(e,t,c0(t)),M3=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:o})=>Xr(e)?e:t?e===""?NaN:e&&+e:n&&Va(e)?new Date(e):o?o(e):e;function Wy(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return Ix(t)?t.files:Mx(t)?C3(e.refs).value:P3(t)?[...t.selectedOptions].map(({value:n})=>n):If(t)?k3(e.refs).value:M3(Xr(t.value)?e.ref.value:t.value,e)}var vL=(e,t,n,o)=>{const c={};for(const d of e){const p=qt(t,d);p&&vr(c,d,p._f)}return{criteriaMode:n,names:[...e],fields:c,shouldUseNativeValidation:o}},wh=e=>Xr(e)?e:s0(e)?e.source:ii(e)?s0(e.value)?e.value.source:e.value:e,_L=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function DE(e,t,n){const o=qt(e,n);if(o||Ax(n))return{error:o,name:n};const c=n.split(".");for(;c.length;){const d=c.join("."),p=qt(t,d),s=qt(e,d);if(p&&!Array.isArray(p)&&n!==d)return{name:n};if(s&&s.type)return{name:d,error:s};c.pop()}return{name:n}}var xL=(e,t,n,o,c)=>c.isOnAll?!1:!n&&c.isOnTouch?!(t||e):(n?o.isOnBlur:c.isOnBlur)?!e:(n?o.isOnChange:c.isOnChange)?e:!0,bL=(e,t)=>!Mf(qt(e,t)).length&&Ei(e,t);const wL={mode:ga.onSubmit,reValidateMode:ga.onChange,shouldFocusError:!0};function EL(e={},t){let n={...wL,...e},o={submitCount:0,isDirty:!1,isLoading:!0,isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},c={},d=ii(n.defaultValues)||ii(n.values)?gl(n.defaultValues||n.values)||{}:{},p=n.shouldUnregister?{}:gl(d),s={action:!1,mount:!1,watch:!1},_={mount:new Set,unMount:new Set,array:new Set,watch:new Set},v,E=0;const T=e.resetOptions&&e.resetOptions.keepDirtyValues,S={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},D={watch:jy(),array:jy(),state:jy()},O=SE(n.mode),M=SE(n.reValidateMode),U=n.criteriaMode===ga.all,$=ue=>Fe=>{clearTimeout(E),E=setTimeout(ue,Fe)},L=async ue=>{if(S.isValid||ue){const Fe=n.resolver?Wo((await le()).errors):await be(c,!0);Fe!==o.isValid&&D.state.next({isValid:Fe})}},F=ue=>S.isValidating&&D.state.next({isValidating:ue}),J=(ue,Fe=[],Ke,it,ct=!0,at=!0)=>{if(it&&Ke){if(s.action=!0,at&&Array.isArray(qt(c,ue))){const Ot=Ke(qt(c,ue),it.argA,it.argB);ct&&vr(c,ue,Ot)}if(at&&Array.isArray(qt(o.errors,ue))){const Ot=Ke(qt(o.errors,ue),it.argA,it.argB);ct&&vr(o.errors,ue,Ot),bL(o.errors,ue)}if(S.touchedFields&&at&&Array.isArray(qt(o.touchedFields,ue))){const Ot=Ke(qt(o.touchedFields,ue),it.argA,it.argB);ct&&vr(o.touchedFields,ue,Ot)}S.dirtyFields&&(o.dirtyFields=qy(d,p)),D.state.next({name:ue,isDirty:Ne(ue,Fe),dirtyFields:o.dirtyFields,errors:o.errors,isValid:o.isValid})}else vr(p,ue,Fe)},V=(ue,Fe)=>{vr(o.errors,ue,Fe),D.state.next({errors:o.errors})},Z=(ue,Fe,Ke,it)=>{const ct=qt(c,ue);if(ct){const at=qt(p,ue,Xr(Ke)?qt(d,ue):Ke);Xr(at)||it&&it.defaultChecked||Fe?vr(p,ue,Fe?at:Wy(ct._f)):ze(ue,at),s.mount&&L()}},G=(ue,Fe,Ke,it,ct)=>{let at=!1,Ot=!1;const on={name:ue};if(!Ke||it){S.isDirty&&(Ot=o.isDirty,o.isDirty=on.isDirty=Ne(),at=Ot!==on.isDirty);const pn=Sc(qt(d,ue),Fe);Ot=qt(o.dirtyFields,ue),pn?Ei(o.dirtyFields,ue):vr(o.dirtyFields,ue,!0),on.dirtyFields=o.dirtyFields,at=at||S.dirtyFields&&Ot!==!pn}if(Ke){const pn=qt(o.touchedFields,ue);pn||(vr(o.touchedFields,ue,Ke),on.touchedFields=o.touchedFields,at=at||S.touchedFields&&pn!==Ke)}return at&&ct&&D.state.next(on),at?on:{}},W=(ue,Fe,Ke,it)=>{const ct=qt(o.errors,ue),at=S.isValid&&ed(Fe)&&o.isValid!==Fe;if(e.delayError&&Ke?(v=$(()=>V(ue,Ke)),v(e.delayError)):(clearTimeout(E),v=null,Ke?vr(o.errors,ue,Ke):Ei(o.errors,ue)),(Ke?!Sc(ct,Ke):ct)||!Wo(it)||at){const Ot={...it,...at&&ed(Fe)?{isValid:Fe}:{},errors:o.errors,name:ue};o={...o,...Ot},D.state.next(Ot)}F(!1)},le=async ue=>await n.resolver(p,n.context,vL(ue||_.mount,c,n.criteriaMode,n.shouldUseNativeValidation)),Ie=async ue=>{const{errors:Fe}=await le();if(ue)for(const Ke of ue){const it=qt(Fe,Ke);it?vr(o.errors,Ke,it):Ei(o.errors,Ke)}else o.errors=Fe;return Fe},be=async(ue,Fe,Ke={valid:!0})=>{for(const it in ue){const ct=ue[it];if(ct){const{_f:at,...Ot}=ct;if(at){const on=_.array.has(at.name),pn=await ME(ct,p,U,n.shouldUseNativeValidation,on);if(pn[at.name]&&(Ke.valid=!1,Fe))break;!Fe&&(qt(pn,at.name)?on?pL(o.errors,pn,at.name):vr(o.errors,at.name,pn[at.name]):Ei(o.errors,at.name))}Ot&&await be(Ot,Fe,Ke)}}return Ke.valid},de=()=>{for(const ue of _.unMount){const Fe=qt(c,ue);Fe&&(Fe._f.refs?Fe._f.refs.every(Ke=>!Gy(Ke)):!Gy(Fe._f.ref))&&tt(ue)}_.unMount=new Set},Ne=(ue,Fe)=>(ue&&Fe&&vr(p,ue,Fe),!Sc(ft(),d)),Ee=(ue,Fe,Ke)=>E3(ue,_,{...s.mount?p:Xr(Fe)?d:Va(ue)?{[ue]:Fe}:Fe},Ke,Fe),Oe=ue=>Mf(qt(s.mount?p:d,ue,e.shouldUnregister?qt(d,ue,[]):[])),ze=(ue,Fe,Ke={})=>{const it=qt(c,ue);let ct=Fe;if(it){const at=it._f;at&&(!at.disabled&&vr(p,ue,M3(Fe,at)),ct=a0(at.ref)&&Ji(Fe)?"":Fe,P3(at.ref)?[...at.ref.options].forEach(Ot=>Ot.selected=ct.includes(Ot.value)):at.refs?If(at.ref)?at.refs.length>1?at.refs.forEach(Ot=>(!Ot.defaultChecked||!Ot.disabled)&&(Ot.checked=Array.isArray(ct)?!!ct.find(on=>on===Ot.value):ct===Ot.value)):at.refs[0]&&(at.refs[0].checked=!!ct):at.refs.forEach(Ot=>Ot.checked=Ot.value===ct):Ix(at.ref)?at.ref.value="":(at.ref.value=ct,at.ref.type||D.watch.next({name:ue})))}(Ke.shouldDirty||Ke.shouldTouch)&&G(ue,ct,Ke.shouldTouch,Ke.shouldDirty,!0),Ke.shouldValidate&&He(ue)},rt=(ue,Fe,Ke)=>{for(const it in Fe){const ct=Fe[it],at=`${ue}.${it}`,Ot=qt(c,at);(_.array.has(ue)||!l0(ct)||Ot&&!Ot._f)&&!qu(ct)?rt(at,ct,Ke):ze(at,ct,Ke)}},We=(ue,Fe,Ke={})=>{const it=qt(c,ue),ct=_.array.has(ue),at=gl(Fe);vr(p,ue,at),ct?(D.array.next({name:ue,values:p}),(S.isDirty||S.dirtyFields)&&Ke.shouldDirty&&D.state.next({name:ue,dirtyFields:qy(d,p),isDirty:Ne(ue,at)})):it&&!it._f&&!Ji(at)?rt(ue,at,Ke):ze(ue,at,Ke),kE(ue,_)&&D.state.next({}),D.watch.next({name:ue}),!s.mount&&t()},Ae=async ue=>{const Fe=ue.target;let Ke=Fe.name;const it=qt(c,Ke),ct=()=>Fe.type?Wy(it._f):v3(ue);if(it){let at,Ot;const on=ct(),pn=ue.type===o0.BLUR||ue.type===o0.FOCUS_OUT,sr=!_L(it._f)&&!n.resolver&&!qt(o.errors,Ke)&&!it._f.deps||xL(pn,qt(o.touchedFields,Ke),o.isSubmitted,M,O),Qn=kE(Ke,_,pn);vr(p,Ke,on),pn?(it._f.onBlur&&it._f.onBlur(ue),v&&v(0)):it._f.onChange&&it._f.onChange(ue);const Jr=G(Ke,on,pn,!1),xr=!Wo(Jr)||Qn;if(!pn&&D.watch.next({name:Ke,type:ue.type}),sr)return S.isValid&&L(),xr&&D.state.next({name:Ke,...Qn?{}:Jr});if(!pn&&Qn&&D.state.next({}),F(!0),n.resolver){const{errors:Ye}=await le([Ke]),_t=DE(o.errors,c,Ke),Kn=DE(Ye,c,_t.name||Ke);at=Kn.error,Ke=Kn.name,Ot=Wo(Ye)}else at=(await ME(it,p,U,n.shouldUseNativeValidation))[Ke],at?Ot=!1:S.isValid&&(Ot=await be(c,!0));it._f.deps&&He(it._f.deps),W(Ke,Ot,at,Jr)}},He=async(ue,Fe={})=>{let Ke,it;const ct=Sm(ue);if(F(!0),n.resolver){const at=await Ie(Xr(ue)?ue:ct);Ke=Wo(at),it=ue?!ct.some(Ot=>qt(at,Ot)):Ke}else ue?(it=(await Promise.all(ct.map(async at=>{const Ot=qt(c,at);return await be(Ot&&Ot._f?{[at]:Ot}:Ot)}))).every(Boolean),!(!it&&!o.isValid)&&L()):it=Ke=await be(c);return D.state.next({...!Va(ue)||S.isValid&&Ke!==o.isValid?{}:{name:ue},...n.resolver||!ue?{isValid:Ke}:{},errors:o.errors,isValidating:!1}),Fe.shouldFocus&&!it&&P_(c,at=>at&&qt(o.errors,at),ue?ct:_.mount),it},ft=ue=>{const Fe={...d,...s.mount?p:{}};return Xr(ue)?Fe:Va(ue)?qt(Fe,ue):ue.map(Ke=>qt(Fe,Ke))},Qe=(ue,Fe)=>({invalid:!!qt((Fe||o).errors,ue),isDirty:!!qt((Fe||o).dirtyFields,ue),isTouched:!!qt((Fe||o).touchedFields,ue),error:qt((Fe||o).errors,ue)}),Rt=ue=>{ue&&Sm(ue).forEach(Fe=>Ei(o.errors,Fe)),D.state.next({errors:ue?o.errors:{}})},zt=(ue,Fe,Ke)=>{const it=(qt(c,ue,{_f:{}})._f||{}).ref;vr(o.errors,ue,{...Fe,ref:it}),D.state.next({name:ue,errors:o.errors,isValid:!1}),Ke&&Ke.shouldFocus&&it&&it.focus&&it.focus()},X=(ue,Fe)=>td(ue)?D.watch.subscribe({next:Ke=>ue(Ee(void 0,Fe),Ke)}):Ee(ue,Fe,!0),tt=(ue,Fe={})=>{for(const Ke of ue?Sm(ue):_.mount)_.mount.delete(Ke),_.array.delete(Ke),qt(c,Ke)&&(Fe.keepValue||(Ei(c,Ke),Ei(p,Ke)),!Fe.keepError&&Ei(o.errors,Ke),!Fe.keepDirty&&Ei(o.dirtyFields,Ke),!Fe.keepTouched&&Ei(o.touchedFields,Ke),!n.shouldUnregister&&!Fe.keepDefaultValue&&Ei(d,Ke));D.watch.next({}),D.state.next({...o,...Fe.keepDirty?{isDirty:Ne()}:{}}),!Fe.keepIsValid&&L()},je=(ue,Fe={})=>{let Ke=qt(c,ue);const it=ed(Fe.disabled);return vr(c,ue,{...Ke||{},_f:{...Ke&&Ke._f?Ke._f:{ref:{name:ue}},name:ue,mount:!0,...Fe}}),_.mount.add(ue),Ke?it&&vr(p,ue,Fe.disabled?void 0:qt(p,ue,Wy(Ke._f))):Z(ue,!0,Fe.value),{...it?{disabled:Fe.disabled}:{},...n.shouldUseNativeValidation?{required:!!Fe.required,min:wh(Fe.min),max:wh(Fe.max),minLength:wh(Fe.minLength),maxLength:wh(Fe.maxLength),pattern:wh(Fe.pattern)}:{},name:ue,onChange:Ae,onBlur:Ae,ref:ct=>{if(ct){je(ue,Fe),Ke=qt(c,ue);const at=Xr(ct.value)&&ct.querySelectorAll&&ct.querySelectorAll("input,select,textarea")[0]||ct,Ot=yL(at),on=Ke._f.refs||[];if(Ot?on.find(pn=>pn===at):at===Ke._f.ref)return;vr(c,ue,{_f:{...Ke._f,...Ot?{refs:[...on.filter(Gy),at,...Array.isArray(qt(d,ue))?[{}]:[]],ref:{type:at.type,name:ue}}:{ref:at}}}),Z(ue,!1,void 0,at)}else Ke=qt(c,ue,{}),Ke._f&&(Ke._f.mount=!1),(n.shouldUnregister||Fe.shouldUnregister)&&!(_3(_.array,ue)&&s.action)&&_.unMount.add(ue)}}},ve=()=>n.shouldFocusError&&P_(c,ue=>ue&&qt(o.errors,ue),_.mount),ke=(ue,Fe)=>async Ke=>{Ke&&(Ke.preventDefault&&Ke.preventDefault(),Ke.persist&&Ke.persist());let it=gl(p);if(D.state.next({isSubmitting:!0}),n.resolver){const{errors:ct,values:at}=await le();o.errors=ct,it=at}else await be(c);Ei(o.errors,"root"),Wo(o.errors)?(D.state.next({errors:{}}),await ue(it,Ke)):(Fe&&await Fe({...o.errors},Ke),ve(),setTimeout(ve)),D.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Wo(o.errors),submitCount:o.submitCount+1,errors:o.errors})},we=(ue,Fe={})=>{qt(c,ue)&&(Xr(Fe.defaultValue)?We(ue,qt(d,ue)):(We(ue,Fe.defaultValue),vr(d,ue,Fe.defaultValue)),Fe.keepTouched||Ei(o.touchedFields,ue),Fe.keepDirty||(Ei(o.dirtyFields,ue),o.isDirty=Fe.defaultValue?Ne(ue,qt(d,ue)):Ne()),Fe.keepError||(Ei(o.errors,ue),S.isValid&&L()),D.state.next({...o}))},De=(ue,Fe={})=>{const Ke=ue||d,it=gl(Ke),ct=ue&&!Wo(ue)?it:d;if(Fe.keepDefaultValues||(d=Ke),!Fe.keepValues){if(Fe.keepDirtyValues||T)for(const at of _.mount)qt(o.dirtyFields,at)?vr(ct,at,qt(p,at)):We(at,qt(ct,at));else{if(Px&&Xr(ue))for(const at of _.mount){const Ot=qt(c,at);if(Ot&&Ot._f){const on=Array.isArray(Ot._f.refs)?Ot._f.refs[0]:Ot._f.ref;if(a0(on)){const pn=on.closest("form");if(pn){pn.reset();break}}}}c={}}p=e.shouldUnregister?Fe.keepDefaultValues?gl(d):{}:it,D.array.next({values:ct}),D.watch.next({values:ct})}_={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!s.mount&&t(),s.mount=!S.isValid||!!Fe.keepIsValid,s.watch=!!e.shouldUnregister,D.state.next({submitCount:Fe.keepSubmitCount?o.submitCount:0,isDirty:Fe.keepDirty?o.isDirty:!!(Fe.keepDefaultValues&&!Sc(ue,d)),isSubmitted:Fe.keepIsSubmitted?o.isSubmitted:!1,dirtyFields:Fe.keepDirtyValues?o.dirtyFields:Fe.keepDefaultValues&&ue?qy(d,ue):{},touchedFields:Fe.keepTouched?o.touchedFields:{},errors:Fe.keepErrors?o.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},Pe=(ue,Fe)=>De(td(ue)?ue(p):ue,Fe),lt=(ue,Fe={})=>{const Ke=qt(c,ue),it=Ke&&Ke._f;if(it){const ct=it.refs?it.refs[0]:it.ref;ct.focus&&(ct.focus(),Fe.shouldSelect&&ct.select())}},dt=ue=>{o={...o,...ue}};return td(n.defaultValues)&&n.defaultValues().then(ue=>{Pe(ue,n.resetOptions),D.state.next({isLoading:!1})}),{control:{register:je,unregister:tt,getFieldState:Qe,_executeSchema:le,_getWatch:Ee,_getDirty:Ne,_updateValid:L,_removeUnmounted:de,_updateFieldArray:J,_getFieldArray:Oe,_reset:De,_updateFormState:dt,_subjects:D,_proxyFormState:S,get _fields(){return c},get _formValues(){return p},get _stateFlags(){return s},set _stateFlags(ue){s=ue},get _defaultValues(){return d},get _names(){return _},set _names(ue){_=ue},get _formState(){return o},set _formState(ue){o=ue},get _options(){return n},set _options(ue){n={...n,...ue}}},trigger:He,register:je,handleSubmit:ke,watch:X,setValue:We,getValues:ft,reset:Pe,resetField:we,clearErrors:Rt,unregister:tt,setError:zt,setFocus:lt,getFieldState:Qe}}function Dx(e={}){const t=Un.useRef(),[n,o]=Un.useState({isDirty:!1,isValidating:!1,isLoading:!0,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:td(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...EL(e,()=>o(d=>({...d}))),formState:n});const c=t.current.control;return c._options=e,Cx({subject:c._subjects.state,next:d=>{b3(d,c._proxyFormState,c._updateFormState,!0)&&o({...c._formState})}}),Un.useEffect(()=>{c._stateFlags.mount||(c._updateValid(),c._stateFlags.mount=!0),c._stateFlags.watch&&(c._stateFlags.watch=!1,c._subjects.state.next({})),c._removeUnmounted()}),Un.useEffect(()=>{e.values&&!Sc(e.values,c._defaultValues)&&c._reset(e.values,c._options.resetOptions)},[e.values,c]),t.current.formState=x3(n,c),t.current}const Ha=P.forwardRef(({className:e,prefix:t,suffix:n,action:o,...c},d)=>vt("div",{className:"relative w-full",children:[t&&re("span",{className:"inline-flex items-center rounded-l-md bg-backgroundPrimary px-3 font-mono text-sm text-textSecondary brightness-hover",children:t}),re("input",{className:En("flex h-10 w-full rounded-md border border-slate-300 bg-transparent py-2 px-3 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",o&&"pr-8",e),ref:d,...c}),n&&re("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3 font-mono text-textSecondary",children:re("span",{className:"text-gray-500 sm:text-sm",children:n})}),o&&re("button",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 hover:text-gray-400 focus:outline-none ",onClick:o.onClick,children:re(o.icon,{size:20})})]}));Ha.displayName="Input";function TL({control:e,disabled:t,field:n}){return re(j0,{name:n.name,control:e,render:({field:{value:o,onChange:c,...d}})=>re(Ha,{type:n.type,value:n.type==="number"?parseInt(o):o,onChange:p=>c(n.type==="number"?parseInt(p.target.value):p.target.value),disabled:t,...n.properties,...d})})}function Bt(){return Bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Bt.apply(this,arguments)}function ln(e,t,{checkForDefaultPrevented:n=!0}={}){return function(c){if(e?.(c),n===!1||!c.defaultPrevented)return t?.(c)}}function SL(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function Rx(...e){return t=>e.forEach(n=>SL(n,t))}function ar(...e){return P.useCallback(Rx(...e),e)}function Ka(e,t=[]){let n=[];function o(d,p){const s=P.createContext(p),_=n.length;n=[...n,p];function v(T){const{scope:S,children:D,...O}=T,M=S?.[e][_]||s,U=P.useMemo(()=>O,Object.values(O));return P.createElement(M.Provider,{value:U},D)}function E(T,S){const D=S?.[e][_]||s,O=P.useContext(D);if(O)return O;if(p!==void 0)return p;throw new Error(`\`${T}\` must be used within \`${d}\``)}return v.displayName=d+"Provider",[v,E]}const c=()=>{const d=n.map(p=>P.createContext(p));return function(s){const _=s?.[e]||d;return P.useMemo(()=>({[`__scope${e}`]:{...s,[e]:_}}),[s,_])}};return c.scopeName=e,[o,kL(c,...t)]}function kL(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const o=e.map(c=>({useScope:c(),scopeName:c.scopeName}));return function(d){const p=o.reduce((s,{useScope:_,scopeName:v})=>{const T=_(d)[`__scope${v}`];return{...s,...T}},{});return P.useMemo(()=>({[`__scope${t.scopeName}`]:p}),[p])}};return n.scopeName=t.scopeName,n}function oi(e){const t=P.useRef(e);return P.useEffect(()=>{t.current=e}),P.useMemo(()=>(...n)=>{var o;return(o=t.current)===null||o===void 0?void 0:o.call(t,...n)},[])}function Ns({prop:e,defaultProp:t,onChange:n=()=>{}}){const[o,c]=CL({defaultProp:t,onChange:n}),d=e!==void 0,p=d?e:o,s=oi(n),_=P.useCallback(v=>{if(d){const T=typeof v=="function"?v(e):v;T!==e&&s(T)}else c(v)},[d,e,c,s]);return[p,_]}function CL({defaultProp:e,onChange:t}){const n=P.useState(e),[o]=n,c=P.useRef(o),d=oi(t);return P.useEffect(()=>{c.current!==o&&(d(o),c.current=o)},[o,c,d]),n}function Lx(e){const t=P.useRef({value:e,previous:e});return P.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}const fo=Boolean(globalThis?.document)?P.useLayoutEffect:()=>{};function Nx(e){const[t,n]=P.useState(void 0);return fo(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const o=new ResizeObserver(c=>{if(!Array.isArray(c)||!c.length)return;const d=c[0];let p,s;if("borderBoxSize"in d){const _=d.borderBoxSize,v=Array.isArray(_)?_[0]:_;p=v.inlineSize,s=v.blockSize}else p=e.offsetWidth,s=e.offsetHeight;n({width:p,height:s})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}else n(void 0)},[e]),t}const md=P.forwardRef((e,t)=>{const{children:n,...o}=e,c=P.Children.toArray(n),d=c.find(AL);if(d){const p=d.props.children,s=c.map(_=>_===d?P.Children.count(p)>1?P.Children.only(null):P.isValidElement(p)?p.props.children:null:_);return P.createElement(A_,Bt({},o,{ref:t}),P.isValidElement(p)?P.cloneElement(p,void 0,s):null)}return P.createElement(A_,Bt({},o,{ref:t}),n)});md.displayName="Slot";const A_=P.forwardRef((e,t)=>{const{children:n,...o}=e;return P.isValidElement(n)?P.cloneElement(n,{...IL(o,n.props),ref:Rx(t,n.ref)}):P.Children.count(n)>1?P.Children.only(null):null});A_.displayName="SlotClone";const PL=({children:e})=>P.createElement(P.Fragment,null,e);function AL(e){return P.isValidElement(e)&&e.type===PL}function IL(e,t){const n={...t};for(const o in t){const c=e[o],d=t[o];/^on[A-Z]/.test(o)?c&&d?n[o]=(...s)=>{d(...s),c(...s)}:c&&(n[o]=c):o==="style"?n[o]={...c,...d}:o==="className"&&(n[o]=[c,d].filter(Boolean).join(" "))}return{...e,...n}}const ML=["a","button","div","h2","h3","img","label","li","nav","ol","p","span","svg","ul"],Tn=ML.reduce((e,t)=>{const n=P.forwardRef((o,c)=>{const{asChild:d,...p}=o,s=d?md:t;return P.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),P.createElement(s,Bt({},p,{ref:c}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function D3(e,t){e&&yo.flushSync(()=>e.dispatchEvent(t))}const R3="Switch",[DL,uU]=Ka(R3),[RL,LL]=DL(R3),NL=P.forwardRef((e,t)=>{const{__scopeSwitch:n,name:o,checked:c,defaultChecked:d,required:p,disabled:s,value:_="on",onCheckedChange:v,...E}=e,[T,S]=P.useState(null),D=ar(t,L=>S(L)),O=P.useRef(!1),M=T?Boolean(T.closest("form")):!0,[U=!1,$]=Ns({prop:c,defaultProp:d,onChange:v});return P.createElement(RL,{scope:n,checked:U,disabled:s},P.createElement(Tn.button,Bt({type:"button",role:"switch","aria-checked":U,"aria-required":p,"data-state":L3(U),"data-disabled":s?"":void 0,disabled:s,value:_},E,{ref:D,onClick:ln(e.onClick,L=>{$(F=>!F),M&&(O.current=L.isPropagationStopped(),O.current||L.stopPropagation())})})),M&&P.createElement(zL,{control:T,bubbles:!O.current,name:o,value:_,checked:U,required:p,disabled:s,style:{transform:"translateX(-100%)"}}))}),OL="SwitchThumb",$L=P.forwardRef((e,t)=>{const{__scopeSwitch:n,...o}=e,c=LL(OL,n);return P.createElement(Tn.span,Bt({"data-state":L3(c.checked),"data-disabled":c.disabled?"":void 0},o,{ref:t}))}),zL=e=>{const{control:t,checked:n,bubbles:o=!0,...c}=e,d=P.useRef(null),p=Lx(n),s=Nx(t);return P.useEffect(()=>{const _=d.current,v=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(v,"checked").set;if(p!==n&&T){const S=new Event("click",{bubbles:o});T.call(_,n),_.dispatchEvent(S)}},[p,n,o]),P.createElement("input",Bt({type:"checkbox","aria-hidden":!0,defaultChecked:n},c,{tabIndex:-1,ref:d,style:{...e.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function L3(e){return e?"checked":"unchecked"}const N3=NL,BL=$L,G0=P.forwardRef(({className:e,...t},n)=>re(N3,{className:En("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=unchecked]:bg-slate-200 data-[state=checked]:bg-slate-900 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900 dark:data-[state=unchecked]:bg-slate-700 dark:data-[state=checked]:bg-slate-400",e),...t,ref:n,children:re(BL,{className:En("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=unchecked]:translate-x-0 data-[state=checked]:translate-x-5")})}));G0.displayName=N3.displayName;function FL({control:e,disabled:t,field:n}){return re(j0,{name:n.name,control:e,render:({field:{value:o,onChange:c,...d}})=>re(G0,{checked:o,onCheckedChange:c,disabled:t,...n.properties,...d})})}function RE(e,[t,n]){return Math.min(n,Math.max(t,e))}function Ox(e){const t=e+"CollectionProvider",[n,o]=Ka(t),[c,d]=n(t,{collectionRef:{current:null},itemMap:new Map}),p=D=>{const{scope:O,children:M}=D,U=Un.useRef(null),$=Un.useRef(new Map).current;return Un.createElement(c,{scope:O,itemMap:$,collectionRef:U},M)},s=e+"CollectionSlot",_=Un.forwardRef((D,O)=>{const{scope:M,children:U}=D,$=d(s,M),L=ar(O,$.collectionRef);return Un.createElement(md,{ref:L},U)}),v=e+"CollectionItemSlot",E="data-radix-collection-item",T=Un.forwardRef((D,O)=>{const{scope:M,children:U,...$}=D,L=Un.useRef(null),F=ar(O,L),J=d(v,M);return Un.useEffect(()=>(J.itemMap.set(L,{ref:L,...$}),()=>void J.itemMap.delete(L))),Un.createElement(md,{[E]:"",ref:F},U)});function S(D){const O=d(e+"CollectionConsumer",D);return Un.useCallback(()=>{const U=O.collectionRef.current;if(!U)return[];const $=Array.from(U.querySelectorAll(`[${E}]`));return Array.from(O.itemMap.values()).sort((J,V)=>$.indexOf(J.ref.current)-$.indexOf(V.ref.current))},[O.collectionRef,O.itemMap])}return[{Provider:p,Slot:_,ItemSlot:T},S,o]}const UL=P.createContext(void 0);function $x(e){const t=P.useContext(UL);return e||t||"ltr"}function VL(e,t=globalThis?.document){const n=oi(e);P.useEffect(()=>{const o=c=>{c.key==="Escape"&&n(c)};return t.addEventListener("keydown",o),()=>t.removeEventListener("keydown",o)},[n,t])}const I_="dismissableLayer.update",jL="dismissableLayer.pointerDownOutside",GL="dismissableLayer.focusOutside";let LE;const O3=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zx=P.forwardRef((e,t)=>{var n;const{disableOutsidePointerEvents:o=!1,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:p,onInteractOutside:s,onDismiss:_,...v}=e,E=P.useContext(O3),[T,S]=P.useState(null),D=(n=T?.ownerDocument)!==null&&n!==void 0?n:globalThis?.document,[,O]=P.useState({}),M=ar(t,W=>S(W)),U=Array.from(E.layers),[$]=[...E.layersWithOutsidePointerEventsDisabled].slice(-1),L=U.indexOf($),F=T?U.indexOf(T):-1,J=E.layersWithOutsidePointerEventsDisabled.size>0,V=F>=L,Z=WL(W=>{const le=W.target,Ie=[...E.branches].some(be=>be.contains(le));!V||Ie||(d?.(W),s?.(W),W.defaultPrevented||_?.())},D),G=HL(W=>{const le=W.target;[...E.branches].some(be=>be.contains(le))||(p?.(W),s?.(W),W.defaultPrevented||_?.())},D);return VL(W=>{F===E.layers.size-1&&(c?.(W),!W.defaultPrevented&&_&&(W.preventDefault(),_()))},D),P.useEffect(()=>{if(T)return o&&(E.layersWithOutsidePointerEventsDisabled.size===0&&(LE=D.body.style.pointerEvents,D.body.style.pointerEvents="none"),E.layersWithOutsidePointerEventsDisabled.add(T)),E.layers.add(T),NE(),()=>{o&&E.layersWithOutsidePointerEventsDisabled.size===1&&(D.body.style.pointerEvents=LE)}},[T,D,o,E]),P.useEffect(()=>()=>{T&&(E.layers.delete(T),E.layersWithOutsidePointerEventsDisabled.delete(T),NE())},[T,E]),P.useEffect(()=>{const W=()=>O({});return document.addEventListener(I_,W),()=>document.removeEventListener(I_,W)},[]),P.createElement(Tn.div,Bt({},v,{ref:M,style:{pointerEvents:J?V?"auto":"none":void 0,...e.style},onFocusCapture:ln(e.onFocusCapture,G.onFocusCapture),onBlurCapture:ln(e.onBlurCapture,G.onBlurCapture),onPointerDownCapture:ln(e.onPointerDownCapture,Z.onPointerDownCapture)}))}),qL=P.forwardRef((e,t)=>{const n=P.useContext(O3),o=P.useRef(null),c=ar(t,o);return P.useEffect(()=>{const d=o.current;if(d)return n.branches.add(d),()=>{n.branches.delete(d)}},[n.branches]),P.createElement(Tn.div,Bt({},e,{ref:c}))});function WL(e,t=globalThis?.document){const n=oi(e),o=P.useRef(!1),c=P.useRef(()=>{});return P.useEffect(()=>{const d=s=>{if(s.target&&!o.current){let E=function(){$3(jL,n,v,{discrete:!0})};var _=E;const v={originalEvent:s};s.pointerType==="touch"?(t.removeEventListener("click",c.current),c.current=E,t.addEventListener("click",c.current,{once:!0})):E()}o.current=!1},p=window.setTimeout(()=>{t.addEventListener("pointerdown",d)},0);return()=>{window.clearTimeout(p),t.removeEventListener("pointerdown",d),t.removeEventListener("click",c.current)}},[t,n]),{onPointerDownCapture:()=>o.current=!0}}function HL(e,t=globalThis?.document){const n=oi(e),o=P.useRef(!1);return P.useEffect(()=>{const c=d=>{d.target&&!o.current&&$3(GL,n,{originalEvent:d},{discrete:!1})};return t.addEventListener("focusin",c),()=>t.removeEventListener("focusin",c)},[t,n]),{onFocusCapture:()=>o.current=!0,onBlurCapture:()=>o.current=!1}}function NE(){const e=new CustomEvent(I_);document.dispatchEvent(e)}function $3(e,t,n,{discrete:o}){const c=n.originalEvent.target,d=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&c.addEventListener(e,t,{once:!0}),o?D3(c,d):c.dispatchEvent(d)}const ZL=zx,KL=qL;let Hy=0;function Bx(){P.useEffect(()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(e=n[0])!==null&&e!==void 0?e:OE()),document.body.insertAdjacentElement("beforeend",(t=n[1])!==null&&t!==void 0?t:OE()),Hy++,()=>{Hy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(o=>o.remove()),Hy--}},[])}function OE(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",e}const Zy="focusScope.autoFocusOnMount",Ky="focusScope.autoFocusOnUnmount",$E={bubbles:!1,cancelable:!0},z3=P.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:c,onUnmountAutoFocus:d,...p}=e,[s,_]=P.useState(null),v=oi(c),E=oi(d),T=P.useRef(null),S=ar(t,M=>_(M)),D=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(o){let $=function(F){if(D.paused||!s)return;const J=F.target;s.contains(J)?T.current=J:_c(T.current,{select:!0})},L=function(F){D.paused||!s||s.contains(F.relatedTarget)||_c(T.current,{select:!0})};var M=$,U=L;return document.addEventListener("focusin",$),document.addEventListener("focusout",L),()=>{document.removeEventListener("focusin",$),document.removeEventListener("focusout",L)}}},[o,s,D.paused]),P.useEffect(()=>{if(s){BE.add(D);const M=document.activeElement;if(!s.contains(M)){const $=new CustomEvent(Zy,$E);s.addEventListener(Zy,v),s.dispatchEvent($),$.defaultPrevented||(XL(tN(B3(s)),{select:!0}),document.activeElement===M&&_c(s))}return()=>{s.removeEventListener(Zy,v),setTimeout(()=>{const $=new CustomEvent(Ky,$E);s.addEventListener(Ky,E),s.dispatchEvent($),$.defaultPrevented||_c(M??document.body,{select:!0}),s.removeEventListener(Ky,E),BE.remove(D)},0)}}},[s,v,E,D]);const O=P.useCallback(M=>{if(!n&&!o||D.paused)return;const U=M.key==="Tab"&&!M.altKey&&!M.ctrlKey&&!M.metaKey,$=document.activeElement;if(U&&$){const L=M.currentTarget,[F,J]=YL(L);F&&J?!M.shiftKey&&$===J?(M.preventDefault(),n&&_c(F,{select:!0})):M.shiftKey&&$===F&&(M.preventDefault(),n&&_c(J,{select:!0})):$===L&&M.preventDefault()}},[n,o,D.paused]);return P.createElement(Tn.div,Bt({tabIndex:-1},p,{ref:S,onKeyDown:O}))});function XL(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(_c(o,{select:t}),document.activeElement!==n)return}function YL(e){const t=B3(e),n=zE(t,e),o=zE(t.reverse(),e);return[n,o]}function B3(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const c=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||c?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function zE(e,t){for(const n of e)if(!JL(n,{upTo:t}))return n}function JL(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function QL(e){return e instanceof HTMLInputElement&&"select"in e}function _c(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&QL(e)&&t&&e.select()}}const BE=eN();function eN(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=FE(e,t),e.unshift(t)},remove(t){var n;e=FE(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function FE(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function tN(e){return e.filter(t=>t.tagName!=="A")}const nN=g9["useId".toString()]||(()=>{});let rN=0;function Wa(e){const[t,n]=P.useState(nN());return fo(()=>{e||n(o=>o??String(rN++))},[e]),e||(t?`radix-${t}`:"")}function jc(e){return e.split("-")[0]}function Df(e){return e.split("-")[1]}function bd(e){return["top","bottom"].includes(jc(e))?"x":"y"}function Fx(e){return e==="y"?"height":"width"}function UE(e,t,n){let{reference:o,floating:c}=e;const d=o.x+o.width/2-c.width/2,p=o.y+o.height/2-c.height/2,s=bd(t),_=Fx(s),v=o[_]/2-c[_]/2,E=s==="x";let T;switch(jc(t)){case"top":T={x:d,y:o.y-c.height};break;case"bottom":T={x:d,y:o.y+o.height};break;case"right":T={x:o.x+o.width,y:p};break;case"left":T={x:o.x-c.width,y:p};break;default:T={x:o.x,y:o.y}}switch(Df(t)){case"start":T[s]-=v*(n&&E?-1:1);break;case"end":T[s]+=v*(n&&E?-1:1)}return T}const iN=async(e,t,n)=>{const{placement:o="bottom",strategy:c="absolute",middleware:d=[],platform:p}=n,s=await(p.isRTL==null?void 0:p.isRTL(t));let _=await p.getElementRects({reference:e,floating:t,strategy:c}),{x:v,y:E}=UE(_,o,s),T=o,S={},D=0;for(let O=0;O<d.length;O++){const{name:M,fn:U}=d[O],{x:$,y:L,data:F,reset:J}=await U({x:v,y:E,initialPlacement:o,placement:T,strategy:c,middlewareData:S,rects:_,platform:p,elements:{reference:e,floating:t}});v=$??v,E=L??E,S={...S,[M]:{...S[M],...F}},J&&D<=50&&(D++,typeof J=="object"&&(J.placement&&(T=J.placement),J.rects&&(_=J.rects===!0?await p.getElementRects({reference:e,floating:t,strategy:c}):J.rects),{x:v,y:E}=UE(_,T,s)),O=-1)}return{x:v,y:E,placement:T,strategy:c,middlewareData:S}};function F3(e){return typeof e!="number"?function(t){return{top:0,right:0,bottom:0,left:0,...t}}(e):{top:e,right:e,bottom:e,left:e}}function u0(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}async function gf(e,t){var n;t===void 0&&(t={});const{x:o,y:c,platform:d,rects:p,elements:s,strategy:_}=e,{boundary:v="clippingAncestors",rootBoundary:E="viewport",elementContext:T="floating",altBoundary:S=!1,padding:D=0}=t,O=F3(D),M=s[S?T==="floating"?"reference":"floating":T],U=u0(await d.getClippingRect({element:(n=await(d.isElement==null?void 0:d.isElement(M)))==null||n?M:M.contextElement||await(d.getDocumentElement==null?void 0:d.getDocumentElement(s.floating)),boundary:v,rootBoundary:E,strategy:_})),$=u0(d.convertOffsetParentRelativeRectToViewportRelativeRect?await d.convertOffsetParentRelativeRectToViewportRelativeRect({rect:T==="floating"?{...p.floating,x:o,y:c}:p.reference,offsetParent:await(d.getOffsetParent==null?void 0:d.getOffsetParent(s.floating)),strategy:_}):p[T]);return{top:U.top-$.top+O.top,bottom:$.bottom-U.bottom+O.bottom,left:U.left-$.left+O.left,right:$.right-U.right+O.right}}const oN=Math.min,xc=Math.max;function M_(e,t,n){return xc(e,oN(t,n))}const VE=e=>({name:"arrow",options:e,async fn(t){const{element:n,padding:o=0}=e??{},{x:c,y:d,placement:p,rects:s,platform:_}=t;if(n==null)return{};const v=F3(o),E={x:c,y:d},T=bd(p),S=Df(p),D=Fx(T),O=await _.getDimensions(n),M=T==="y"?"top":"left",U=T==="y"?"bottom":"right",$=s.reference[D]+s.reference[T]-E[T]-s.floating[D],L=E[T]-s.reference[T],F=await(_.getOffsetParent==null?void 0:_.getOffsetParent(n));let J=F?T==="y"?F.clientHeight||0:F.clientWidth||0:0;J===0&&(J=s.floating[D]);const V=$/2-L/2,Z=v[M],G=J-O[D]-v[U],W=J/2-O[D]/2+V,le=M_(Z,W,G),Ie=(S==="start"?v[M]:v[U])>0&&W!==le&&s.reference[D]<=s.floating[D];return{[T]:E[T]-(Ie?W<Z?Z-W:G-W:0),data:{[T]:le,centerOffset:W-le}}}}),aN={left:"right",right:"left",bottom:"top",top:"bottom"};function d0(e){return e.replace(/left|right|bottom|top/g,t=>aN[t])}function sN(e,t,n){n===void 0&&(n=!1);const o=Df(e),c=bd(e),d=Fx(c);let p=c==="x"?o===(n?"end":"start")?"right":"left":o==="start"?"bottom":"top";return t.reference[d]>t.floating[d]&&(p=d0(p)),{main:p,cross:d0(p)}}const lN={start:"end",end:"start"};function jE(e){return e.replace(/start|end/g,t=>lN[t])}const U3=["top","right","bottom","left"];U3.reduce((e,t)=>e.concat(t,t+"-start",t+"-end"),[]);const cN=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n;const{placement:o,middlewareData:c,rects:d,initialPlacement:p,platform:s,elements:_}=t,{mainAxis:v=!0,crossAxis:E=!0,fallbackPlacements:T,fallbackStrategy:S="bestFit",flipAlignment:D=!0,...O}=e,M=jc(o),U=T||(M===p||!D?[d0(p)]:function(W){const le=d0(W);return[jE(W),le,jE(le)]}(p)),$=[p,...U],L=await gf(t,O),F=[];let J=((n=c.flip)==null?void 0:n.overflows)||[];if(v&&F.push(L[M]),E){const{main:W,cross:le}=sN(o,d,await(s.isRTL==null?void 0:s.isRTL(_.floating)));F.push(L[W],L[le])}if(J=[...J,{placement:o,overflows:F}],!F.every(W=>W<=0)){var V,Z;const W=((V=(Z=c.flip)==null?void 0:Z.index)!=null?V:0)+1,le=$[W];if(le)return{data:{index:W,overflows:J},reset:{placement:le}};let Ie="bottom";switch(S){case"bestFit":{var G;const be=(G=J.map(de=>[de,de.overflows.filter(Ne=>Ne>0).reduce((Ne,Ee)=>Ne+Ee,0)]).sort((de,Ne)=>de[1]-Ne[1])[0])==null?void 0:G[0].placement;be&&(Ie=be);break}case"initialPlacement":Ie=p}if(o!==Ie)return{reset:{placement:Ie}}}return{}}}};function GE(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function qE(e){return U3.some(t=>e[t]>=0)}const uN=function(e){let{strategy:t="referenceHidden",...n}=e===void 0?{}:e;return{name:"hide",async fn(o){const{rects:c}=o;switch(t){case"referenceHidden":{const d=GE(await gf(o,{...n,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:qE(d)}}}case"escaped":{const d=GE(await gf(o,{...n,altBoundary:!0}),c.floating);return{data:{escapedOffsets:d,escaped:qE(d)}}}default:return{}}}}},dN=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){const{x:n,y:o}=t,c=await async function(d,p){const{placement:s,platform:_,elements:v}=d,E=await(_.isRTL==null?void 0:_.isRTL(v.floating)),T=jc(s),S=Df(s),D=bd(s)==="x",O=["left","top"].includes(T)?-1:1,M=E&&D?-1:1,U=typeof p=="function"?p(d):p;let{mainAxis:$,crossAxis:L,alignmentAxis:F}=typeof U=="number"?{mainAxis:U,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...U};return S&&typeof F=="number"&&(L=S==="end"?-1*F:F),D?{x:L*M,y:$*O}:{x:$*O,y:L*M}}(t,e);return{x:n+c.x,y:o+c.y,data:c}}}};function V3(e){return e==="x"?"y":"x"}const hN=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:o,placement:c}=t,{mainAxis:d=!0,crossAxis:p=!1,limiter:s={fn:U=>{let{x:$,y:L}=U;return{x:$,y:L}}},..._}=e,v={x:n,y:o},E=await gf(t,_),T=bd(jc(c)),S=V3(T);let D=v[T],O=v[S];if(d){const U=T==="y"?"bottom":"right";D=M_(D+E[T==="y"?"top":"left"],D,D-E[U])}if(p){const U=S==="y"?"bottom":"right";O=M_(O+E[S==="y"?"top":"left"],O,O-E[U])}const M=s.fn({...t,[T]:D,[S]:O});return{...M,data:{x:M.x-n,y:M.y-o}}}}},fN=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:o,placement:c,rects:d,middlewareData:p}=t,{offset:s=0,mainAxis:_=!0,crossAxis:v=!0}=e,E={x:n,y:o},T=bd(c),S=V3(T);let D=E[T],O=E[S];const M=typeof s=="function"?s({...d,placement:c}):s,U=typeof M=="number"?{mainAxis:M,crossAxis:0}:{mainAxis:0,crossAxis:0,...M};if(_){const V=T==="y"?"height":"width",Z=d.reference[T]-d.floating[V]+U.mainAxis,G=d.reference[T]+d.reference[V]-U.mainAxis;D<Z?D=Z:D>G&&(D=G)}if(v){var $,L,F,J;const V=T==="y"?"width":"height",Z=["top","left"].includes(jc(c)),G=d.reference[S]-d.floating[V]+(Z&&($=(L=p.offset)==null?void 0:L[S])!=null?$:0)+(Z?0:U.crossAxis),W=d.reference[S]+d.reference[V]+(Z?0:(F=(J=p.offset)==null?void 0:J[S])!=null?F:0)-(Z?U.crossAxis:0);O<G?O=G:O>W&&(O=W)}return{[T]:D,[S]:O}}}},pN=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){const{placement:n,rects:o,platform:c,elements:d}=t,{apply:p,...s}=e,_=await gf(t,s),v=jc(n),E=Df(n);let T,S;v==="top"||v==="bottom"?(T=v,S=E===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(S=v,T=E==="end"?"top":"bottom");const D=xc(_.left,0),O=xc(_.right,0),M=xc(_.top,0),U=xc(_.bottom,0),$={availableHeight:o.floating.height-(["left","right"].includes(n)?2*(M!==0||U!==0?M+U:xc(_.top,_.bottom)):_[T]),availableWidth:o.floating.width-(["top","bottom"].includes(n)?2*(D!==0||O!==0?D+O:xc(_.left,_.right)):_[S])},L=await c.getDimensions(d.floating);p?.({...t,...$});const F=await c.getDimensions(d.floating);return L.width!==F.width||L.height!==F.height?{reset:{rects:!0}}:{}}}};function j3(e){return e&&e.document&&e.location&&e.alert&&e.setInterval}function zs(e){if(e==null)return window;if(!j3(e)){const t=e.ownerDocument;return t&&t.defaultView||window}return e}function Rf(e){return zs(e).getComputedStyle(e)}function Ps(e){return j3(e)?"":e?(e.nodeName||"").toLowerCase():""}function G3(){const e=navigator.userAgentData;return e!=null&&e.brands?e.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function Za(e){return e instanceof zs(e).HTMLElement}function Ll(e){return e instanceof zs(e).Element}function Ux(e){return typeof ShadowRoot>"u"?!1:e instanceof zs(e).ShadowRoot||e instanceof ShadowRoot}function q0(e){const{overflow:t,overflowX:n,overflowY:o}=Rf(e);return/auto|scroll|overlay|hidden/.test(t+o+n)}function mN(e){return["table","td","th"].includes(Ps(e))}function WE(e){const t=/firefox/i.test(G3()),n=Rf(e);return n.transform!=="none"||n.perspective!=="none"||n.contain==="paint"||["transform","perspective"].includes(n.willChange)||t&&n.willChange==="filter"||t&&!!n.filter&&n.filter!=="none"}function q3(){return!/^((?!chrome|android).)*safari/i.test(G3())}const HE=Math.min,Uh=Math.max,h0=Math.round;function As(e,t,n){var o,c,d,p;t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect();let _=1,v=1;t&&Za(e)&&(_=e.offsetWidth>0&&h0(s.width)/e.offsetWidth||1,v=e.offsetHeight>0&&h0(s.height)/e.offsetHeight||1);const E=Ll(e)?zs(e):window,T=!q3()&&n,S=(s.left+(T&&(o=(c=E.visualViewport)==null?void 0:c.offsetLeft)!=null?o:0))/_,D=(s.top+(T&&(d=(p=E.visualViewport)==null?void 0:p.offsetTop)!=null?d:0))/v,O=s.width/_,M=s.height/v;return{width:O,height:M,top:D,right:S+O,bottom:D+M,left:S,x:S,y:D}}function Il(e){return(t=e,(t instanceof zs(t).Node?e.ownerDocument:e.document)||window.document).documentElement;var t}function W0(e){return Ll(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function W3(e){return As(Il(e)).left+W0(e).scrollLeft}function gN(e,t,n){const o=Za(t),c=Il(t),d=As(e,o&&function(_){const v=As(_);return h0(v.width)!==_.offsetWidth||h0(v.height)!==_.offsetHeight}(t),n==="fixed");let p={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(o||!o&&n!=="fixed")if((Ps(t)!=="body"||q0(c))&&(p=W0(t)),Za(t)){const _=As(t,!0);s.x=_.x+t.clientLeft,s.y=_.y+t.clientTop}else c&&(s.x=W3(c));return{x:d.left+p.scrollLeft-s.x,y:d.top+p.scrollTop-s.y,width:d.width,height:d.height}}function H3(e){return Ps(e)==="html"?e:e.assignedSlot||e.parentNode||(Ux(e)?e.host:null)||Il(e)}function ZE(e){return Za(e)&&getComputedStyle(e).position!=="fixed"?e.offsetParent:null}function D_(e){const t=zs(e);let n=ZE(e);for(;n&&mN(n)&&getComputedStyle(n).position==="static";)n=ZE(n);return n&&(Ps(n)==="html"||Ps(n)==="body"&&getComputedStyle(n).position==="static"&&!WE(n))?t:n||function(o){let c=H3(o);for(Ux(c)&&(c=c.host);Za(c)&&!["html","body"].includes(Ps(c));){if(WE(c))return c;c=c.parentNode}return null}(e)||t}function KE(e){if(Za(e))return{width:e.offsetWidth,height:e.offsetHeight};const t=As(e);return{width:t.width,height:t.height}}function Z3(e){const t=H3(e);return["html","body","#document"].includes(Ps(t))?e.ownerDocument.body:Za(t)&&q0(t)?t:Z3(t)}function f0(e,t){var n;t===void 0&&(t=[]);const o=Z3(e),c=o===((n=e.ownerDocument)==null?void 0:n.body),d=zs(o),p=c?[d].concat(d.visualViewport||[],q0(o)?o:[]):o,s=t.concat(p);return c?s:s.concat(f0(p))}function XE(e,t,n){return t==="viewport"?u0(function(o,c){const d=zs(o),p=Il(o),s=d.visualViewport;let _=p.clientWidth,v=p.clientHeight,E=0,T=0;if(s){_=s.width,v=s.height;const S=q3();(S||!S&&c==="fixed")&&(E=s.offsetLeft,T=s.offsetTop)}return{width:_,height:v,x:E,y:T}}(e,n)):Ll(t)?function(o,c){const d=As(o,!1,c==="fixed"),p=d.top+o.clientTop,s=d.left+o.clientLeft;return{top:p,left:s,x:s,y:p,right:s+o.clientWidth,bottom:p+o.clientHeight,width:o.clientWidth,height:o.clientHeight}}(t,n):u0(function(o){var c;const d=Il(o),p=W0(o),s=(c=o.ownerDocument)==null?void 0:c.body,_=Uh(d.scrollWidth,d.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),v=Uh(d.scrollHeight,d.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0);let E=-p.scrollLeft+W3(o);const T=-p.scrollTop;return Rf(s||d).direction==="rtl"&&(E+=Uh(d.clientWidth,s?s.clientWidth:0)-_),{width:_,height:v,x:E,y:T}}(Il(e)))}function yN(e){const t=f0(e),n=["absolute","fixed"].includes(Rf(e).position)&&Za(e)?D_(e):e;return Ll(n)?t.filter(o=>Ll(o)&&function(c,d){const p=d.getRootNode==null?void 0:d.getRootNode();if(c.contains(d))return!0;if(p&&Ux(p)){let s=d;do{if(s&&c===s)return!0;s=s.parentNode||s.host}while(s)}return!1}(o,n)&&Ps(o)!=="body"):[]}const vN={getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:o,strategy:c}=e;const d=[...n==="clippingAncestors"?yN(t):[].concat(n),o],p=d[0],s=d.reduce((_,v)=>{const E=XE(t,v,c);return _.top=Uh(E.top,_.top),_.right=HE(E.right,_.right),_.bottom=HE(E.bottom,_.bottom),_.left=Uh(E.left,_.left),_},XE(t,p,c));return{width:s.right-s.left,height:s.bottom-s.top,x:s.left,y:s.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:o}=e;const c=Za(n),d=Il(n);if(n===d)return t;let p={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if((c||!c&&o!=="fixed")&&((Ps(n)!=="body"||q0(d))&&(p=W0(n)),Za(n))){const _=As(n,!0);s.x=_.x+n.clientLeft,s.y=_.y+n.clientTop}return{...t,x:t.x-p.scrollLeft+s.x,y:t.y-p.scrollTop+s.y}},isElement:Ll,getDimensions:KE,getOffsetParent:D_,getDocumentElement:Il,getElementRects:e=>{let{reference:t,floating:n,strategy:o}=e;return{reference:gN(t,D_(n),o),floating:{...KE(n),x:0,y:0}}},getClientRects:e=>Array.from(e.getClientRects()),isRTL:e=>Rf(e).direction==="rtl"};function _N(e,t,n,o){o===void 0&&(o={});const{ancestorScroll:c=!0,ancestorResize:d=!0,elementResize:p=!0,animationFrame:s=!1}=o,_=c&&!s,v=d&&!s,E=_||v?[...Ll(e)?f0(e):[],...f0(t)]:[];E.forEach(O=>{_&&O.addEventListener("scroll",n,{passive:!0}),v&&O.addEventListener("resize",n)});let T,S=null;if(p){let O=!0;S=new ResizeObserver(()=>{O||n(),O=!1}),Ll(e)&&!s&&S.observe(e),S.observe(t)}let D=s?As(e):null;return s&&function O(){const M=As(e);!D||M.x===D.x&&M.y===D.y&&M.width===D.width&&M.height===D.height||n(),D=M,T=requestAnimationFrame(O)}(),n(),()=>{var O;E.forEach(M=>{_&&M.removeEventListener("scroll",n),v&&M.removeEventListener("resize",n)}),(O=S)==null||O.disconnect(),S=null,s&&cancelAnimationFrame(T)}}const xN=(e,t,n)=>iN(e,t,{platform:vN,...n});var R_=typeof document<"u"?P.useLayoutEffect:P.useEffect;function L_(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,o,c;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(o=n;o--!==0;)if(!L_(e[o],t[o]))return!1;return!0}if(c=Object.keys(e),n=c.length,n!==Object.keys(t).length)return!1;for(o=n;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,c[o]))return!1;for(o=n;o--!==0;){const d=c[o];if(!(d==="_owner"&&e.$$typeof)&&!L_(e[d],t[d]))return!1}return!0}return e!==e&&t!==t}function bN(e){const t=P.useRef(e);return R_(()=>{t.current=e}),t}function wN(e){let{middleware:t,placement:n="bottom",strategy:o="absolute",whileElementsMounted:c}=e===void 0?{}:e;const d=P.useRef(null),p=P.useRef(null),s=bN(c),_=P.useRef(null),[v,E]=P.useState({x:null,y:null,strategy:o,placement:n,middlewareData:{}}),[T,S]=P.useState(t);L_(T?.map(F=>{let{options:J}=F;return J}),t?.map(F=>{let{options:J}=F;return J}))||S(t);const D=P.useCallback(()=>{!d.current||!p.current||xN(d.current,p.current,{middleware:T,placement:n,strategy:o}).then(F=>{O.current&&yo.flushSync(()=>{E(F)})})},[T,n,o]);R_(()=>{O.current&&D()},[D]);const O=P.useRef(!1);R_(()=>(O.current=!0,()=>{O.current=!1}),[]);const M=P.useCallback(()=>{if(typeof _.current=="function"&&(_.current(),_.current=null),d.current&&p.current)if(s.current){const F=s.current(d.current,p.current,D);_.current=F}else D()},[D,s]),U=P.useCallback(F=>{d.current=F,M()},[M]),$=P.useCallback(F=>{p.current=F,M()},[M]),L=P.useMemo(()=>({reference:d,floating:p}),[]);return P.useMemo(()=>({...v,update:D,refs:L,reference:U,floating:$}),[v,D,L,U,$])}const EN=e=>{const{element:t,padding:n}=e;function o(c){return Object.prototype.hasOwnProperty.call(c,"current")}return{name:"arrow",options:e,fn(c){return o(t)?t.current!=null?VE({element:t.current,padding:n}).fn(c):{}:t?VE({element:t,padding:n}).fn(c):{}}}},K3="Popper",[Vx,X3]=Ka(K3),[TN,Y3]=Vx(K3),SN=e=>{const{__scopePopper:t,children:n}=e,[o,c]=P.useState(null);return P.createElement(TN,{scope:t,anchor:o,onAnchorChange:c},n)},kN="PopperAnchor",CN=P.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:o,...c}=e,d=Y3(kN,n),p=P.useRef(null),s=ar(t,p);return P.useEffect(()=>{d.onAnchorChange(o?.current||p.current)}),o?null:P.createElement(Tn.div,Bt({},c,{ref:s}))}),p0="PopperContent",[PN,dU]=Vx(p0),[AN,IN]=Vx(p0,{hasParent:!1,positionUpdateFns:new Set}),MN=P.forwardRef((e,t)=>{var n,o,c,d,p,s,_,v;const{__scopePopper:E,side:T="bottom",sideOffset:S=0,align:D="center",alignOffset:O=0,arrowPadding:M=0,collisionBoundary:U=[],collisionPadding:$=0,sticky:L="partial",hideWhenDetached:F=!1,avoidCollisions:J=!0,onPlaced:V,...Z}=e,G=Y3(p0,E),[W,le]=P.useState(null),Ie=ar(t,on=>le(on)),[be,de]=P.useState(null),Ne=Nx(be),Ee=(n=Ne?.width)!==null&&n!==void 0?n:0,Oe=(o=Ne?.height)!==null&&o!==void 0?o:0,ze=T+(D!=="center"?"-"+D:""),rt=typeof $=="number"?$:{top:0,right:0,bottom:0,left:0,...$},We=Array.isArray(U)?U:[U],Ae=We.length>0,He={padding:rt,boundary:We.filter(RN),altBoundary:Ae},{reference:ft,floating:Qe,strategy:Rt,x:zt,y:X,placement:tt,middlewareData:je,update:ve}=wN({strategy:"fixed",placement:ze,whileElementsMounted:_N,middleware:[LN(),dN({mainAxis:S+Oe,alignmentAxis:O}),J?hN({mainAxis:!0,crossAxis:!1,limiter:L==="partial"?fN():void 0,...He}):void 0,be?EN({element:be,padding:M}):void 0,J?cN({...He}):void 0,pN({...He,apply:({elements:on,availableWidth:pn,availableHeight:sr})=>{on.floating.style.setProperty("--radix-popper-available-width",`${pn}px`),on.floating.style.setProperty("--radix-popper-available-height",`${sr}px`)}}),NN({arrowWidth:Ee,arrowHeight:Oe}),F?uN({strategy:"referenceHidden"}):void 0].filter(DN)});fo(()=>{ft(G.anchor)},[ft,G.anchor]);const ke=zt!==null&&X!==null,[we,De]=J3(tt),Pe=oi(V);fo(()=>{ke&&Pe?.()},[ke,Pe]);const lt=(c=je.arrow)===null||c===void 0?void 0:c.x,dt=(d=je.arrow)===null||d===void 0?void 0:d.y,ue=((p=je.arrow)===null||p===void 0?void 0:p.centerOffset)!==0,[Fe,Ke]=P.useState();fo(()=>{W&&Ke(window.getComputedStyle(W).zIndex)},[W]);const{hasParent:it,positionUpdateFns:ct}=IN(p0,E),at=!it;P.useLayoutEffect(()=>{if(!at)return ct.add(ve),()=>{ct.delete(ve)}},[at,ct,ve]),fo(()=>{at&&ke&&Array.from(ct).reverse().forEach(on=>requestAnimationFrame(on))},[at,ke,ct]);const Ot={"data-side":we,"data-align":De,...Z,ref:Ie,style:{...Z.style,animation:ke?void 0:"none",opacity:(s=je.hide)!==null&&s!==void 0&&s.referenceHidden?0:void 0}};return P.createElement("div",{ref:Qe,"data-radix-popper-content-wrapper":"",style:{position:Rt,left:0,top:0,transform:ke?`translate3d(${Math.round(zt)}px, ${Math.round(X)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:Fe,["--radix-popper-transform-origin"]:[(_=je.transformOrigin)===null||_===void 0?void 0:_.x,(v=je.transformOrigin)===null||v===void 0?void 0:v.y].join(" ")},dir:e.dir},P.createElement(PN,{scope:E,placedSide:we,onArrowChange:de,arrowX:lt,arrowY:dt,shouldHideArrow:ue},at?P.createElement(AN,{scope:E,hasParent:!0,positionUpdateFns:ct},P.createElement(Tn.div,Ot)):P.createElement(Tn.div,Ot)))});function DN(e){return e!==void 0}function RN(e){return e!==null}const LN=()=>({name:"anchorCssProperties",fn(e){const{rects:t,elements:n}=e,{width:o,height:c}=t.reference;return n.floating.style.setProperty("--radix-popper-anchor-width",`${o}px`),n.floating.style.setProperty("--radix-popper-anchor-height",`${c}px`),{}}}),NN=e=>({name:"transformOrigin",options:e,fn(t){var n,o,c,d,p;const{placement:s,rects:_,middlewareData:v}=t,T=((n=v.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,S=T?0:e.arrowWidth,D=T?0:e.arrowHeight,[O,M]=J3(s),U={start:"0%",center:"50%",end:"100%"}[M],$=((o=(c=v.arrow)===null||c===void 0?void 0:c.x)!==null&&o!==void 0?o:0)+S/2,L=((d=(p=v.arrow)===null||p===void 0?void 0:p.y)!==null&&d!==void 0?d:0)+D/2;let F="",J="";return O==="bottom"?(F=T?U:`${$}px`,J=`${-D}px`):O==="top"?(F=T?U:`${$}px`,J=`${_.floating.height+D}px`):O==="right"?(F=`${-D}px`,J=T?U:`${L}px`):O==="left"&&(F=`${_.floating.width+D}px`,J=T?U:`${L}px`),{data:{x:F,y:J}}}});function J3(e){const[t,n="center"]=e.split("-");return[t,n]}const ON=SN,$N=CN,zN=MN,jx=P.forwardRef((e,t)=>{var n;const{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...c}=e;return o?Uk.createPortal(P.createElement(Tn.div,Bt({},c,{ref:t})),o):null}),Gx=P.forwardRef((e,t)=>P.createElement(Tn.span,Bt({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}})));var BN=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Su=new WeakMap,em=new WeakMap,tm={},Xy=0,Q3=function(e){return e&&(e.host||Q3(e.parentNode))},FN=function(e,t){return t.map(function(n){if(e.contains(n))return n;var o=Q3(n);return o&&e.contains(o)?o:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return Boolean(n)})},UN=function(e,t,n,o){var c=FN(t,Array.isArray(e)?e:[e]);tm[n]||(tm[n]=new WeakMap);var d=tm[n],p=[],s=new Set,_=new Set(c),v=function(T){!T||s.has(T)||(s.add(T),v(T.parentNode))};c.forEach(v);var E=function(T){!T||_.has(T)||Array.prototype.forEach.call(T.children,function(S){if(s.has(S))E(S);else{var D=S.getAttribute(o),O=D!==null&&D!=="false",M=(Su.get(S)||0)+1,U=(d.get(S)||0)+1;Su.set(S,M),d.set(S,U),p.push(S),M===1&&O&&em.set(S,!0),U===1&&S.setAttribute(n,"true"),O||S.setAttribute(o,"true")}})};return E(t),s.clear(),Xy++,function(){p.forEach(function(T){var S=Su.get(T)-1,D=d.get(T)-1;Su.set(T,S),d.set(T,D),S||(em.has(T)||T.removeAttribute(o),em.delete(T)),D||T.removeAttribute(n)}),Xy--,Xy||(Su=new WeakMap,Su=new WeakMap,em=new WeakMap,tm={})}},qx=function(e,t,n){n===void 0&&(n="data-aria-hidden");var o=Array.from(Array.isArray(e)?e:[e]),c=t||BN(e);return c?(o.push.apply(o,Array.from(c.querySelectorAll("[aria-live]"))),UN(o,c,n,"aria-hidden")):function(){return null}},Vh="right-scroll-bar-position",jh="width-before-scroll-bar",VN="with-scroll-bars-hidden",jN="--removed-body-scroll-bar-size";function GN(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function qN(e,t){var n=P.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(o){var c=n.value;c!==o&&(n.value=o,n.callback(o,c))}}}})[0];return n.callback=t,n.facade}function eP(e,t){return qN(t||null,function(n){return e.forEach(function(o){return GN(o,n)})})}function WN(e){return e}function HN(e,t){t===void 0&&(t=WN);var n=[],o=!1,c={read:function(){if(o)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(d){var p=t(d,o);return n.push(p),function(){n=n.filter(function(s){return s!==p})}},assignSyncMedium:function(d){for(o=!0;n.length;){var p=n;n=[],p.forEach(d)}n={push:function(s){return d(s)},filter:function(){return n}}},assignMedium:function(d){o=!0;var p=[];if(n.length){var s=n;n=[],s.forEach(d),p=n}var _=function(){var E=p;p=[],E.forEach(d)},v=function(){return Promise.resolve().then(_)};v(),n={push:function(E){p.push(E),v()},filter:function(E){return p=p.filter(E),n}}}};return c}function tP(e){e===void 0&&(e={});var t=HN(null);return t.options=Si({async:!0,ssr:!1},e),t}var nP=function(e){var t=e.sideCar,n=$0(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var o=t.read();if(!o)throw new Error("Sidecar medium not found");return P.createElement(o,Si({},n))};nP.isSideCarExport=!0;function rP(e,t){return e.useMedium(t),nP}var iP=tP(),Yy=function(){},H0=P.forwardRef(function(e,t){var n=P.useRef(null),o=P.useState({onScrollCapture:Yy,onWheelCapture:Yy,onTouchMoveCapture:Yy}),c=o[0],d=o[1],p=e.forwardProps,s=e.children,_=e.className,v=e.removeScrollBar,E=e.enabled,T=e.shards,S=e.sideCar,D=e.noIsolation,O=e.inert,M=e.allowPinchZoom,U=e.as,$=U===void 0?"div":U,L=$0(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),F=S,J=eP([n,t]),V=Si(Si({},L),c);return P.createElement(P.Fragment,null,E&&P.createElement(F,{sideCar:iP,removeScrollBar:v,shards:T,noIsolation:D,inert:O,setCallbacks:d,allowPinchZoom:!!M,lockRef:n}),p?P.cloneElement(P.Children.only(s),Si(Si({},V),{ref:J})):P.createElement($,Si({},V,{className:_,ref:J}),s))});H0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};H0.classNames={fullWidth:jh,zeroRight:Vh};var YE,ZN=function(){if(YE)return YE;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function KN(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=ZN();return t&&e.setAttribute("nonce",t),e}function XN(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function YN(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var JN=function(){var e=0,t=null;return{add:function(n){e==0&&(t=KN())&&(XN(t,n),YN(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},QN=function(){var e=JN();return function(t,n){P.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Wx=function(){var e=QN(),t=function(n){var o=n.styles,c=n.dynamic;return e(o,c),null};return t},eO={left:0,top:0,right:0,gap:0},Jy=function(e){return parseInt(e||"",10)||0},tO=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],o=t[e==="padding"?"paddingTop":"marginTop"],c=t[e==="padding"?"paddingRight":"marginRight"];return[Jy(n),Jy(o),Jy(c)]},nO=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return eO;var t=tO(e),n=document.documentElement.clientWidth,o=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,o-n+t[2]-t[0])}},rO=Wx(),iO=function(e,t,n,o){var c=e.left,d=e.top,p=e.right,s=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(VN,` {
   overflow: hidden `).concat(o,`;
   padding-right: `).concat(s,"px ").concat(o,`;
  }
  body {
    overflow: hidden `).concat(o,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(o,";"),n==="margin"&&`
    padding-left: `.concat(c,`px;
    padding-top: `).concat(d,`px;
    padding-right: `).concat(p,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(o,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(o,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Vh,` {
    right: `).concat(s,"px ").concat(o,`;
  }
  
  .`).concat(jh,` {
    margin-right: `).concat(s,"px ").concat(o,`;
  }
  
  .`).concat(Vh," .").concat(Vh,` {
    right: 0 `).concat(o,`;
  }
  
  .`).concat(jh," .").concat(jh,` {
    margin-right: 0 `).concat(o,`;
  }
  
  body {
    `).concat(jN,": ").concat(s,`px;
  }
`)},oP=function(e){var t=e.noRelative,n=e.noImportant,o=e.gapMode,c=o===void 0?"margin":o,d=P.useMemo(function(){return nO(c)},[c]);return P.createElement(rO,{styles:iO(d,!t,c,n?"":"!important")})},N_=!1;if(typeof window<"u")try{var nm=Object.defineProperty({},"passive",{get:function(){return N_=!0,!0}});window.addEventListener("test",nm,nm),window.removeEventListener("test",nm,nm)}catch{N_=!1}var ku=N_?{passive:!1}:!1,oO=function(e){return e.tagName==="TEXTAREA"},aP=function(e,t){var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!oO(e)&&n[t]==="visible")},aO=function(e){return aP(e,"overflowY")},sO=function(e){return aP(e,"overflowX")},JE=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=sP(e,n);if(o){var c=lP(e,n),d=c[1],p=c[2];if(d>p)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},lO=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},cO=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},sP=function(e,t){return e==="v"?aO(t):sO(t)},lP=function(e,t){return e==="v"?lO(t):cO(t)},uO=function(e,t){return e==="h"&&t==="rtl"?-1:1},dO=function(e,t,n,o,c){var d=uO(e,window.getComputedStyle(t).direction),p=d*o,s=n.target,_=t.contains(s),v=!1,E=p>0,T=0,S=0;do{var D=lP(e,s),O=D[0],M=D[1],U=D[2],$=M-U-d*O;(O||$)&&sP(e,s)&&(T+=$,S+=O),s=s.parentNode}while(!_&&s!==document.body||_&&(t.contains(s)||t===s));return(E&&(c&&T===0||!c&&p>T)||!E&&(c&&S===0||!c&&-p>S))&&(v=!0),v},rm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},QE=function(e){return[e.deltaX,e.deltaY]},eT=function(e){return e&&"current"in e?e.current:e},hO=function(e,t){return e[0]===t[0]&&e[1]===t[1]},fO=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},pO=0,Cu=[];function mO(e){var t=P.useRef([]),n=P.useRef([0,0]),o=P.useRef(),c=P.useState(pO++)[0],d=P.useState(function(){return Wx()})[0],p=P.useRef(e);P.useEffect(function(){p.current=e},[e]),P.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(c));var M=fx([e.lockRef.current],(e.shards||[]).map(eT),!0).filter(Boolean);return M.forEach(function(U){return U.classList.add("allow-interactivity-".concat(c))}),function(){document.body.classList.remove("block-interactivity-".concat(c)),M.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(c))})}}},[e.inert,e.lockRef.current,e.shards]);var s=P.useCallback(function(M,U){if("touches"in M&&M.touches.length===2)return!p.current.allowPinchZoom;var $=rm(M),L=n.current,F="deltaX"in M?M.deltaX:L[0]-$[0],J="deltaY"in M?M.deltaY:L[1]-$[1],V,Z=M.target,G=Math.abs(F)>Math.abs(J)?"h":"v";if("touches"in M&&G==="h"&&Z.type==="range")return!1;var W=JE(G,Z);if(!W)return!0;if(W?V=G:(V=G==="v"?"h":"v",W=JE(G,Z)),!W)return!1;if(!o.current&&"changedTouches"in M&&(F||J)&&(o.current=V),!V)return!0;var le=o.current||V;return dO(le,U,M,le==="h"?F:J,!0)},[]),_=P.useCallback(function(M){var U=M;if(!(!Cu.length||Cu[Cu.length-1]!==d)){var $="deltaY"in U?QE(U):rm(U),L=t.current.filter(function(V){return V.name===U.type&&V.target===U.target&&hO(V.delta,$)})[0];if(L&&L.should){U.cancelable&&U.preventDefault();return}if(!L){var F=(p.current.shards||[]).map(eT).filter(Boolean).filter(function(V){return V.contains(U.target)}),J=F.length>0?s(U,F[0]):!p.current.noIsolation;J&&U.cancelable&&U.preventDefault()}}},[]),v=P.useCallback(function(M,U,$,L){var F={name:M,delta:U,target:$,should:L};t.current.push(F),setTimeout(function(){t.current=t.current.filter(function(J){return J!==F})},1)},[]),E=P.useCallback(function(M){n.current=rm(M),o.current=void 0},[]),T=P.useCallback(function(M){v(M.type,QE(M),M.target,s(M,e.lockRef.current))},[]),S=P.useCallback(function(M){v(M.type,rm(M),M.target,s(M,e.lockRef.current))},[]);P.useEffect(function(){return Cu.push(d),e.setCallbacks({onScrollCapture:T,onWheelCapture:T,onTouchMoveCapture:S}),document.addEventListener("wheel",_,ku),document.addEventListener("touchmove",_,ku),document.addEventListener("touchstart",E,ku),function(){Cu=Cu.filter(function(M){return M!==d}),document.removeEventListener("wheel",_,ku),document.removeEventListener("touchmove",_,ku),document.removeEventListener("touchstart",E,ku)}},[]);var D=e.removeScrollBar,O=e.inert;return P.createElement(P.Fragment,null,O?P.createElement(d,{styles:fO(c)}):null,D?P.createElement(oP,{gapMode:"margin"}):null)}const gO=rP(iP,mO);var cP=P.forwardRef(function(e,t){return P.createElement(H0,Si({},e,{ref:t,sideCar:gO}))});cP.classNames=H0.classNames;const uP=cP,yO=[" ","Enter","ArrowUp","ArrowDown"],vO=[" ","Enter"],Z0="Select",[K0,Hx,_O]=Ox(Z0),[wd,hU]=Ka(Z0,[_O,X3]),Zx=X3(),[xO,Gc]=wd(Z0),[bO,wO]=wd(Z0),EO=e=>{const{__scopeSelect:t,children:n,open:o,defaultOpen:c,onOpenChange:d,value:p,defaultValue:s,onValueChange:_,dir:v,name:E,autoComplete:T,disabled:S,required:D}=e,O=Zx(t),[M,U]=P.useState(null),[$,L]=P.useState(null),[F,J]=P.useState(!1),V=$x(v),[Z=!1,G]=Ns({prop:o,defaultProp:c,onChange:d}),[W,le]=Ns({prop:p,defaultProp:s,onChange:_}),Ie=P.useRef(null),be=M?Boolean(M.closest("form")):!0,[de,Ne]=P.useState(new Set),Ee=Array.from(de).map(Oe=>Oe.props.value).join(";");return P.createElement(ON,O,P.createElement(xO,{required:D,scope:t,trigger:M,onTriggerChange:U,valueNode:$,onValueNodeChange:L,valueNodeHasChildren:F,onValueNodeHasChildrenChange:J,contentId:Wa(),value:W,onValueChange:le,open:Z,onOpenChange:G,dir:V,triggerPointerDownPosRef:Ie,disabled:S},P.createElement(K0.Provider,{scope:t},P.createElement(bO,{scope:e.__scopeSelect,onNativeOptionAdd:P.useCallback(Oe=>{Ne(ze=>new Set(ze).add(Oe))},[]),onNativeOptionRemove:P.useCallback(Oe=>{Ne(ze=>{const rt=new Set(ze);return rt.delete(Oe),rt})},[])},n)),be?P.createElement(fP,{key:Ee,"aria-hidden":!0,required:D,tabIndex:-1,name:E,autoComplete:T,value:W,onChange:Oe=>le(Oe.target.value),disabled:S},W===void 0?P.createElement("option",{value:""}):null,Array.from(de)):null))},TO="SelectTrigger",SO=P.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:o=!1,...c}=e,d=Zx(n),p=Gc(TO,n),s=p.disabled||o,_=ar(t,p.onTriggerChange),v=Hx(n),[E,T,S]=pP(O=>{const M=v().filter(L=>!L.disabled),U=M.find(L=>L.value===p.value),$=mP(M,O,U);$!==void 0&&p.onValueChange($.value)}),D=()=>{s||(p.onOpenChange(!0),S())};return P.createElement($N,Bt({asChild:!0},d),P.createElement(Tn.button,Bt({type:"button",role:"combobox","aria-controls":p.contentId,"aria-expanded":p.open,"aria-required":p.required,"aria-autocomplete":"none",dir:p.dir,"data-state":p.open?"open":"closed",disabled:s,"data-disabled":s?"":void 0,"data-placeholder":p.value===void 0?"":void 0},c,{ref:_,onClick:ln(c.onClick,O=>{O.currentTarget.focus()}),onPointerDown:ln(c.onPointerDown,O=>{const M=O.target;M.hasPointerCapture(O.pointerId)&&M.releasePointerCapture(O.pointerId),O.button===0&&O.ctrlKey===!1&&(D(),p.triggerPointerDownPosRef.current={x:Math.round(O.pageX),y:Math.round(O.pageY)},O.preventDefault())}),onKeyDown:ln(c.onKeyDown,O=>{const M=E.current!=="";!(O.ctrlKey||O.altKey||O.metaKey)&&O.key.length===1&&T(O.key),!(M&&O.key===" ")&&yO.includes(O.key)&&(D(),O.preventDefault())})})))}),kO="SelectValue",CO=P.forwardRef((e,t)=>{const{__scopeSelect:n,className:o,style:c,children:d,placeholder:p,...s}=e,_=Gc(kO,n),{onValueNodeHasChildrenChange:v}=_,E=d!==void 0,T=ar(t,_.onValueNodeChange);return fo(()=>{v(E)},[v,E]),P.createElement(Tn.span,Bt({},s,{ref:T,style:{pointerEvents:"none"}}),_.value===void 0&&p!==void 0?p:d)}),PO=e=>P.createElement(jx,Bt({asChild:!0},e)),gd="SelectContent",AO=P.forwardRef((e,t)=>{const n=Gc(gd,e.__scopeSelect),[o,c]=P.useState();if(fo(()=>{c(new DocumentFragment)},[]),!n.open){const d=o;return d?yo.createPortal(P.createElement(dP,{scope:e.__scopeSelect},P.createElement(K0.Slot,{scope:e.__scopeSelect},P.createElement("div",null,e.children))),d):null}return P.createElement(IO,Bt({},e,{ref:t}))}),_s=10,[dP,X0]=wd(gd),IO=P.forwardRef((e,t)=>{const{__scopeSelect:n,position:o="item-aligned",onCloseAutoFocus:c,onEscapeKeyDown:d,onPointerDownOutside:p,side:s,sideOffset:_,align:v,alignOffset:E,arrowPadding:T,collisionBoundary:S,collisionPadding:D,sticky:O,hideWhenDetached:M,avoidCollisions:U,...$}=e,L=Gc(gd,n),[F,J]=P.useState(null),[V,Z]=P.useState(null),G=ar(t,je=>J(je)),[W,le]=P.useState(null),[Ie,be]=P.useState(null),de=Hx(n),[Ne,Ee]=P.useState(!1),Oe=P.useRef(!1);P.useEffect(()=>{if(F)return qx(F)},[F]),Bx();const ze=P.useCallback(je=>{const[ve,...ke]=de().map(Pe=>Pe.ref.current),[we]=ke.slice(-1),De=document.activeElement;for(const Pe of je)if(Pe===De||(Pe?.scrollIntoView({block:"nearest"}),Pe===ve&&V&&(V.scrollTop=0),Pe===we&&V&&(V.scrollTop=V.scrollHeight),Pe?.focus(),document.activeElement!==De))return},[de,V]),rt=P.useCallback(()=>ze([W,F]),[ze,W,F]);P.useEffect(()=>{Ne&&rt()},[Ne,rt]);const{onOpenChange:We,triggerPointerDownPosRef:Ae}=L;P.useEffect(()=>{if(F){let je={x:0,y:0};const ve=we=>{var De,Pe,lt,dt;je={x:Math.abs(Math.round(we.pageX)-((De=(Pe=Ae.current)===null||Pe===void 0?void 0:Pe.x)!==null&&De!==void 0?De:0)),y:Math.abs(Math.round(we.pageY)-((lt=(dt=Ae.current)===null||dt===void 0?void 0:dt.y)!==null&&lt!==void 0?lt:0))}},ke=we=>{je.x<=10&&je.y<=10?we.preventDefault():F.contains(we.target)||We(!1),document.removeEventListener("pointermove",ve),Ae.current=null};return Ae.current!==null&&(document.addEventListener("pointermove",ve),document.addEventListener("pointerup",ke,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ve),document.removeEventListener("pointerup",ke,{capture:!0})}}},[F,We,Ae]),P.useEffect(()=>{const je=()=>We(!1);return window.addEventListener("blur",je),window.addEventListener("resize",je),()=>{window.removeEventListener("blur",je),window.removeEventListener("resize",je)}},[We]);const[He,ft]=pP(je=>{const ve=de().filter(De=>!De.disabled),ke=ve.find(De=>De.ref.current===document.activeElement),we=mP(ve,je,ke);we&&setTimeout(()=>we.ref.current.focus())}),Qe=P.useCallback((je,ve,ke)=>{const we=!Oe.current&&!ke;(L.value!==void 0&&L.value===ve||we)&&(le(je),we&&(Oe.current=!0))},[L.value]),Rt=P.useCallback(()=>F?.focus(),[F]),zt=P.useCallback((je,ve,ke)=>{const we=!Oe.current&&!ke;(L.value!==void 0&&L.value===ve||we)&&be(je)},[L.value]),X=o==="popper"?tT:MO,tt=X===tT?{side:s,sideOffset:_,align:v,alignOffset:E,arrowPadding:T,collisionBoundary:S,collisionPadding:D,sticky:O,hideWhenDetached:M,avoidCollisions:U}:{};return P.createElement(dP,{scope:n,content:F,viewport:V,onViewportChange:Z,itemRefCallback:Qe,selectedItem:W,onItemLeave:Rt,itemTextRefCallback:zt,focusSelectedItem:rt,selectedItemText:Ie,position:o,isPositioned:Ne,searchRef:He},P.createElement(uP,{as:md,allowPinchZoom:!0},P.createElement(z3,{asChild:!0,trapped:L.open,onMountAutoFocus:je=>{je.preventDefault()},onUnmountAutoFocus:ln(c,je=>{var ve;(ve=L.trigger)===null||ve===void 0||ve.focus({preventScroll:!0}),je.preventDefault()})},P.createElement(zx,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:d,onPointerDownOutside:p,onFocusOutside:je=>je.preventDefault(),onDismiss:()=>L.onOpenChange(!1)},P.createElement(X,Bt({role:"listbox",id:L.contentId,"data-state":L.open?"open":"closed",dir:L.dir,onContextMenu:je=>je.preventDefault()},$,tt,{onPlaced:()=>Ee(!0),ref:G,style:{display:"flex",flexDirection:"column",outline:"none",...$.style},onKeyDown:ln($.onKeyDown,je=>{const ve=je.ctrlKey||je.altKey||je.metaKey;if(je.key==="Tab"&&je.preventDefault(),!ve&&je.key.length===1&&ft(je.key),["ArrowUp","ArrowDown","Home","End"].includes(je.key)){let we=de().filter(De=>!De.disabled).map(De=>De.ref.current);if(["ArrowUp","End"].includes(je.key)&&(we=we.slice().reverse()),["ArrowUp","ArrowDown"].includes(je.key)){const De=je.target,Pe=we.indexOf(De);we=we.slice(Pe+1)}setTimeout(()=>ze(we)),je.preventDefault()}})}))))))}),MO=P.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:o,...c}=e,d=Gc(gd,n),p=X0(gd,n),[s,_]=P.useState(null),[v,E]=P.useState(null),T=ar(t,G=>E(G)),S=Hx(n),D=P.useRef(!1),O=P.useRef(!0),{viewport:M,selectedItem:U,selectedItemText:$,focusSelectedItem:L}=p,F=P.useCallback(()=>{if(d.trigger&&d.valueNode&&s&&v&&M&&U&&$){const G=d.trigger.getBoundingClientRect(),W=v.getBoundingClientRect(),le=d.valueNode.getBoundingClientRect(),Ie=$.getBoundingClientRect();if(d.dir!=="rtl"){const De=Ie.left-W.left,Pe=le.left-De,lt=G.left-Pe,dt=G.width+lt,ue=Math.max(dt,W.width),Fe=window.innerWidth-_s,Ke=RE(Pe,[_s,Fe-ue]);s.style.minWidth=dt+"px",s.style.left=Ke+"px"}else{const De=W.right-Ie.right,Pe=window.innerWidth-le.right-De,lt=window.innerWidth-G.right-Pe,dt=G.width+lt,ue=Math.max(dt,W.width),Fe=window.innerWidth-_s,Ke=RE(Pe,[_s,Fe-ue]);s.style.minWidth=dt+"px",s.style.right=Ke+"px"}const be=S(),de=window.innerHeight-_s*2,Ne=M.scrollHeight,Ee=window.getComputedStyle(v),Oe=parseInt(Ee.borderTopWidth,10),ze=parseInt(Ee.paddingTop,10),rt=parseInt(Ee.borderBottomWidth,10),We=parseInt(Ee.paddingBottom,10),Ae=Oe+ze+Ne+We+rt,He=Math.min(U.offsetHeight*5,Ae),ft=window.getComputedStyle(M),Qe=parseInt(ft.paddingTop,10),Rt=parseInt(ft.paddingBottom,10),zt=G.top+G.height/2-_s,X=de-zt,tt=U.offsetHeight/2,je=U.offsetTop+tt,ve=Oe+ze+je,ke=Ae-ve;if(ve<=zt){const De=U===be[be.length-1].ref.current;s.style.bottom="0px";const Pe=v.clientHeight-M.offsetTop-M.offsetHeight,lt=Math.max(X,tt+(De?Rt:0)+Pe+rt),dt=ve+lt;s.style.height=dt+"px"}else{const De=U===be[0].ref.current;s.style.top="0px";const lt=Math.max(zt,Oe+M.offsetTop+(De?Qe:0)+tt)+ke;s.style.height=lt+"px",M.scrollTop=ve-zt+M.offsetTop}s.style.margin=`${_s}px 0`,s.style.minHeight=He+"px",s.style.maxHeight=de+"px",o?.(),requestAnimationFrame(()=>D.current=!0)}},[S,d.trigger,d.valueNode,s,v,M,U,$,d.dir,o]);fo(()=>F(),[F]);const[J,V]=P.useState();fo(()=>{v&&V(window.getComputedStyle(v).zIndex)},[v]);const Z=P.useCallback(G=>{G&&O.current===!0&&(F(),L?.(),O.current=!1)},[F,L]);return P.createElement(DO,{scope:n,contentWrapper:s,shouldExpandOnScrollRef:D,onScrollButtonChange:Z},P.createElement("div",{ref:_,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:J}},P.createElement(Tn.div,Bt({},c,{ref:T,style:{boxSizing:"border-box",maxHeight:"100%",...c.style}}))))}),tT=P.forwardRef((e,t)=>{const{__scopeSelect:n,align:o="start",collisionPadding:c=_s,...d}=e,p=Zx(n);return P.createElement(zN,Bt({},p,d,{ref:t,align:o,collisionPadding:c,style:{boxSizing:"border-box",...d.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[DO,RO]=wd(gd,{}),nT="SelectViewport",LO=P.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e,c=X0(nT,n),d=RO(nT,n),p=ar(t,c.onViewportChange),s=P.useRef(0);return P.createElement(P.Fragment,null,P.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),P.createElement(K0.Slot,{scope:n},P.createElement(Tn.div,Bt({"data-radix-select-viewport":"",role:"presentation"},o,{ref:p,style:{position:"relative",flex:1,overflow:"auto",...o.style},onScroll:ln(o.onScroll,_=>{const v=_.currentTarget,{contentWrapper:E,shouldExpandOnScrollRef:T}=d;if(T!=null&&T.current&&E){const S=Math.abs(s.current-v.scrollTop);if(S>0){const D=window.innerHeight-_s*2,O=parseFloat(E.style.minHeight),M=parseFloat(E.style.height),U=Math.max(O,M);if(U<D){const $=U+S,L=Math.min(D,$),F=$-L;E.style.height=L+"px",E.style.bottom==="0px"&&(v.scrollTop=F>0?F:0,E.style.justifyContent="flex-end")}}}s.current=v.scrollTop})}))))}),NO="SelectGroup",[fU,OO]=wd(NO),$O="SelectLabel",zO=P.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e,c=OO($O,n);return P.createElement(Tn.div,Bt({id:c.id},o,{ref:t}))}),O_="SelectItem",[BO,hP]=wd(O_),FO=P.forwardRef((e,t)=>{const{__scopeSelect:n,value:o,disabled:c=!1,textValue:d,...p}=e,s=Gc(O_,n),_=X0(O_,n),v=s.value===o,[E,T]=P.useState(d??""),[S,D]=P.useState(!1),O=ar(t,$=>{var L;return(L=_.itemRefCallback)===null||L===void 0?void 0:L.call(_,$,o,c)}),M=Wa(),U=()=>{c||(s.onValueChange(o),s.onOpenChange(!1))};return P.createElement(BO,{scope:n,value:o,disabled:c,textId:M,isSelected:v,onItemTextChange:P.useCallback($=>{T(L=>{var F;return L||((F=$?.textContent)!==null&&F!==void 0?F:"").trim()})},[])},P.createElement(K0.ItemSlot,{scope:n,value:o,disabled:c,textValue:E},P.createElement(Tn.div,Bt({role:"option","aria-labelledby":M,"data-highlighted":S?"":void 0,"aria-selected":v&&S,"data-state":v?"checked":"unchecked","aria-disabled":c||void 0,"data-disabled":c?"":void 0,tabIndex:c?void 0:-1},p,{ref:O,onFocus:ln(p.onFocus,()=>D(!0)),onBlur:ln(p.onBlur,()=>D(!1)),onPointerUp:ln(p.onPointerUp,U),onPointerMove:ln(p.onPointerMove,$=>{if(c){var L;(L=_.onItemLeave)===null||L===void 0||L.call(_)}else $.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ln(p.onPointerLeave,$=>{if($.currentTarget===document.activeElement){var L;(L=_.onItemLeave)===null||L===void 0||L.call(_)}}),onKeyDown:ln(p.onKeyDown,$=>{var L;((L=_.searchRef)===null||L===void 0?void 0:L.current)!==""&&$.key===" "||(vO.includes($.key)&&U(),$.key===" "&&$.preventDefault())})}))))}),im="SelectItemText",UO=P.forwardRef((e,t)=>{const{__scopeSelect:n,className:o,style:c,...d}=e,p=Gc(im,n),s=X0(im,n),_=hP(im,n),v=wO(im,n),[E,T]=P.useState(null),S=ar(t,$=>T($),_.onItemTextChange,$=>{var L;return(L=s.itemTextRefCallback)===null||L===void 0?void 0:L.call(s,$,_.value,_.disabled)}),D=E?.textContent,O=P.useMemo(()=>P.createElement("option",{key:_.value,value:_.value,disabled:_.disabled},D),[_.disabled,_.value,D]),{onNativeOptionAdd:M,onNativeOptionRemove:U}=v;return fo(()=>(M(O),()=>U(O)),[M,U,O]),P.createElement(P.Fragment,null,P.createElement(Tn.span,Bt({id:_.textId},d,{ref:S})),_.isSelected&&p.valueNode&&!p.valueNodeHasChildren?yo.createPortal(d.children,p.valueNode):null)}),VO="SelectItemIndicator",jO=P.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e;return hP(VO,n).isSelected?P.createElement(Tn.span,Bt({"aria-hidden":!0},o,{ref:t})):null}),GO=P.forwardRef((e,t)=>{const{__scopeSelect:n,...o}=e;return P.createElement(Tn.div,Bt({"aria-hidden":!0},o,{ref:t}))}),fP=P.forwardRef((e,t)=>{const{value:n,...o}=e,c=P.useRef(null),d=ar(t,c),p=Lx(n);return P.useEffect(()=>{const s=c.current,_=window.HTMLSelectElement.prototype,E=Object.getOwnPropertyDescriptor(_,"value").set;if(p!==n&&E){const T=new Event("change",{bubbles:!0});E.call(s,n),s.dispatchEvent(T)}},[p,n]),P.createElement(Gx,{asChild:!0},P.createElement("select",Bt({},o,{ref:d,defaultValue:n})))});fP.displayName="BubbleSelect";function pP(e){const t=oi(e),n=P.useRef(""),o=P.useRef(0),c=P.useCallback(p=>{const s=n.current+p;t(s),function _(v){n.current=v,window.clearTimeout(o.current),v!==""&&(o.current=window.setTimeout(()=>_(""),1e3))}(s)},[t]),d=P.useCallback(()=>{n.current="",window.clearTimeout(o.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(o.current),[]),[n,c,d]}function mP(e,t,n){const c=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,d=n?e.indexOf(n):-1;let p=qO(e,Math.max(d,0));c.length===1&&(p=p.filter(v=>v!==n));const _=p.find(v=>v.textValue.toLowerCase().startsWith(c.toLowerCase()));return _!==n?_:void 0}function qO(e,t){return e.map((n,o)=>e[(t+o)%e.length])}const WO=EO,gP=SO,HO=CO,ZO=PO,yP=AO,KO=LO,vP=zO,_P=FO,XO=UO,YO=jO,xP=GO,JO=WO,QO=HO,bP=P.forwardRef(({className:e,children:t,...n},o)=>vt(gP,{ref:o,className:En("flex h-10 w-full items-center justify-between rounded-md border border-slate-300 bg-transparent py-2 px-3 text-sm placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",e),...n,children:[t,re(YD,{className:"h-4 w-4 opacity-50"})]}));bP.displayName=gP.displayName;const wP=P.forwardRef(({className:e,children:t,...n},o)=>re(ZO,{children:re(yP,{ref:o,className:En("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-slate-100 bg-white text-slate-700 shadow-md animate-in fade-in-80 dark:border-slate-800 dark:bg-slate-800 dark:text-slate-400",e),...n,children:re(KO,{className:"p-1",children:t})})}));wP.displayName=yP.displayName;const e$=P.forwardRef(({className:e,...t},n)=>re(vP,{ref:n,className:En("py-1.5 pr-2 pl-8 text-sm font-semibold text-slate-900 dark:text-slate-300",e),...t}));e$.displayName=vP.displayName;const EP=P.forwardRef(({className:e,children:t,...n},o)=>vt(_P,{ref:o,className:En("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-2 pl-8 text-sm font-medium outline-none focus:bg-slate-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:focus:bg-slate-700",e),...n,children:[re("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:re(YO,{children:re(QC,{className:"h-4 w-4"})})}),re(XO,{children:t})]}));EP.displayName=_P.displayName;const t$=P.forwardRef(({className:e,...t},n)=>re(xP,{ref:n,className:En("-mx-1 my-1 h-px bg-slate-100 dark:bg-slate-700",e),...t}));t$.displayName=xP.displayName;function n$({control:e,disabled:t,field:n}){return re(j0,{name:n.name,control:e,render:({field:{value:o,onChange:c,...d}})=>{const{enumValue:p,formatEnumName:s,..._}=n.properties,v=p?Object.entries(p).filter(E=>typeof E[1]=="number"):[];return vt(JO,{onValueChange:E=>c(parseInt(E)),disabled:t,value:o?.toString(),..._,...d,children:[re(bP,{children:re(QO,{})}),re(wP,{children:v.map(([E,T],S)=>re(EP,{value:T.toString(),children:s?E.replace(/_/g," ").toLowerCase().split(" ").map(D=>D.charAt(0).toUpperCase()+D.substring(1)).join(" "):E},S))})]})}})}function r$({field:e,control:t,disabled:n}){switch(e.type){case"text":case"password":case"number":return re(TL,{field:e,control:t,disabled:n});case"toggle":return re(FL,{field:e,control:t,disabled:n});case"select":return re(n$,{field:e,control:t,disabled:n});case"multiSelect":return re("div",{children:"tmp"})}}const i$=P.forwardRef((e,t)=>P.createElement(Tn.label,Bt({},e,{ref:t,onMouseDown:n=>{var o;(o=e.onMouseDown)===null||o===void 0||o.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault()}}))),TP=i$,_a=P.forwardRef(({className:e,...t},n)=>re(TP,{ref:n,className:En("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...t}));_a.displayName=TP.displayName;const o$=({label:e,description:t,children:n})=>re("div",{className:"pt-6 sm:pt-5",children:re("div",{role:"group","aria-labelledby":"label-notifications",children:vt("div",{className:"sm:grid sm:grid-cols-3 sm:items-baseline sm:gap-4",children:[re(_a,{children:e}),re("div",{className:"sm:col-span-2",children:vt("div",{className:"max-w-lg",children:[re("p",{className:"text-sm text-gray-500",children:t}),re("div",{className:"mt-4 space-y-4",children:re("div",{className:"flex items-center",children:n})})]})})]})})});function Ui({onSubmit:e,submitType:t="onChange",hasSubmitButton:n,defaultValues:o,fieldGroups:c}){const{handleSubmit:d,control:p,getValues:s}=Dx({mode:t,defaultValues:o}),_=v=>v?v.some(E=>{const T=s(E.fieldName);return typeof T=="boolean"?E.invert?T:!T:typeof T=="number"?E.invert?E.selector!==T:E.selector===T:!1}):!1;return vt("form",{className:"space-y-8 divide-y divide-gray-200",...t==="onSubmit"?{onSubmit:d(e)}:{onChange:d(e)},children:[c.map((v,E)=>vt("div",{className:"space-y-8 divide-y divide-gray-200 sm:space-y-5",children:[vt("div",{children:[re(f3,{className:"font-medium",children:v.label}),re(Rl,{children:v.description})]}),v.fields.map((T,S)=>re(o$,{label:T.label,description:T.description,children:re(r$,{field:T,control:p,disabled:_(T.disabledBy)},S)}))]},E)),n&&re(to,{type:"submit",children:"Submit"})]})}const a$=1,s$=1e3;let Qy=0;function l$(){return Qy=(Qy+1)%Number.MAX_VALUE,Qy.toString()}const ev=new Map,rT=e=>{if(ev.has(e))return;const t=setTimeout(()=>{ev.delete(e),Gh({type:"REMOVE_TOAST",toastId:e})},s$);ev.set(e,t)},c$=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,a$)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case"DISMISS_TOAST":const{toastId:n}=t;return n?rT(n):e.toasts.forEach(o=>{rT(o.id)}),{...e,toasts:e.toasts.map(o=>o.id===n||n===void 0?{...o,open:!1}:o)};case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(o=>o.id!==t.toastId)}}},Cm=[];let Pm={toasts:[]};function Gh(e){Pm=c$(Pm,e),Cm.forEach(t=>{t(Pm)})}function u$({...e}){const t=l$(),n=c=>Gh({type:"UPDATE_TOAST",toast:{...c,id:t}}),o=()=>Gh({type:"DISMISS_TOAST",toastId:t});return Gh({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:c=>{c||o()}}}),{id:t,dismiss:o,update:n}}function Kx(){const[e,t]=P.useState(Pm);return P.useEffect(()=>(Cm.push(t),()=>{const n=Cm.indexOf(t);n>-1&&Cm.splice(n,1)}),[e]),{...e,toast:u$,dismiss:n=>Gh({type:"DISMISS_TOAST",toastId:n})}}const d$=({channel:e})=>{const{connection:t,addChannel:n}=In(),{toast:o}=Kx();return re(Ui,{onSubmit:d=>{const p=new fd({...d,settings:{...d.settings,psk:m3(d.settings.psk??"")}});t?.setChannel(p).then(()=>{o({title:`Saved Channel: ${p.settings?.name}`}),n(p)})},submitType:"onSubmit",hasSubmitButton:!0,defaultValues:{...e,settings:{...e?.settings,psk:g3(e?.settings?.psk??new Uint8Array(0))}},fieldGroups:[{label:"Channel Settings",description:"Crypto, MQTT & misc settings",fields:[{type:"select",name:"role",label:"Role",description:"Description",properties:{enumValue:Nc}},{type:"password",name:"settings.psk",label:"pre-Shared Key",description:"Description",properties:{}},{type:"number",name:"settings.channelNum",label:"Channel Number",description:"Description"},{type:"text",name:"settings.name",label:"Name",description:"Description"},{type:"number",name:"settings.id",label:"ID",description:"Description"},{type:"toggle",name:"settings.uplinkEnabled",label:"Uplink Enabled",description:"Description"},{type:"toggle",name:"settings.downlinkEnabled",label:"Downlink Enabled",description:"Description"}]}]})},tv="rovingFocusGroup.onEntryFocus",h$={bubbles:!1,cancelable:!0},Xx="RovingFocusGroup",[$_,SP,f$]=Ox(Xx),[p$,kP]=Ka(Xx,[f$]),[m$,g$]=p$(Xx),y$=P.forwardRef((e,t)=>P.createElement($_.Provider,{scope:e.__scopeRovingFocusGroup},P.createElement($_.Slot,{scope:e.__scopeRovingFocusGroup},P.createElement(v$,Bt({},e,{ref:t}))))),v$=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:o,loop:c=!1,dir:d,currentTabStopId:p,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:_,onEntryFocus:v,...E}=e,T=P.useRef(null),S=ar(t,T),D=$x(d),[O=null,M]=Ns({prop:p,defaultProp:s,onChange:_}),[U,$]=P.useState(!1),L=oi(v),F=SP(n),J=P.useRef(!1),[V,Z]=P.useState(0);return P.useEffect(()=>{const G=T.current;if(G)return G.addEventListener(tv,L),()=>G.removeEventListener(tv,L)},[L]),P.createElement(m$,{scope:n,orientation:o,dir:D,loop:c,currentTabStopId:O,onItemFocus:P.useCallback(G=>M(G),[M]),onItemShiftTab:P.useCallback(()=>$(!0),[]),onFocusableItemAdd:P.useCallback(()=>Z(G=>G+1),[]),onFocusableItemRemove:P.useCallback(()=>Z(G=>G-1),[])},P.createElement(Tn.div,Bt({tabIndex:U||V===0?-1:0,"data-orientation":o},E,{ref:S,style:{outline:"none",...e.style},onMouseDown:ln(e.onMouseDown,()=>{J.current=!0}),onFocus:ln(e.onFocus,G=>{const W=!J.current;if(G.target===G.currentTarget&&W&&!U){const le=new CustomEvent(tv,h$);if(G.currentTarget.dispatchEvent(le),!le.defaultPrevented){const Ie=F().filter(Oe=>Oe.focusable),be=Ie.find(Oe=>Oe.active),de=Ie.find(Oe=>Oe.id===O),Ee=[be,de,...Ie].filter(Boolean).map(Oe=>Oe.ref.current);CP(Ee)}}J.current=!1}),onBlur:ln(e.onBlur,()=>$(!1))})))}),_$="RovingFocusGroupItem",x$=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:o=!0,active:c=!1,tabStopId:d,...p}=e,s=Wa(),_=d||s,v=g$(_$,n),E=v.currentTabStopId===_,T=SP(n),{onFocusableItemAdd:S,onFocusableItemRemove:D}=v;return P.useEffect(()=>{if(o)return S(),()=>D()},[o,S,D]),P.createElement($_.ItemSlot,{scope:n,id:_,focusable:o,active:c},P.createElement(Tn.span,Bt({tabIndex:E?0:-1,"data-orientation":v.orientation},p,{ref:t,onMouseDown:ln(e.onMouseDown,O=>{o?v.onItemFocus(_):O.preventDefault()}),onFocus:ln(e.onFocus,()=>v.onItemFocus(_)),onKeyDown:ln(e.onKeyDown,O=>{if(O.key==="Tab"&&O.shiftKey){v.onItemShiftTab();return}if(O.target!==O.currentTarget)return;const M=E$(O,v.orientation,v.dir);if(M!==void 0){O.preventDefault();let $=T().filter(L=>L.focusable).map(L=>L.ref.current);if(M==="last")$.reverse();else if(M==="prev"||M==="next"){M==="prev"&&$.reverse();const L=$.indexOf(O.currentTarget);$=v.loop?T$($,L+1):$.slice(L+1)}setTimeout(()=>CP($))}})})))}),b$={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function w$(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function E$(e,t,n){const o=w$(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(o))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(o)))return b$[o]}function CP(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function T$(e,t){return e.map((n,o)=>e[(t+o)%e.length])}const S$=y$,k$=x$;function C$(e,t){return P.useReducer((n,o)=>{const c=t[n][o];return c??n},e)}const Xa=e=>{const{present:t,children:n}=e,o=P$(t),c=typeof n=="function"?n({present:o.isPresent}):P.Children.only(n),d=ar(o.ref,c.ref);return typeof n=="function"||o.isPresent?P.cloneElement(c,{ref:d}):null};Xa.displayName="Presence";function P$(e){const[t,n]=P.useState(),o=P.useRef({}),c=P.useRef(e),d=P.useRef("none"),p=e?"mounted":"unmounted",[s,_]=C$(p,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const v=om(o.current);d.current=s==="mounted"?v:"none"},[s]),fo(()=>{const v=o.current,E=c.current;if(E!==e){const S=d.current,D=om(v);e?_("MOUNT"):D==="none"||v?.display==="none"?_("UNMOUNT"):_(E&&S!==D?"ANIMATION_OUT":"UNMOUNT"),c.current=e}},[e,_]),fo(()=>{if(t){const v=T=>{const D=om(o.current).includes(T.animationName);T.target===t&&D&&yo.flushSync(()=>_("ANIMATION_END"))},E=T=>{T.target===t&&(d.current=om(o.current))};return t.addEventListener("animationstart",E),t.addEventListener("animationcancel",v),t.addEventListener("animationend",v),()=>{t.removeEventListener("animationstart",E),t.removeEventListener("animationcancel",v),t.removeEventListener("animationend",v)}}else _("ANIMATION_END")},[t,_]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:P.useCallback(v=>{v&&(o.current=getComputedStyle(v)),n(v)},[])}}function om(e){return e?.animationName||"none"}const PP="Tabs",[A$,pU]=Ka(PP,[kP]),AP=kP(),[I$,Yx]=A$(PP),M$=P.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,onValueChange:c,defaultValue:d,orientation:p="horizontal",dir:s,activationMode:_="automatic",...v}=e,E=$x(s),[T,S]=Ns({prop:o,onChange:c,defaultProp:d});return P.createElement(I$,{scope:n,baseId:Wa(),value:T,onValueChange:S,orientation:p,dir:E,activationMode:_},P.createElement(Tn.div,Bt({dir:E,"data-orientation":p},v,{ref:t})))}),D$="TabsList",R$=P.forwardRef((e,t)=>{const{__scopeTabs:n,loop:o=!0,...c}=e,d=Yx(D$,n),p=AP(n);return P.createElement(S$,Bt({asChild:!0},p,{orientation:d.orientation,dir:d.dir,loop:o}),P.createElement(Tn.div,Bt({role:"tablist","aria-orientation":d.orientation},c,{ref:t})))}),L$="TabsTrigger",N$=P.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,disabled:c=!1,...d}=e,p=Yx(L$,n),s=AP(n),_=IP(p.baseId,o),v=MP(p.baseId,o),E=o===p.value;return P.createElement(k$,Bt({asChild:!0},s,{focusable:!c,active:E}),P.createElement(Tn.button,Bt({type:"button",role:"tab","aria-selected":E,"aria-controls":v,"data-state":E?"active":"inactive","data-disabled":c?"":void 0,disabled:c,id:_},d,{ref:t,onMouseDown:ln(e.onMouseDown,T=>{!c&&T.button===0&&T.ctrlKey===!1?p.onValueChange(o):T.preventDefault()}),onKeyDown:ln(e.onKeyDown,T=>{[" ","Enter"].includes(T.key)&&p.onValueChange(o)}),onFocus:ln(e.onFocus,()=>{const T=p.activationMode!=="manual";!E&&!c&&T&&p.onValueChange(o)})})))}),O$="TabsContent",$$=P.forwardRef((e,t)=>{const{__scopeTabs:n,value:o,forceMount:c,children:d,...p}=e,s=Yx(O$,n),_=IP(s.baseId,o),v=MP(s.baseId,o),E=o===s.value,T=P.useRef(E);return P.useEffect(()=>{const S=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(S)},[]),P.createElement(Xa,{present:c||E},({present:S})=>P.createElement(Tn.div,Bt({"data-state":E?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":_,hidden:!S,id:v,tabIndex:0},p,{ref:t,style:{...e.style,animationDuration:T.current?"0s":void 0}}),S&&d))});function IP(e,t){return`${e}-trigger-${t}`}function MP(e,t){return`${e}-content-${t}`}const z$=M$,DP=R$,RP=N$,LP=$$,Y0=z$,Lf=P.forwardRef(({className:e,...t},n)=>re(DP,{ref:n,className:En("inline-flex items-center justify-center rounded-md bg-slate-100 p-1 dark:bg-slate-800",e),...t}));Lf.displayName=DP.displayName;const Nf=P.forwardRef(({className:e,...t},n)=>re(RP,{className:En("inline-flex min-w-[100px] items-center justify-center rounded-[0.185rem] px-3 py-1.5  text-sm font-medium text-slate-700 transition-all  disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-slate-900 data-[state=active]:shadow-sm dark:text-slate-200 dark:data-[state=active]:bg-slate-900 dark:data-[state=active]:text-slate-100",e),...t,ref:n}));Nf.displayName=RP.displayName;const Of=P.forwardRef(({className:e,...t},n)=>re(LP,{className:En("mt-2 rounded-md border border-slate-200 p-6 dark:border-slate-700",e),...t,ref:n}));Of.displayName=LP.displayName;const z_=e=>e.settings?.name.length?e.settings?.name:e.index===0?"Primary":`Ch ${e.index}`,B$=()=>{const{channels:e,setDialogOpen:t}=In(),[n,o]=P.useState(ks.PRIMARY),c=e.get(n),d=Array.from(e.values());return vt(Jo,{children:[re(Af,{}),re(V0,{label:`Channel: ${c?z_(c):"Loading..."}`,actions:[{icon:oR,onClick(){t("import",!0)}},{icon:Tm,onClick(){t("QR",!0)}}],children:vt(Y0,{defaultValue:"0",children:[re(Lf,{children:d.map(p=>re(Nf,{value:p.index.toString(),children:z_(p)},p.index))}),d.map(p=>re(Of,{value:p.index.toString(),children:re(d$,{channel:p},p.index)},p.index))]})})]})},F$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"network",value:{...o,ipv4Config:new SC(o.ipv4Config)}}}))},defaultValues:e.network,fieldGroups:[{label:"WiFi Config",description:"WiFi radio configuration",fields:[{type:"toggle",name:"wifiEnabled",label:"Enabled",description:"Enable or disable the WiFi radio"},{type:"text",name:"wifiSsid",label:"SSID",description:"Network name",disabledBy:[{fieldName:"wifiEnabled"}]},{type:"password",name:"wifiPsk",label:"PSK",description:"Network password",disabledBy:[{fieldName:"wifiEnabled"}]}]},{label:"Ethernet Config",description:"Ethernet port configuration",fields:[{type:"toggle",name:"ethEnabled",label:"Enabled",description:"Enable or disable the Ethernet port"}]},{label:"IP Config",description:"IP configuration",fields:[{type:"select",name:"addressMode",label:"Address Mode",description:"Address assignment selection",properties:{enumValue:Iu}},{type:"text",name:"ipv4Config.ip",label:"IP",description:"IP Address",disabledBy:[{fieldName:"addressMode",selector:Iu.DHCP}]},{type:"text",name:"ipv4Config.gateway",label:"Gateway",description:"Default Gateway",disabledBy:[{fieldName:"addressMode",selector:Iu.DHCP}]},{type:"text",name:"ipv4Config.subnet",label:"Subnet",description:"Subnet Mask",disabledBy:[{fieldName:"addressMode",selector:Iu.DHCP}]},{type:"text",name:"ipv4Config.dns",label:"DNS",description:"DNS Server",disabledBy:[{fieldName:"addressMode",selector:Iu.DHCP}]}]},{label:"NTP Config",description:"NTP configuration",fields:[{type:"text",name:"ntpServer",label:"NTP Server"}]},{label:"Rsyslog Config",description:"Rsyslog configuration",fields:[{type:"text",name:"rsyslogServer",label:"Rsyslog Server"}]}]})},U$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"bluetooth",value:o}}))},defaultValues:e.bluetooth,fieldGroups:[{label:"Bluetooth Settings",description:"Settings for the Bluetooth module",fields:[{type:"toggle",name:"enabled",label:"Enabled",description:"Enable or disable Bluetooth"},{type:"select",name:"mode",label:"Pairing mode",description:"Pin selection behaviour.",disabledBy:[{fieldName:"enabled"}],properties:{enumValue:b_,formatEnumName:!0}},{type:"number",name:"fixedPin",label:"Pin",description:"Pin to use when pairing",disabledBy:[{fieldName:"mode",selector:b_.FIXED_PIN,invert:!0},{fieldName:"enabled"}],properties:{}}]}]})},V$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"device",value:o}}))},defaultValues:e.device,fieldGroups:[{label:"Device Settings",description:"Settings for the device",fields:[{type:"select",name:"role",label:"Role",description:"What role the device performs on the mesh",properties:{enumValue:yx,formatEnumName:!0}},{type:"toggle",name:"serialEnabled",label:"Serial Output Enabled",description:"Enable the device's serial console"},{type:"toggle",name:"debugLogEnabled",label:"Enabled Debug Log",description:"Output debugging information to the device's serial port (auto disables when serial client is connected)"},{type:"number",name:"buttonGpio",label:"Button Pin",description:"Button pin override"},{type:"number",name:"buzzerGpio",label:"Buzzer Pin",description:"Buzzer pin override"},{type:"select",name:"rebroadcastMode",label:"Rebroadcast Mode",description:"How to handle rebroadcasting",properties:{enumValue:bC,formatEnumName:!0}},{type:"number",name:"nodeInfoBroadcastSecs",label:"Node Info Broadcast Interval",description:"How often to broadcast node info",properties:{suffix:"Seconds"}}]}]})},j$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"display",value:o}}))},defaultValues:e.display,fieldGroups:[{label:"Display Settings",description:"Settings for the device display",fields:[{type:"number",name:"screenOnSecs",label:"Screen Timeout",description:"Turn off the display after this long",properties:{suffix:"seconds"}},{type:"select",name:"gpsFormat",label:"GPS Display Units",description:"Coordinate display format",properties:{enumValue:CC}},{type:"number",name:"autoScreenCarouselSecs",label:"Carousel Delay",description:"How fast to cycle through windows"},{type:"toggle",name:"compassNorthTop",label:"Compass North Top",description:"Fix north to the top of compass"},{type:"toggle",name:"flipScreen",label:"Flip Screen",description:"Flip display 180 degrees"},{type:"select",name:"units",label:"Display Units",description:"Display metric or imperial units",properties:{enumValue:PC,formatEnumName:!0}},{type:"select",name:"oled",label:"OLED Type",description:"Type of OLED screen attached to the device",properties:{enumValue:AC}},{type:"select",name:"displaymode",label:"Display Mode",description:"Screen layout variant",properties:{enumValue:IC,formatEnumName:!0}},{type:"toggle",name:"headingBold",label:"Bold Heading",description:"Bolden the heading text"}]}]})},G$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"lora",value:o}}))},defaultValues:e.lora,fieldGroups:[{label:"Mesh Settings",description:"Settings for the LoRa mesh",fields:[{type:"select",name:"region",label:"Region",description:"Sets the region for your node",properties:{enumValue:MC}},{type:"number",name:"hopLimit",label:"Hop Limit",description:"Maximum number of hops"},{type:"number",name:"channelNum",label:"Channel Number",description:"LoRa channel number"}]},{label:"Waveform Settings",description:"Settings for the LoRa waveform",fields:[{type:"toggle",name:"usePreset",label:"Use Preset",description:"Use one of the predefined modem presets"},{type:"select",name:"modemPreset",label:"Modem Preset",description:"Modem preset to use",disabledBy:[{fieldName:"usePreset"}],properties:{enumValue:DC,formatEnumName:!0}},{type:"number",name:"bandwidth",label:"Bandwidth",description:"Channel bandwidth in MHz",disabledBy:[{fieldName:"usePreset",invert:!0}],properties:{suffix:"MHz"}},{type:"number",name:"spreadFactor",label:"Spreading Factor",description:"Indicates the number of chirps per symbol",disabledBy:[{fieldName:"usePreset",invert:!0}],properties:{suffix:"CPS"}},{type:"number",name:"codingRate",label:"Coding Rate",description:"The denominator of the coding rate",disabledBy:[{fieldName:"usePreset",invert:!0}]}]},{label:"Radio Settings",description:"Settings for the LoRa radio",fields:[{type:"toggle",name:"txEnabled",label:"Tramsmit Enabled",description:"Enable/Disable transmit (TX) from the LoRa radio"},{type:"number",name:"txPower",label:"Transmit Power",description:"Max transmit power",properties:{suffix:"dBm"}},{type:"toggle",name:"overrideDutyCycle",label:"Override Duty Cycle",description:"Override Duty Cycle"},{type:"number",name:"frequencyOffset",label:"Frequency Offset",description:"Frequency offset to correct for crystal calibration errors",properties:{suffix:"Hz"}},{type:"toggle",name:"sx126xRxBoostedGain",label:"Boosted RX Gain",description:"Boosted RX gain"},{type:"number",name:"overrideFrequency",label:"Override Frequency",description:"Override frequency",properties:{suffix:"Hz"}}]}]})},q$=()=>{const{config:e,nodes:t,hardware:n,setWorkingConfig:o}=In();return re(Ui,{onSubmit:d=>{o(new ba({payloadVariant:{case:"position",value:d}}))},defaultValues:e.position,fieldGroups:[{label:"Position settings",description:"Settings for the position module",fields:[{type:"toggle",name:"positionBroadcastSmartEnabled",label:"Enable Smart Position",description:"Only send position when there has been a meaningful change in location"},{type:"toggle",name:"fixedPosition",label:"Fixed Position",description:"Don't report GPS position, but a manually-specified one"},{type:"toggle",name:"gpsEnabled",label:"GPS Enabled",description:"Enable the internal GPS module"},{type:"multiSelect",name:"positionFlags",label:"Position Flags",description:"Configuration options for Position messages",properties:{enumValue:_D}},{type:"number",name:"rxGpio",label:"Receive Pin",description:"GPS Module RX pin override"},{type:"number",name:"txGpio",label:"Transmit Pin",description:"GPS Module TX pin override"}]},{label:"Intervals",description:"How often to send position updates",fields:[{type:"number",name:"positionBroadcastSecs",label:"Broadcast Interval",description:"How often your position is sent out over the mesh"},{type:"number",name:"gpsUpdateInterval",label:"GPS Update Interval",description:"How often a GPS fix should be acquired"},{type:"number",name:"gpsAttemptTime",label:"Fix Attempt Duration",description:"How long the device will try to get a fix for"}]}]})},W$=()=>{const{config:e,setWorkingConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new ba({payloadVariant:{case:"power",value:o}}))},defaultValues:e.power,fieldGroups:[{label:"Power Config",description:"Settings for the power module",fields:[{type:"toggle",name:"isPowerSaving",label:"Enable power saving mode",description:"Select if powered from a low-current source (i.e. solar), to minimize power consumption as much as possible."},{type:"number",name:"onBatteryShutdownAfterSecs",label:"Shutdown on battery delay",description:"Automatically shutdown node after this long when on battery, 0 for indefinite",properties:{suffix:"Seconds"}},{type:"number",name:"adcMultiplierOverride",label:"ADC Multiplier Override ratio",description:"Used for tweaking battery voltage reading"},{type:"number",name:"waitBluetoothSecs",label:"No Connection Bluetooth Disabled",description:"If the device does not receive a Bluetooth connection, the BLE radio will be disabled after this long",properties:{suffix:"Seconds"}}]},{label:"Sleep Settings",description:"Sleep settings for the power module",fields:[{type:"number",name:"meshSdsTimeoutSecs",label:"Mesh SDS Timeout",description:"The device will enter super deep sleep after this time",properties:{suffix:"Seconds"}},{type:"number",name:"sdsSecs",label:"Super Deep Sleep Duration",description:"How long the device will be in super deep sleep for",properties:{suffix:"Seconds"}},{type:"number",name:"lsSecs",label:"Light Sleep Duration",description:"How long the device will be in light sleep for",properties:{suffix:"Seconds"}},{type:"number",name:"minWakeSecs",label:"Minimum Wake Time",description:"Minimum amount of time the device will stay awake for after receiving a packet",properties:{suffix:"Seconds"}}]}]})},H$=()=>{const{hardware:e}=In(),t=[{label:"Device",element:V$,count:0},{label:"Position",element:q$},{label:"Power",element:W$},{label:"Network",element:F$,disabled:!e.hasWifi},{label:"Display",element:j$},{label:"LoRa",element:G$},{label:"Bluetooth",element:U$}];return vt(Y0,{defaultValue:"Device",children:[re(Lf,{children:t.map(n=>re(Nf,{value:n.label,disabled:n.disabled,children:n.label},n.label))}),t.map(n=>re(Of,{value:n.label,children:re(n.element,{})},n.label))]})},Z$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"audio",value:o}}))},defaultValues:e.audio,fieldGroups:[{label:"Audio Settings",description:"Settings for the Audio module",fields:[{type:"toggle",name:"codec2Enabled",label:"Codec 2 Enabled",description:"Enable Codec 2 audio encoding"},{type:"number",name:"pttPin",label:"PTT Pin",description:"GPIO pin to use for PTT"},{type:"select",name:"bitrate",label:"Bitrate",description:"Bitrate to use for audio encoding",properties:{enumValue:$C}},{type:"number",name:"i2sWs",label:"i2S WS",description:"GPIO pin to use for i2S WS"},{type:"number",name:"i2sSd",label:"i2S SD",description:"GPIO pin to use for i2S SD"},{type:"number",name:"i2sDin",label:"i2S DIN",description:"GPIO pin to use for i2S DIN"},{type:"number",name:"i2sSck",label:"i2S SCK",description:"GPIO pin to use for i2S SCK"}]}]})},K$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"cannedMessage",value:o}}))},defaultValues:e.mqtt,fieldGroups:[{label:"Canned Message Settings",description:"Settings for the Canned Message module",fields:[{type:"toggle",name:"rotary1Enabled",label:"Rotary Encoder #1 Enabled",description:"Enable the rotary encoder"},{type:"number",name:"inputbrokerPinA",label:"Encoder Pin A",description:"GPIO Pin Value (1-39) For encoder port A"},{type:"number",name:"inputbrokerPinB",label:"Encoder Pin B",description:"GPIO Pin Value (1-39) For encoder port B"},{type:"number",name:"inputbrokerPinPress",label:"Encoder Pin Press",description:"GPIO Pin Value (1-39) For encoder Press"},{type:"select",name:"inputbrokerEventCw",label:"Clockwise event",description:"Select input event.",properties:{enumValue:Qu}},{type:"select",name:"inputbrokerEventCcw",label:"Counter Clockwise event",description:"Select input event.",properties:{enumValue:Qu}},{type:"select",name:"inputbrokerEventPress",label:"Press event",description:"Select input event",properties:{enumValue:Qu}},{type:"toggle",name:"updown1Enabled",label:"Up Down enabled",description:"Enable the up / down encoder"},{type:"text",name:"allowInputSource",label:"Allow Input Source",description:"Select from: '_any', 'rotEnc1', 'upDownEnc1', 'cardkb'"},{type:"toggle",name:"sendBell",label:"Send Bell",description:"Sends a bell character with each message"}]}]})},X$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"externalNotification",value:o}}))},defaultValues:e.externalNotification,fieldGroups:[{label:"External Notification Settings",description:"Configure the external notification module",fields:[{type:"toggle",name:"enabled",label:"Module Enabled",description:"Enable External Notification"},{type:"number",name:"outputMs",label:"Output MS",description:"Output MS",disabledBy:[{fieldName:"enabled"}],properties:{suffix:"ms"}},{type:"number",name:"output",label:"Output",description:"Output",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"outputVibra",label:"Output Vibrate",description:"Output Vibrate",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"outputBuzzer",label:"Output Buzzer",description:"Output Buzzer",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"active",label:"Active",description:"Active",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertMessage",label:"Alert Message",description:"Alert Message",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertMessageVibra",label:"Alert Message Vibrate",description:"Alert Message Vibrate",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertMessageBuzzer",label:"Alert Message Buzzer",description:"Alert Message Buzzer",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertBell",label:"Alert Bell",description:"Should an alert be triggered when receiving an incoming bell?",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertBellVibra",label:"Alert Bell Vibrate",description:"Alert Bell Vibrate",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"alertBellBuzzer",label:"Alert Bell Buzzer",description:"Alert Bell Buzzer",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"usePwm",label:"Use PWM",description:"Use PWM",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"nagTimeout",label:"Nag Timeout",description:"Nag Timeout",disabledBy:[{fieldName:"enabled"}]}]}]})},Y$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"mqtt",value:o}}))},defaultValues:e.mqtt,fieldGroups:[{label:"MQTT Settings",description:"Settings for the MQTT module",fields:[{type:"toggle",name:"enabled",label:"Enabled",description:"Enable or disable MQTT"},{type:"text",name:"address",label:"MQTT Server Address",description:"MQTT server address to use for default/custom servers",disabledBy:[{fieldName:"enabled"}]},{type:"text",name:"username",label:"MQTT Username",description:"MQTT username to use for default/custom servers",disabledBy:[{fieldName:"enabled"}]},{type:"password",name:"password",label:"MQTT Password",description:"MQTT password to use for default/custom servers",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"encryptionEnabled",label:"Encryption Enabled",description:"Enable or disable MQTT encryption",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"jsonEnabled",label:"JSON Enabled",description:"Whether to send/consume JSON packets on MQTT",disabledBy:[{fieldName:"enabled"}]}]}]})},J$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"rangeTest",value:o}}))},defaultValues:e.mqtt,fieldGroups:[{label:"Range Test Settings",description:"Settings for the Range Test module",fields:[{type:"toggle",name:"enabled",label:"Module Enabled",description:"Enable Range Test"},{type:"number",name:"sender",label:"Message Interval",description:"How long to wait between sending test packets",disabledBy:[{fieldName:"enabled"}]},{type:"toggle",name:"save",label:"Save CSV to storage",description:"ESP32 Only",disabledBy:[{fieldName:"enabled"}]}]}]})},Q$=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"serial",value:o}}))},defaultValues:e.serial,fieldGroups:[{label:"Serial Settings",description:"Settings for the Serial module",fields:[{type:"toggle",name:"enabled",label:"Module Enabled",description:"Enable Serial output"},{type:"toggle",name:"echo",label:"Echo",description:"Any packets you send will be echoed back to your device",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"rxd",label:"Receive Pin",description:"Set the GPIO pin to the RXD pin you have set up.",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"txd",label:"Transmit Pin",description:"Set the GPIO pin to the TXD pin you have set up.",disabledBy:[{fieldName:"enabled"}]},{type:"select",name:"baud",label:"Baud Rate",description:"The serial baud rate",disabledBy:[{fieldName:"enabled"}],properties:{enumValue:BC}},{type:"number",name:"timeout",label:"Timeout",description:"Seconds to wait before we consider your packet as 'done'",disabledBy:[{fieldName:"enabled"}],properties:{suffix:"Seconds"}},{type:"select",name:"mode",label:"Mode",description:"Select Mode",disabledBy:[{fieldName:"enabled"}],properties:{enumValue:FC,formatEnumName:!0}}]}]})},ez=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"storeForward",value:o}}))},defaultValues:e.mqtt,fieldGroups:[{label:"Store & Forward Settings",description:"Settings for the Store & Forward module",fields:[{type:"toggle",name:"enabled",label:"Module Enabled",description:"Enable Store & Forward"},{type:"toggle",name:"heartbeat",label:"Heartbeat Enabled",description:"Enable Store & Forward heartbeat",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"records",label:"Number of records",description:"Number of records to store",disabledBy:[{fieldName:"enabled"}],properties:{suffix:"Records"}},{type:"number",name:"historyReturnMax",label:"History return max",description:"Max number of records to return",disabledBy:[{fieldName:"enabled"}]},{type:"number",name:"historyReturnWindow",label:"History return window",description:"Max number of records to return",disabledBy:[{fieldName:"enabled"}]}]}]})},tz=()=>{const{moduleConfig:e,setWorkingModuleConfig:t}=In();return re(Ui,{onSubmit:o=>{t(new wa({payloadVariant:{case:"telemetry",value:o}}))},defaultValues:e.telemetry,fieldGroups:[{label:"Telemetry Settings",description:"Settings for the Telemetry module",fields:[{type:"number",name:"deviceUpdateInterval",label:"Query Interval",description:"Interval to get telemetry data",properties:{suffix:"seconds"}},{type:"number",name:"environmentUpdateInterval",label:"Update Interval",description:"How often to send Metrics over the mesh",properties:{suffix:"seconds"}},{type:"toggle",name:"environmentMeasurementEnabled",label:"Module Enabled",description:"Enable the Environment Telemetry"},{type:"toggle",name:"environmentScreenEnabled",label:"Displayed on Screen",description:"Show the Telemetry Module on the OLED"},{type:"toggle",name:"environmentDisplayFahrenheit",label:"Display Fahrenheit",description:"Display temp in Fahrenheit"}]}]})},nz=()=>{In();const e=[{label:"MQTT",element:Y$},{label:"Serial",element:Q$},{label:"Ext Notif",element:X$},{label:"S&F",element:ez},{label:"Range Test",element:J$},{label:"Telemetry",element:tz},{label:"Canned",element:K$},{label:"Audio",element:Z$}];return vt(Y0,{defaultValue:"MQTT",children:[re(Lf,{children:e.map(t=>re(Nf,{value:t.label,children:t.label},t.label))}),e.map(t=>re(Of,{value:t.label,children:re(t.element,{})},t.label))]})},rz=()=>{const{workingConfig:e,workingModuleConfig:t,connection:n}=In(),[o,c]=P.useState("device"),{toast:d}=Kx();return vt(Jo,{children:[re(Af,{children:vt(mf,{label:"Config Sections",children:[re(pd,{label:"Device Config",active:o==="device",onClick:()=>c("device"),icon:Ex}),re(pd,{label:"Module Config",active:o==="module",onClick:()=>c("module"),icon:KD})]})}),re(V0,{label:o==="device"?"Device Config":"Module Config",actions:[{icon:pR,async onClick(){o==="device"?e.map(async p=>await n?.setConfig(p).then(()=>d({title:`Config ${p.payloadVariant.case} saved`}))):t.map(async p=>await n?.setModuleConfig(p).then(()=>d({title:`Config ${p.payloadVariant.case} saved`}))),await n?.commitEditSettings()}}],children:o==="device"?re(H$,{}):re(nz,{})})]})};var B_={},iz={get exports(){return B_},set exports(e){B_=e}};(function(e,t){(function(n,o){e.exports=o()})(pi,function(){var n,o,c;function d(s,_){if(!n)n=_;else if(!o)o=_;else{var v="var sharedChunk = {}; ("+n+")(sharedChunk); ("+o+")(sharedChunk);",E={};n(E),c=_(E),typeof window<"u"&&(c.workerUrl=window.URL.createObjectURL(new Blob([v],{type:"text/javascript"})))}}d(["exports"],function(s){var _=v;function v(a,r,l,h){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=r,this.p2x=l,this.p2y=h}function E(a,r,l,h){const g=new _(a,r,l,h);return function(x){return g.solve(x)}}v.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,r){if(r===void 0&&(r=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,h=0;h<8;h++){var g=this.sampleCurveX(l)-a;if(Math.abs(g)<r)return l;var x=this.sampleCurveDerivativeX(l);if(Math.abs(x)<1e-6)break;l-=g/x}var w=0,C=1;for(l=a,h=0;h<20&&(g=this.sampleCurveX(l),!(Math.abs(g-a)<r));h++)a>g?w=l:C=l,l=.5*(C-w)+w;return l},solve:function(a,r){return this.sampleCurveY(this.solveCurveX(a,r))}};const T=E(.25,.1,.25,1);function S(a,r,l){return Math.min(l,Math.max(r,a))}function D(a,r,l){const h=l-r,g=((a-r)%h+h)%h+r;return g===r?l:g}function O(a,...r){for(const l of r)for(const h in l)a[h]=l[h];return a}let M=1;function U(a,r){a.forEach(l=>{r[l]&&(r[l]=r[l].bind(r))})}function $(a,r,l){const h={};for(const g in a)h[g]=r.call(l||this,a[g],g,a);return h}function L(a,r,l){const h={};for(const g in a)r.call(l||this,a[g],g,a)&&(h[g]=a[g]);return h}function F(a){return Array.isArray(a)?a.map(F):typeof a=="object"&&a?$(a,F):a}const J={};function V(a){J[a]||(typeof console<"u"&&console.warn(a),J[a]=!0)}function Z(a,r,l){return(l.y-a.y)*(r.x-a.x)>(r.y-a.y)*(l.x-a.x)}function G(a){let r=0;for(let l,h,g=0,x=a.length,w=x-1;g<x;w=g++)l=a[g],h=a[w],r+=(h.x-l.x)*(l.y+h.y);return r}function W(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function le(a){const r={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,h,g,x)=>{const w=g||x;return r[h]=!w||w.toLowerCase(),""}),r["max-age"]){const l=parseInt(r["max-age"],10);isNaN(l)?delete r["max-age"]:r["max-age"]=l}return r}let Ie,be,de=null;function Ne(a){if(de==null){const r=a.navigator?a.navigator.userAgent:null;de=!!a.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return de}function Ee(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Oe={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(a){const r=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(a,r=0){const l=window.document.createElement("canvas"),h=l.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return l.width=a.width,l.height=a.height,h.drawImage(a,0,0,a.width,a.height),h.getImageData(-r,-r,a.width+2*r,a.height+2*r)},resolveURL:a=>(Ie||(Ie=document.createElement("a")),Ie.href=a,Ie.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(be==null&&(be=matchMedia("(prefers-reduced-motion: reduce)")),be.matches)}};var ze=rt;function rt(a,r){this.x=a,this.y=r}rt.prototype={clone:function(){return new rt(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,r){return this.clone()._rotateAround(a,r)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var r=a.x-this.x,l=a.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,r){return Math.atan2(this.x*r-this.y*a,this.x*a+this.y*r)},_matMult:function(a){var r=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=r,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var r=Math.cos(a),l=Math.sin(a),h=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=h,this},_rotateAround:function(a,r){var l=Math.cos(a),h=Math.sin(a),g=r.y+h*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-h*(this.y-r.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rt.convert=function(a){return a instanceof rt?a:Array.isArray(a)?new rt(a[0],a[1]):a};const We={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Ae="mapbox-tiles";let He,ft,Qe=500,Rt=50;function zt(){typeof caches>"u"||He||(He=caches.open(Ae))}let X=1/0;const tt={supported:!1,testSupport:function(a){!ke&&ve&&(we?De(a):je=a)}};let je,ve,ke=!1,we=!1;function De(a){const r=a.createTexture();a.bindTexture(a.TEXTURE_2D,r);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,ve),a.isContextLost())return;tt.supported=!0}catch{}a.deleteTexture(r),ke=!0}typeof document<"u"&&(ve=document.createElement("img"),ve.onload=function(){je&&De(je),je=null,we=!0},ve.onerror=function(){ke=!0,je=null},ve.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Pe={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Pe);class lt extends Error{constructor(r,l,h,g){super(`AJAXError: ${l} (${r}): ${h}`),this.status=r,this.statusText=l,this.url=h,this.body=g}}const dt=W()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ue(a,r){const l=new AbortController,h=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:dt(),signal:l.signal});let g=!1,x=!1;return a.type==="json"&&h.headers.set("Accept","application/json"),((w,C,A)=>{if(x)return;const N=Date.now();fetch(h).then(j=>j.ok?((H,Q,te)=>{(a.type==="arrayBuffer"?H.arrayBuffer():a.type==="json"?H.json():H.text()).then(ne=>{x||(Q&&te&&function(_e,me,$e){if(zt(),!He)return;const qe={status:me.status,statusText:me.statusText,headers:new Headers};me.headers.forEach((Ve,st)=>qe.headers.set(st,Ve));const Le=le(me.headers.get("Cache-Control")||"");Le["no-store"]||(Le["max-age"]&&qe.headers.set("Expires",new Date($e+1e3*Le["max-age"]).toUTCString()),new Date(qe.headers.get("Expires")).getTime()-$e<42e4||function(Ve,st){if(ft===void 0)try{new Response(new ReadableStream),ft=!0}catch{ft=!1}ft?st(Ve.body):Ve.blob().then(st)}(me,Ve=>{const st=new Response(Ve,qe);zt(),He&&He.then(ot=>ot.put(function(Nt){const Vt=Nt.indexOf("?");return Vt<0?Nt:Nt.slice(0,Vt)}(_e.url),st)).catch(ot=>V(ot.message))}))}(h,Q,te),g=!0,r(null,ne,H.headers.get("Cache-Control"),H.headers.get("Expires")))}).catch(ne=>{x||r(new Error(ne.message))})})(j,null,N):j.blob().then(H=>r(new lt(j.status,j.statusText,a.url,H)))).catch(j=>{j.code!==20&&r(new Error(j.message))})})(),{cancel:()=>{x=!0,g||l.abort()}}}const Fe=function(a,r){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){if(W()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,r);if(!W()){const h=a.url.substring(0,a.url.indexOf("://"));return(We.REGISTERED_PROTOCOLS[h]||ue)(a,r)}}if(!(/^file:/.test(l=a.url)||/^file:/.test(dt())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ue(a,r);if(W()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,r,void 0,!0)}var l;return function(h,g){const x=new XMLHttpRequest;x.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const w in h.headers)x.setRequestHeader(w,h.headers[w]);return h.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=h.credentials==="include",x.onerror=()=>{g(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let w=x.response;if(h.type==="json")try{w=JSON.parse(x.response)}catch(C){return g(C)}g(null,w,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else{const w=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});g(new lt(x.status,x.statusText,h.url,w))}},x.send(h.body),{cancel:()=>x.abort()}}(a,r)},Ke=function(a,r){return Fe(O(a,{type:"arrayBuffer"}),r)};function it(a){const r=window.document.createElement("a");return r.href=a,r.protocol===window.document.location.protocol&&r.host===window.document.location.host}const ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let at,Ot;at=[],Ot=0;const on=function(a,r){if(tt.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),Ot>=We.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:a,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return at.push(x),x}Ot++;let l=!1;const h=()=>{if(!l)for(l=!0,Ot--;at.length&&Ot<We.MAX_PARALLEL_IMAGE_REQUESTS;){const x=at.shift(),{requestParameters:w,callback:C,cancelled:A}=x;A||(x.cancel=on(w,C).cancel)}},g=Ke(a,(x,w,C,A)=>{h(),x?r(x):w&&function(N,j){typeof createImageBitmap=="function"?function(H,Q){const te=new Blob([new Uint8Array(H)],{type:"image/png"});createImageBitmap(te).then(ne=>{Q(null,ne)}).catch(ne=>{Q(new Error(`Could not load image because of ${ne.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(N,j):function(H,Q){const te=new Image;te.onload=()=>{Q(null,te),URL.revokeObjectURL(te.src),te.onload=null,window.requestAnimationFrame(()=>{te.src=ct})},te.onerror=()=>Q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ne=new Blob([new Uint8Array(H)],{type:"image/png"});te.src=H.byteLength?URL.createObjectURL(ne):ct}(N,j)}(w,(N,j)=>{N!=null?r(N):j!=null&&r(null,j,{cacheControl:C,expires:A})})});return{cancel:()=>{g.cancel(),h()}}};function pn(a,r,l){l[a]&&l[a].indexOf(r)!==-1||(l[a]=l[a]||[],l[a].push(r))}function sr(a,r,l){if(l&&l[a]){const h=l[a].indexOf(r);h!==-1&&l[a].splice(h,1)}}class Qn{constructor(r,l={}){O(this,l),this.type=r}}class Jr extends Qn{constructor(r,l={}){super("error",O({error:r},l))}}class xr{on(r,l){return this._listeners=this._listeners||{},pn(r,l,this._listeners),this}off(r,l){return sr(r,l,this._listeners),sr(r,l,this._oneTimeListeners),this}once(r,l){return this._oneTimeListeners=this._oneTimeListeners||{},pn(r,l,this._oneTimeListeners),this}fire(r,l){typeof r=="string"&&(r=new Qn(r,l||{}));const h=r.type;if(this.listens(h)){r.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const C of g)C.call(this,r);const x=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const C of x)sr(h,C,this._oneTimeListeners),C.call(this,r);const w=this._eventedParent;w&&(O(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(r))}else r instanceof Jr&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,l){return this._eventedParent=r,this._eventedParentData=l,this}}var Ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class _t{constructor(r,l,h,g){this.message=(r?`${r}: `:"")+h,g&&(this.identifier=g),l!=null&&l.__line__&&(this.line=l.__line__)}}function Kn(a){const r=a.value;return r?[new _t(a.key,r,"constants have been deprecated as of v8")]:[]}function Dr(a,...r){for(const l of r)for(const h in l)a[h]=l[h];return a}function cn(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Rr(a){if(Array.isArray(a))return a.map(Rr);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const r={};for(const l in a)r[l]=Rr(a[l]);return r}return cn(a)}class br extends Error{constructor(r,l){super(l),this.message=l,this.key=r}}class dr{constructor(r,l=[]){this.parent=r,this.bindings={};for(const[h,g]of l)this.bindings[h]=g}concat(r){return new dr(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const ai={kind:"null"},xt={kind:"number"},tn={kind:"string"},Kt={kind:"boolean"},er={kind:"color"},gi={kind:"object"},Jt={kind:"value"},Ur={kind:"collator"},zn={kind:"formatted"},yi={kind:"padding"},Bn={kind:"resolvedImage"};function lr(a,r){return{kind:"array",itemType:a,N:r}}function hn(a){if(a.kind==="array"){const r=hn(a.itemType);return typeof a.N=="number"?`array<${r}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${r}>`}return a.kind}const Vi=[ai,xt,tn,Kt,er,zn,gi,lr(Jt),yi,Bn];function Qr(a,r){if(r.kind==="error")return null;if(a.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Qr(a.itemType,r.itemType))&&(typeof a.N!="number"||a.N===r.N))return null}else{if(a.kind===r.kind)return null;if(a.kind==="value"){for(const l of Vi)if(!Qr(l,r))return null}}return`Expected ${hn(a)} but found ${hn(r)} instead.`}function Pi(a,r){return r.some(l=>l.kind===a.kind)}function Ai(a,r){return r.some(l=>l==="null"?a===null:l==="array"?Array.isArray(a):l==="object"?a&&!Array.isArray(a)&&typeof a=="object":l===typeof a)}var ji,vi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ae(a){return(a=Math.round(a))<0?0:a>255?255:a}function B(a){return ae(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function K(a){return(r=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:r>1?1:r;var r}function ie(a,r,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(r-a)*l*6:2*l<1?r:3*l<2?a+(r-a)*(2/3-l)*6:a}try{ji={}.parseCSSColor=function(a){var r,l=a.replace(/ /g,"").toLowerCase();if(l in vi)return vi[l].slice();if(l[0]==="#")return l.length===4?(r=parseInt(l.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:l.length===7&&(r=parseInt(l.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var h=l.indexOf("("),g=l.indexOf(")");if(h!==-1&&g+1===l.length){var x=l.substr(0,h),w=l.substr(h+1,g-(h+1)).split(","),C=1;switch(x){case"rgba":if(w.length!==4)return null;C=K(w.pop());case"rgb":return w.length!==3?null:[B(w[0]),B(w[1]),B(w[2]),C];case"hsla":if(w.length!==4)return null;C=K(w.pop());case"hsl":if(w.length!==3)return null;var A=(parseFloat(w[0])%360+360)%360/360,N=K(w[1]),j=K(w[2]),H=j<=.5?j*(N+1):j+N-j*N,Q=2*j-H;return[ae(255*ie(Q,H,A+1/3)),ae(255*ie(Q,H,A)),ae(255*ie(Q,H,A-1/3)),C];default:return null}}return null}}catch{}class oe{constructor(r,l,h,g=1){this.r=r,this.g=l,this.b=h,this.a=g}static parse(r){if(!r)return;if(r instanceof oe)return r;if(typeof r!="string")return;const l=ji(r);return l?new oe(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[r,l,h,g]=this.toArray();return`rgba(${Math.round(r)},${Math.round(l)},${Math.round(h)},${g})`}toArray(){const{r,g:l,b:h,a:g}=this;return g===0?[0,0,0,0]:[255*r/g,255*l/g,255*h/g,g]}}oe.black=new oe(0,0,0,1),oe.white=new oe(1,1,1,1),oe.transparent=new oe(0,0,0,0),oe.red=new oe(1,0,0,1);class ge{constructor(r,l,h){this.sensitivity=r?l?"variant":"case":l?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,l){return this.collator.compare(r,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Se{constructor(r,l,h,g,x){this.text=r,this.image=l,this.scale=h,this.fontStack=g,this.textColor=x}}class xe{constructor(r){this.sections=r}static fromString(r){return new xe([new Se(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof xe?r:xe.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class ye{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof ye)return r;if(typeof r=="number")return new ye([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const l of r)if(typeof l!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new ye(r)}}toString(){return JSON.stringify(this.values)}}class Ce{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Ce({name:r,available:!1}):null}}function Xe(a,r,l,h){return typeof a=="number"&&a>=0&&a<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof l=="number"&&l>=0&&l<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[a,r,l,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[a,r,l,h]:[a,r,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ut(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof oe||a instanceof ge||a instanceof xe||a instanceof ye||a instanceof Ce)return!0;if(Array.isArray(a)){for(const r of a)if(!ut(r))return!1;return!0}if(typeof a=="object"){for(const r in a)if(!ut(a[r]))return!1;return!0}return!1}function Ze(a){if(a===null)return ai;if(typeof a=="string")return tn;if(typeof a=="boolean")return Kt;if(typeof a=="number")return xt;if(a instanceof oe)return er;if(a instanceof ge)return Ur;if(a instanceof xe)return zn;if(a instanceof ye)return yi;if(a instanceof Ce)return Bn;if(Array.isArray(a)){const r=a.length;let l;for(const h of a){const g=Ze(h);if(l){if(l===g)continue;l=Jt;break}l=g}return lr(l||Jt,r)}return gi}function Ct(a){const r=typeof a;return a===null?"":r==="string"||r==="number"||r==="boolean"?String(a):a instanceof oe||a instanceof xe||a instanceof ye||a instanceof Ce?a.toString():JSON.stringify(a)}class Ut{constructor(r,l){this.type=r,this.value=l}static parse(r,l){if(r.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!ut(r[1]))return l.error("invalid value");const h=r[1];let g=Ze(h);const x=l.expectedType;return g.kind!=="array"||g.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(g=x),new Ut(g,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Pt{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Xt={string:tn,number:xt,boolean:Kt,object:gi};class Qt{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");let h,g=1;const x=r[0];if(x==="array"){let C,A;if(r.length>2){const N=r[1];if(typeof N!="string"||!(N in Xt)||N==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);C=Xt[N],g++}else C=Jt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return l.error('The length argument to "array" must be a positive integer literal',2);A=r[2],g++}h=lr(C,A)}else{if(!Xt[x])throw new Error(`Types doesn't contain name = ${x}`);h=Xt[x]}const w=[];for(;g<r.length;g++){const C=l.parse(r[g],g,Jt);if(!C)return null;w.push(C)}return new Qt(h,w)}evaluate(r){for(let l=0;l<this.args.length;l++){const h=this.args[l].evaluate(r);if(!Qr(this.type,Ze(h)))return h;if(l===this.args.length-1)throw new Pt(`Expected value to be of type ${hn(this.type)}, but found ${hn(Ze(h))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const _n={"to-boolean":Kt,"to-color":er,"to-number":xt,"to-string":tn};class en{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[0];if(!_n[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&r.length!==2)return l.error("Expected one argument.");const g=_n[h],x=[];for(let w=1;w<r.length;w++){const C=l.parse(r[w],w,Jt);if(!C)return null;x.push(C)}return new en(g,x)}evaluate(r){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(r));if(this.type.kind==="color"){let l,h;for(const g of this.args){if(l=g.evaluate(r),h=null,l instanceof oe)return l;if(typeof l=="string"){const x=r.parseColor(l);if(x)return x}else if(Array.isArray(l)&&(h=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Xe(l[0],l[1],l[2],l[3]),!h))return new oe(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Pt(h||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}if(this.type.kind==="padding"){let l;for(const h of this.args){l=h.evaluate(r);const g=ye.parse(l);if(g)return g}throw new Pt(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}if(this.type.kind==="number"){let l=null;for(const h of this.args){if(l=h.evaluate(r),l===null)return 0;const g=Number(l);if(!isNaN(g))return g}throw new Pt(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?xe.fromString(Ct(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?Ce.fromString(Ct(this.args[0].evaluate(r))):Ct(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const an=["Unknown","Point","LineString","Polygon"];class xn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?an[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let l=this._parseColorCache[r];return l||(l=this._parseColorCache[r]=oe.parse(r)),l}}class bn{constructor(r,l,h,g){this.name=r,this.type=l,this._evaluate=h,this.args=g}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,l){const h=r[0],g=bn.definitions[h];if(!g)return l.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(g)?g[0]:g.type,w=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=w.filter(([N])=>!Array.isArray(N)||N.length===r.length-1);let A=null;for(const[N,j]of C){A=new Ca(l.registry,l.path,null,l.scope);const H=[];let Q=!1;for(let te=1;te<r.length;te++){const ne=r[te],_e=Array.isArray(N)?N[te-1]:N.type,me=A.parse(ne,1+H.length,_e);if(!me){Q=!0;break}H.push(me)}if(!Q)if(Array.isArray(N)&&N.length!==H.length)A.error(`Expected ${N.length} arguments, but found ${H.length} instead.`);else{for(let te=0;te<H.length;te++){const ne=Array.isArray(N)?N[te]:N.type,_e=H[te];A.concat(te+1).checkSubtype(ne,_e.type)}if(A.errors.length===0)return new bn(h,x,j,H)}}if(C.length===1)l.errors.push(...A.errors);else{const N=(C.length?C:w).map(([H])=>{return Q=H,Array.isArray(Q)?`(${Q.map(hn).join(", ")})`:`(${hn(Q.type)}...)`;var Q}).join(" | "),j=[];for(let H=1;H<r.length;H++){const Q=l.parse(r[H],1+j.length);if(!Q)return null;j.push(hn(Q.type))}l.error(`Expected arguments of type ${N}, but found (${j.join(", ")}) instead.`)}return null}static register(r,l){bn.definitions=l;for(const h in l)r[h]=bn}}class Cr{constructor(r,l,h){this.type=Ur,this.locale=h,this.caseSensitive=r,this.diacriticSensitive=l}static parse(r,l){if(r.length!==2)return l.error("Expected one argument.");const h=r[1];if(typeof h!="object"||Array.isArray(h))return l.error("Collator options argument must be an object.");const g=l.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Kt);if(!g)return null;const x=l.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Kt);if(!x)return null;let w=null;return h.locale&&(w=l.parse(h.locale,1,tn),!w)?null:new Cr(g,x,w)}evaluate(r){return new ge(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}const Gn=8192;function Vr(a,r){a[0]=Math.min(a[0],r[0]),a[1]=Math.min(a[1],r[1]),a[2]=Math.max(a[2],r[0]),a[3]=Math.max(a[3],r[1])}function Ea(a,r){return!(a[0]<=r[0]||a[2]>=r[2]||a[1]<=r[1]||a[3]>=r[3])}function Ja(a,r){const l=(180+a[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,r.z);return[Math.round(l*g*Gn),Math.round(h*g*Gn)]}function Mn(a,r,l){const h=a[0]-r[0],g=a[1]-r[1],x=a[0]-l[0],w=a[1]-l[1];return h*w-x*g==0&&h*x<=0&&g*w<=0}function Ta(a,r){let l=!1;for(let w=0,C=r.length;w<C;w++){const A=r[w];for(let N=0,j=A.length;N<j-1;N++){if(Mn(a,A[N],A[N+1]))return!1;(g=A[N])[1]>(h=a)[1]!=(x=A[N+1])[1]>h[1]&&h[0]<(x[0]-g[0])*(h[1]-g[1])/(x[1]-g[1])+g[0]&&(l=!l)}}var h,g,x;return l}function Bl(a,r){for(let l=0;l<r.length;l++)if(Ta(a,r[l]))return!0;return!1}function Sa(a,r,l,h){const g=h[0]-l[0],x=h[1]-l[1],w=(a[0]-l[0])*x-g*(a[1]-l[1]),C=(r[0]-l[0])*x-g*(r[1]-l[1]);return w>0&&C<0||w<0&&C>0}function Fl(a,r,l){for(const N of l)for(let j=0;j<N.length-1;++j)if((C=[(w=N[j+1])[0]-(x=N[j])[0],w[1]-x[1]])[0]*(A=[(g=r)[0]-(h=a)[0],g[1]-h[1]])[1]-C[1]*A[0]!=0&&Sa(h,g,x,w)&&Sa(x,w,h,g))return!0;var h,g,x,w,C,A;return!1}function Bs(a,r){for(let l=0;l<a.length;++l)if(!Ta(a[l],r))return!1;for(let l=0;l<a.length-1;++l)if(Fl(a[l],a[l+1],r))return!1;return!0}function Cd(a,r){for(let l=0;l<r.length;l++)if(Bs(a,r[l]))return!0;return!1}function Fs(a,r,l){const h=[];for(let g=0;g<a.length;g++){const x=[];for(let w=0;w<a[g].length;w++){const C=Ja(a[g][w],l);Vr(r,C),x.push(C)}h.push(x)}return h}function Ul(a,r,l){const h=[];for(let g=0;g<a.length;g++){const x=Fs(a[g],r,l);h.push(x)}return h}function Xc(a,r,l,h){if(a[0]<l[0]||a[0]>l[2]){const g=.5*h;let x=a[0]-l[0]>g?-h:l[0]-a[0]>g?h:0;x===0&&(x=a[0]-l[2]>g?-h:l[2]-a[0]>g?h:0),a[0]+=x}Vr(r,a)}function Vl(a,r,l,h){const g=Math.pow(2,h.z)*Gn,x=[h.x*Gn,h.y*Gn],w=[];for(const C of a)for(const A of C){const N=[A.x+x[0],A.y+x[1]];Xc(N,r,l,g),w.push(N)}return w}function Yc(a,r,l,h){const g=Math.pow(2,h.z)*Gn,x=[h.x*Gn,h.y*Gn],w=[];for(const A of a){const N=[];for(const j of A){const H=[j.x+x[0],j.y+x[1]];Vr(r,H),N.push(H)}w.push(N)}if(r[2]-r[0]<=g/2){(C=r)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const A of w)for(const N of A)Xc(N,r,l,g)}var C;return w}class na{constructor(r,l){this.type=Kt,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ut(r[1])){const h=r[1];if(h.type==="FeatureCollection")for(let g=0;g<h.features.length;++g){const x=h.features[g].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new na(h,h.features[g].geometry)}else if(h.type==="Feature"){const g=h.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new na(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new na(h,h)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(h.type==="Polygon"){const C=Fs(h.coordinates,x,w),A=Vl(l.geometry(),g,x,w);if(!Ea(g,x))return!1;for(const N of A)if(!Ta(N,C))return!1}if(h.type==="MultiPolygon"){const C=Ul(h.coordinates,x,w),A=Vl(l.geometry(),g,x,w);if(!Ea(g,x))return!1;for(const N of A)if(!Bl(N,C))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,h){const g=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],w=l.canonicalID();if(h.type==="Polygon"){const C=Fs(h.coordinates,x,w),A=Yc(l.geometry(),g,x,w);if(!Ea(g,x))return!1;for(const N of A)if(!Bs(N,C))return!1}if(h.type==="MultiPolygon"){const C=Ul(h.coordinates,x,w),A=Yc(l.geometry(),g,x,w);if(!Ea(g,x))return!1;for(const N of A)if(!Cd(N,C))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function ka(a){if(a instanceof bn&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof na)return!1;let r=!0;return a.eachChild(l=>{r&&!ka(l)&&(r=!1)}),r}function _o(a){if(a instanceof bn&&a.name==="feature-state")return!1;let r=!0;return a.eachChild(l=>{r&&!_o(l)&&(r=!1)}),r}function xo(a,r){if(a instanceof bn&&r.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(h=>{l&&!xo(h,r)&&(l=!1)}),l}class Us{constructor(r,l){this.type=l.type,this.name=r,this.boundExpression=l}static parse(r,l){if(r.length!==2||typeof r[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const h=r[1];return l.scope.has(h)?new Us(h,l.scope.get(h)):l.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Ca{constructor(r,l=[],h,g=new dr,x=[]){this.registry=r,this.path=l,this.key=l.map(w=>`[${w}]`).join(""),this.scope=g,this.errors=x,this.expectedType=h}parse(r,l,h,g,x={}){return l?this.concat(l,h,g)._parse(r,x):this._parse(r,x)}_parse(r,l){function h(g,x,w){return w==="assert"?new Qt(x,[g]):w==="coerce"?new en(x,[g]):g}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=r[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const x=this.registry[g];if(x){let w=x.parse(r,this);if(!w)return null;if(this.expectedType){const C=this.expectedType,A=w.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||A.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string")if(C.kind!=="padding"||A.kind!=="value"&&A.kind!=="number"&&A.kind!=="array"){if(this.checkSubtype(C,A))return null}else w=h(w,C,l.typeAnnotation||"coerce");else w=h(w,C,l.typeAnnotation||"coerce");else w=h(w,C,l.typeAnnotation||"assert")}if(!(w instanceof Ut)&&w.type.kind!=="resolvedImage"&&io(w)){const C=new xn;try{w=new Ut(w.type,w.evaluate(C))}catch(A){return this.error(A.message),null}}return w}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,l,h){const g=typeof r=="number"?this.path.concat(r):this.path,x=h?this.scope.concat(h):this.scope;return new Ca(this.registry,g,l||null,x,this.errors)}error(r,...l){const h=`${this.key}${l.map(g=>`[${g}]`).join("")}`;this.errors.push(new br(h,r))}checkSubtype(r,l){const h=Qr(r,l);return h&&this.error(h),h}}function io(a){if(a instanceof Us)return io(a.boundExpression);if(a instanceof bn&&a.name==="error"||a instanceof Cr||a instanceof na)return!1;const r=a instanceof en||a instanceof Qt;let l=!0;return a.eachChild(h=>{l=r?l&&io(h):l&&h instanceof Ut}),!!l&&ka(a)&&xo(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Vs(a,r){const l=a.length-1;let h,g,x=0,w=l,C=0;for(;x<=w;)if(C=Math.floor((x+w)/2),h=a[C],g=a[C+1],h<=r){if(C===l||r<g)return C;x=C+1}else{if(!(h>r))throw new Pt("Input is not a number.");w=C-1}return 0}class Qa{constructor(r,l,h){this.type=r,this.input=l,this.labels=[],this.outputs=[];for(const[g,x]of h)this.labels.push(g),this.outputs.push(x)}static parse(r,l){if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");const h=l.parse(r[1],1,xt);if(!h)return null;const g=[];let x=null;l.expectedType&&l.expectedType.kind!=="value"&&(x=l.expectedType);for(let w=1;w<r.length;w+=2){const C=w===1?-1/0:r[w],A=r[w+1],N=w,j=w+1;if(typeof C!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(g.length&&g[g.length-1][0]>=C)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const H=l.parse(A,j,x);if(!H)return null;x=x||H.type,g.push([C,H])}return new Qa(x,h,g)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const g=this.input.evaluate(r);if(g<=l[0])return h[0].evaluate(r);const x=l.length;return g>=l[x-1]?h[x-1].evaluate(r):h[Vs(l,g)].evaluate(r)}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function qn(a,r,l){return a*(1-l)+r*l}var es=Object.freeze({__proto__:null,number:qn,color:function(a,r,l){return new oe(qn(a.r,r.r,l),qn(a.g,r.g,l),qn(a.b,r.b,l),qn(a.a,r.a,l))},array:function(a,r,l){return a.map((h,g)=>qn(h,r[g],l))},padding:function(a,r,l){const h=a.values,g=r.values;return new ye([qn(h[0],g[0],l),qn(h[1],g[1],l),qn(h[2],g[2],l),qn(h[3],g[3],l)])}});const Jc=.95047,Oo=1.08883,js=4/29,Gs=6/29,ts=3*Gs*Gs,Pd=Math.PI/180,jl=180/Math.PI;function Gl(a){return a>.008856451679035631?Math.pow(a,1/3):a/ts+js}function qs(a){return a>Gs?a*a*a:ts*(a-js)}function Ws(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Hs(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function yn(a){const r=Hs(a.r),l=Hs(a.g),h=Hs(a.b),g=Gl((.4124564*r+.3575761*l+.1804375*h)/Jc),x=Gl((.2126729*r+.7151522*l+.072175*h)/1);return{l:116*x-16,a:500*(g-x),b:200*(x-Gl((.0193339*r+.119192*l+.9503041*h)/Oo)),alpha:a.a}}function ql(a){let r=(a.l+16)/116,l=isNaN(a.a)?r:r+a.a/500,h=isNaN(a.b)?r:r-a.b/200;return r=1*qs(r),l=Jc*qs(l),h=Oo*qs(h),new oe(Ws(3.2404542*l-1.5371385*r-.4985314*h),Ws(-.969266*l+1.8760108*r+.041556*h),Ws(.0556434*l-.2040259*r+1.0572252*h),a.alpha)}function Ad(a,r,l){const h=r-a;return a+l*(h>180||h<-180?h-360*Math.round(h/360):h)}const ns={forward:yn,reverse:ql,interpolate:function(a,r,l){return{l:qn(a.l,r.l,l),a:qn(a.a,r.a,l),b:qn(a.b,r.b,l),alpha:qn(a.alpha,r.alpha,l)}}},rs={forward:function(a){const{l:r,a:l,b:h}=yn(a),g=Math.atan2(h,l)*jl;return{h:g<0?g+360:g,c:Math.sqrt(l*l+h*h),l:r,alpha:a.a}},reverse:function(a){const r=a.h*Pd,l=a.c;return ql({l:a.l,a:Math.cos(r)*l,b:Math.sin(r)*l,alpha:a.alpha})},interpolate:function(a,r,l){return{h:Ad(a.h,r.h,l),c:qn(a.c,r.c,l),l:qn(a.l,r.l,l),alpha:qn(a.alpha,r.alpha,l)}}};var he=Object.freeze({__proto__:null,lab:ns,hcl:rs});class Me{constructor(r,l,h,g,x){this.type=r,this.operator=l,this.interpolation=h,this.input=g,this.labels=[],this.outputs=[];for(const[w,C]of x)this.labels.push(w),this.outputs.push(C)}static interpolationFactor(r,l,h,g){let x=0;if(r.name==="exponential")x=pt(l,r.base,h,g);else if(r.name==="linear")x=pt(l,1,h,g);else if(r.name==="cubic-bezier"){const w=r.controlPoints;x=new _(w[0],w[1],w[2],w[3]).solve(pt(l,1,h,g))}return x}static parse(r,l){let[h,g,x,...w]=r;if(!Array.isArray(g)||g.length===0)return l.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const N=g[1];if(typeof N!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:N}}else{if(g[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const N=g.slice(1);if(N.length!==4||N.some(j=>typeof j!="number"||j<0||j>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:N}}}if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(x=l.parse(x,2,xt),!x)return null;const C=[];let A=null;h==="interpolate-hcl"||h==="interpolate-lab"?A=er:l.expectedType&&l.expectedType.kind!=="value"&&(A=l.expectedType);for(let N=0;N<w.length;N+=2){const j=w[N],H=w[N+1],Q=N+3,te=N+4;if(typeof j!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Q);if(C.length&&C[C.length-1][0]>=j)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Q);const ne=l.parse(H,te,A);if(!ne)return null;A=A||ne.type,C.push([j,ne])}return A.kind==="number"||A.kind==="color"||A.kind==="padding"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Me(A,h,g,x,C):l.error(`Type ${hn(A)} is not interpolatable.`)}evaluate(r){const l=this.labels,h=this.outputs;if(l.length===1)return h[0].evaluate(r);const g=this.input.evaluate(r);if(g<=l[0])return h[0].evaluate(r);const x=l.length;if(g>=l[x-1])return h[x-1].evaluate(r);const w=Vs(l,g),C=Me.interpolationFactor(this.interpolation,g,l[w],l[w+1]),A=h[w].evaluate(r),N=h[w+1].evaluate(r);return this.operator==="interpolate"?es[this.type.kind.toLowerCase()](A,N,C):this.operator==="interpolate-hcl"?rs.reverse(rs.interpolate(rs.forward(A),rs.forward(N),C)):ns.reverse(ns.interpolate(ns.forward(A),ns.forward(N),C))}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function pt(a,r,l,h){const g=h-l,x=a-l;return g===0?0:r===1?x/g:(Math.pow(r,x)-1)/(Math.pow(r,g)-1)}class Ft{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expectected at least one argument.");let h=null;const g=l.expectedType;g&&g.kind!=="value"&&(h=g);const x=[];for(const C of r.slice(1)){const A=l.parse(C,1+x.length,h,void 0,{typeAnnotation:"omit"});if(!A)return null;h=h||A.type,x.push(A)}if(!h)throw new Error("No output type");const w=g&&x.some(C=>Qr(g,C.type));return new Ft(w?Jt:h,x)}evaluate(r){let l,h=null,g=0;for(const x of this.args)if(g++,h=x.evaluate(r),h&&h instanceof Ce&&!h.available&&(l||(l=h.name),h=null,g===this.args.length&&(h=l)),h!==null)break;return h}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}class Nn{constructor(r,l){this.type=l.type,this.bindings=[].concat(r),this.result=l}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const l of this.bindings)r(l[1]);r(this.result)}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const h=[];for(let x=1;x<r.length-1;x+=2){const w=r[x];if(typeof w!="string")return l.error(`Expected string, but found ${typeof w} instead.`,x);if(/[^a-zA-Z0-9_]/.test(w))return l.error("Variable names must contain only alphanumeric characters or '_'.",x);const C=l.parse(r[x+1],x+1);if(!C)return null;h.push([w,C])}const g=l.parse(r[r.length-1],r.length-1,l.expectedType,h);return g?new Nn(h,g):null}outputDefined(){return this.result.outputDefined()}}class sn{constructor(r,l,h){this.type=r,this.index=l,this.input=h}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,xt),g=l.parse(r[2],2,lr(l.expectedType||Jt));return h&&g?new sn(g.type.itemType,h,g):null}evaluate(r){const l=this.index.evaluate(r),h=this.input.evaluate(r);if(l<0)throw new Pt(`Array index out of bounds: ${l} < 0.`);if(l>=h.length)throw new Pt(`Array index out of bounds: ${l} > ${h.length-1}.`);if(l!==Math.floor(l))throw new Pt(`Array index must be an integer, but found ${l} instead.`);return h[l]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Xn{constructor(r,l){this.type=Kt,this.needle=r,this.haystack=l}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Jt),g=l.parse(r[2],2,Jt);return h&&g?Pi(h.type,[Kt,tn,xt,ai,Jt])?new Xn(h,g):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${hn(h.type)} instead`):null}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!h)return!1;if(!Ai(l,["boolean","string","number","null"]))throw new Pt(`Expected first argument to be of type boolean, string, number or null, but found ${hn(Ze(l))} instead.`);if(!Ai(h,["string","array"]))throw new Pt(`Expected second argument to be of type array or string, but found ${hn(Ze(h))} instead.`);return h.indexOf(l)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class hr{constructor(r,l,h){this.type=xt,this.needle=r,this.haystack=l,this.fromIndex=h}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Jt),g=l.parse(r[2],2,Jt);if(!h||!g)return null;if(!Pi(h.type,[Kt,tn,xt,ai,Jt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${hn(h.type)} instead`);if(r.length===4){const x=l.parse(r[3],3,xt);return x?new hr(h,g,x):null}return new hr(h,g)}evaluate(r){const l=this.needle.evaluate(r),h=this.haystack.evaluate(r);if(!Ai(l,["boolean","string","number","null"]))throw new Pt(`Expected first argument to be of type boolean, string, number or null, but found ${hn(Ze(l))} instead.`);if(!Ai(h,["string","array"]))throw new Pt(`Expected second argument to be of type array or string, but found ${hn(Ze(h))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(r);return h.indexOf(l,g)}return h.indexOf(l)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class wr{constructor(r,l,h,g,x,w){this.inputType=r,this.type=l,this.input=h,this.cases=g,this.outputs=x,this.otherwise=w}static parse(r,l){if(r.length<5)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return l.error("Expected an even number of arguments.");let h,g;l.expectedType&&l.expectedType.kind!=="value"&&(g=l.expectedType);const x={},w=[];for(let N=2;N<r.length-1;N+=2){let j=r[N];const H=r[N+1];Array.isArray(j)||(j=[j]);const Q=l.concat(N);if(j.length===0)return Q.error("Expected at least one branch label.");for(const ne of j){if(typeof ne!="number"&&typeof ne!="string")return Q.error("Branch labels must be numbers or strings.");if(typeof ne=="number"&&Math.abs(ne)>Number.MAX_SAFE_INTEGER)return Q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ne=="number"&&Math.floor(ne)!==ne)return Q.error("Numeric branch labels must be integer values.");if(h){if(Q.checkSubtype(h,Ze(ne)))return null}else h=Ze(ne);if(x[String(ne)]!==void 0)return Q.error("Branch labels must be unique.");x[String(ne)]=w.length}const te=l.parse(H,N,g);if(!te)return null;g=g||te.type,w.push(te)}const C=l.parse(r[1],1,Jt);if(!C)return null;const A=l.parse(r[r.length-1],r.length-1,g);return A?C.type.kind!=="value"&&l.concat(1).checkSubtype(h,C.type)?null:new wr(h,g,C,x,w,A):null}evaluate(r){const l=this.input.evaluate(r);return(Ze(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Wn{constructor(r,l,h){this.type=r,this.branches=l,this.otherwise=h}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return l.error("Expected an odd number of arguments.");let h;l.expectedType&&l.expectedType.kind!=="value"&&(h=l.expectedType);const g=[];for(let w=1;w<r.length-1;w+=2){const C=l.parse(r[w],w,Kt);if(!C)return null;const A=l.parse(r[w+1],w+1,h);if(!A)return null;g.push([C,A]),h=h||A.type}const x=l.parse(r[r.length-1],r.length-1,h);if(!x)return null;if(!h)throw new Error("Can't infer output type");return new Wn(h,g,x)}evaluate(r){for(const[l,h]of this.branches)if(l.evaluate(r))return h.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[l,h]of this.branches)r(l),r(h);r(this.otherwise)}outputDefined(){return this.branches.every(([r,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class jr{constructor(r,l,h,g){this.type=r,this.input=l,this.beginIndex=h,this.endIndex=g}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const h=l.parse(r[1],1,Jt),g=l.parse(r[2],2,xt);if(!h||!g)return null;if(!Pi(h.type,[lr(Jt),tn,Jt]))return l.error(`Expected first argument to be of type array or string, but found ${hn(h.type)} instead`);if(r.length===4){const x=l.parse(r[3],3,xt);return x?new jr(h.type,h,g,x):null}return new jr(h.type,h,g)}evaluate(r){const l=this.input.evaluate(r),h=this.beginIndex.evaluate(r);if(!Ai(l,["string","array"]))throw new Pt(`Expected first argument to be of type array or string, but found ${hn(Ze(l))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(r);return l.slice(h,g)}return l.slice(h)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function Ii(a,r){return a==="=="||a==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Lr(a,r,l,h){return h.compare(r,l)===0}function Nr(a,r,l){const h=a!=="=="&&a!=="!=";return class NP{constructor(x,w,C){this.type=Kt,this.lhs=x,this.rhs=w,this.collator=C,this.hasUntypedArgument=x.type.kind==="value"||w.type.kind==="value"}static parse(x,w){if(x.length!==3&&x.length!==4)return w.error("Expected two or three arguments.");const C=x[0];let A=w.parse(x[1],1,Jt);if(!A)return null;if(!Ii(C,A.type))return w.concat(1).error(`"${C}" comparisons are not supported for type '${hn(A.type)}'.`);let N=w.parse(x[2],2,Jt);if(!N)return null;if(!Ii(C,N.type))return w.concat(2).error(`"${C}" comparisons are not supported for type '${hn(N.type)}'.`);if(A.type.kind!==N.type.kind&&A.type.kind!=="value"&&N.type.kind!=="value")return w.error(`Cannot compare types '${hn(A.type)}' and '${hn(N.type)}'.`);h&&(A.type.kind==="value"&&N.type.kind!=="value"?A=new Qt(N.type,[A]):A.type.kind!=="value"&&N.type.kind==="value"&&(N=new Qt(A.type,[N])));let j=null;if(x.length===4){if(A.type.kind!=="string"&&N.type.kind!=="string"&&A.type.kind!=="value"&&N.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(j=w.parse(x[3],3,Ur),!j)return null}return new NP(A,N,j)}evaluate(x){const w=this.lhs.evaluate(x),C=this.rhs.evaluate(x);if(h&&this.hasUntypedArgument){const A=Ze(w),N=Ze(C);if(A.kind!==N.kind||A.kind!=="string"&&A.kind!=="number")throw new Pt(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${A.kind}, ${N.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const A=Ze(w),N=Ze(C);if(A.kind!=="string"||N.kind!=="string")return r(x,w,C)}return this.collator?l(x,w,C,this.collator.evaluate(x)):r(x,w,C)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}}}const Mi=Nr("==",function(a,r,l){return r===l},Lr),$o=Nr("!=",function(a,r,l){return r!==l},function(a,r,l,h){return!Lr(0,r,l,h)}),bo=Nr("<",function(a,r,l){return r<l},function(a,r,l,h){return h.compare(r,l)<0}),ra=Nr(">",function(a,r,l){return r>l},function(a,r,l,h){return h.compare(r,l)>0}),Qc=Nr("<=",function(a,r,l){return r<=l},function(a,r,l,h){return h.compare(r,l)<=0}),Zs=Nr(">=",function(a,r,l){return r>=l},function(a,r,l,h){return h.compare(r,l)>=0});class Pa{constructor(r,l,h,g,x){this.type=tn,this.number=r,this.locale=l,this.currency=h,this.minFractionDigits=g,this.maxFractionDigits=x}static parse(r,l){if(r.length!==3)return l.error("Expected two arguments.");const h=l.parse(r[1],1,xt);if(!h)return null;const g=r[2];if(typeof g!="object"||Array.isArray(g))return l.error("NumberFormat options argument must be an object.");let x=null;if(g.locale&&(x=l.parse(g.locale,1,tn),!x))return null;let w=null;if(g.currency&&(w=l.parse(g.currency,1,tn),!w))return null;let C=null;if(g["min-fraction-digits"]&&(C=l.parse(g["min-fraction-digits"],1,xt),!C))return null;let A=null;return g["max-fraction-digits"]&&(A=l.parse(g["max-fraction-digits"],1,xt),!A)?null:new Pa(h,x,w,C,A)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class eu{constructor(r){this.type=zn,this.sections=r}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const h=r[1];if(!Array.isArray(h)&&typeof h=="object")return l.error("First argument must be an image or text section.");const g=[];let x=!1;for(let w=1;w<=r.length-1;++w){const C=r[w];if(x&&typeof C=="object"&&!Array.isArray(C)){x=!1;let A=null;if(C["font-scale"]&&(A=l.parse(C["font-scale"],1,xt),!A))return null;let N=null;if(C["text-font"]&&(N=l.parse(C["text-font"],1,lr(tn)),!N))return null;let j=null;if(C["text-color"]&&(j=l.parse(C["text-color"],1,er),!j))return null;const H=g[g.length-1];H.scale=A,H.font=N,H.textColor=j}else{const A=l.parse(r[w],1,Jt);if(!A)return null;const N=A.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new eu(g)}evaluate(r){return new xe(this.sections.map(l=>{const h=l.content.evaluate(r);return Ze(h)===Bn?new Se("",h,null,null,null):new Se(Ct(h),null,l.scale?l.scale.evaluate(r):null,l.font?l.font.evaluate(r).join(","):null,l.textColor?l.textColor.evaluate(r):null)}))}eachChild(r){for(const l of this.sections)r(l.content),l.scale&&r(l.scale),l.font&&r(l.font),l.textColor&&r(l.textColor)}outputDefined(){return!1}}class Id{constructor(r){this.type=Bn,this.input=r}static parse(r,l){if(r.length!==2)return l.error("Expected two arguments.");const h=l.parse(r[1],1,tn);return h?new Id(h):l.error("No image name provided.")}evaluate(r){const l=this.input.evaluate(r),h=Ce.fromString(l);return h&&r.availableImages&&(h.available=r.availableImages.indexOf(l)>-1),h}eachChild(r){r(this.input)}outputDefined(){return!1}}class Md{constructor(r){this.type=xt,this.input=r}static parse(r,l){if(r.length!==2)return l.error(`Expected 1 argument, but found ${r.length-1} instead.`);const h=l.parse(r[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${hn(h.type)} instead.`):new Md(h):null}evaluate(r){const l=this.input.evaluate(r);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Pt(`Expected value to be of type string or array, but found ${hn(Ze(l))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Ks={"==":Mi,"!=":$o,">":ra,"<":bo,">=":Zs,"<=":Qc,array:Qt,at:sn,boolean:Qt,case:Wn,coalesce:Ft,collator:Cr,format:eu,image:Id,in:Xn,"index-of":hr,interpolate:Me,"interpolate-hcl":Me,"interpolate-lab":Me,length:Md,let:Nn,literal:Ut,match:wr,number:Qt,"number-format":Pa,object:Qt,slice:jr,step:Qa,string:Qt,"to-boolean":en,"to-color":en,"to-number":en,"to-string":en,var:Us,within:na};function Bf(a,[r,l,h,g]){r=r.evaluate(a),l=l.evaluate(a),h=h.evaluate(a);const x=g?g.evaluate(a):1,w=Xe(r,l,h,x);if(w)throw new Pt(w);return new oe(r/255*x,l/255*x,h/255*x,x)}function Ff(a,r){return a in r}function tu(a,r){const l=r[a];return l===void 0?null:l}function is(a){return{type:a}}function Uf(a){return{result:"success",value:a}}function Xs(a){return{result:"error",value:a}}function Yn(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function Vf(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function vn(a){return!!a.expression&&a.expression.interpolated}function Pn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function Hn(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function tr(a){return a}function Wl(a,r){const l=r.type==="color",h=a.stops&&typeof a.stops[0][0]=="object",g=h||!(h||a.property!==void 0),x=a.type||(vn(r)?"exponential":"interval");if(l||r.type==="padding"){const N=l?oe.parse:ye.parse;(a=Dr({},a)).stops&&(a.stops=a.stops.map(j=>[j[0],N(j[1])])),a.default=N(a.default?a.default:r.default)}if(a.colorSpace&&a.colorSpace!=="rgb"&&!he[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let w,C,A;if(x==="exponential")w=jf;else if(x==="interval")w=ug;else if(x==="categorical"){w=cg,C=Object.create(null);for(const N of a.stops)C[N[0]]=N[1];A=typeof a.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);w=dg}if(h){const N={},j=[];for(let te=0;te<a.stops.length;te++){const ne=a.stops[te],_e=ne[0].zoom;N[_e]===void 0&&(N[_e]={zoom:_e,type:a.type,property:a.property,default:a.default,stops:[]},j.push(_e)),N[_e].stops.push([ne[0].value,ne[1]])}const H=[];for(const te of j)H.push([N[te].zoom,Wl(N[te],r)]);const Q={name:"linear"};return{kind:"composite",interpolationType:Q,interpolationFactor:Me.interpolationFactor.bind(void 0,Q),zoomStops:H.map(te=>te[0]),evaluate:({zoom:te},ne)=>jf({stops:H,base:a.base},r,te).evaluate(te,ne)}}if(g){const N=x==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:Me.interpolationFactor.bind(void 0,N),zoomStops:a.stops.map(j=>j[0]),evaluate:({zoom:j})=>w(a,r,j,C,A)}}return{kind:"source",evaluate(N,j){const H=j&&j.properties?j.properties[a.property]:void 0;return H===void 0?Ys(a.default,r.default):w(a,r,H,C,A)}}}function Ys(a,r,l){return a!==void 0?a:r!==void 0?r:l!==void 0?l:void 0}function cg(a,r,l,h,g){return Ys(typeof l===g?h[l]:void 0,a.default,r.default)}function ug(a,r,l){if(Pn(l)!=="number")return Ys(a.default,r.default);const h=a.stops.length;if(h===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[h-1][0])return a.stops[h-1][1];const g=Vs(a.stops.map(x=>x[0]),l);return a.stops[g][1]}function jf(a,r,l){const h=a.base!==void 0?a.base:1;if(Pn(l)!=="number")return Ys(a.default,r.default);const g=a.stops.length;if(g===1||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[g-1][0])return a.stops[g-1][1];const x=Vs(a.stops.map(j=>j[0]),l),w=function(j,H,Q,te){const ne=te-Q,_e=j-Q;return ne===0?0:H===1?_e/ne:(Math.pow(H,_e)-1)/(Math.pow(H,ne)-1)}(l,h,a.stops[x][0],a.stops[x+1][0]),C=a.stops[x][1],A=a.stops[x+1][1];let N=es[r.type]||tr;if(a.colorSpace&&a.colorSpace!=="rgb"){const j=he[a.colorSpace];N=(H,Q)=>j.reverse(j.interpolate(j.forward(H),j.forward(Q),w))}return typeof C.evaluate=="function"?{evaluate(...j){const H=C.evaluate.apply(void 0,j),Q=A.evaluate.apply(void 0,j);if(H!==void 0&&Q!==void 0)return N(H,Q,w)}}:N(C,A,w)}function dg(a,r,l){switch(r.type){case"color":l=oe.parse(l);break;case"formatted":l=xe.fromString(l.toString());break;case"resolvedImage":l=Ce.fromString(l.toString());break;case"padding":l=ye.parse(l);break;default:Pn(l)===r.type||r.type==="enum"&&r.values[l]||(l=void 0)}return Ys(l,a.default,r.default)}bn.register(Ks,{error:[{kind:"error"},[tn],(a,[r])=>{throw new Pt(r.evaluate(a))}],typeof:[tn,[Jt],(a,[r])=>hn(Ze(r.evaluate(a)))],"to-rgba":[lr(xt,4),[er],(a,[r])=>r.evaluate(a).toArray()],rgb:[er,[xt,xt,xt],Bf],rgba:[er,[xt,xt,xt,xt],Bf],has:{type:Kt,overloads:[[[tn],(a,[r])=>Ff(r.evaluate(a),a.properties())],[[tn,gi],(a,[r,l])=>Ff(r.evaluate(a),l.evaluate(a))]]},get:{type:Jt,overloads:[[[tn],(a,[r])=>tu(r.evaluate(a),a.properties())],[[tn,gi],(a,[r,l])=>tu(r.evaluate(a),l.evaluate(a))]]},"feature-state":[Jt,[tn],(a,[r])=>tu(r.evaluate(a),a.featureState||{})],properties:[gi,[],a=>a.properties()],"geometry-type":[tn,[],a=>a.geometryType()],id:[Jt,[],a=>a.id()],zoom:[xt,[],a=>a.globals.zoom],"heatmap-density":[xt,[],a=>a.globals.heatmapDensity||0],"line-progress":[xt,[],a=>a.globals.lineProgress||0],accumulated:[Jt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[xt,is(xt),(a,r)=>{let l=0;for(const h of r)l+=h.evaluate(a);return l}],"*":[xt,is(xt),(a,r)=>{let l=1;for(const h of r)l*=h.evaluate(a);return l}],"-":{type:xt,overloads:[[[xt,xt],(a,[r,l])=>r.evaluate(a)-l.evaluate(a)],[[xt],(a,[r])=>-r.evaluate(a)]]},"/":[xt,[xt,xt],(a,[r,l])=>r.evaluate(a)/l.evaluate(a)],"%":[xt,[xt,xt],(a,[r,l])=>r.evaluate(a)%l.evaluate(a)],ln2:[xt,[],()=>Math.LN2],pi:[xt,[],()=>Math.PI],e:[xt,[],()=>Math.E],"^":[xt,[xt,xt],(a,[r,l])=>Math.pow(r.evaluate(a),l.evaluate(a))],sqrt:[xt,[xt],(a,[r])=>Math.sqrt(r.evaluate(a))],log10:[xt,[xt],(a,[r])=>Math.log(r.evaluate(a))/Math.LN10],ln:[xt,[xt],(a,[r])=>Math.log(r.evaluate(a))],log2:[xt,[xt],(a,[r])=>Math.log(r.evaluate(a))/Math.LN2],sin:[xt,[xt],(a,[r])=>Math.sin(r.evaluate(a))],cos:[xt,[xt],(a,[r])=>Math.cos(r.evaluate(a))],tan:[xt,[xt],(a,[r])=>Math.tan(r.evaluate(a))],asin:[xt,[xt],(a,[r])=>Math.asin(r.evaluate(a))],acos:[xt,[xt],(a,[r])=>Math.acos(r.evaluate(a))],atan:[xt,[xt],(a,[r])=>Math.atan(r.evaluate(a))],min:[xt,is(xt),(a,r)=>Math.min(...r.map(l=>l.evaluate(a)))],max:[xt,is(xt),(a,r)=>Math.max(...r.map(l=>l.evaluate(a)))],abs:[xt,[xt],(a,[r])=>Math.abs(r.evaluate(a))],round:[xt,[xt],(a,[r])=>{const l=r.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[xt,[xt],(a,[r])=>Math.floor(r.evaluate(a))],ceil:[xt,[xt],(a,[r])=>Math.ceil(r.evaluate(a))],"filter-==":[Kt,[tn,Jt],(a,[r,l])=>a.properties()[r.value]===l.value],"filter-id-==":[Kt,[Jt],(a,[r])=>a.id()===r.value],"filter-type-==":[Kt,[tn],(a,[r])=>a.geometryType()===r.value],"filter-<":[Kt,[tn,Jt],(a,[r,l])=>{const h=a.properties()[r.value],g=l.value;return typeof h==typeof g&&h<g}],"filter-id-<":[Kt,[Jt],(a,[r])=>{const l=a.id(),h=r.value;return typeof l==typeof h&&l<h}],"filter->":[Kt,[tn,Jt],(a,[r,l])=>{const h=a.properties()[r.value],g=l.value;return typeof h==typeof g&&h>g}],"filter-id->":[Kt,[Jt],(a,[r])=>{const l=a.id(),h=r.value;return typeof l==typeof h&&l>h}],"filter-<=":[Kt,[tn,Jt],(a,[r,l])=>{const h=a.properties()[r.value],g=l.value;return typeof h==typeof g&&h<=g}],"filter-id-<=":[Kt,[Jt],(a,[r])=>{const l=a.id(),h=r.value;return typeof l==typeof h&&l<=h}],"filter->=":[Kt,[tn,Jt],(a,[r,l])=>{const h=a.properties()[r.value],g=l.value;return typeof h==typeof g&&h>=g}],"filter-id->=":[Kt,[Jt],(a,[r])=>{const l=a.id(),h=r.value;return typeof l==typeof h&&l>=h}],"filter-has":[Kt,[Jt],(a,[r])=>r.value in a.properties()],"filter-has-id":[Kt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Kt,[lr(tn)],(a,[r])=>r.value.indexOf(a.geometryType())>=0],"filter-id-in":[Kt,[lr(Jt)],(a,[r])=>r.value.indexOf(a.id())>=0],"filter-in-small":[Kt,[tn,lr(Jt)],(a,[r,l])=>l.value.indexOf(a.properties()[r.value])>=0],"filter-in-large":[Kt,[tn,lr(Jt)],(a,[r,l])=>function(h,g,x,w){for(;x<=w;){const C=x+w>>1;if(g[C]===h)return!0;g[C]>h?w=C-1:x=C+1}return!1}(a.properties()[r.value],l.value,0,l.value.length-1)],all:{type:Kt,overloads:[[[Kt,Kt],(a,[r,l])=>r.evaluate(a)&&l.evaluate(a)],[is(Kt),(a,r)=>{for(const l of r)if(!l.evaluate(a))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],(a,[r,l])=>r.evaluate(a)||l.evaluate(a)],[is(Kt),(a,r)=>{for(const l of r)if(l.evaluate(a))return!0;return!1}]]},"!":[Kt,[Kt],(a,[r])=>!r.evaluate(a)],"is-supported-script":[Kt,[tn],(a,[r])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(r.evaluate(a))}],upcase:[tn,[tn],(a,[r])=>r.evaluate(a).toUpperCase()],downcase:[tn,[tn],(a,[r])=>r.evaluate(a).toLowerCase()],concat:[tn,is(Jt),(a,r)=>r.map(l=>Ct(l.evaluate(a))).join("")],"resolved-locale":[tn,[Ur],(a,[r])=>r.evaluate(a).resolvedLocale()]});class nu{constructor(r,l){this.expression=r,this._warningHistory={},this._evaluator=new xn,this._defaultValue=l?function(h){return h.type==="color"&&Hn(h.default)?new oe(0,0,0,0):h.type==="color"?oe.parse(h.default)||null:h.type==="padding"?ye.parse(h.default)||null:h.default===void 0?null:h.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(r,l,h,g,x,w){return this._evaluator.globals=r,this._evaluator.feature=l,this._evaluator.featureState=h,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(r,l,h,g,x,w){this._evaluator.globals=r,this._evaluator.feature=l||null,this._evaluator.featureState=h||null,this._evaluator.canonical=g,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=w||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Pt(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Hl(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ks}function Zl(a,r){const l=new Ca(Ks,[],r?function(g){const x={color:er,string:tn,number:xt,enum:tn,boolean:Kt,formatted:zn,padding:yi,resolvedImage:Bn};return g.type==="array"?lr(x[g.value]||Jt,g.length):x[g.type]}(r):void 0),h=l.parse(a,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Uf(new nu(h,r)):Xs(l.errors)}class Kl{constructor(r,l){this.kind=r,this._styleExpression=l,this.isStateDependent=r!=="constant"&&!_o(l.expression)}evaluateWithoutErrorHandling(r,l,h,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,g,x,w)}evaluate(r,l,h,g,x,w){return this._styleExpression.evaluate(r,l,h,g,x,w)}}class Dd{constructor(r,l,h,g){this.kind=r,this.zoomStops=h,this._styleExpression=l,this.isStateDependent=r!=="camera"&&!_o(l.expression),this.interpolationType=g}evaluateWithoutErrorHandling(r,l,h,g,x,w){return this._styleExpression.evaluateWithoutErrorHandling(r,l,h,g,x,w)}evaluate(r,l,h,g,x,w){return this._styleExpression.evaluate(r,l,h,g,x,w)}interpolationFactor(r,l,h){return this.interpolationType?Me.interpolationFactor(this.interpolationType,r,l,h):0}}function Gf(a,r){const l=Zl(a,r);if(l.result==="error")return l;const h=l.value.expression,g=ka(h);if(!g&&!Yn(r))return Xs([new br("","data expressions not supported")]);const x=xo(h,["zoom"]);if(!x&&!Vf(r))return Xs([new br("","zoom expressions not supported")]);const w=iu(h);return w||x?w instanceof br?Xs([w]):w instanceof Me&&!vn(r)?Xs([new br("",'"interpolate" expressions cannot be used with this property')]):Uf(w?new Dd(g?"camera":"composite",l.value,w.labels,w instanceof Me?w.interpolation:void 0):new Kl(g?"constant":"source",l.value)):Xs([new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ru{constructor(r,l){this._parameters=r,this._specification=l,Dr(this,Wl(this._parameters,this._specification))}static deserialize(r){return new ru(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function iu(a){let r=null;if(a instanceof Nn)r=iu(a.result);else if(a instanceof Ft){for(const l of a.args)if(r=iu(l),r)break}else(a instanceof Qa||a instanceof Me)&&a.input instanceof bn&&a.input.name==="zoom"&&(r=a);return r instanceof br||a.eachChild(l=>{const h=iu(l);h instanceof br?r=h:!r&&h?r=new br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&h&&r!==h&&(r=new br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function wo(a){const r=a.key,l=a.value,h=a.valueSpec||{},g=a.objectElementValidators||{},x=a.style,w=a.styleSpec;let C=[];const A=Pn(l);if(A!=="object")return[new _t(r,l,`object expected, ${A} found`)];for(const N in l){const j=N.split(".")[0],H=h[j]||h["*"];let Q;if(g[j])Q=g[j];else if(h[j])Q=qi;else if(g["*"])Q=g["*"];else{if(!h["*"]){C.push(new _t(r,l[N],`unknown property "${N}"`));continue}Q=qi}C=C.concat(Q({key:(r&&`${r}.`)+N,value:l[N],valueSpec:H,style:x,styleSpec:w,object:l,objectKey:N},l))}for(const N in h)g[N]||h[N].required&&h[N].default===void 0&&l[N]===void 0&&C.push(new _t(r,l,`missing required property "${N}"`));return C}function qf(a){const r=a.value,l=a.valueSpec,h=a.style,g=a.styleSpec,x=a.key,w=a.arrayElementValidator||qi;if(Pn(r)!=="array")return[new _t(x,r,`array expected, ${Pn(r)} found`)];if(l.length&&r.length!==l.length)return[new _t(x,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new _t(x,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let C={type:l.value,values:l.values};g.$version<7&&(C.function=l.function),Pn(l.value)==="object"&&(C=l.value);let A=[];for(let N=0;N<r.length;N++)A=A.concat(w({array:r,arrayIndex:N,value:r[N],valueSpec:C,style:h,styleSpec:g,key:`${x}[${N}]`}));return A}function Rd(a){const r=a.key,l=a.value,h=a.valueSpec;let g=Pn(l);return g==="number"&&l!=l&&(g="NaN"),g!=="number"?[new _t(r,l,`number expected, ${g} found`)]:"minimum"in h&&l<h.minimum?[new _t(r,l,`${l} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&l>h.maximum?[new _t(r,l,`${l} is greater than the maximum value ${h.maximum}`)]:[]}function Wf(a){const r=a.valueSpec,l=cn(a.value.type);let h,g,x,w={};const C=l!=="categorical"&&a.value.property===void 0,A=!C,N=Pn(a.value.stops)==="array"&&Pn(a.value.stops[0])==="array"&&Pn(a.value.stops[0][0])==="object",j=wo({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(te){if(l==="identity")return[new _t(te.key,te.value,'identity function may not have a "stops" property')];let ne=[];const _e=te.value;return ne=ne.concat(qf({key:te.key,value:_e,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:H})),Pn(_e)==="array"&&_e.length===0&&ne.push(new _t(te.key,_e,"array must have at least one stop")),ne},default:function(te){return qi({key:te.key,value:te.value,valueSpec:r,style:te.style,styleSpec:te.styleSpec})}}});return l==="identity"&&C&&j.push(new _t(a.key,a.value,'missing required property "property"')),l==="identity"||a.value.stops||j.push(new _t(a.key,a.value,'missing required property "stops"')),l==="exponential"&&a.valueSpec.expression&&!vn(a.valueSpec)&&j.push(new _t(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(A&&!Yn(a.valueSpec)?j.push(new _t(a.key,a.value,"property functions not supported")):C&&!Vf(a.valueSpec)&&j.push(new _t(a.key,a.value,"zoom functions not supported"))),l!=="categorical"&&!N||a.value.property!==void 0||j.push(new _t(a.key,a.value,'"property" property is required')),j;function H(te){let ne=[];const _e=te.value,me=te.key;if(Pn(_e)!=="array")return[new _t(me,_e,`array expected, ${Pn(_e)} found`)];if(_e.length!==2)return[new _t(me,_e,`array length 2 expected, length ${_e.length} found`)];if(N){if(Pn(_e[0])!=="object")return[new _t(me,_e,`object expected, ${Pn(_e[0])} found`)];if(_e[0].zoom===void 0)return[new _t(me,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new _t(me,_e,"object stop key must have value")];if(x&&x>cn(_e[0].zoom))return[new _t(me,_e[0].zoom,"stop zoom values must appear in ascending order")];cn(_e[0].zoom)!==x&&(x=cn(_e[0].zoom),g=void 0,w={}),ne=ne.concat(wo({key:`${me}[0]`,value:_e[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:Rd,value:Q}}))}else ne=ne.concat(Q({key:`${me}[0]`,value:_e[0],valueSpec:{},style:te.style,styleSpec:te.styleSpec},_e));return Hl(Rr(_e[1]))?ne.concat([new _t(`${me}[1]`,_e[1],"expressions are not allowed in function stops.")]):ne.concat(qi({key:`${me}[1]`,value:_e[1],valueSpec:r,style:te.style,styleSpec:te.styleSpec}))}function Q(te,ne){const _e=Pn(te.value),me=cn(te.value),$e=te.value!==null?te.value:ne;if(h){if(_e!==h)return[new _t(te.key,$e,`${_e} stop domain type must match previous stop domain type ${h}`)]}else h=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean")return[new _t(te.key,$e,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&l!=="categorical"){let qe=`number expected, ${_e} found`;return Yn(r)&&l===void 0&&(qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _t(te.key,$e,qe)]}return l!=="categorical"||_e!=="number"||isFinite(me)&&Math.floor(me)===me?l!=="categorical"&&_e==="number"&&g!==void 0&&me<g?[new _t(te.key,$e,"stop domain values must appear in ascending order")]:(g=me,l==="categorical"&&me in w?[new _t(te.key,$e,"stop domain values must be unique")]:(w[me]=!0,[])):[new _t(te.key,$e,`integer expected, found ${me}`)]}}function os(a){const r=(a.expressionContext==="property"?Gf:Zl)(Rr(a.value),a.valueSpec);if(r.result==="error")return r.value.map(h=>new _t(`${a.key}${h.key}`,a.value,h.message));const l=r.value.expression||r.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!l.outputDefined())return[new _t(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!_o(l))return[new _t(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!_o(l))return[new _t(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!xo(l,["zoom","feature-state"]))return[new _t(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!ka(l))return[new _t(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xl(a){const r=a.key,l=a.value,h=a.valueSpec,g=[];return Array.isArray(h.values)?h.values.indexOf(cn(l))===-1&&g.push(new _t(r,l,`expected one of [${h.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(h.values).indexOf(cn(l))===-1&&g.push(new _t(r,l,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(l)} found`)),g}function Js(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const r of a.slice(1))if(!Js(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const hg={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ou(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Js(a)||(a=Yl(a));const r=Zl(a,hg);if(r.result==="error")throw new Error(r.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,h,g)=>r.value.evaluate(l,h,{},g),needGeometry:Zf(a)}}function Hf(a,r){return a<r?-1:a>r?1:0}function Zf(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let r=1;r<a.length;r++)if(Zf(a[r]))return!0;return!1}function Yl(a){if(!a)return!0;const r=a[0];return a.length<=1?r!=="any":r==="=="?Ld(a[1],a[2],"=="):r==="!="?Qs(Ld(a[1],a[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Ld(a[1],a[2],r):r==="any"?(l=a.slice(1),["any"].concat(l.map(Yl))):r==="all"?["all"].concat(a.slice(1).map(Yl)):r==="none"?["all"].concat(a.slice(1).map(Yl).map(Qs)):r==="in"?au(a[1],a.slice(2)):r==="!in"?Qs(au(a[1],a.slice(2))):r==="has"?Jl(a[1]):r==="!has"?Qs(Jl(a[1])):r!=="within"||a;var l}function Ld(a,r,l){switch(a){case"$type":return[`filter-type-${l}`,r];case"$id":return[`filter-id-${l}`,r];default:return[`filter-${l}`,a,r]}}function au(a,r){if(r.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(l=>typeof l!=typeof r[0])?["filter-in-large",a,["literal",r.sort(Hf)]]:["filter-in-small",a,["literal",r]]}}function Jl(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Qs(a){return["!",a]}function Ql(a){return Js(Rr(a.value))?os(Dr({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Kf(a)}function Kf(a){const r=a.value,l=a.key;if(Pn(r)!=="array")return[new _t(l,r,`array expected, ${Pn(r)} found`)];const h=a.styleSpec;let g,x=[];if(r.length<1)return[new _t(l,r,"filter array must have at least 1 element")];switch(x=x.concat(Xl({key:`${l}[0]`,value:r[0],valueSpec:h.filter_operator,style:a.style,styleSpec:a.styleSpec})),cn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&cn(r[1])==="$type"&&x.push(new _t(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&x.push(new _t(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(g=Pn(r[1]),g!=="string"&&x.push(new _t(`${l}[1]`,r[1],`string expected, ${g} found`)));for(let w=2;w<r.length;w++)g=Pn(r[w]),cn(r[1])==="$type"?x=x.concat(Xl({key:`${l}[${w}]`,value:r[w],valueSpec:h.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&x.push(new _t(`${l}[${w}]`,r[w],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let w=1;w<r.length;w++)x=x.concat(Kf({key:`${l}[${w}]`,value:r[w],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Pn(r[1]),r.length!==2?x.push(new _t(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):g!=="string"&&x.push(new _t(`${l}[1]`,r[1],`string expected, ${g} found`));break;case"within":g=Pn(r[1]),r.length!==2?x.push(new _t(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):g!=="object"&&x.push(new _t(`${l}[1]`,r[1],`object expected, ${g} found`))}return x}function ec(a,r){const l=a.key,h=a.style,g=a.styleSpec,x=a.value,w=a.objectKey,C=g[`${r}_${a.layerType}`];if(!C)return[];const A=w.match(/^(.*)-transition$/);if(r==="paint"&&A&&C[A[1]]&&C[A[1]].transition)return qi({key:l,value:x,valueSpec:g.transition,style:h,styleSpec:g});const N=a.valueSpec||C[w];if(!N)return[new _t(l,x,`unknown property "${w}"`)];let j;if(Pn(x)==="string"&&Yn(N)&&!N.tokens&&(j=/^{([^}]+)}$/.exec(x)))return[new _t(l,x,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const H=[];return a.layerType==="symbol"&&(w==="text-field"&&h&&!h.glyphs&&H.push(new _t(l,x,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Hn(Rr(x))&&cn(x.type)==="identity"&&H.push(new _t(l,x,'"text-font" does not support identity functions'))),H.concat(qi({key:a.key,value:x,valueSpec:N,style:h,styleSpec:g,expressionContext:"property",propertyType:r,propertyKey:w}))}function Xf(a){return ec(a,"paint")}function Yf(a){return ec(a,"layout")}function Jf(a){let r=[];const l=a.value,h=a.key,g=a.style,x=a.styleSpec;l.type||l.ref||r.push(new _t(h,l,'either "type" or "ref" is required'));let w=cn(l.type);const C=cn(l.ref);if(l.id){const A=cn(l.id);for(let N=0;N<a.arrayIndex;N++){const j=g.layers[N];cn(j.id)===A&&r.push(new _t(h,l.id,`duplicate layer id "${l.id}", previously used at line ${j.id.__line__}`))}}if("ref"in l){let A;["type","source","source-layer","filter","layout"].forEach(N=>{N in l&&r.push(new _t(h,l[N],`"${N}" is prohibited for ref layers`))}),g.layers.forEach(N=>{cn(N.id)===C&&(A=N)}),A?A.ref?r.push(new _t(h,l.ref,"ref cannot reference another ref layer")):w=cn(A.type):r.push(new _t(h,l.ref,`ref layer "${C}" not found`))}else if(w!=="background")if(l.source){const A=g.sources&&g.sources[l.source],N=A&&cn(A.type);A?N==="vector"&&w==="raster"?r.push(new _t(h,l.source,`layer "${l.id}" requires a raster source`)):N==="raster"&&w!=="raster"?r.push(new _t(h,l.source,`layer "${l.id}" requires a vector source`)):N!=="vector"||l["source-layer"]?N==="raster-dem"&&w!=="hillshade"?r.push(new _t(h,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!l.paint||!l.paint["line-gradient"]||N==="geojson"&&A.lineMetrics||r.push(new _t(h,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new _t(h,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new _t(h,l.source,`source "${l.source}" not found`))}else r.push(new _t(h,l,'missing required property "source"'));return r=r.concat(wo({key:h,value:l,valueSpec:x.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>qi({key:`${h}.type`,value:l.type,valueSpec:x.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:Ql,layout:A=>wo({layer:l,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":N=>Yf(Dr({layerType:w},N))}}),paint:A=>wo({layer:l,key:A.key,value:A.value,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":N=>Xf(Dr({layerType:w},N))}})}})),r}function el(a){const r=a.value,l=a.key,h=Pn(r);return h!=="string"?[new _t(l,r,`string expected, ${h} found`)]:[]}const Qf={promoteId:function({key:a,value:r}){if(Pn(r)==="string")return el({key:a,value:r});{const l=[];for(const h in r)l.push(...el({key:`${a}.${h}`,value:r[h]}));return l}}};function tc(a){const r=a.value,l=a.key,h=a.styleSpec,g=a.style;if(!r.type)return[new _t(l,r,'"type" is required')];const x=cn(r.type);let w;switch(x){case"vector":case"raster":case"raster-dem":return w=wo({key:l,value:r,valueSpec:h[`source_${x.replace("-","_")}`],style:a.style,styleSpec:h,objectElementValidators:Qf}),w;case"geojson":if(w=wo({key:l,value:r,valueSpec:h.source_geojson,style:g,styleSpec:h,objectElementValidators:Qf}),r.cluster)for(const C in r.clusterProperties){const[A,N]=r.clusterProperties[C],j=typeof A=="string"?[A,["accumulated"],["get",C]]:A;w.push(...os({key:`${l}.${C}.map`,value:N,expressionContext:"cluster-map"})),w.push(...os({key:`${l}.${C}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return w;case"video":return wo({key:l,value:r,valueSpec:h.source_video,style:g,styleSpec:h});case"image":return wo({key:l,value:r,valueSpec:h.source_image,style:g,styleSpec:h});case"canvas":return[new _t(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xl({key:`${l}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,styleSpec:h})}}function nc(a){const r=a.value,l=a.styleSpec,h=l.light,g=a.style;let x=[];const w=Pn(r);if(r===void 0)return x;if(w!=="object")return x=x.concat([new _t("light",r,`object expected, ${w} found`)]),x;for(const C in r){const A=C.match(/^(.*)-transition$/);x=x.concat(A&&h[A[1]]&&h[A[1]].transition?qi({key:C,value:r[C],valueSpec:l.transition,style:g,styleSpec:l}):h[C]?qi({key:C,value:r[C],valueSpec:h[C],style:g,styleSpec:l}):[new _t(C,r[C],`unknown property "${C}"`)])}return x}function Gi(a){const r=a.value,l=a.styleSpec,h=l.terrain,g=a.style;let x=[];const w=Pn(r);if(r===void 0)return x;if(w!=="object")return x=x.concat([new _t("terrain",r,`object expected, ${w} found`)]),x;for(const C in r)x=x.concat(h[C]?qi({key:C,value:r[C],valueSpec:h[C],style:g,styleSpec:l}):[new _t(C,r[C],`unknown property "${C}"`)]);return x}const rc={"*":()=>[],array:qf,boolean:function(a){const r=a.value,l=a.key,h=Pn(r);return h!=="boolean"?[new _t(l,r,`boolean expected, ${h} found`)]:[]},number:Rd,color:function(a){const r=a.key,l=a.value,h=Pn(l);return h!=="string"?[new _t(r,l,`color expected, ${h} found`)]:ji(l)===null?[new _t(r,l,`color expected, "${l}" found`)]:[]},constants:Kn,enum:Xl,filter:Ql,function:Wf,layer:Jf,object:wo,source:tc,light:nc,terrain:Gi,string:el,formatted:function(a){return el(a).length===0?[]:os(a)},resolvedImage:function(a){return el(a).length===0?[]:os(a)},padding:function(a){const r=a.key,l=a.value;if(Pn(l)==="array"){if(l.length<1||l.length>4)return[new _t(r,l,`padding requires 1 to 4 values; ${l.length} values found`)];const h={type:"number"};let g=[];for(let x=0;x<l.length;x++)g=g.concat(qi({key:`${r}[${x}]`,value:l[x],valueSpec:h}));return g}return Rd({key:r,value:l,valueSpec:{}})}};function qi(a){const r=a.value,l=a.valueSpec,h=a.styleSpec;return l.expression&&Hn(cn(r))?Wf(a):l.expression&&Hl(Rr(r))?os(a):l.type&&rc[l.type]?rc[l.type](a):wo(Dr({},a,{valueSpec:l.type?h[l.type]:l}))}function fg(a){const r=a.value,l=a.key,h=el(a);return h.length||(r.indexOf("{fontstack}")===-1&&h.push(new _t(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&h.push(new _t(l,r,'"glyphs" url must include a "{range}" token'))),h}function Aa(a,r=Ye){let l=[];return l=l.concat(qi({key:"",value:a,valueSpec:r.$root,styleSpec:r,style:a,objectElementValidators:{glyphs:fg,"*":()=>[]}})),a.constants&&(l=l.concat(Kn({key:"constants",value:a.constants,style:a,styleSpec:r}))),ep(l)}function ep(a){return[].concat(a).sort((r,l)=>r.line-l.line)}function ia(a){return function(...r){return ep(a.apply(this,r))}}Aa.source=ia(tc),Aa.light=ia(nc),Aa.terrain=ia(Gi),Aa.layer=ia(Jf),Aa.filter=ia(Ql),Aa.paintProperty=ia(Xf),Aa.layoutProperty=ia(Yf);const ic=Aa,Nd=ic.light,pg=ic.paintProperty,mg=ic.layoutProperty;function su(a,r){let l=!1;if(r&&r.length)for(const h of r)a.fire(new Jr(new Error(h.message))),l=!0;return l}class oc{constructor(r,l,h){const g=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const w=new Int32Array(this.arrayBuffer);r=w[0],this.d=(l=w[1])+2*(h=w[2]);for(let A=0;A<this.d*this.d;A++){const N=w[3+A],j=w[3+A+1];g.push(N===j?null:w.subarray(N,j))}const C=w[3+g.length+1];this.keys=w.subarray(w[3+g.length],C),this.bboxes=w.subarray(C),this.insert=this._insertReadonly}else{this.d=l+2*h;for(let w=0;w<this.d*this.d;w++)g.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=r,this.padding=h,this.scale=l/r,this.uid=0;const x=h/l*r;this.min=-x,this.max=r+x}insert(r,l,h,g,x){this._forEachCell(l,h,g,x,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(x)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,l,h,g,x,w){this.cells[x].push(w)}query(r,l,h,g,x){const w=this.min,C=this.max;if(r<=w&&l<=w&&C<=h&&C<=g&&!x)return Array.prototype.slice.call(this.keys);{const A=[];return this._forEachCell(r,l,h,g,this._queryCell,A,{},x),A}}_queryCell(r,l,h,g,x,w,C,A){const N=this.cells[x];if(N!==null){const j=this.keys,H=this.bboxes;for(let Q=0;Q<N.length;Q++){const te=N[Q];if(C[te]===void 0){const ne=4*te;(A?A(H[ne+0],H[ne+1],H[ne+2],H[ne+3]):r<=H[ne+2]&&l<=H[ne+3]&&h>=H[ne+0]&&g>=H[ne+1])?(C[te]=!0,w.push(j[te])):C[te]=!1}}}}_forEachCell(r,l,h,g,x,w,C,A){const N=this._convertToCellCoord(r),j=this._convertToCellCoord(l),H=this._convertToCellCoord(h),Q=this._convertToCellCoord(g);for(let te=N;te<=H;te++)for(let ne=j;ne<=Q;ne++){const _e=this.d*ne+te;if((!A||A(this._convertFromCellCoord(te),this._convertFromCellCoord(ne),this._convertFromCellCoord(te+1),this._convertFromCellCoord(ne+1)))&&x.call(this,r,l,h,g,_e,w,C,A))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,l=3+this.cells.length+1+1;let h=0;for(let w=0;w<this.cells.length;w++)h+=this.cells[w].length;const g=new Int32Array(l+h+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let x=l;for(let w=0;w<r.length;w++){const C=r[w];g[3+w]=x,g.set(C,x),x+=C.length}return g[3+r.length]=x,g.set(this.keys,x),x+=this.keys.length,g[3+r.length+1]=x,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer}static serialize(r,l){const h=r.toArrayBuffer();return l&&l.push(h),{buffer:h}}static deserialize(r){return new oc(r.buffer)}}const oa={};function $t(a,r,l={}){if(oa[a])throw new Error(`${a} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:a,writeable:!1}),oa[a]={klass:r,omit:l.omit||[],shallow:l.shallow||[]}}$t("Object",Object),$t("TransferableGridIndex",oc),$t("Color",oe),$t("Error",Error),$t("AJAXError",lt),$t("ResolvedImage",Ce),$t("StylePropertyFunction",ru),$t("StyleExpression",nu,{omit:["_evaluator"]}),$t("ZoomDependentExpression",Dd),$t("ZoomConstantExpression",Kl),$t("CompoundExpression",bn,{omit:["_evaluate"]});for(const a in Ks)Ks[a]._classRegistryKey||$t(`Expression_${a}`,Ks[a]);function tp(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function as(a,r){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob)return a;if(tp(a)||Ee(a))return r&&r.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return r&&r.push(l.buffer),l}if(a instanceof ImageData)return r&&r.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const h of a)l.push(as(h,r));return l}if(typeof a=="object"){const l=a.constructor,h=l._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!oa[h])throw new Error(`${h} is not registered.`);const g=l.serialize?l.serialize(a,r):{};if(l.serialize){if(r&&g===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const x in a){if(!a.hasOwnProperty(x)||oa[h].omit.indexOf(x)>=0)continue;const w=a[x];g[x]=oa[h].shallow.indexOf(x)>=0?w:as(w,r)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(g.$name=h),g}throw new Error("can't serialize object of type "+typeof a)}function Ia(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||tp(a)||Ee(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Ia);if(typeof a=="object"){const r=a.$name||"Object";if(!oa[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:l}=oa[r];if(!l)throw new Error(`can't deserialize unregistered class ${r}`);if(l.deserialize)return l.deserialize(a);const h=Object.create(l.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const x=a[g];h[g]=oa[r].shallow.indexOf(g)>=0?x:Ia(x)}return h}throw new Error("can't deserialize object of type "+typeof a)}class Od{constructor(){this.first=!0}update(r,l){const h=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=l),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=h,!0))}}const At={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function lu(a){for(const r of a)if(zd(r.charCodeAt(0)))return!0;return!1}function gg(a){for(const r of a)if(!$d(r.charCodeAt(0)))return!1;return!0}function $d(a){return!(At.Arabic(a)||At["Arabic Supplement"](a)||At["Arabic Extended-A"](a)||At["Arabic Presentation Forms-A"](a)||At["Arabic Presentation Forms-B"](a))}function zd(a){return!(a!==746&&a!==747&&(a<4352||!(At["Bopomofo Extended"](a)||At.Bopomofo(a)||At["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||At["CJK Compatibility Ideographs"](a)||At["CJK Compatibility"](a)||At["CJK Radicals Supplement"](a)||At["CJK Strokes"](a)||!(!At["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||At["CJK Unified Ideographs Extension A"](a)||At["CJK Unified Ideographs"](a)||At["Enclosed CJK Letters and Months"](a)||At["Hangul Compatibility Jamo"](a)||At["Hangul Jamo Extended-A"](a)||At["Hangul Jamo Extended-B"](a)||At["Hangul Jamo"](a)||At["Hangul Syllables"](a)||At.Hiragana(a)||At["Ideographic Description Characters"](a)||At.Kanbun(a)||At["Kangxi Radicals"](a)||At["Katakana Phonetic Extensions"](a)||At.Katakana(a)&&a!==12540||!(!At["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!At["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||At["Unified Canadian Aboriginal Syllabics"](a)||At["Unified Canadian Aboriginal Syllabics Extended"](a)||At["Vertical Forms"](a)||At["Yijing Hexagram Symbols"](a)||At["Yi Syllables"](a)||At["Yi Radicals"](a))))}function np(a){return!(zd(a)||function(r){return!!(At["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||At["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||At["Letterlike Symbols"](r)||At["Number Forms"](r)||At["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||At["Control Pictures"](r)&&r!==9251||At["Optical Character Recognition"](r)||At["Enclosed Alphanumerics"](r)||At["Geometric Shapes"](r)||At["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||At["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||At["CJK Symbols and Punctuation"](r)||At.Katakana(r)||At["Private Use Area"](r)||At["CJK Compatibility Forms"](r)||At["Small Form Variants"](r)||At["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(a))}function rp(a){return a>=1424&&a<=2303||At["Arabic Presentation Forms-A"](a)||At["Arabic Presentation Forms-B"](a)}function yg(a,r){return!(!r&&rp(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||At.Khmer(a))}function ip(a){for(const r of a)if(rp(r.charCodeAt(0)))return!0;return!1}const Bd="deferred",Fd="loading",Ud="loaded";let Vd=null,Di="unavailable",Ma=null;const op=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(Di="error"),Vd&&Vd(a)};function tl(){jd.fire(new Qn("pluginStateChange",{pluginStatus:Di,pluginURL:Ma}))}const jd=new xr,ac=function(){return Di},ap=function(){if(Di!==Bd||!Ma)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Di=Fd,tl(),Ma&&Ke({url:Ma},a=>{a?op(a):(Di=Ud,tl())})},oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Di===Ud||oo.applyArabicShaping!=null,isLoading:()=>Di===Fd,setState(a){if(!W())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Di=a.pluginStatus,Ma=a.pluginURL},isParsed(){if(!W())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return oo.applyArabicShaping!=null&&oo.processBidirectionalText!=null&&oo.processStyledBidirectionalText!=null},getPluginURL(){if(!W())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Ma}};class nr{constructor(r,l){this.zoom=r,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Od,this.transition={})}isSupportedScript(r){return function(l,h){for(const g of l)if(!yg(g.charCodeAt(0),h))return!1;return!0}(r,oo.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,l=r-Math.floor(r),h=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*l}}}class sc{constructor(r,l){this.property=r,this.value=l,this.expression=function(h,g){if(Hn(h))return new ru(h,g);if(Hl(h)){const x=Gf(h,g);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));return x.value}{let x=h;return g.type==="color"&&typeof h=="string"?x=oe.parse(h):g.type!=="padding"||typeof h!="number"&&!Array.isArray(h)||(x=ye.parse(h)),{kind:"constant",evaluate:()=>x}}}(l===void 0?r.specification.default:l,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,l,h){return this.property.possiblyEvaluate(this,r,l,h)}}class cu{constructor(r){this.property=r,this.value=new sc(r,void 0)}transitioned(r,l){return new lp(this.property,this.value,l,O({},r.transition,this.transition),r.now)}untransitioned(){return new lp(this.property,this.value,null,{},0)}}class sp{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return F(this._values[r].value.value)}setValue(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new cu(this._values[r].property)),this._values[r].value=new sc(this._values[r].property,l===null?void 0:F(l))}getTransition(r){return F(this._values[r].transition)}setTransition(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new cu(this._values[r].property)),this._values[r].transition=F(l)||void 0}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h);const g=this.getTransition(l);g!==void 0&&(r[`${l}-transition`]=g)}return r}transitioned(r,l){const h=new cp(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].transitioned(r,l._values[g]);return h}untransitioned(){const r=new cp(this._properties);for(const l of Object.keys(this._values))r._values[l]=this._values[l].untransitioned();return r}}class lp{constructor(r,l,h,g,x){this.property=r,this.value=l,this.begin=x+g.delay||0,this.end=this.begin+g.duration||0,r.specification.transition&&(g.delay||g.duration)&&(this.prior=h)}possiblyEvaluate(r,l,h){const g=r.now||0,x=this.value.possiblyEvaluate(r,l,h),w=this.prior;if(w){if(g>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(g<this.begin)return w.possiblyEvaluate(r,l,h);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(r,l,h),x,function(A){if(A<=0)return 0;if(A>=1)return 1;const N=A*A,j=N*A;return 4*(A<.5?j:3*(A-N)+j-.75)}(C))}}return x}}class cp{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,l,h){const g=new lc(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(r,l,h);return g}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class vg{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return F(this._values[r].value)}setValue(r,l){this._values[r]=new sc(this._values[r].property,l===null?void 0:F(l))}serialize(){const r={};for(const l of Object.keys(this._values)){const h=this.getValue(l);h!==void 0&&(r[l]=h)}return r}possiblyEvaluate(r,l,h){const g=new lc(this._properties);for(const x of Object.keys(this._values))g._values[x]=this._values[x].possiblyEvaluate(r,l,h);return g}}class zo{constructor(r,l,h){this.property=r,this.value=l,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,l,h,g){return this.property.evaluate(this.value,this.parameters,r,l,h,g)}}class lc{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class jt{constructor(r){this.specification=r}possiblyEvaluate(r,l){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(l)}interpolate(r,l,h){const g=es[this.specification.type];return g?g(r,l,h):r}}class Yt{constructor(r,l){this.specification=r,this.overrides=l}possiblyEvaluate(r,l,h,g){return new zo(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(l,null,{},h,g)}:r.expression,l)}interpolate(r,l,h){if(r.value.kind!=="constant"||l.value.kind!=="constant")return r;if(r.value.value===void 0||l.value.value===void 0)return new zo(this,{kind:"constant",value:void 0},r.parameters);const g=es[this.specification.type];return g?new zo(this,{kind:"constant",value:g(r.value.value,l.value.value,h)},r.parameters):r}evaluate(r,l,h,g,x,w){return r.kind==="constant"?r.value:r.evaluate(l,h,g,x,w)}}class nl extends Yt{possiblyEvaluate(r,l,h,g){if(r.value===void 0)return new zo(this,{kind:"constant",value:void 0},l);if(r.expression.kind==="constant"){const x=r.expression.evaluate(l,null,{},h,g),w=r.property.specification.type==="resolvedImage"&&typeof x!="string"?x.name:x,C=this._calculate(w,w,w,l);return new zo(this,{kind:"constant",value:C},l)}if(r.expression.kind==="camera"){const x=this._calculate(r.expression.evaluate({zoom:l.zoom-1}),r.expression.evaluate({zoom:l.zoom}),r.expression.evaluate({zoom:l.zoom+1}),l);return new zo(this,{kind:"constant",value:x},l)}return new zo(this,r.expression,l)}evaluate(r,l,h,g,x,w){if(r.kind==="source"){const C=r.evaluate(l,h,g,x,w);return this._calculate(C,C,C,l)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(l.zoom)-1},h,g),r.evaluate({zoom:Math.floor(l.zoom)},h,g),r.evaluate({zoom:Math.floor(l.zoom)+1},h,g),l):r.value}_calculate(r,l,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:h,to:l}}interpolate(r){return r}}class Gd{constructor(r){this.specification=r}possiblyEvaluate(r,l,h,g){if(r.value!==void 0){if(r.expression.kind==="constant"){const x=r.expression.evaluate(l,null,{},h,g);return this._calculate(x,x,x,l)}return this._calculate(r.expression.evaluate(new nr(Math.floor(l.zoom-1),l)),r.expression.evaluate(new nr(Math.floor(l.zoom),l)),r.expression.evaluate(new nr(Math.floor(l.zoom+1),l)),l)}}_calculate(r,l,h,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:h,to:l}}interpolate(r){return r}}class Da{constructor(r){this.specification=r}possiblyEvaluate(r,l,h,g){return!!r.expression.evaluate(l,null,{},h,g)}interpolate(){return!1}}class ei{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in r){const h=r[l];h.specification.overridable&&this.overridableProperties.push(l);const g=this.defaultPropertyValues[l]=new sc(h,void 0),x=this.defaultTransitionablePropertyValues[l]=new cu(h);this.defaultTransitioningPropertyValues[l]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=g.possiblyEvaluate({})}}}$t("DataDrivenProperty",Yt),$t("DataConstantProperty",jt),$t("CrossFadedDataDrivenProperty",nl),$t("CrossFadedProperty",Gd),$t("ColorRampProperty",Da);const Ra="-transition";class Bo extends xr{constructor(r,l){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),l.layout&&(this._unevaluatedLayout=new vg(l.layout)),l.paint)){this._transitionablePaint=new sp(l.paint);for(const h in r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(const h in r.layout)this.setLayoutProperty(h,r.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lc(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,l,h={}){l!=null&&this._validate(mg,`layers.${this.id}.layout.${r}`,r,l,h)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,l):this.visibility=l)}getPaintProperty(r){return r.endsWith(Ra)?this._transitionablePaint.getTransition(r.slice(0,-Ra.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,l,h={}){if(l!=null&&this._validate(pg,`layers.${this.id}.paint.${r}`,r,l,h))return!1;if(r.endsWith(Ra))return this._transitionablePaint.setTransition(r.slice(0,-Ra.length),l||void 0),!1;{const g=this._transitionablePaint._values[r],x=g.property.specification["property-type"]==="cross-faded-data-driven",w=g.value.isDataDriven(),C=g.value;this._transitionablePaint.setValue(r,l),this._handleSpecialPaintPropertyUpdate(r);const A=this._transitionablePaint._values[r].value;return A.isDataDriven()||w||x||this._handleOverridablePaintPropertyUpdate(r,C,A)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,l,h){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,l){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),L(r,(l,h)=>!(l===void 0||h==="layout"&&!Object.keys(l).length||h==="paint"&&!Object.keys(l).length))}_validate(r,l,h,g,x={}){return(!x||x.validate!==!1)&&su(this,r.call(ic,{key:l,layerType:this.type,objectKey:h,value:g,styleSpec:Ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const l=this.paint.get(r);if(l instanceof zo&&Yn(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const up={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class La{constructor(r,l){this._structArray=r,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class mr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,l){return r._trim(),l&&(r.isTransferred=!0,l.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const l=Object.create(this.prototype);return l.arrayBuffer=r.arrayBuffer,l.length=r.length,l.capacity=r.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Pr(a,r=1){let l=0,h=0;return{members:a.map(g=>{const x=up[g.type].BYTES_PER_ELEMENT,w=l=qd(l,Math.max(r,x)),C=g.components||1;return h=Math.max(h,x),l+=x*C,{name:g.name,type:g.type,components:C,offset:w}}),size:qd(l,Math.max(h,r)),alignment:r}}function qd(a,r){return Math.ceil(a/r)*r}class ss extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const g=2*r;return this.int16[g+0]=l,this.int16[g+1]=h,r}}ss.prototype.bytesPerElement=4,$t("StructArrayLayout2i4",ss);class m extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,r,l,h,g)}emplace(r,l,h,g,x){const w=4*r;return this.int16[w+0]=l,this.int16[w+1]=h,this.int16[w+2]=g,this.int16[w+3]=x,r}}m.prototype.bytesPerElement=8,$t("StructArrayLayout4i8",m);class i extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,r,l,h,g,x,w)}emplace(r,l,h,g,x,w,C){const A=6*r;return this.int16[A+0]=l,this.int16[A+1]=h,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=w,this.int16[A+5]=C,r}}i.prototype.bytesPerElement=12,$t("StructArrayLayout2i4i12",i);class u extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,r,l,h,g,x,w)}emplace(r,l,h,g,x,w,C){const A=4*r,N=8*r;return this.int16[A+0]=l,this.int16[A+1]=h,this.uint8[N+4]=g,this.uint8[N+5]=x,this.uint8[N+6]=w,this.uint8[N+7]=C,r}}u.prototype.bytesPerElement=8,$t("StructArrayLayout2i4ub8",u);class f extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const g=2*r;return this.float32[g+0]=l,this.float32[g+1]=h,r}}f.prototype.bytesPerElement=8,$t("StructArrayLayout2f8",f);class y extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w,C,A,N,j){const H=this.length;return this.resize(H+1),this.emplace(H,r,l,h,g,x,w,C,A,N,j)}emplace(r,l,h,g,x,w,C,A,N,j,H){const Q=10*r;return this.uint16[Q+0]=l,this.uint16[Q+1]=h,this.uint16[Q+2]=g,this.uint16[Q+3]=x,this.uint16[Q+4]=w,this.uint16[Q+5]=C,this.uint16[Q+6]=A,this.uint16[Q+7]=N,this.uint16[Q+8]=j,this.uint16[Q+9]=H,r}}y.prototype.bytesPerElement=20,$t("StructArrayLayout10ui20",y);class b extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w,C,A,N,j,H,Q){const te=this.length;return this.resize(te+1),this.emplace(te,r,l,h,g,x,w,C,A,N,j,H,Q)}emplace(r,l,h,g,x,w,C,A,N,j,H,Q,te){const ne=12*r;return this.int16[ne+0]=l,this.int16[ne+1]=h,this.int16[ne+2]=g,this.int16[ne+3]=x,this.uint16[ne+4]=w,this.uint16[ne+5]=C,this.uint16[ne+6]=A,this.uint16[ne+7]=N,this.int16[ne+8]=j,this.int16[ne+9]=H,this.int16[ne+10]=Q,this.int16[ne+11]=te,r}}b.prototype.bytesPerElement=24,$t("StructArrayLayout4i4ui4i24",b);class k extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,l,h)}emplace(r,l,h,g){const x=3*r;return this.float32[x+0]=l,this.float32[x+1]=h,this.float32[x+2]=g,r}}k.prototype.bytesPerElement=12,$t("StructArrayLayout3f12",k);class I extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint32[1*r+0]=l,r}}I.prototype.bytesPerElement=4,$t("StructArrayLayout1ul4",I);class R extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w,C,A,N){const j=this.length;return this.resize(j+1),this.emplace(j,r,l,h,g,x,w,C,A,N)}emplace(r,l,h,g,x,w,C,A,N,j){const H=10*r,Q=5*r;return this.int16[H+0]=l,this.int16[H+1]=h,this.int16[H+2]=g,this.int16[H+3]=x,this.int16[H+4]=w,this.int16[H+5]=C,this.uint32[Q+3]=A,this.uint16[H+8]=N,this.uint16[H+9]=j,r}}R.prototype.bytesPerElement=20,$t("StructArrayLayout6i1ul2ui20",R);class z extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w){const C=this.length;return this.resize(C+1),this.emplace(C,r,l,h,g,x,w)}emplace(r,l,h,g,x,w,C){const A=6*r;return this.int16[A+0]=l,this.int16[A+1]=h,this.int16[A+2]=g,this.int16[A+3]=x,this.int16[A+4]=w,this.int16[A+5]=C,r}}z.prototype.bytesPerElement=12,$t("StructArrayLayout2i2i2i12",z);class q extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x){const w=this.length;return this.resize(w+1),this.emplace(w,r,l,h,g,x)}emplace(r,l,h,g,x,w){const C=4*r,A=8*r;return this.float32[C+0]=l,this.float32[C+1]=h,this.float32[C+2]=g,this.int16[A+6]=x,this.int16[A+7]=w,r}}q.prototype.bytesPerElement=16,$t("StructArrayLayout2f1f2i16",q);class Y extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,r,l,h,g)}emplace(r,l,h,g,x){const w=12*r,C=3*r;return this.uint8[w+0]=l,this.uint8[w+1]=h,this.float32[C+1]=g,this.float32[C+2]=x,r}}Y.prototype.bytesPerElement=12,$t("StructArrayLayout2ub2f12",Y);class ee extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,l,h)}emplace(r,l,h,g){const x=3*r;return this.uint16[x+0]=l,this.uint16[x+1]=h,this.uint16[x+2]=g,r}}ee.prototype.bytesPerElement=6,$t("StructArrayLayout3ui6",ee);class fe extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e){const qe=this.length;return this.resize(qe+1),this.emplace(qe,r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e)}emplace(r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e,qe){const Le=24*r,Ve=12*r,st=48*r;return this.int16[Le+0]=l,this.int16[Le+1]=h,this.uint16[Le+2]=g,this.uint16[Le+3]=x,this.uint32[Ve+2]=w,this.uint32[Ve+3]=C,this.uint32[Ve+4]=A,this.uint16[Le+10]=N,this.uint16[Le+11]=j,this.uint16[Le+12]=H,this.float32[Ve+7]=Q,this.float32[Ve+8]=te,this.uint8[st+36]=ne,this.uint8[st+37]=_e,this.uint8[st+38]=me,this.uint32[Ve+10]=$e,this.int16[Le+22]=qe,r}}fe.prototype.bytesPerElement=48,$t("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",fe);class se extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e,qe,Le,Ve,st,ot,Nt,Vt,It,St,wt,Mt){const kt=this.length;return this.resize(kt+1),this.emplace(kt,r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e,qe,Le,Ve,st,ot,Nt,Vt,It,St,wt,Mt)}emplace(r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e,me,$e,qe,Le,Ve,st,ot,Nt,Vt,It,St,wt,Mt,kt){const yt=34*r,Zt=17*r;return this.int16[yt+0]=l,this.int16[yt+1]=h,this.int16[yt+2]=g,this.int16[yt+3]=x,this.int16[yt+4]=w,this.int16[yt+5]=C,this.int16[yt+6]=A,this.int16[yt+7]=N,this.uint16[yt+8]=j,this.uint16[yt+9]=H,this.uint16[yt+10]=Q,this.uint16[yt+11]=te,this.uint16[yt+12]=ne,this.uint16[yt+13]=_e,this.uint16[yt+14]=me,this.uint16[yt+15]=$e,this.uint16[yt+16]=qe,this.uint16[yt+17]=Le,this.uint16[yt+18]=Ve,this.uint16[yt+19]=st,this.uint16[yt+20]=ot,this.uint16[yt+21]=Nt,this.uint16[yt+22]=Vt,this.uint32[Zt+12]=It,this.float32[Zt+13]=St,this.float32[Zt+14]=wt,this.float32[Zt+15]=Mt,this.float32[Zt+16]=kt,r}}se.prototype.bytesPerElement=68,$t("StructArrayLayout8i15ui1ul4f68",se);class ce extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.float32[1*r+0]=l,r}}ce.prototype.bytesPerElement=4,$t("StructArrayLayout1f4",ce);class Te extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,l,h)}emplace(r,l,h,g){const x=3*r;return this.int16[x+0]=l,this.int16[x+1]=h,this.int16[x+2]=g,r}}Te.prototype.bytesPerElement=6,$t("StructArrayLayout3i6",Te);class Re extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,l,h)}emplace(r,l,h,g){const x=4*r;return this.uint32[2*r+0]=l,this.uint16[x+2]=h,this.uint16[x+3]=g,r}}Re.prototype.bytesPerElement=8,$t("StructArrayLayout1ul2ui8",Re);class Be extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l){const h=this.length;return this.resize(h+1),this.emplace(h,r,l)}emplace(r,l,h){const g=2*r;return this.uint16[g+0]=l,this.uint16[g+1]=h,r}}Be.prototype.bytesPerElement=4,$t("StructArrayLayout2ui4",Be);class pe extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint16[1*r+0]=l,r}}pe.prototype.bytesPerElement=2,$t("StructArrayLayout1ui2",pe);class Ge extends mr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,h,g){const x=this.length;return this.resize(x+1),this.emplace(x,r,l,h,g)}emplace(r,l,h,g,x){const w=4*r;return this.float32[w+0]=l,this.float32[w+1]=h,this.float32[w+2]=g,this.float32[w+3]=x,r}}Ge.prototype.bytesPerElement=16,$t("StructArrayLayout4f16",Ge);class Ue extends La{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ze(this.anchorPointX,this.anchorPointY)}}Ue.prototype.size=20;class et extends R{get(r){return new Ue(this,r)}}$t("CollisionBoxArray",et);class nt extends La{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}nt.prototype.size=48;class gt extends fe{get(r){return new nt(this,r)}}$t("PlacedSymbolArray",gt);class Je extends La{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Je.prototype.size=68;class Dt extends se{get(r){return new Je(this,r)}}$t("SymbolInstanceArray",Dt);class Tt extends ce{getoffsetX(r){return this.float32[1*r+0]}}$t("GlyphOffsetArray",Tt);class Lt extends Te{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}$t("SymbolLineVertexArray",Lt);class rn extends La{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}rn.prototype.size=8;class un extends Re{get(r){return new rn(this,r)}}$t("FeatureIndexArray",un);class Ht extends ss{}class Dn extends ss{}class Rn extends ss{}class wn extends i{}class Sn extends u{}class On extends f{}class Gr extends y{}class Fo extends b{}class Eo extends k{}class Uo extends I{}class Na extends z{}class ao extends Y{}class Ri extends ee{}class aa extends Be{}const uu=Pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Or}=uu;class fn{constructor(r=[]){this.segments=r}prepareSegment(r,l,h,g){let x=this.segments[this.segments.length-1];return r>fn.MAX_VERTEX_ARRAY_LENGTH&&V(`Max vertices per segment is ${fn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!x||x.vertexLength+r>fn.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==g)&&(x={vertexOffset:l.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},g!==void 0&&(x.sortKey=g),this.segments.push(x)),x}get(){return this.segments}destroy(){for(const r of this.segments)for(const l in r.vaos)r.vaos[l].destroy()}static simpleSegment(r,l,h,g){return new fn([{vertexOffset:r,primitiveOffset:l,vertexLength:h,primitiveLength:g,vaos:{},sortKey:0}])}}function An(a,r){return 256*(a=S(Math.floor(a),0,255))+S(Math.floor(r),0,255)}fn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,$t("SegmentVector",fn);const qr=Pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Wr={exports:{}},rr={exports:{}};rr.exports=function(a,r){var l,h,g,x,w,C,A,N;for(h=a.length-(l=3&a.length),g=r,w=3432918353,C=461845907,N=0;N<h;)A=255&a.charCodeAt(N)|(255&a.charCodeAt(++N))<<8|(255&a.charCodeAt(++N))<<16|(255&a.charCodeAt(++N))<<24,++N,g=27492+(65535&(x=5*(65535&(g=(g^=A=(65535&(A=(A=(65535&A)*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*C+(((A>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(A=0,l){case 3:A^=(255&a.charCodeAt(N+2))<<16;case 2:A^=(255&a.charCodeAt(N+1))<<8;case 1:g^=A=(65535&(A=(A=(65535&(A^=255&a.charCodeAt(N)))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*C+(((A>>>16)*C&65535)<<16)&4294967295}return g^=a.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var so={exports:{}};so.exports=function(a,r){for(var l,h=a.length,g=r^h,x=0;h>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(x)|(255&a.charCodeAt(++x))<<8|(255&a.charCodeAt(++x))<<16|(255&a.charCodeAt(++x))<<24))+((1540483477*(l>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),h-=4,++x;switch(h){case 3:g^=(255&a.charCodeAt(x+2))<<16;case 2:g^=(255&a.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&a.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var ls=rr.exports,Wd=so.exports;Wr.exports=ls,Wr.exports.murmur3=ls,Wr.exports.murmur2=Wd;class rl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,l,h,g){this.ids.push(dp(r)),this.positions.push(l,h,g)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=dp(r);let h=0,g=this.ids.length-1;for(;h<g;){const w=h+g>>1;this.ids[w]>=l?g=w:h=w+1}const x=[];for(;this.ids[h]===l;)x.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return x}static serialize(r,l){const h=new Float64Array(r.ids),g=new Uint32Array(r.positions);return Hd(h,g,0,h.length-1),l&&l.push(h.buffer,g.buffer),{ids:h,positions:g}}static deserialize(r){const l=new rl;return l.ids=r.ids,l.positions=r.positions,l.indexed=!0,l}}function dp(a){const r=+a;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Wr.exports(String(a))}function Hd(a,r,l,h){for(;l<h;){const g=a[l+h>>1];let x=l-1,w=h+1;for(;;){do x++;while(a[x]<g);do w--;while(a[w]>g);if(x>=w)break;Oa(a,x,w),Oa(r,3*x,3*w),Oa(r,3*x+1,3*w+1),Oa(r,3*x+2,3*w+2)}w-l<h-w?(Hd(a,r,l,w),l=w+1):(Hd(a,r,w+1,h),h=w)}}function Oa(a,r,l){const h=a[r];a[r]=a[l],a[l]=h}$t("FeaturePositionMap",rl);class cs{constructor(r,l){this.gl=r.gl,this.location=l}}class us extends cs{constructor(r,l){super(r,l),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class du extends cs{constructor(r,l){super(r,l),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class lb extends cs{constructor(r,l){super(r,l),this.current=oe.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const cI=new Float32Array(16);function _g(a){return[An(255*a.r,255*a.g),An(255*a.b,255*a.a)]}class Zd{constructor(r,l,h){this.value=r,this.uniformNames=l.map(g=>`u_${g}`),this.type=h}setUniform(r,l,h){r.set(h.constantOr(this.value))}getBinding(r,l,h){return this.type==="color"?new lb(r,l):new us(r,l)}}class hu{constructor(r,l){this.uniformNames=l.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=r.tlbr}setUniform(r,l,h,g){const x=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;x&&r.set(x)}getBinding(r,l,h){return h.substr(0,9)==="u_pattern"?new du(r,l):new us(r,l)}}class ds{constructor(r,l,h,g){this.expression=r,this.type=h,this.maxValue=0,this.paintVertexAttributes=l.map(x=>({name:`a_${x}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(r,l,h,g,x){const w=this.paintVertexArray.length,C=this.expression.evaluate(new nr(0),l,{},g,[],x);this.paintVertexArray.resize(r),this._setPaintValue(w,r,C)}updatePaintArray(r,l,h,g){const x=this.expression.evaluate({zoom:0},h,g);this._setPaintValue(r,l,x)}_setPaintValue(r,l,h){if(this.type==="color"){const g=_g(h);for(let x=r;x<l;x++)this.paintVertexArray.emplace(x,g[0],g[1])}else{for(let g=r;g<l;g++)this.paintVertexArray.emplace(g,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class sa{constructor(r,l,h,g,x,w){this.expression=r,this.uniformNames=l.map(C=>`u_${C}_t`),this.type=h,this.useIntegerZoom=g,this.zoom=x,this.maxValue=0,this.paintVertexAttributes=l.map(C=>({name:`a_${C}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(r,l,h,g,x){const w=this.expression.evaluate(new nr(this.zoom),l,{},g,[],x),C=this.expression.evaluate(new nr(this.zoom+1),l,{},g,[],x),A=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(A,r,w,C)}updatePaintArray(r,l,h,g){const x=this.expression.evaluate({zoom:this.zoom},h,g),w=this.expression.evaluate({zoom:this.zoom+1},h,g);this._setPaintValue(r,l,x,w)}_setPaintValue(r,l,h,g){if(this.type==="color"){const x=_g(h),w=_g(g);for(let C=r;C<l;C++)this.paintVertexArray.emplace(C,x[0],x[1],w[0],w[1])}else{for(let x=r;x<l;x++)this.paintVertexArray.emplace(x,h,g);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(g))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,l){const h=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,g=S(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);r.set(g)}getBinding(r,l,h){return new us(r,l)}}class il{constructor(r,l,h,g,x,w){this.expression=r,this.type=l,this.useIntegerZoom=h,this.zoom=g,this.layerId=w,this.zoomInPaintVertexArray=new x,this.zoomOutPaintVertexArray=new x}populatePaintArray(r,l,h){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(g,r,l.patterns&&l.patterns[this.layerId],h)}updatePaintArray(r,l,h,g,x){this._setPaintValues(r,l,h.patterns&&h.patterns[this.layerId],x)}_setPaintValues(r,l,h,g){if(!g||!h)return;const{min:x,mid:w,max:C}=h,A=g[x],N=g[w],j=g[C];if(A&&N&&j)for(let H=r;H<l;H++)this.zoomInPaintVertexArray.emplace(H,N.tl[0],N.tl[1],N.br[0],N.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],N.pixelRatio,A.pixelRatio),this.zoomOutPaintVertexArray.emplace(H,N.tl[0],N.tl[1],N.br[0],N.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],N.pixelRatio,j.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,qr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,qr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class cb{constructor(r,l,h){this.binders={},this._buffers=[];const g=[];for(const x in r.paint._values){if(!h(x))continue;const w=r.paint.get(x);if(!(w instanceof zo&&Yn(w.property.specification)))continue;const C=uI(x,r.type),A=w.value,N=w.property.specification.type,j=w.property.useIntegerZoom,H=w.property.specification["property-type"],Q=H==="cross-faded"||H==="cross-faded-data-driven";if(A.kind==="constant")this.binders[x]=Q?new hu(A.value,C):new Zd(A.value,C,N),g.push(`/u_${x}`);else if(A.kind==="source"||Q){const te=ub(x,N,"source");this.binders[x]=Q?new il(A,N,j,l,te,r.id):new ds(A,C,N,te),g.push(`/a_${x}`)}else{const te=ub(x,N,"composite");this.binders[x]=new sa(A,C,N,j,l,te),g.push(`/z_${x}`)}}this.cacheKey=g.sort().join("")}getMaxValue(r){const l=this.binders[r];return l instanceof ds||l instanceof sa?l.maxValue:0}populatePaintArrays(r,l,h,g,x){for(const w in this.binders){const C=this.binders[w];(C instanceof ds||C instanceof sa||C instanceof il)&&C.populatePaintArray(r,l,h,g,x)}}setConstantPatternPositions(r,l){for(const h in this.binders){const g=this.binders[h];g instanceof hu&&g.setConstantPatternPositions(r,l)}}updatePaintArrays(r,l,h,g,x){let w=!1;for(const C in r){const A=l.getPositions(C);for(const N of A){const j=h.feature(N.index);for(const H in this.binders){const Q=this.binders[H];if((Q instanceof ds||Q instanceof sa||Q instanceof il)&&Q.expression.isStateDependent===!0){const te=g.paint.get(H);Q.expression=te.value,Q.updatePaintArray(N.start,N.end,j,r[C],x),w=!0}}}}return w}defines(){const r=[];for(const l in this.binders){const h=this.binders[l];(h instanceof Zd||h instanceof hu)&&r.push(...h.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return r}getBinderAttributes(){const r=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof ds||h instanceof sa)for(let g=0;g<h.paintVertexAttributes.length;g++)r.push(h.paintVertexAttributes[g].name);else if(h instanceof il)for(let g=0;g<qr.members.length;g++)r.push(qr.members[g].name)}return r}getBinderUniforms(){const r=[];for(const l in this.binders){const h=this.binders[l];if(h instanceof Zd||h instanceof hu||h instanceof sa)for(const g of h.uniformNames)r.push(g)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,l){const h=[];for(const g in this.binders){const x=this.binders[g];if(x instanceof Zd||x instanceof hu||x instanceof sa){for(const w of x.uniformNames)if(l[w]){const C=x.getBinding(r,l[w],w);h.push({name:w,property:g,binding:C})}}}return h}setUniforms(r,l,h,g){for(const{name:x,property:w,binding:C}of l)this.binders[w].setUniform(C,g,h.get(w),x)}updatePaintBuffers(r){this._buffers=[];for(const l in this.binders){const h=this.binders[l];if(r&&h instanceof il){const g=r.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(h instanceof ds||h instanceof sa)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(r){for(const l in this.binders){const h=this.binders[l];(h instanceof ds||h instanceof sa||h instanceof il)&&h.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const l=this.binders[r];(l instanceof ds||l instanceof sa||l instanceof il)&&l.destroy()}}}class cc{constructor(r,l,h=()=>!0){this.programConfigurations={};for(const g of r)this.programConfigurations[g.id]=new cb(g,l,h);this.needsUpload=!1,this._featureMap=new rl,this._bufferOffset=0}populatePaintArrays(r,l,h,g,x,w){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(r,l,g,x,w);l.id!==void 0&&this._featureMap.add(l.id,h,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,l,h,g){for(const x of h)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(r,this._featureMap,l,x,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function uI(a,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${r}-`,"").replace(/-/g,"_")]}function ub(a,r,l){const h={color:{source:f,composite:Ge},number:{source:ce,composite:f}},g=function(x){return{"line-pattern":{source:Gr,composite:Gr},"fill-pattern":{source:Gr,composite:Gr},"fill-extrusion-pattern":{source:Gr,composite:Gr}}[x]}(a);return g&&g[l]||h[r][l]}$t("ConstantBinder",Zd),$t("CrossFadedConstantBinder",hu),$t("SourceExpressionBinder",ds),$t("CrossFadedCompositeBinder",il),$t("CompositeExpressionBinder",sa),$t("ProgramConfiguration",cb,{omit:["_buffers"]}),$t("ProgramConfigurationSet",cc);var $r=8192;const xg=Math.pow(2,14)-1,db=-xg-1;function uc(a){const r=$r/a.extent,l=a.loadGeometry();for(let h=0;h<l.length;h++){const g=l[h];for(let x=0;x<g.length;x++){const w=g[x],C=Math.round(w.x*r),A=Math.round(w.y*r);w.x=S(C,db,xg),w.y=S(A,db,xg),(C<w.x||C>w.x+1||A<w.y||A>w.y+1)&&V("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function dc(a,r){return{type:a.type,id:a.id,properties:a.properties,geometry:r?uc(a):[]}}function hp(a,r,l,h,g){a.emplaceBack(2*r+(h+1)/2,2*l+(g+1)/2)}class bg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Dn,this.indexArray=new Ri,this.segments=new fn,this.programConfigurations=new cc(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){const g=this.layers[0],x=[];let w=null,C=!1;g.type==="circle"&&(w=g.layout.get("circle-sort-key"),C=!w.isConstant());for(const{feature:A,id:N,index:j,sourceLayerIndex:H}of r){const Q=this.layers[0]._featureFilter.needGeometry,te=dc(A,Q);if(!this.layers[0]._featureFilter.filter(new nr(this.zoom),te,h))continue;const ne=C?w.evaluate(te,{},h):void 0,_e={id:N,properties:A.properties,type:A.type,sourceLayerIndex:H,index:j,geometry:Q?te.geometry:uc(A),patterns:{},sortKey:ne};x.push(_e)}C&&x.sort((A,N)=>A.sortKey-N.sortKey);for(const A of x){const{geometry:N,index:j,sourceLayerIndex:H}=A,Q=r[j].feature;this.addFeature(A,N,j,h),l.featureIndex.insert(Q,N,j,H,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Or),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,l,h,g){for(const x of l)for(const w of x){const C=w.x,A=w.y;if(C<0||C>=$r||A<0||A>=$r)continue;const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),j=N.vertexLength;hp(this.layoutVertexArray,C,A,-1,-1),hp(this.layoutVertexArray,C,A,1,-1),hp(this.layoutVertexArray,C,A,1,1),hp(this.layoutVertexArray,C,A,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+3,j+2),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,{},g)}}function hb(a,r){for(let l=0;l<a.length;l++)if(fu(r,a[l]))return!0;for(let l=0;l<r.length;l++)if(fu(a,r[l]))return!0;return!!wg(a,r)}function dI(a,r,l){return!!fu(a,r)||!!Eg(r,a,l)}function fb(a,r){if(a.length===1)return mb(r,a[0]);for(let l=0;l<r.length;l++){const h=r[l];for(let g=0;g<h.length;g++)if(fu(a,h[g]))return!0}for(let l=0;l<a.length;l++)if(mb(r,a[l]))return!0;for(let l=0;l<r.length;l++)if(wg(a,r[l]))return!0;return!1}function hI(a,r,l){if(a.length>1){if(wg(a,r))return!0;for(let h=0;h<r.length;h++)if(Eg(r[h],a,l))return!0}for(let h=0;h<a.length;h++)if(Eg(a[h],r,l))return!0;return!1}function wg(a,r){if(a.length===0||r.length===0)return!1;for(let l=0;l<a.length-1;l++){const h=a[l],g=a[l+1];for(let x=0;x<r.length-1;x++)if(fI(h,g,r[x],r[x+1]))return!0}return!1}function fI(a,r,l,h){return Z(a,l,h)!==Z(r,l,h)&&Z(a,r,l)!==Z(a,r,h)}function Eg(a,r,l){const h=l*l;if(r.length===1)return a.distSqr(r[0])<h;for(let g=1;g<r.length;g++)if(pb(a,r[g-1],r[g])<h)return!0;return!1}function pb(a,r,l){const h=r.distSqr(l);if(h===0)return a.distSqr(r);const g=((a.x-r.x)*(l.x-r.x)+(a.y-r.y)*(l.y-r.y))/h;return a.distSqr(g<0?r:g>1?l:l.sub(r)._mult(g)._add(r))}function mb(a,r){let l,h,g,x=!1;for(let w=0;w<a.length;w++){l=a[w];for(let C=0,A=l.length-1;C<l.length;A=C++)h=l[C],g=l[A],h.y>r.y!=g.y>r.y&&r.x<(g.x-h.x)*(r.y-h.y)/(g.y-h.y)+h.x&&(x=!x)}return x}function fu(a,r){let l=!1;for(let h=0,g=a.length-1;h<a.length;g=h++){const x=a[h],w=a[g];x.y>r.y!=w.y>r.y&&r.x<(w.x-x.x)*(r.y-x.y)/(w.y-x.y)+x.x&&(l=!l)}return l}function pI(a,r,l){const h=l[0],g=l[2];if(a.x<h.x&&r.x<h.x||a.x>g.x&&r.x>g.x||a.y<h.y&&r.y<h.y||a.y>g.y&&r.y>g.y)return!1;const x=Z(a,r,l[0]);return x!==Z(a,r,l[1])||x!==Z(a,r,l[2])||x!==Z(a,r,l[3])}function Kd(a,r,l){const h=r.paint.get(a).value;return h.kind==="constant"?h.value:l.programConfigurations.get(r.id).getMaxValue(a)}function fp(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function pp(a,r,l,h,g){if(!r[0]&&!r[1])return a;const x=ze.convert(r)._mult(g);l==="viewport"&&x._rotate(-h);const w=[];for(let C=0;C<a.length;C++)w.push(a[C].sub(x));return w}$t("CircleBucket",bg,{omit:["layers"]});const mI=new ei({"circle-sort-key":new Yt(Ye.layout_circle["circle-sort-key"])});var gI={paint:new ei({"circle-radius":new Yt(Ye.paint_circle["circle-radius"]),"circle-color":new Yt(Ye.paint_circle["circle-color"]),"circle-blur":new Yt(Ye.paint_circle["circle-blur"]),"circle-opacity":new Yt(Ye.paint_circle["circle-opacity"]),"circle-translate":new jt(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new jt(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new jt(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new jt(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Yt(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Yt(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Yt(Ye.paint_circle["circle-stroke-opacity"])}),layout:mI},Li=1e-6,Ni=typeof Float32Array<"u"?Float32Array:Array;function gb(){var a=new Ni(9);return Ni!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Tg(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function yb(a,r,l){var h=r[0],g=r[1],x=r[2],w=r[3],C=r[4],A=r[5],N=r[6],j=r[7],H=r[8],Q=r[9],te=r[10],ne=r[11],_e=r[12],me=r[13],$e=r[14],qe=r[15],Le=l[0],Ve=l[1],st=l[2],ot=l[3];return a[0]=Le*h+Ve*C+st*H+ot*_e,a[1]=Le*g+Ve*A+st*Q+ot*me,a[2]=Le*x+Ve*N+st*te+ot*$e,a[3]=Le*w+Ve*j+st*ne+ot*qe,a[4]=(Le=l[4])*h+(Ve=l[5])*C+(st=l[6])*H+(ot=l[7])*_e,a[5]=Le*g+Ve*A+st*Q+ot*me,a[6]=Le*x+Ve*N+st*te+ot*$e,a[7]=Le*w+Ve*j+st*ne+ot*qe,a[8]=(Le=l[8])*h+(Ve=l[9])*C+(st=l[10])*H+(ot=l[11])*_e,a[9]=Le*g+Ve*A+st*Q+ot*me,a[10]=Le*x+Ve*N+st*te+ot*$e,a[11]=Le*w+Ve*j+st*ne+ot*qe,a[12]=(Le=l[12])*h+(Ve=l[13])*C+(st=l[14])*H+(ot=l[15])*_e,a[13]=Le*g+Ve*A+st*Q+ot*me,a[14]=Le*x+Ve*N+st*te+ot*$e,a[15]=Le*w+Ve*j+st*ne+ot*qe,a}Math.hypot||(Math.hypot=function(){for(var a=0,r=arguments.length;r--;)a+=arguments[r]*arguments[r];return Math.sqrt(a)});var Xd,yI=yb;function vb(){var a=new Ni(3);return Ni!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function _b(a,r,l){var h=new Ni(3);return h[0]=a,h[1]=r,h[2]=l,h}function mp(a,r,l){var h=r[0],g=r[1],x=r[2],w=r[3];return a[0]=l[0]*h+l[4]*g+l[8]*x+l[12]*w,a[1]=l[1]*h+l[5]*g+l[9]*x+l[13]*w,a[2]=l[2]*h+l[6]*g+l[10]*x+l[14]*w,a[3]=l[3]*h+l[7]*g+l[11]*x+l[15]*w,a}function xb(){var a=new Ni(4);return Ni!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function bb(a,r){const l=mp([],[a.x,a.y,0,1],r);return new ze(l[0]/l[3],l[1]/l[3])}vb(),Xd=new Ni(4),Ni!=Float32Array&&(Xd[0]=0,Xd[1]=0,Xd[2]=0,Xd[3]=0),vb(),_b(1,0,0),_b(0,1,0),xb(),xb(),gb(),function(){var a;a=new Ni(2),Ni!=Float32Array&&(a[0]=0,a[1]=0)}();class wb extends bg{}$t("HeatmapBucket",wb,{omit:["layers"]});var vI={paint:new ei({"heatmap-radius":new Yt(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Yt(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new jt(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Da(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new jt(Ye.paint_heatmap["heatmap-opacity"])})};function Sg(a,{width:r,height:l},h,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==r*l*h)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${r*l*h}`)}else g=new Uint8Array(r*l*h);return a.width=r,a.height=l,a.data=g,a}function Eb(a,{width:r,height:l},h){if(r===a.width&&l===a.height)return;const g=Sg({},{width:r,height:l},h);kg(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,r),height:Math.min(a.height,l)},h),a.width=r,a.height=l,a.data=g.data}function kg(a,r,l,h,g,x){if(g.width===0||g.height===0)return r;if(g.width>a.width||g.height>a.height||l.x>a.width-g.width||l.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>r.width||g.height>r.height||h.x>r.width-g.width||h.y>r.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const w=a.data,C=r.data;if(w===C)throw new Error("srcData equals dstData, so image is already copied");for(let A=0;A<g.height;A++){const N=((l.y+A)*a.width+l.x)*x,j=((h.y+A)*r.width+h.x)*x;for(let H=0;H<g.width*x;H++)C[j+H]=w[N+H]}return r}class Yd{constructor(r,l){Sg(this,r,1,l)}resize(r){Eb(this,r,1)}clone(){return new Yd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,g,x){kg(r,l,h,g,x,1)}}class To{constructor(r,l){Sg(this,r,4,l)}resize(r){Eb(this,r,4)}replace(r,l){l?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new To({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,h,g,x){kg(r,l,h,g,x,4)}}function Tb(a){const r={},l=a.resolution||256,h=a.clips?a.clips.length:1,g=a.image||new To({width:l,height:h});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const x=(w,C,A)=>{r[a.evaluationKey]=A;const N=a.expression.evaluate(r);g.data[w+C+0]=Math.floor(255*N.r/N.a),g.data[w+C+1]=Math.floor(255*N.g/N.a),g.data[w+C+2]=Math.floor(255*N.b/N.a),g.data[w+C+3]=Math.floor(255*N.a)};if(a.clips)for(let w=0,C=0;w<h;++w,C+=4*l)for(let A=0,N=0;A<l;A++,N+=4){const j=A/(l-1),{start:H,end:Q}=a.clips[w];x(C,N,H*(1-j)+Q*j)}else for(let w=0,C=0;w<l;w++,C+=4)x(0,C,w/(l-1));return g}$t("AlphaImage",Yd),$t("RGBAImage",To);var _I={paint:new ei({"hillshade-illumination-direction":new jt(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new jt(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new jt(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new jt(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new jt(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new jt(Ye.paint_hillshade["hillshade-accent-color"])})};const xI=Pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:bI}=xI;var gp={exports:{}};function yp(a,r,l){l=l||2;var h,g,x,w,C,A,N,j=r&&r.length,H=j?r[0]*l:a.length,Q=Sb(a,0,H,l,!0),te=[];if(!Q||Q.next===Q.prev)return te;if(j&&(Q=function(_e,me,$e,qe){var Le,Ve,st,ot=[];for(Le=0,Ve=me.length;Le<Ve;Le++)(st=Sb(_e,me[Le]*qe,Le<Ve-1?me[Le+1]*qe:_e.length,qe,!1))===st.next&&(st.steiner=!0),ot.push(AI(st));for(ot.sort(kI),Le=0;Le<ot.length;Le++)$e=CI(ot[Le],$e);return $e}(a,r,Q,l)),a.length>80*l){h=x=a[0],g=w=a[1];for(var ne=l;ne<H;ne+=l)(C=a[ne])<h&&(h=C),(A=a[ne+1])<g&&(g=A),C>x&&(x=C),A>w&&(w=A);N=(N=Math.max(x-h,w-g))!==0?32767/N:0}return Jd(Q,te,l,h,g,N,0),te}function Sb(a,r,l,h,g){var x,w;if(g===Ag(a,r,l,h)>0)for(x=r;x<l;x+=h)w=Pb(x,a[x],a[x+1],w);else for(x=l-h;x>=r;x-=h)w=Pb(x,a[x],a[x+1],w);return w&&vp(w,w.next)&&(eh(w),w=w.next),w}function hc(a,r){if(!a)return a;r||(r=a);var l,h=a;do if(l=!1,h.steiner||!vp(h,h.next)&&Er(h.prev,h,h.next)!==0)h=h.next;else{if(eh(h),(h=r=h.prev)===h.next)break;l=!0}while(l||h!==r);return r}function Jd(a,r,l,h,g,x,w){if(a){!w&&x&&function(j,H,Q,te){var ne=j;do ne.z===0&&(ne.z=Cg(ne.x,ne.y,H,Q,te)),ne.prevZ=ne.prev,ne.nextZ=ne.next,ne=ne.next;while(ne!==j);ne.prevZ.nextZ=null,ne.prevZ=null,function(_e){var me,$e,qe,Le,Ve,st,ot,Nt,Vt=1;do{for($e=_e,_e=null,Ve=null,st=0;$e;){for(st++,qe=$e,ot=0,me=0;me<Vt&&(ot++,qe=qe.nextZ);me++);for(Nt=Vt;ot>0||Nt>0&&qe;)ot!==0&&(Nt===0||!qe||$e.z<=qe.z)?(Le=$e,$e=$e.nextZ,ot--):(Le=qe,qe=qe.nextZ,Nt--),Ve?Ve.nextZ=Le:_e=Le,Le.prevZ=Ve,Ve=Le;$e=qe}Ve.nextZ=null,Vt*=2}while(st>1)}(ne)}(a,h,g,x);for(var C,A,N=a;a.prev!==a.next;)if(C=a.prev,A=a.next,x?EI(a,h,g,x):wI(a))r.push(C.i/l|0),r.push(a.i/l|0),r.push(A.i/l|0),eh(a),a=A.next,N=A.next;else if((a=A)===N){w?w===1?Jd(a=TI(hc(a),r,l),r,l,h,g,x,2):w===2&&SI(a,r,l,h,g,x):Jd(hc(a),r,l,h,g,x,1);break}}}function wI(a){var r=a.prev,l=a,h=a.next;if(Er(r,l,h)>=0)return!1;for(var g=r.x,x=l.x,w=h.x,C=r.y,A=l.y,N=h.y,j=g<x?g<w?g:w:x<w?x:w,H=C<A?C<N?C:N:A<N?A:N,Q=g>x?g>w?g:w:x>w?x:w,te=C>A?C>N?C:N:A>N?A:N,ne=h.next;ne!==r;){if(ne.x>=j&&ne.x<=Q&&ne.y>=H&&ne.y<=te&&pu(g,C,x,A,w,N,ne.x,ne.y)&&Er(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function EI(a,r,l,h){var g=a.prev,x=a,w=a.next;if(Er(g,x,w)>=0)return!1;for(var C=g.x,A=x.x,N=w.x,j=g.y,H=x.y,Q=w.y,te=C<A?C<N?C:N:A<N?A:N,ne=j<H?j<Q?j:Q:H<Q?H:Q,_e=C>A?C>N?C:N:A>N?A:N,me=j>H?j>Q?j:Q:H>Q?H:Q,$e=Cg(te,ne,r,l,h),qe=Cg(_e,me,r,l,h),Le=a.prevZ,Ve=a.nextZ;Le&&Le.z>=$e&&Ve&&Ve.z<=qe;){if(Le.x>=te&&Le.x<=_e&&Le.y>=ne&&Le.y<=me&&Le!==g&&Le!==w&&pu(C,j,A,H,N,Q,Le.x,Le.y)&&Er(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,Ve.x>=te&&Ve.x<=_e&&Ve.y>=ne&&Ve.y<=me&&Ve!==g&&Ve!==w&&pu(C,j,A,H,N,Q,Ve.x,Ve.y)&&Er(Ve.prev,Ve,Ve.next)>=0))return!1;Ve=Ve.nextZ}for(;Le&&Le.z>=$e;){if(Le.x>=te&&Le.x<=_e&&Le.y>=ne&&Le.y<=me&&Le!==g&&Le!==w&&pu(C,j,A,H,N,Q,Le.x,Le.y)&&Er(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;Ve&&Ve.z<=qe;){if(Ve.x>=te&&Ve.x<=_e&&Ve.y>=ne&&Ve.y<=me&&Ve!==g&&Ve!==w&&pu(C,j,A,H,N,Q,Ve.x,Ve.y)&&Er(Ve.prev,Ve,Ve.next)>=0)return!1;Ve=Ve.nextZ}return!0}function TI(a,r,l){var h=a;do{var g=h.prev,x=h.next.next;!vp(g,x)&&kb(g,h,h.next,x)&&Qd(g,x)&&Qd(x,g)&&(r.push(g.i/l|0),r.push(h.i/l|0),r.push(x.i/l|0),eh(h),eh(h.next),h=a=x),h=h.next}while(h!==a);return hc(h)}function SI(a,r,l,h,g,x){var w=a;do{for(var C=w.next.next;C!==w.prev;){if(w.i!==C.i&&II(w,C)){var A=Cb(w,C);return w=hc(w,w.next),A=hc(A,A.next),Jd(w,r,l,h,g,x,0),void Jd(A,r,l,h,g,x,0)}C=C.next}w=w.next}while(w!==a)}function kI(a,r){return a.x-r.x}function CI(a,r){var l=function(g,x){var w,C=x,A=g.x,N=g.y,j=-1/0;do{if(N<=C.y&&N>=C.next.y&&C.next.y!==C.y){var H=C.x+(N-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(H<=A&&H>j&&(j=H,w=C.x<C.next.x?C:C.next,H===A))return w}C=C.next}while(C!==x);if(!w)return null;var Q,te=w,ne=w.x,_e=w.y,me=1/0;C=w;do A>=C.x&&C.x>=ne&&A!==C.x&&pu(N<_e?A:j,N,ne,_e,N<_e?j:A,N,C.x,C.y)&&(Q=Math.abs(N-C.y)/(A-C.x),Qd(C,g)&&(Q<me||Q===me&&(C.x>w.x||C.x===w.x&&PI(w,C)))&&(w=C,me=Q)),C=C.next;while(C!==te);return w}(a,r);if(!l)return r;var h=Cb(l,a);return hc(h,h.next),hc(l,l.next)}function PI(a,r){return Er(a.prev,a,r.prev)<0&&Er(r.next,a,a.next)<0}function Cg(a,r,l,h,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-h)*g|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function AI(a){var r=a,l=a;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==a);return l}function pu(a,r,l,h,g,x,w,C){return(g-w)*(r-C)>=(a-w)*(x-C)&&(a-w)*(h-C)>=(l-w)*(r-C)&&(l-w)*(x-C)>=(g-w)*(h-C)}function II(a,r){return a.next.i!==r.i&&a.prev.i!==r.i&&!function(l,h){var g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==h.i&&g.next.i!==h.i&&kb(g,g.next,l,h))return!0;g=g.next}while(g!==l);return!1}(a,r)&&(Qd(a,r)&&Qd(r,a)&&function(l,h){var g=l,x=!1,w=(l.x+h.x)/2,C=(l.y+h.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&w<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==l);return x}(a,r)&&(Er(a.prev,a,r.prev)||Er(a,r.prev,r))||vp(a,r)&&Er(a.prev,a,a.next)>0&&Er(r.prev,r,r.next)>0)}function Er(a,r,l){return(r.y-a.y)*(l.x-r.x)-(r.x-a.x)*(l.y-r.y)}function vp(a,r){return a.x===r.x&&a.y===r.y}function kb(a,r,l,h){var g=xp(Er(a,r,l)),x=xp(Er(a,r,h)),w=xp(Er(l,h,a)),C=xp(Er(l,h,r));return g!==x&&w!==C||!(g!==0||!_p(a,l,r))||!(x!==0||!_p(a,h,r))||!(w!==0||!_p(l,a,h))||!(C!==0||!_p(l,r,h))}function _p(a,r,l){return r.x<=Math.max(a.x,l.x)&&r.x>=Math.min(a.x,l.x)&&r.y<=Math.max(a.y,l.y)&&r.y>=Math.min(a.y,l.y)}function xp(a){return a>0?1:a<0?-1:0}function Qd(a,r){return Er(a.prev,a,a.next)<0?Er(a,r,a.next)>=0&&Er(a,a.prev,r)>=0:Er(a,r,a.prev)<0||Er(a,a.next,r)<0}function Cb(a,r){var l=new Pg(a.i,a.x,a.y),h=new Pg(r.i,r.x,r.y),g=a.next,x=r.prev;return a.next=r,r.prev=a,l.next=g,g.prev=l,h.next=l,l.prev=h,x.next=h,h.prev=x,h}function Pb(a,r,l,h){var g=new Pg(a,r,l);return h?(g.next=h.next,g.prev=h,h.next.prev=g,h.next=g):(g.prev=g,g.next=g),g}function eh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Pg(a,r,l){this.i=a,this.x=r,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ag(a,r,l,h){for(var g=0,x=r,w=l-h;x<l;x+=h)g+=(a[w]-a[x])*(a[x+1]+a[w+1]),w=x;return g}function MI(a,r,l,h,g){Ab(a,r,l||0,h||a.length-1,g||DI)}function Ab(a,r,l,h,g){for(;h>l;){if(h-l>600){var x=h-l+1,w=r-l+1,C=Math.log(x),A=.5*Math.exp(2*C/3),N=.5*Math.sqrt(C*A*(x-A)/x)*(w-x/2<0?-1:1);Ab(a,r,Math.max(l,Math.floor(r-w*A/x+N)),Math.min(h,Math.floor(r+(x-w)*A/x+N)),g)}var j=a[r],H=l,Q=h;for(th(a,l,r),g(a[h],j)>0&&th(a,l,h);H<Q;){for(th(a,H,Q),H++,Q--;g(a[H],j)<0;)H++;for(;g(a[Q],j)>0;)Q--}g(a[l],j)===0?th(a,l,Q):th(a,++Q,h),Q<=r&&(l=Q+1),r<=Q&&(h=Q-1)}}function th(a,r,l){var h=a[r];a[r]=a[l],a[l]=h}function DI(a,r){return a<r?-1:a>r?1:0}function Ig(a,r){const l=a.length;if(l<=1)return[a];const h=[];let g,x;for(let w=0;w<l;w++){const C=G(a[w]);C!==0&&(a[w].area=Math.abs(C),x===void 0&&(x=C<0),x===C<0?(g&&h.push(g),g=[a[w]]):g.push(a[w]))}if(g&&h.push(g),r>1)for(let w=0;w<h.length;w++)h[w].length<=r||(MI(h[w],r,1,h[w].length-1,RI),h[w]=h[w].slice(0,r));return h}function RI(a,r){return r.area-a.area}function Mg(a,r,l){const h=l.patternDependencies;let g=!1;for(const x of r){const w=x.paint.get(`${a}-pattern`);w.isConstant()||(g=!0);const C=w.constantOr(null);C&&(g=!0,h[C.to]=!0,h[C.from]=!0)}return g}function Dg(a,r,l,h,g){const x=g.patternDependencies;for(const w of r){const C=w.paint.get(`${a}-pattern`).value;if(C.kind!=="constant"){let A=C.evaluate({zoom:h-1},l,{},g.availableImages),N=C.evaluate({zoom:h},l,{},g.availableImages),j=C.evaluate({zoom:h+1},l,{},g.availableImages);A=A&&A.name?A.name:A,N=N&&N.name?N.name:N,j=j&&j.name?j.name:j,x[A]=!0,x[N]=!0,x[j]=!0,l.patterns[w.id]={min:A,mid:N,max:j}}}return l}gp.exports=yp,gp.exports.default=yp,yp.deviation=function(a,r,l,h){var g=r&&r.length,x=Math.abs(Ag(a,0,g?r[0]*l:a.length,l));if(g)for(var w=0,C=r.length;w<C;w++)x-=Math.abs(Ag(a,r[w]*l,w<C-1?r[w+1]*l:a.length,l));var A=0;for(w=0;w<h.length;w+=3){var N=h[w]*l,j=h[w+1]*l,H=h[w+2]*l;A+=Math.abs((a[N]-a[H])*(a[j+1]-a[N+1])-(a[N]-a[j])*(a[H+1]-a[N+1]))}return x===0&&A===0?0:Math.abs((A-x)/x)},yp.flatten=function(a){for(var r=a[0][0].length,l={vertices:[],holes:[],dimensions:r},h=0,g=0;g<a.length;g++){for(var x=0;x<a[g].length;x++)for(var w=0;w<r;w++)l.vertices.push(a[g][x][w]);g>0&&l.holes.push(h+=a[g-1].length)}return l};class Rg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Rn,this.indexArray=new Ri,this.indexArray2=new aa,this.programConfigurations=new cc(r.layers,r.zoom),this.segments=new fn,this.segments2=new fn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.hasPattern=Mg("fill",this.layers,l);const g=this.layers[0].layout.get("fill-sort-key"),x=!g.isConstant(),w=[];for(const{feature:C,id:A,index:N,sourceLayerIndex:j}of r){const H=this.layers[0]._featureFilter.needGeometry,Q=dc(C,H);if(!this.layers[0]._featureFilter.filter(new nr(this.zoom),Q,h))continue;const te=x?g.evaluate(Q,{},h,l.availableImages):void 0,ne={id:A,properties:C.properties,type:C.type,sourceLayerIndex:j,index:N,geometry:H?Q.geometry:uc(C),patterns:{},sortKey:te};w.push(ne)}x&&w.sort((C,A)=>C.sortKey-A.sortKey);for(const C of w){const{geometry:A,index:N,sourceLayerIndex:j}=C;if(this.hasPattern){const H=Dg("fill",this.layers,C,this.zoom,l);this.patternFeatures.push(H)}else this.addFeature(C,A,N,h,{});l.featureIndex.insert(r[N].feature,A,N,j,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}addFeatures(r,l,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,bI),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,l,h,g,x){for(const w of Ig(l,500)){let C=0;for(const te of w)C+=te.length;const A=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),N=A.vertexLength,j=[],H=[];for(const te of w){if(te.length===0)continue;te!==w[0]&&H.push(j.length/2);const ne=this.segments2.prepareSegment(te.length,this.layoutVertexArray,this.indexArray2),_e=ne.vertexLength;this.layoutVertexArray.emplaceBack(te[0].x,te[0].y),this.indexArray2.emplaceBack(_e+te.length-1,_e),j.push(te[0].x),j.push(te[0].y);for(let me=1;me<te.length;me++)this.layoutVertexArray.emplaceBack(te[me].x,te[me].y),this.indexArray2.emplaceBack(_e+me-1,_e+me),j.push(te[me].x),j.push(te[me].y);ne.vertexLength+=te.length,ne.primitiveLength+=te.length}const Q=gp.exports(j,H);for(let te=0;te<Q.length;te+=3)this.indexArray.emplaceBack(N+Q[te],N+Q[te+1],N+Q[te+2]);A.vertexLength+=C,A.primitiveLength+=Q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,x,g)}}$t("FillBucket",Rg,{omit:["layers","patternFeatures"]});const LI=new ei({"fill-sort-key":new Yt(Ye.layout_fill["fill-sort-key"])});var NI={paint:new ei({"fill-antialias":new jt(Ye.paint_fill["fill-antialias"]),"fill-opacity":new Yt(Ye.paint_fill["fill-opacity"]),"fill-color":new Yt(Ye.paint_fill["fill-color"]),"fill-outline-color":new Yt(Ye.paint_fill["fill-outline-color"]),"fill-translate":new jt(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new jt(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new nl(Ye.paint_fill["fill-pattern"])}),layout:LI};const OI=Pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),$I=Pr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:zI}=OI;var ol={},BI=ze,Ib=mu;function mu(a,r,l,h,g){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=h,this._values=g,a.readFields(FI,this,r)}function FI(a,r,l){a==1?r.id=l.readVarint():a==2?function(h,g){for(var x=h.readVarint()+h.pos;h.pos<x;){var w=g._keys[h.readVarint()],C=g._values[h.readVarint()];g.properties[w]=C}}(l,r):a==3?r.type=l.readVarint():a==4&&(r._geometry=l.pos)}function UI(a){for(var r,l,h=0,g=0,x=a.length,w=x-1;g<x;w=g++)h+=((l=a[w]).x-(r=a[g]).x)*(r.y+l.y);return h}mu.types=["Unknown","Point","LineString","Polygon"],mu.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var r,l=a.readVarint()+a.pos,h=1,g=0,x=0,w=0,C=[];a.pos<l;){if(g<=0){var A=a.readVarint();h=7&A,g=A>>3}if(g--,h===1||h===2)x+=a.readSVarint(),w+=a.readSVarint(),h===1&&(r&&C.push(r),r=[]),r.push(new BI(x,w));else{if(h!==7)throw new Error("unknown command "+h);r&&r.push(r[0].clone())}}return r&&C.push(r),C},mu.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var r=a.readVarint()+a.pos,l=1,h=0,g=0,x=0,w=1/0,C=-1/0,A=1/0,N=-1/0;a.pos<r;){if(h<=0){var j=a.readVarint();l=7&j,h=j>>3}if(h--,l===1||l===2)(g+=a.readSVarint())<w&&(w=g),g>C&&(C=g),(x+=a.readSVarint())<A&&(A=x),x>N&&(N=x);else if(l!==7)throw new Error("unknown command "+l)}return[w,A,C,N]},mu.prototype.toGeoJSON=function(a,r,l){var h,g,x=this.extent*Math.pow(2,l),w=this.extent*a,C=this.extent*r,A=this.loadGeometry(),N=mu.types[this.type];function j(te){for(var ne=0;ne<te.length;ne++){var _e=te[ne];te[ne]=[360*(_e.x+w)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(_e.y+C)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(h=0;h<A.length;h++)H[h]=A[h][0];j(A=H);break;case 2:for(h=0;h<A.length;h++)j(A[h]);break;case 3:for(A=function(te){var ne=te.length;if(ne<=1)return[te];for(var _e,me,$e=[],qe=0;qe<ne;qe++){var Le=UI(te[qe]);Le!==0&&(me===void 0&&(me=Le<0),me===Le<0?(_e&&$e.push(_e),_e=[te[qe]]):_e.push(te[qe]))}return _e&&$e.push(_e),$e}(A),h=0;h<A.length;h++)for(g=0;g<A[h].length;g++)j(A[h][g])}A.length===1?A=A[0]:N="Multi"+N;var Q={type:"Feature",geometry:{type:N,coordinates:A},properties:this.properties};return"id"in this&&(Q.id=this.id),Q};var VI=Ib,Mb=Db;function Db(a,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(jI,this,r),this.length=this._features.length}function jI(a,r,l){a===15?r.version=l.readVarint():a===1?r.name=l.readString():a===5?r.extent=l.readVarint():a===2?r._features.push(l.pos):a===3?r._keys.push(l.readString()):a===4&&r._values.push(function(h){for(var g=null,x=h.readVarint()+h.pos;h.pos<x;){var w=h.readVarint()>>3;g=w===1?h.readString():w===2?h.readFloat():w===3?h.readDouble():w===4?h.readVarint64():w===5?h.readVarint():w===6?h.readSVarint():w===7?h.readBoolean():null}return g}(l))}Db.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var r=this._pbf.readVarint()+this._pbf.pos;return new VI(this._pbf,r,this.extent,this._keys,this._values)};var GI=Mb;function qI(a,r,l){if(a===3){var h=new GI(l,l.readVarint()+l.pos);h.length&&(r[h.name]=h)}}ol.VectorTile=function(a,r){this.layers=a.readFields(qI,{},r)},ol.VectorTileFeature=Ib,ol.VectorTileLayer=Mb;const WI=ol.VectorTileFeature.types,Lg=Math.pow(2,13);function nh(a,r,l,h,g,x,w,C){a.emplaceBack(r,l,2*Math.floor(h*Lg)+w,g*Lg*2,x*Lg*2,Math.round(C))}class Ng{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new wn,this.centroidVertexArray=new Ht,this.indexArray=new Ri,this.programConfigurations=new cc(r.layers,r.zoom),this.segments=new fn,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.features=[],this.hasPattern=Mg("fill-extrusion",this.layers,l);for(const{feature:g,id:x,index:w,sourceLayerIndex:C}of r){const A=this.layers[0]._featureFilter.needGeometry,N=dc(g,A);if(!this.layers[0]._featureFilter.filter(new nr(this.zoom),N,h))continue;const j={id:x,sourceLayerIndex:C,index:w,geometry:A?N.geometry:uc(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Dg("fill-extrusion",this.layers,j,this.zoom,l)):this.addFeature(j,j.geometry,w,h,{}),l.featureIndex.insert(g,j.geometry,w,C,this.index,!0)}}addFeatures(r,l,h){for(const g of this.features){const{geometry:x}=g;this.addFeature(g,x,g.index,l,h)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,zI),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,$I.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,l,h,g,x){const w={x:0,y:0,vertexCount:0};for(const C of Ig(l,500)){let A=0;for(const ne of C)A+=ne.length;let N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ne of C){if(ne.length===0||ZI(ne))continue;let _e=0;for(let me=0;me<ne.length;me++){const $e=ne[me];if(me>=1){const qe=ne[me-1];if(!HI($e,qe)){N.vertexLength+4>fn.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Le=$e.sub(qe)._perp()._unit(),Ve=qe.dist($e);_e+Ve>32768&&(_e=0),nh(this.layoutVertexArray,$e.x,$e.y,Le.x,Le.y,0,0,_e),nh(this.layoutVertexArray,$e.x,$e.y,Le.x,Le.y,0,1,_e),w.x+=2*$e.x,w.y+=2*$e.y,w.vertexCount+=2,_e+=Ve,nh(this.layoutVertexArray,qe.x,qe.y,Le.x,Le.y,0,0,_e),nh(this.layoutVertexArray,qe.x,qe.y,Le.x,Le.y,0,1,_e),w.x+=2*qe.x,w.y+=2*qe.y,w.vertexCount+=2;const st=N.vertexLength;this.indexArray.emplaceBack(st,st+2,st+1),this.indexArray.emplaceBack(st+1,st+2,st+3),N.vertexLength+=4,N.primitiveLength+=2}}}}if(N.vertexLength+A>fn.MAX_VERTEX_ARRAY_LENGTH&&(N=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray)),WI[r.type]!=="Polygon")continue;const j=[],H=[],Q=N.vertexLength;for(const ne of C)if(ne.length!==0){ne!==C[0]&&H.push(j.length/2);for(let _e=0;_e<ne.length;_e++){const me=ne[_e];nh(this.layoutVertexArray,me.x,me.y,0,0,1,1,0),w.x+=me.x,w.y+=me.y,w.vertexCount+=1,j.push(me.x),j.push(me.y)}}const te=gp.exports(j,H);for(let ne=0;ne<te.length;ne+=3)this.indexArray.emplaceBack(Q+te[ne],Q+te[ne+2],Q+te[ne+1]);N.primitiveLength+=te.length/3,N.vertexLength+=A}for(let C=0;C<w.vertexCount;C++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,x,g)}}function HI(a,r){return a.x===r.x&&(a.x<0||a.x>$r)||a.y===r.y&&(a.y<0||a.y>$r)}function ZI(a){return a.every(r=>r.x<0)||a.every(r=>r.x>$r)||a.every(r=>r.y<0)||a.every(r=>r.y>$r)}$t("FillExtrusionBucket",Ng,{omit:["layers","features"]});var KI={paint:new ei({"fill-extrusion-opacity":new jt(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Yt(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new jt(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new jt(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new nl(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Yt(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Yt(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new jt(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function rh(a,r){return a.x*r.x+a.y*r.y}function Rb(a,r){if(a.length===1){let l=0;const h=r[l++];let g;for(;!g||h.equals(g);)if(g=r[l++],!g)return 1/0;for(;l<r.length;l++){const x=r[l],w=a[0],C=g.sub(h),A=x.sub(h),N=w.sub(h),j=rh(C,C),H=rh(C,A),Q=rh(A,A),te=rh(N,C),ne=rh(N,A),_e=j*Q-H*H,me=(Q*te-H*ne)/_e,$e=(j*ne-H*te)/_e,qe=h.z*(1-me-$e)+g.z*me+x.z*$e;if(isFinite(qe))return qe}return 1/0}{let l=1/0;for(const h of r)l=Math.min(l,h.z);return l}}const XI=Pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:YI}=XI,JI=Pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:QI}=JI,e4=ol.VectorTileFeature.types,t4=Math.cos(Math.PI/180*37.5),Lb=Math.pow(2,14)/.5;class Og{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new Sn,this.layoutVertexArray2=new On,this.indexArray=new Ri,this.programConfigurations=new cc(r.layers,r.zoom),this.segments=new fn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,h){this.hasPattern=Mg("line",this.layers,l);const g=this.layers[0].layout.get("line-sort-key"),x=!g.isConstant(),w=[];for(const{feature:C,id:A,index:N,sourceLayerIndex:j}of r){const H=this.layers[0]._featureFilter.needGeometry,Q=dc(C,H);if(!this.layers[0]._featureFilter.filter(new nr(this.zoom),Q,h))continue;const te=x?g.evaluate(Q,{},h):void 0,ne={id:A,properties:C.properties,type:C.type,sourceLayerIndex:j,index:N,geometry:H?Q.geometry:uc(C),patterns:{},sortKey:te};w.push(ne)}x&&w.sort((C,A)=>C.sortKey-A.sortKey);for(const C of w){const{geometry:A,index:N,sourceLayerIndex:j}=C;if(this.hasPattern){const H=Dg("line",this.layers,C,this.zoom,l);this.patternFeatures.push(H)}else this.addFeature(C,A,N,h,{});l.featureIndex.insert(r[N].feature,A,N,j,this.index)}}update(r,l,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,h)}addFeatures(r,l,h){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,l,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,QI)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,YI),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,l,h,g,x){const w=this.layers[0].layout,C=w.get("line-join").evaluate(r,{}),A=w.get("line-cap"),N=w.get("line-miter-limit"),j=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const H of l)this.addLine(H,r,C,A,N,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,h,x,g)}addLine(r,l,h,g,x,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let $e=0;$e<r.length-1;$e++)this.totalDistance+=r[$e].dist(r[$e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=e4[l.type]==="Polygon";let A=r.length;for(;A>=2&&r[A-1].equals(r[A-2]);)A--;let N=0;for(;N<A-1&&r[N].equals(r[N+1]);)N++;if(A<(C?3:2))return;h==="bevel"&&(x=1.05);const j=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let Q,te,ne,_e,me;this.e1=this.e2=-1,C&&(Q=r[A-2],me=r[N].sub(Q)._unit()._perp());for(let $e=N;$e<A;$e++){if(ne=$e===A-1?C?r[N+1]:void 0:r[$e+1],ne&&r[$e].equals(ne))continue;me&&(_e=me),Q&&(te=Q),Q=r[$e],me=ne?ne.sub(Q)._unit()._perp():_e,_e=_e||me;let qe=_e.add(me);qe.x===0&&qe.y===0||qe._unit();const Le=_e.x*me.x+_e.y*me.y,Ve=qe.x*me.x+qe.y*me.y,st=Ve!==0?1/Ve:1/0,ot=2*Math.sqrt(2-2*Ve),Nt=Ve<t4&&te&&ne,Vt=_e.x*me.y-_e.y*me.x>0;if(Nt&&$e>N){const wt=Q.dist(te);if(wt>2*j){const Mt=Q.sub(Q.sub(te)._mult(j/wt)._round());this.updateDistance(te,Mt),this.addCurrentVertex(Mt,_e,0,0,H),te=Mt}}const It=te&&ne;let St=It?h:C?"butt":g;if(It&&St==="round"&&(st<w?St="miter":st<=2&&(St="fakeround")),St==="miter"&&st>x&&(St="bevel"),St==="bevel"&&(st>2&&(St="flipbevel"),st<x&&(St="miter")),te&&this.updateDistance(te,Q),St==="miter")qe._mult(st),this.addCurrentVertex(Q,qe,0,0,H);else if(St==="flipbevel"){if(st>100)qe=me.mult(-1);else{const wt=st*_e.add(me).mag()/_e.sub(me).mag();qe._perp()._mult(wt*(Vt?-1:1))}this.addCurrentVertex(Q,qe,0,0,H),this.addCurrentVertex(Q,qe.mult(-1),0,0,H)}else if(St==="bevel"||St==="fakeround"){const wt=-Math.sqrt(st*st-1),Mt=Vt?wt:0,kt=Vt?0:wt;if(te&&this.addCurrentVertex(Q,_e,Mt,kt,H),St==="fakeround"){const yt=Math.round(180*ot/Math.PI/20);for(let Zt=1;Zt<yt;Zt++){let Gt=Zt/yt;if(Gt!==.5){const Jn=Gt-.5;Gt+=Gt*Jn*(Gt-1)*((1.0904+Le*(Le*(3.55645-1.43519*Le)-3.2452))*Jn*Jn+(.848013+Le*(.215638*Le-1.06021)))}const dn=me.sub(_e)._mult(Gt)._add(_e)._unit()._mult(Vt?-1:1);this.addHalfVertex(Q,dn.x,dn.y,!1,Vt,0,H)}}ne&&this.addCurrentVertex(Q,me,-Mt,-kt,H)}else if(St==="butt")this.addCurrentVertex(Q,qe,0,0,H);else if(St==="square"){const wt=te?1:-1;this.addCurrentVertex(Q,qe,wt,wt,H)}else St==="round"&&(te&&(this.addCurrentVertex(Q,_e,0,0,H),this.addCurrentVertex(Q,_e,1,1,H,!0)),ne&&(this.addCurrentVertex(Q,me,-1,-1,H,!0),this.addCurrentVertex(Q,me,0,0,H)));if(Nt&&$e<A-1){const wt=Q.dist(ne);if(wt>2*j){const Mt=Q.add(ne.sub(Q)._mult(j/wt)._round());this.updateDistance(Q,Mt),this.addCurrentVertex(Mt,me,0,0,H),Q=Mt}}}}addCurrentVertex(r,l,h,g,x,w=!1){const C=l.y*g-l.x,A=-l.y-l.x*g;this.addHalfVertex(r,l.x+l.y*h,l.y-l.x*h,w,!1,h,x),this.addHalfVertex(r,C,A,w,!0,-g,x),this.distance>Lb/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(r,l,h,g,x,w))}addHalfVertex({x:r,y:l},h,g,x,w,C,A){const N=.5*(this.lineClips?this.scaledDistance*(Lb-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(x?1:0),(l<<1)+(w?1:0),Math.round(63*h)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1)|(63&N)<<2,N>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const j=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,j),A.primitiveLength++),w?this.e2=j:this.e1=j}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,l){this.distance+=r.dist(l),this.updateScaledDistance()}}$t("LineBucket",Og,{omit:["layers","patternFeatures"]});const n4=new ei({"line-cap":new jt(Ye.layout_line["line-cap"]),"line-join":new Yt(Ye.layout_line["line-join"]),"line-miter-limit":new jt(Ye.layout_line["line-miter-limit"]),"line-round-limit":new jt(Ye.layout_line["line-round-limit"]),"line-sort-key":new Yt(Ye.layout_line["line-sort-key"])});var Nb={paint:new ei({"line-opacity":new Yt(Ye.paint_line["line-opacity"]),"line-color":new Yt(Ye.paint_line["line-color"]),"line-translate":new jt(Ye.paint_line["line-translate"]),"line-translate-anchor":new jt(Ye.paint_line["line-translate-anchor"]),"line-width":new Yt(Ye.paint_line["line-width"]),"line-gap-width":new Yt(Ye.paint_line["line-gap-width"]),"line-offset":new Yt(Ye.paint_line["line-offset"]),"line-blur":new Yt(Ye.paint_line["line-blur"]),"line-dasharray":new Gd(Ye.paint_line["line-dasharray"]),"line-pattern":new nl(Ye.paint_line["line-pattern"]),"line-gradient":new Da(Ye.paint_line["line-gradient"])}),layout:n4};const Ob=new class extends Yt{possiblyEvaluate(a,r){return r=new nr(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(a,r)}evaluate(a,r,l,h){return r=O({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(a,r,l,h)}}(Nb.paint.properties["line-width"].specification);function $b(a,r){return r>0?r+2*a:a}Ob.useIntegerZoom=!0;const r4=Pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),i4=Pr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const o4=Pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zb=Pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),a4=Pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function s4(a,r,l){return a.sections.forEach(h=>{h.text=function(g,x,w){const C=x.layout.get("text-transform").evaluate(w,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),oo.applyArabicShaping&&(g=oo.applyArabicShaping(g)),g}(h.text,r,l)}),a}Pr([{name:"triangle",components:3,type:"Uint16"}]),Pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Pr([{type:"Float32",name:"offsetX"}]),Pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ih={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ti=24,$g=Fn,Bb=function(a,r,l,h,g){var x,w,C=8*g-h-1,A=(1<<C)-1,N=A>>1,j=-7,H=l?g-1:0,Q=l?-1:1,te=a[r+H];for(H+=Q,x=te&(1<<-j)-1,te>>=-j,j+=C;j>0;x=256*x+a[r+H],H+=Q,j-=8);for(w=x&(1<<-j)-1,x>>=-j,j+=h;j>0;w=256*w+a[r+H],H+=Q,j-=8);if(x===0)x=1-N;else{if(x===A)return w?NaN:1/0*(te?-1:1);w+=Math.pow(2,h),x-=N}return(te?-1:1)*w*Math.pow(2,x-h)},Fb=function(a,r,l,h,g,x){var w,C,A,N=8*x-g-1,j=(1<<N)-1,H=j>>1,Q=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,te=h?0:x-1,ne=h?1:-1,_e=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(C=isNaN(r)?1:0,w=j):(w=Math.floor(Math.log(r)/Math.LN2),r*(A=Math.pow(2,-w))<1&&(w--,A*=2),(r+=w+H>=1?Q/A:Q*Math.pow(2,1-H))*A>=2&&(w++,A/=2),w+H>=j?(C=0,w=j):w+H>=1?(C=(r*A-1)*Math.pow(2,g),w+=H):(C=r*Math.pow(2,H-1)*Math.pow(2,g),w=0));g>=8;a[l+te]=255&C,te+=ne,C/=256,g-=8);for(w=w<<g|C,N+=g;N>0;a[l+te]=255&w,te+=ne,w/=256,N-=8);a[l+te-ne]|=128*_e};function Fn(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Fn.Varint=0,Fn.Fixed64=1,Fn.Bytes=2,Fn.Fixed32=5;var al,zg=4294967296,Ub=1/zg,Vb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function hs(a){return a.type===Fn.Bytes?a.readVarint()+a.pos:a.pos+1}function gu(a,r,l){return l?4294967296*r+(a>>>0):4294967296*(r>>>0)+(a>>>0)}function jb(a,r,l){var h=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));l.realloc(h);for(var g=l.pos-1;g>=a;g--)l.buf[g+h]=l.buf[g]}function l4(a,r){for(var l=0;l<a.length;l++)r.writeVarint(a[l])}function c4(a,r){for(var l=0;l<a.length;l++)r.writeSVarint(a[l])}function u4(a,r){for(var l=0;l<a.length;l++)r.writeFloat(a[l])}function d4(a,r){for(var l=0;l<a.length;l++)r.writeDouble(a[l])}function h4(a,r){for(var l=0;l<a.length;l++)r.writeBoolean(a[l])}function f4(a,r){for(var l=0;l<a.length;l++)r.writeFixed32(a[l])}function p4(a,r){for(var l=0;l<a.length;l++)r.writeSFixed32(a[l])}function m4(a,r){for(var l=0;l<a.length;l++)r.writeFixed64(a[l])}function g4(a,r){for(var l=0;l<a.length;l++)r.writeSFixed64(a[l])}function bp(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+16777216*a[r+3]}function yu(a,r,l){a[l]=r,a[l+1]=r>>>8,a[l+2]=r>>>16,a[l+3]=r>>>24}function Gb(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+(a[r+3]<<24)}function y4(a,r,l){a===1&&l.readMessage(v4,r)}function v4(a,r,l){if(a===3){const{id:h,bitmap:g,width:x,height:w,left:C,top:A,advance:N}=l.readMessage(_4,{});r.push({id:h,bitmap:new Yd({width:x+6,height:w+6},g),metrics:{width:x,height:w,left:C,top:A,advance:N}})}}function _4(a,r,l){a===1?r.id=l.readVarint():a===2?r.bitmap=l.readBytes():a===3?r.width=l.readVarint():a===4?r.height=l.readVarint():a===5?r.left=l.readSVarint():a===6?r.top=l.readSVarint():a===7&&(r.advance=l.readVarint())}function qb(a){let r=0,l=0;for(const w of a)r+=w.w*w.h,l=Math.max(l,w.w);a.sort((w,C)=>C.h-w.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),l),h:1/0}];let g=0,x=0;for(const w of a)for(let C=h.length-1;C>=0;C--){const A=h[C];if(!(w.w>A.w||w.h>A.h)){if(w.x=A.x,w.y=A.y,x=Math.max(x,w.y+w.h),g=Math.max(g,w.x+w.w),w.w===A.w&&w.h===A.h){const N=h.pop();C<h.length&&(h[C]=N)}else w.h===A.h?(A.x+=w.w,A.w-=w.w):w.w===A.w?(A.y+=w.h,A.h-=w.h):(h.push({x:A.x+w.w,y:A.y,w:A.w-w.w,h:w.h}),A.y+=w.h,A.h-=w.h);break}}return{w:g,h:x,fill:r/(g*x)||0}}Fn.prototype={destroy:function(){this.buf=null},readFields:function(a,r,l){for(l=l||this.length;this.pos<l;){var h=this.readVarint(),g=h>>3,x=this.pos;this.type=7&h,a(g,r,this),this.pos===x&&this.skip(h)}return r},readMessage:function(a,r){return this.readFields(a,r,this.readVarint()+this.pos)},readFixed32:function(){var a=bp(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Gb(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=bp(this.buf,this.pos)+bp(this.buf,this.pos+4)*zg;return this.pos+=8,a},readSFixed64:function(){var a=bp(this.buf,this.pos)+Gb(this.buf,this.pos+4)*zg;return this.pos+=8,a},readFloat:function(){var a=Bb(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Bb(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var r,l,h=this.buf;return r=127&(l=h[this.pos++]),l<128?r:(r|=(127&(l=h[this.pos++]))<<7,l<128?r:(r|=(127&(l=h[this.pos++]))<<14,l<128?r:(r|=(127&(l=h[this.pos++]))<<21,l<128?r:function(g,x,w){var C,A,N=w.buf;if(C=(112&(A=N[w.pos++]))>>4,A<128||(C|=(127&(A=N[w.pos++]))<<3,A<128)||(C|=(127&(A=N[w.pos++]))<<10,A<128)||(C|=(127&(A=N[w.pos++]))<<17,A<128)||(C|=(127&(A=N[w.pos++]))<<24,A<128)||(C|=(1&(A=N[w.pos++]))<<31,A<128))return gu(g,C,x);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(l=h[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,r=this.pos;return this.pos=a,a-r>=12&&Vb?function(l,h,g){return Vb.decode(l.subarray(h,g))}(this.buf,r,a):function(l,h,g){for(var x="",w=h;w<g;){var C,A,N,j=l[w],H=null,Q=j>239?4:j>223?3:j>191?2:1;if(w+Q>g)break;Q===1?j<128&&(H=j):Q===2?(192&(C=l[w+1]))==128&&(H=(31&j)<<6|63&C)<=127&&(H=null):Q===3?(A=l[w+2],(192&(C=l[w+1]))==128&&(192&A)==128&&((H=(15&j)<<12|(63&C)<<6|63&A)<=2047||H>=55296&&H<=57343)&&(H=null)):Q===4&&(A=l[w+2],N=l[w+3],(192&(C=l[w+1]))==128&&(192&A)==128&&(192&N)==128&&((H=(15&j)<<18|(63&C)<<12|(63&A)<<6|63&N)<=65535||H>=1114112)&&(H=null)),H===null?(H=65533,Q=1):H>65535&&(H-=65536,x+=String.fromCharCode(H>>>10&1023|55296),H=56320|1023&H),x+=String.fromCharCode(H),w+=Q}return x}(this.buf,r,a)},readBytes:function(){var a=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,a);return this.pos=a,r},readPackedVarint:function(a,r){if(this.type!==Fn.Bytes)return a.push(this.readVarint(r));var l=hs(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(r));return a},readPackedSVarint:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSVarint());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Fn.Bytes)return a.push(this.readBoolean());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFloat());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Fn.Bytes)return a.push(this.readDouble());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFixed32());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSFixed32());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Fn.Bytes)return a.push(this.readFixed64());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Fn.Bytes)return a.push(this.readSFixed64());var r=hs(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed64());return a},skip:function(a){var r=7&a;if(r===Fn.Varint)for(;this.buf[this.pos++]>127;);else if(r===Fn.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Fn.Fixed32)this.pos+=4;else{if(r!==Fn.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(a,r){this.writeVarint(a<<3|r)},realloc:function(a){for(var r=this.length||16;r<this.pos+a;)r*=2;if(r!==this.length){var l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),yu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),yu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),yu(this.buf,-1&a,this.pos),yu(this.buf,Math.floor(a*Ub),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),yu(this.buf,-1&a,this.pos),yu(this.buf,Math.floor(a*Ub),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(r,l){var h,g;if(r>=0?(h=r%4294967296|0,g=r/4294967296|0):(g=~(-r/4294967296),4294967295^(h=~(-r%4294967296))?h=h+1|0:(h=0,g=g+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(x,w,C){C.buf[C.pos++]=127&x|128,x>>>=7,C.buf[C.pos++]=127&x|128,x>>>=7,C.buf[C.pos++]=127&x|128,x>>>=7,C.buf[C.pos++]=127&x|128,C.buf[C.pos]=127&(x>>>=7)}(h,0,l),function(x,w){var C=(7&x)<<4;w.buf[w.pos++]|=C|((x>>>=3)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x|((x>>>=7)?128:0),x&&(w.buf[w.pos++]=127&x)))))}(g,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var r=this.pos;this.pos=function(h,g,x){for(var w,C,A=0;A<g.length;A++){if((w=g.charCodeAt(A))>55295&&w<57344){if(!C){w>56319||A+1===g.length?(h[x++]=239,h[x++]=191,h[x++]=189):C=w;continue}if(w<56320){h[x++]=239,h[x++]=191,h[x++]=189,C=w;continue}w=C-55296<<10|w-56320|65536,C=null}else C&&(h[x++]=239,h[x++]=191,h[x++]=189,C=null);w<128?h[x++]=w:(w<2048?h[x++]=w>>6|192:(w<65536?h[x++]=w>>12|224:(h[x++]=w>>18|240,h[x++]=w>>12&63|128),h[x++]=w>>6&63|128),h[x++]=63&w|128)}return x}(this.buf,a,this.pos);var l=this.pos-r;l>=128&&jb(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),Fb(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Fb(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var r=a.length;this.writeVarint(r),this.realloc(r);for(var l=0;l<r;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,r){this.pos++;var l=this.pos;a(r,this);var h=this.pos-l;h>=128&&jb(l,h,this),this.pos=l-1,this.writeVarint(h),this.pos+=h},writeMessage:function(a,r,l){this.writeTag(a,Fn.Bytes),this.writeRawMessage(r,l)},writePackedVarint:function(a,r){r.length&&this.writeMessage(a,l4,r)},writePackedSVarint:function(a,r){r.length&&this.writeMessage(a,c4,r)},writePackedBoolean:function(a,r){r.length&&this.writeMessage(a,h4,r)},writePackedFloat:function(a,r){r.length&&this.writeMessage(a,u4,r)},writePackedDouble:function(a,r){r.length&&this.writeMessage(a,d4,r)},writePackedFixed32:function(a,r){r.length&&this.writeMessage(a,f4,r)},writePackedSFixed32:function(a,r){r.length&&this.writeMessage(a,p4,r)},writePackedFixed64:function(a,r){r.length&&this.writeMessage(a,m4,r)},writePackedSFixed64:function(a,r){r.length&&this.writeMessage(a,g4,r)},writeBytesField:function(a,r){this.writeTag(a,Fn.Bytes),this.writeBytes(r)},writeFixed32Field:function(a,r){this.writeTag(a,Fn.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(a,r){this.writeTag(a,Fn.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(a,r){this.writeTag(a,Fn.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(a,r){this.writeTag(a,Fn.Fixed64),this.writeSFixed64(r)},writeVarintField:function(a,r){this.writeTag(a,Fn.Varint),this.writeVarint(r)},writeSVarintField:function(a,r){this.writeTag(a,Fn.Varint),this.writeSVarint(r)},writeStringField:function(a,r){this.writeTag(a,Fn.Bytes),this.writeString(r)},writeFloatField:function(a,r){this.writeTag(a,Fn.Fixed32),this.writeFloat(r)},writeDoubleField:function(a,r){this.writeTag(a,Fn.Fixed64),this.writeDouble(r)},writeBooleanField:function(a,r){this.writeVarintField(a,Boolean(r))}};class Bg{constructor(r,{pixelRatio:l,version:h,stretchX:g,stretchY:x,content:w}){this.paddedRect=r,this.pixelRatio=l,this.stretchX=g,this.stretchY=x,this.content=w,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Wb{constructor(r,l){const h={},g={};this.haveRenderCallbacks=[];const x=[];this.addImages(r,h,x),this.addImages(l,g,x);const{w,h:C}=qb(x),A=new To({width:w||1,height:C||1});for(const N in r){const j=r[N],H=h[N].paddedRect;To.copy(j.data,A,{x:0,y:0},{x:H.x+1,y:H.y+1},j.data)}for(const N in l){const j=l[N],H=g[N].paddedRect,Q=H.x+1,te=H.y+1,ne=j.data.width,_e=j.data.height;To.copy(j.data,A,{x:0,y:0},{x:Q,y:te},j.data),To.copy(j.data,A,{x:0,y:_e-1},{x:Q,y:te-1},{width:ne,height:1}),To.copy(j.data,A,{x:0,y:0},{x:Q,y:te+_e},{width:ne,height:1}),To.copy(j.data,A,{x:ne-1,y:0},{x:Q-1,y:te},{width:1,height:_e}),To.copy(j.data,A,{x:0,y:0},{x:Q+ne,y:te},{width:1,height:_e})}this.image=A,this.iconPositions=h,this.patternPositions=g}addImages(r,l,h){for(const g in r){const x=r[g],w={x:0,y:0,w:x.data.width+2,h:x.data.height+2};h.push(w),l[g]=new Bg(w,x),x.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(r,l){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in r.updatedImages)this.patchUpdatedImage(this.iconPositions[h],r.getImage(h),l),this.patchUpdatedImage(this.patternPositions[h],r.getImage(h),l)}patchUpdatedImage(r,l,h){if(!r||!l||r.version===l.version)return;r.version=l.version;const[g,x]=r.tl;h.update(l.data,void 0,{x:g,y:x})}}$t("ImagePosition",Bg),$t("ImageAtlas",Wb),s.WritingMode=void 0,(al=s.WritingMode||(s.WritingMode={}))[al.none=0]="none",al[al.horizontal=1]="horizontal",al[al.vertical=2]="vertical",al[al.horizontalOnly=3]="horizontalOnly";const wp=-17;class oh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,l){const h=new oh;return h.scale=r||1,h.fontStack=l,h}static forImage(r){const l=new oh;return l.imageName=r,l}}class vu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,l){const h=new vu;for(let g=0;g<r.sections.length;g++){const x=r.sections[g];x.image?h.addImageSection(x):h.addTextSection(x,l)}return h}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let l="";for(let h=0;h<r.length;h++){const g=r.charCodeAt(h+1)||null,x=r.charCodeAt(h-1)||null;l+=g&&np(g)&&!ih[r[h+1]]||x&&np(x)&&!ih[r[h-1]]||!ih[r[h]]?r[h]:ih[r[h]]}return l}(this.text)}trim(){let r=0;for(let h=0;h<this.text.length&&Tp[this.text.charCodeAt(h)];h++)r++;let l=this.text.length;for(let h=this.text.length-1;h>=0&&h>=r&&Tp[this.text.charCodeAt(h)];h--)l--;this.text=this.text.substring(r,l),this.sectionIndex=this.sectionIndex.slice(r,l)}substring(r,l){const h=new vu;return h.text=this.text.substring(r,l),h.sectionIndex=this.sectionIndex.slice(r,l),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,l)=>Math.max(r,this.sections[l].scale),0)}addTextSection(r,l){this.text+=r.text,this.sections.push(oh.forText(r.scale,r.fontStack||l));const h=this.sections.length-1;for(let g=0;g<r.text.length;++g)this.sectionIndex.push(h)}addImageSection(r){const l=r.image?r.image.name:"";if(l.length===0)return void V("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(oh.forImage(l)),this.sectionIndex.push(this.sections.length-1)):V("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ep(a,r,l,h,g,x,w,C,A,N,j,H,Q,te,ne,_e){const me=vu.fromFeature(a,g);let $e;H===s.WritingMode.vertical&&me.verticalizePunctuation();const{processBidirectionalText:qe,processStyledBidirectionalText:Le}=oo;if(qe&&me.sections.length===1){$e=[];const ot=qe(me.toString(),Fg(me,N,x,r,h,te,ne));for(const Nt of ot){const Vt=new vu;Vt.text=Nt,Vt.sections=me.sections;for(let It=0;It<Nt.length;It++)Vt.sectionIndex.push(0);$e.push(Vt)}}else if(Le){$e=[];const ot=Le(me.text,me.sectionIndex,Fg(me,N,x,r,h,te,ne));for(const Nt of ot){const Vt=new vu;Vt.text=Nt[0],Vt.sectionIndex=Nt[1],Vt.sections=me.sections,$e.push(Vt)}}else $e=function(ot,Nt){const Vt=[],It=ot.text;let St=0;for(const wt of Nt)Vt.push(ot.substring(St,wt)),St=wt;return St<It.length&&Vt.push(ot.substring(St,It.length)),Vt}(me,Fg(me,N,x,r,h,te,ne));const Ve=[],st={positionedLines:Ve,text:me.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:H,iconsInText:!1,verticalizable:!1};return function(ot,Nt,Vt,It,St,wt,Mt,kt,yt,Zt,Gt,dn){let Jn=0,ir=wp,zr=0,ko=0;const si=kt==="right"?1:kt==="left"?0:.5;let Ar=0;for(const Ir of St){Ir.trim();const ci=Ir.getMaxScale(),xi=(ci-1)*ti,Oi={positionedGlyphs:[],lineOffset:0};ot.positionedLines[Ar]=Oi;const Hi=Oi.positionedGlyphs;let Zi=0;if(!Ir.length()){ir+=wt,++Ar;continue}for(let Zr=0;Zr<Ir.length();Zr++){const mn=Ir.getSection(Zr),lo=Ir.getSectionIndex(Zr),ui=Ir.getCharCode(Zr);let bi=0,Vo=null,la=null,ca=null,ps=ti;const jo=!(yt===s.WritingMode.horizontal||!Gt&&!zd(ui)||Gt&&(Tp[ui]||(Hr=ui,At.Arabic(Hr)||At["Arabic Supplement"](Hr)||At["Arabic Extended-A"](Hr)||At["Arabic Presentation Forms-A"](Hr)||At["Arabic Presentation Forms-B"](Hr))));if(mn.imageName){const Co=It[mn.imageName];if(!Co)continue;ca=mn.imageName,ot.iconsInText=ot.iconsInText||!0,la=Co.paddedRect;const Ki=Co.displaySize;mn.scale=mn.scale*ti/dn,Vo={width:Ki[0],height:Ki[1],left:1,top:-3,advance:jo?Ki[1]:Ki[0]},bi=xi+(ti-Ki[1]*mn.scale),ps=Vo.advance;const ms=jo?Ki[0]*mn.scale-ti*ci:Ki[1]*mn.scale-ti*ci;ms>0&&ms>Zi&&(Zi=ms)}else{const Co=Vt[mn.fontStack],Ki=Co&&Co[ui];if(Ki&&Ki.rect)la=Ki.rect,Vo=Ki.metrics;else{const ms=Nt[mn.fontStack],lh=ms&&ms[ui];if(!lh)continue;Vo=lh.metrics}bi=(ci-mn.scale)*ti}jo?(ot.verticalizable=!0,Hi.push({glyph:ui,imageName:ca,x:Jn,y:ir+bi,vertical:jo,scale:mn.scale,fontStack:mn.fontStack,sectionIndex:lo,metrics:Vo,rect:la}),Jn+=ps*mn.scale+Zt):(Hi.push({glyph:ui,imageName:ca,x:Jn,y:ir+bi,vertical:jo,scale:mn.scale,fontStack:mn.fontStack,sectionIndex:lo,metrics:Vo,rect:la}),Jn+=Vo.advance*mn.scale+Zt)}Hi.length!==0&&(zr=Math.max(Jn-Zt,zr),w4(Hi,0,Hi.length-1,si,Zi)),Jn=0;const cr=wt*ci+Zi;Oi.lineOffset=Math.max(Zi,xi),ir+=cr,ko=Math.max(cr,ko),++Ar}var Hr;const li=ir-wp,{horizontalAlign:_i,verticalAlign:Wi}=Ug(Mt);(function(Ir,ci,xi,Oi,Hi,Zi,cr,Zr,mn){const lo=(ci-xi)*Hi;let ui=0;ui=Zi!==cr?-Zr*Oi-wp:(-Oi*mn+.5)*cr;for(const bi of Ir)for(const Vo of bi.positionedGlyphs)Vo.x+=lo,Vo.y+=ui})(ot.positionedLines,si,_i,Wi,zr,ko,wt,li,St.length),ot.top+=-Wi*li,ot.bottom=ot.top+li,ot.left+=-_i*zr,ot.right=ot.left+zr}(st,r,l,h,$e,w,C,A,H,N,Q,_e),!function(ot){for(const Nt of ot)if(Nt.positionedGlyphs.length!==0)return!1;return!0}(Ve)&&st}const Tp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},x4={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Hb(a,r,l,h,g,x){if(r.imageName){const w=h[r.imageName];return w?w.displaySize[0]*r.scale*ti/x+g:0}{const w=l[r.fontStack],C=w&&w[a];return C?C.metrics.advance*r.scale+g:0}}function Zb(a,r,l,h){const g=Math.pow(a-r,2);return h?a<r?g/2:2*g:g+Math.abs(l)*l}function b4(a,r,l){let h=0;return a===10&&(h-=1e4),l&&(h+=150),a!==40&&a!==65288||(h+=50),r!==41&&r!==65289||(h+=50),h}function Kb(a,r,l,h,g,x){let w=null,C=Zb(r,l,g,x);for(const A of h){const N=Zb(r-A.x,l,g,x)+A.badness;N<=C&&(w=A,C=N)}return{index:a,x:r,priorBreak:w,badness:C}}function Xb(a){return a?Xb(a.priorBreak).concat(a.index):[]}function Fg(a,r,l,h,g,x,w){if(x!=="point")return[];if(!a)return[];const C=[],A=function(Q,te,ne,_e,me,$e){let qe=0;for(let Le=0;Le<Q.length();Le++){const Ve=Q.getSection(Le);qe+=Hb(Q.getCharCode(Le),Ve,_e,me,te,$e)}return qe/Math.max(1,Math.ceil(qe/ne))}(a,r,l,h,g,w),N=a.text.indexOf("")>=0;let j=0;for(let Q=0;Q<a.length();Q++){const te=a.getSection(Q),ne=a.getCharCode(Q);if(Tp[ne]||(j+=Hb(ne,te,h,g,r,w)),Q<a.length()-1){const _e=!((H=ne)<11904||!(At["Bopomofo Extended"](H)||At.Bopomofo(H)||At["CJK Compatibility Forms"](H)||At["CJK Compatibility Ideographs"](H)||At["CJK Compatibility"](H)||At["CJK Radicals Supplement"](H)||At["CJK Strokes"](H)||At["CJK Symbols and Punctuation"](H)||At["CJK Unified Ideographs Extension A"](H)||At["CJK Unified Ideographs"](H)||At["Enclosed CJK Letters and Months"](H)||At["Halfwidth and Fullwidth Forms"](H)||At.Hiragana(H)||At["Ideographic Description Characters"](H)||At["Kangxi Radicals"](H)||At["Katakana Phonetic Extensions"](H)||At.Katakana(H)||At["Vertical Forms"](H)||At["Yi Radicals"](H)||At["Yi Syllables"](H)));(x4[ne]||_e||te.imageName)&&C.push(Kb(Q+1,j,A,C,b4(ne,a.getCharCode(Q+1),_e&&N),!1))}}var H;return Xb(Kb(a.length(),j,A,C,0,!0))}function Ug(a){let r=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:r,verticalAlign:l}}function w4(a,r,l,h,g){if(!h&&!g)return;const x=a[l],w=(a[l].x+x.metrics.advance*x.scale)*h;for(let C=r;C<=l;C++)a[C].x-=w,a[C].y+=g}function E4(a,r,l){const{horizontalAlign:h,verticalAlign:g}=Ug(l),x=r[0]-a.displaySize[0]*h,w=r[1]-a.displaySize[1]*g;return{image:a,top:w,bottom:w+a.displaySize[1],left:x,right:x+a.displaySize[0]}}function Yb(a,r,l,h,g,x){const w=a.image;let C;if(w.content){const me=w.content,$e=w.pixelRatio||1;C=[me[0]/$e,me[1]/$e,w.displaySize[0]-me[2]/$e,w.displaySize[1]-me[3]/$e]}const A=r.left*x,N=r.right*x;let j,H,Q,te;l==="width"||l==="both"?(te=g[0]+A-h[3],H=g[0]+N+h[1]):(te=g[0]+(A+N-w.displaySize[0])/2,H=te+w.displaySize[0]);const ne=r.top*x,_e=r.bottom*x;return l==="height"||l==="both"?(j=g[1]+ne-h[0],Q=g[1]+_e+h[2]):(j=g[1]+(ne+_e-w.displaySize[1])/2,Q=j+w.displaySize[1]),{image:w,top:j,right:H,bottom:Q,left:te,collisionPadding:C}}const fs=128;function Jb(a,r){const{expression:l}=r;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new nr(a+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=l;let x=0;for(;x<h.length&&h[x]<=a;)x++;x=Math.max(0,x-1);let w=x;for(;w<h.length&&h[w]<a+1;)w++;w=Math.min(h.length-1,w);const C=h[x],A=h[w];return l.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:A,minSize:l.evaluate(new nr(C)),maxSize:l.evaluate(new nr(A)),interpolationType:g}}}class sl extends ze{constructor(r,l,h,g){super(r,l),this.angle=h,g!==void 0&&(this.segment=g)}clone(){return new sl(this.x,this.y,this.angle,this.segment)}}function Qb(a,r,l,h,g){if(r.segment===void 0)return!0;let x=r,w=r.segment+1,C=0;for(;C>-l/2;){if(w--,w<0)return!1;C-=a[w].dist(x),x=a[w]}C+=a[w].dist(a[w+1]),w++;const A=[];let N=0;for(;C<l/2;){const j=a[w],H=a[w+1];if(!H)return!1;let Q=a[w-1].angleTo(j)-j.angleTo(H);for(Q=Math.abs((Q+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:C,angleDelta:Q}),N+=Q;C-A[0].distance>h;)N-=A.shift().angleDelta;if(N>g)return!1;w++,C+=j.dist(H)}return!0}function ew(a){let r=0;for(let l=0;l<a.length-1;l++)r+=a[l].dist(a[l+1]);return r}function tw(a,r,l){return a?.6*r*l:0}function nw(a,r){return Math.max(a?a.right-a.left:0,r?r.right-r.left:0)}function T4(a,r,l,h,g,x){const w=tw(l,g,x),C=nw(l,h)*x;let A=0;const N=ew(a)/2;for(let j=0;j<a.length-1;j++){const H=a[j],Q=a[j+1],te=H.dist(Q);if(A+te>N){const ne=(N-A)/te,_e=qn(H.x,Q.x,ne),me=qn(H.y,Q.y,ne),$e=new sl(_e,me,Q.angleTo(H),j);return $e._round(),!w||Qb(a,$e,C,w,r)?$e:void 0}A+=te}}function S4(a,r,l,h,g,x,w,C,A){const N=tw(h,x,w),j=nw(h,g),H=j*w,Q=a[0].x===0||a[0].x===A||a[0].y===0||a[0].y===A;return r-H<r/4&&(r=H+r/4),rw(a,Q?r/2*C%r:(j/2+2*x)*w*C%r,r,N,l,H,Q,!1,A)}function rw(a,r,l,h,g,x,w,C,A){const N=x/2,j=ew(a);let H=0,Q=r-l,te=[];for(let ne=0;ne<a.length-1;ne++){const _e=a[ne],me=a[ne+1],$e=_e.dist(me),qe=me.angleTo(_e);for(;Q+l<H+$e;){Q+=l;const Le=(Q-H)/$e,Ve=qn(_e.x,me.x,Le),st=qn(_e.y,me.y,Le);if(Ve>=0&&Ve<A&&st>=0&&st<A&&Q-N>=0&&Q+N<=j){const ot=new sl(Ve,st,qe,ne);ot._round(),h&&!Qb(a,ot,x,h,g)||te.push(ot)}}H+=$e}return C||te.length||w||(te=rw(a,H/2,l,h,g,x,w,!0,A)),te}function iw(a,r,l,h,g){const x=[];for(let w=0;w<a.length;w++){const C=a[w];let A;for(let N=0;N<C.length-1;N++){let j=C[N],H=C[N+1];j.x<r&&H.x<r||(j.x<r?j=new ze(r,j.y+(r-j.x)/(H.x-j.x)*(H.y-j.y))._round():H.x<r&&(H=new ze(r,j.y+(r-j.x)/(H.x-j.x)*(H.y-j.y))._round()),j.y<l&&H.y<l||(j.y<l?j=new ze(j.x+(l-j.y)/(H.y-j.y)*(H.x-j.x),l)._round():H.y<l&&(H=new ze(j.x+(l-j.y)/(H.y-j.y)*(H.x-j.x),l)._round()),j.x>=h&&H.x>=h||(j.x>=h?j=new ze(h,j.y+(h-j.x)/(H.x-j.x)*(H.y-j.y))._round():H.x>=h&&(H=new ze(h,j.y+(h-j.x)/(H.x-j.x)*(H.y-j.y))._round()),j.y>=g&&H.y>=g||(j.y>=g?j=new ze(j.x+(g-j.y)/(H.y-j.y)*(H.x-j.x),g)._round():H.y>=g&&(H=new ze(j.x+(g-j.y)/(H.y-j.y)*(H.x-j.x),g)._round()),A&&j.equals(A[A.length-1])||(A=[j],x.push(A)),A.push(H)))))}}return x}function ow(a,r,l,h){const g=[],x=a.image,w=x.pixelRatio,C=x.paddedRect.w-2,A=x.paddedRect.h-2,N=a.right-a.left,j=a.bottom-a.top,H=x.stretchX||[[0,C]],Q=x.stretchY||[[0,A]],te=(wt,Mt)=>wt+Mt[1]-Mt[0],ne=H.reduce(te,0),_e=Q.reduce(te,0),me=C-ne,$e=A-_e;let qe=0,Le=ne,Ve=0,st=_e,ot=0,Nt=me,Vt=0,It=$e;if(x.content&&h){const wt=x.content;qe=Sp(H,0,wt[0]),Ve=Sp(Q,0,wt[1]),Le=Sp(H,wt[0],wt[2]),st=Sp(Q,wt[1],wt[3]),ot=wt[0]-qe,Vt=wt[1]-Ve,Nt=wt[2]-wt[0]-Le,It=wt[3]-wt[1]-st}const St=(wt,Mt,kt,yt)=>{const Zt=kp(wt.stretch-qe,Le,N,a.left),Gt=Cp(wt.fixed-ot,Nt,wt.stretch,ne),dn=kp(Mt.stretch-Ve,st,j,a.top),Jn=Cp(Mt.fixed-Vt,It,Mt.stretch,_e),ir=kp(kt.stretch-qe,Le,N,a.left),zr=Cp(kt.fixed-ot,Nt,kt.stretch,ne),ko=kp(yt.stretch-Ve,st,j,a.top),si=Cp(yt.fixed-Vt,It,yt.stretch,_e),Ar=new ze(Zt,dn),Hr=new ze(ir,dn),li=new ze(ir,ko),_i=new ze(Zt,ko),Wi=new ze(Gt/w,Jn/w),Ir=new ze(zr/w,si/w),ci=r*Math.PI/180;if(ci){const Hi=Math.sin(ci),Zi=Math.cos(ci),cr=[Zi,-Hi,Hi,Zi];Ar._matMult(cr),Hr._matMult(cr),_i._matMult(cr),li._matMult(cr)}const xi=wt.stretch+wt.fixed,Oi=Mt.stretch+Mt.fixed;return{tl:Ar,tr:Hr,bl:_i,br:li,tex:{x:x.paddedRect.x+1+xi,y:x.paddedRect.y+1+Oi,w:kt.stretch+kt.fixed-xi,h:yt.stretch+yt.fixed-Oi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Wi,pixelOffsetBR:Ir,minFontScaleX:Nt/w/N,minFontScaleY:It/w/j,isSDF:l}};if(h&&(x.stretchX||x.stretchY)){const wt=aw(H,me,ne),Mt=aw(Q,$e,_e);for(let kt=0;kt<wt.length-1;kt++){const yt=wt[kt],Zt=wt[kt+1];for(let Gt=0;Gt<Mt.length-1;Gt++)g.push(St(yt,Mt[Gt],Zt,Mt[Gt+1]))}}else g.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:A+1}));return g}function Sp(a,r,l){let h=0;for(const g of a)h+=Math.max(r,Math.min(l,g[1]))-Math.max(r,Math.min(l,g[0]));return h}function aw(a,r,l){const h=[{fixed:-1,stretch:0}];for(const[g,x]of a){const w=h[h.length-1];h.push({fixed:g-w.stretch,stretch:w.stretch}),h.push({fixed:g-w.stretch,stretch:w.stretch+(x-g)})}return h.push({fixed:r+1,stretch:l}),h}function kp(a,r,l,h){return a/r*l+h}function Cp(a,r,l,h){return a-r*l/h}$t("Anchor",sl);class Pp{constructor(r,l,h,g,x,w,C,A,N,j){if(this.boxStartIndex=r.length,N){let H=w.top,Q=w.bottom;const te=w.collisionPadding;te&&(H-=te[1],Q+=te[3]);let ne=Q-H;ne>0&&(ne=Math.max(10,ne),this.circleDiameter=ne)}else{let H=w.top*C-A[0],Q=w.bottom*C+A[2],te=w.left*C-A[3],ne=w.right*C+A[1];const _e=w.collisionPadding;if(_e&&(te-=_e[0]*C,H-=_e[1]*C,ne+=_e[2]*C,Q+=_e[3]*C),j){const me=new ze(te,H),$e=new ze(ne,H),qe=new ze(te,Q),Le=new ze(ne,Q),Ve=j*Math.PI/180;me._rotate(Ve),$e._rotate(Ve),qe._rotate(Ve),Le._rotate(Ve),te=Math.min(me.x,$e.x,qe.x,Le.x),ne=Math.max(me.x,$e.x,qe.x,Le.x),H=Math.min(me.y,$e.y,qe.y,Le.y),Q=Math.max(me.y,$e.y,qe.y,Le.y)}r.emplaceBack(l.x,l.y,te,H,ne,Q,h,g,x)}this.boxEndIndex=r.length}}class k4{constructor(r=[],l=C4){if(this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:l,compare:h}=this,g=l[r];for(;r>0;){const x=r-1>>1,w=l[x];if(h(g,w)>=0)break;l[r]=w,r=x}l[r]=g}_down(r){const{data:l,compare:h}=this,g=this.length>>1,x=l[r];for(;r<g;){let w=1+(r<<1),C=l[w];const A=w+1;if(A<this.length&&h(l[A],C)<0&&(w=A,C=l[A]),h(C,x)>=0)break;l[r]=C,r=w}l[r]=x}}function C4(a,r){return a<r?-1:a>r?1:0}function P4(a,r=1,l=!1){let h=1/0,g=1/0,x=-1/0,w=-1/0;const C=a[0];for(let te=0;te<C.length;te++){const ne=C[te];(!te||ne.x<h)&&(h=ne.x),(!te||ne.y<g)&&(g=ne.y),(!te||ne.x>x)&&(x=ne.x),(!te||ne.y>w)&&(w=ne.y)}const A=Math.min(x-h,w-g);let N=A/2;const j=new k4([],A4);if(A===0)return new ze(h,g);for(let te=h;te<x;te+=A)for(let ne=g;ne<w;ne+=A)j.push(new _u(te+N,ne+N,N,a));let H=function(te){let ne=0,_e=0,me=0;const $e=te[0];for(let qe=0,Le=$e.length,Ve=Le-1;qe<Le;Ve=qe++){const st=$e[qe],ot=$e[Ve],Nt=st.x*ot.y-ot.x*st.y;_e+=(st.x+ot.x)*Nt,me+=(st.y+ot.y)*Nt,ne+=3*Nt}return new _u(_e/ne,me/ne,0,te)}(a),Q=j.length;for(;j.length;){const te=j.pop();(te.d>H.d||!H.d)&&(H=te,l&&console.log("found best %d after %d probes",Math.round(1e4*te.d)/1e4,Q)),te.max-H.d<=r||(N=te.h/2,j.push(new _u(te.p.x-N,te.p.y-N,N,a)),j.push(new _u(te.p.x+N,te.p.y-N,N,a)),j.push(new _u(te.p.x-N,te.p.y+N,N,a)),j.push(new _u(te.p.x+N,te.p.y+N,N,a)),Q+=4)}return l&&(console.log(`num probes: ${Q}`),console.log(`best distance: ${H.d}`)),H.p}function A4(a,r){return r.max-a.max}function _u(a,r,l,h){this.p=new ze(a,r),this.h=l,this.d=function(g,x){let w=!1,C=1/0;for(let A=0;A<x.length;A++){const N=x[A];for(let j=0,H=N.length,Q=H-1;j<H;Q=j++){const te=N[j],ne=N[Q];te.y>g.y!=ne.y>g.y&&g.x<(ne.x-te.x)*(g.y-te.y)/(ne.y-te.y)+te.x&&(w=!w),C=Math.min(C,pb(g,te,ne))}}return(w?1:-1)*Math.sqrt(C)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const Vg=Number.POSITIVE_INFINITY;function sw(a,r){return r[1]!==Vg?function(l,h,g){let x=0,w=0;switch(h=Math.abs(h),g=Math.abs(g),l){case"top-right":case"top-left":case"top":w=g-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-g}switch(l){case"top-right":case"bottom-right":case"right":x=-h;break;case"top-left":case"bottom-left":case"left":x=h}return[x,w]}(a,r[0],r[1]):function(l,h){let g=0,x=0;h<0&&(h=0);const w=h/Math.sqrt(2);switch(l){case"top-right":case"top-left":x=w-7;break;case"bottom-right":case"bottom-left":x=7-w;break;case"bottom":x=7-h;break;case"top":x=h-7}switch(l){case"top-right":case"bottom-right":g=-w;break;case"top-left":case"bottom-left":g=w;break;case"left":g=h;break;case"right":g=-h}return[g,x]}(a,r[0])}function jg(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function I4(a,r,l,h,g,x,w,C,A,N,j){let H=x.textMaxSize.evaluate(r,{});H===void 0&&(H=w);const Q=a.layers[0].layout,te=Q.get("icon-offset").evaluate(r,{},j),ne=cw(l.horizontal),_e=w/24,me=a.tilePixelRatio*_e,$e=a.tilePixelRatio*H/24,qe=a.tilePixelRatio*C,Le=a.tilePixelRatio*Q.get("symbol-spacing"),Ve=Q.get("text-padding")*a.tilePixelRatio,st=function(yt,Zt,Gt,dn=1){const Jn=yt.get("icon-padding").evaluate(Zt,{},Gt),ir=Jn&&Jn.values;return[ir[0]*dn,ir[1]*dn,ir[2]*dn,ir[3]*dn]}(Q,r,j,a.tilePixelRatio),ot=Q.get("text-max-angle")/180*Math.PI,Nt=Q.get("text-rotation-alignment")!=="viewport"&&Q.get("symbol-placement")!=="point",Vt=Q.get("icon-rotation-alignment")==="map"&&Q.get("symbol-placement")!=="point",It=Q.get("symbol-placement"),St=Le/2,wt=Q.get("icon-text-fit");let Mt;h&&wt!=="none"&&(a.allowVerticalPlacement&&l.vertical&&(Mt=Yb(h,l.vertical,wt,Q.get("icon-text-fit-padding"),te,_e)),ne&&(h=Yb(h,ne,wt,Q.get("icon-text-fit-padding"),te,_e)));const kt=(yt,Zt)=>{Zt.x<0||Zt.x>=$r||Zt.y<0||Zt.y>=$r||function(Gt,dn,Jn,ir,zr,ko,si,Ar,Hr,li,_i,Wi,Ir,ci,xi,Oi,Hi,Zi,cr,Zr,mn,lo,ui,bi,Vo){const la=Gt.addToLineVertexArray(dn,Jn);let ca,ps,jo,Co,Ki=0,ms=0,lh=0,Sw=0,Qg=-1,ey=-1;const gs={};let kw=Wr.exports(""),ty=0,ny=0;if(Ar._unevaluatedLayout.getValue("text-radial-offset")===void 0?[ty,ny]=Ar.layout.get("text-offset").evaluate(mn,{},bi).map(Xi=>Xi*ti):(ty=Ar.layout.get("text-radial-offset").evaluate(mn,{},bi)*ti,ny=Vg),Gt.allowVerticalPlacement&&ir.vertical){const Xi=Ar.layout.get("text-rotate").evaluate(mn,{},bi)+90;jo=new Pp(Hr,dn,li,_i,Wi,ir.vertical,Ir,ci,xi,Xi),si&&(Co=new Pp(Hr,dn,li,_i,Wi,si,Hi,Zi,xi,Xi))}if(zr){const Xi=Ar.layout.get("icon-rotate").evaluate(mn,{}),$a=Ar.layout.get("icon-text-fit")!=="none",ch=ow(zr,Xi,ui,$a),uh=si?ow(si,Xi,ui,$a):void 0;ps=new Pp(Hr,dn,li,_i,Wi,zr,Hi,Zi,!1,Xi),Ki=4*ch.length;const Aw=Gt.iconSizeData;let pc=null;Aw.kind==="source"?(pc=[fs*Ar.layout.get("icon-size").evaluate(mn,{})],pc[0]>ll&&V(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Aw.kind==="composite"&&(pc=[fs*lo.compositeIconSizes[0].evaluate(mn,{},bi),fs*lo.compositeIconSizes[1].evaluate(mn,{},bi)],(pc[0]>ll||pc[1]>ll)&&V(`${Gt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Gt.addSymbols(Gt.icon,ch,pc,Zr,cr,mn,s.WritingMode.none,dn,la.lineStartIndex,la.lineLength,-1,bi),Qg=Gt.icon.placedSymbolArray.length-1,uh&&(ms=4*uh.length,Gt.addSymbols(Gt.icon,uh,pc,Zr,cr,mn,s.WritingMode.vertical,dn,la.lineStartIndex,la.lineLength,-1,bi),ey=Gt.icon.placedSymbolArray.length-1)}const Cw=Object.keys(ir.horizontal);for(const Xi of Cw){const $a=ir.horizontal[Xi];if(!ca){kw=Wr.exports($a.text);const uh=Ar.layout.get("text-rotate").evaluate(mn,{},bi);ca=new Pp(Hr,dn,li,_i,Wi,$a,Ir,ci,xi,uh)}const ch=$a.positionedLines.length===1;if(lh+=lw(Gt,dn,$a,ko,Ar,xi,mn,Oi,la,ir.vertical?s.WritingMode.horizontal:s.WritingMode.horizontalOnly,ch?Cw:[Xi],gs,Qg,lo,bi),ch)break}ir.vertical&&(Sw+=lw(Gt,dn,ir.vertical,ko,Ar,xi,mn,Oi,la,s.WritingMode.vertical,["vertical"],gs,ey,lo,bi));const j4=ca?ca.boxStartIndex:Gt.collisionBoxArray.length,G4=ca?ca.boxEndIndex:Gt.collisionBoxArray.length,q4=jo?jo.boxStartIndex:Gt.collisionBoxArray.length,W4=jo?jo.boxEndIndex:Gt.collisionBoxArray.length,H4=ps?ps.boxStartIndex:Gt.collisionBoxArray.length,Z4=ps?ps.boxEndIndex:Gt.collisionBoxArray.length,K4=Co?Co.boxStartIndex:Gt.collisionBoxArray.length,X4=Co?Co.boxEndIndex:Gt.collisionBoxArray.length;let ua=-1;const Rp=(Xi,$a)=>Xi&&Xi.circleDiameter?Math.max(Xi.circleDiameter,$a):$a;ua=Rp(ca,ua),ua=Rp(jo,ua),ua=Rp(ps,ua),ua=Rp(Co,ua);const Pw=ua>-1?1:0;Pw&&(ua*=Vo/ti),Gt.glyphOffsetArray.length>=xu.MAX_GLYPHS&&V("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mn.sortKey!==void 0&&Gt.addToSortKeyRanges(Gt.symbolInstances.length,mn.sortKey),Gt.symbolInstances.emplaceBack(dn.x,dn.y,gs.right>=0?gs.right:-1,gs.center>=0?gs.center:-1,gs.left>=0?gs.left:-1,gs.vertical||-1,Qg,ey,kw,j4,G4,q4,W4,H4,Z4,K4,X4,li,lh,Sw,Ki,ms,Pw,0,Ir,ty,ny,ua)}(a,Zt,yt,l,h,g,Mt,a.layers[0],a.collisionBoxArray,r.index,r.sourceLayerIndex,a.index,me,[Ve,Ve,Ve,Ve],Nt,A,qe,st,Vt,te,r,x,N,j,w)};if(It==="line")for(const yt of iw(r.geometry,0,0,$r,$r)){const Zt=S4(yt,Le,ot,l.vertical||ne,h,24,$e,a.overscaling,$r);for(const Gt of Zt){const dn=ne;dn&&M4(a,dn.text,St,Gt)||kt(yt,Gt)}}else if(It==="line-center"){for(const yt of r.geometry)if(yt.length>1){const Zt=T4(yt,ot,l.vertical||ne,h,24,$e);Zt&&kt(yt,Zt)}}else if(r.type==="Polygon")for(const yt of Ig(r.geometry,0)){const Zt=P4(yt,16);kt(yt[0],new sl(Zt.x,Zt.y,0))}else if(r.type==="LineString")for(const yt of r.geometry)kt(yt,new sl(yt[0].x,yt[0].y,0));else if(r.type==="Point")for(const yt of r.geometry)for(const Zt of yt)kt([Zt],new sl(Zt.x,Zt.y,0))}const ll=32640;function lw(a,r,l,h,g,x,w,C,A,N,j,H,Q,te,ne){const _e=function(qe,Le,Ve,st,ot,Nt,Vt,It){const St=st.layout.get("text-rotate").evaluate(Nt,{})*Math.PI/180,wt=[];for(const Mt of Le.positionedLines)for(const kt of Mt.positionedGlyphs){if(!kt.rect)continue;const yt=kt.rect||{};let Zt=4,Gt=!0,dn=1,Jn=0;const ir=(ot||It)&&kt.vertical,zr=kt.metrics.advance*kt.scale/2;if(It&&Le.verticalizable){const cr=(kt.scale-1)*ti,Zr=(ti-kt.metrics.width*kt.scale)/2;Jn=Mt.lineOffset/2-(kt.imageName?-Zr:cr)}if(kt.imageName){const cr=Vt[kt.imageName];Gt=cr.sdf,dn=cr.pixelRatio,Zt=1/dn}const ko=ot?[kt.x+zr,kt.y]:[0,0];let si=ot?[0,0]:[kt.x+zr+Ve[0],kt.y+Ve[1]-Jn],Ar=[0,0];ir&&(Ar=si,si=[0,0]);const Hr=(kt.metrics.left-Zt)*kt.scale-zr+si[0],li=(-kt.metrics.top-Zt)*kt.scale+si[1],_i=Hr+yt.w*kt.scale/dn,Wi=li+yt.h*kt.scale/dn,Ir=new ze(Hr,li),ci=new ze(_i,li),xi=new ze(Hr,Wi),Oi=new ze(_i,Wi);if(ir){const cr=new ze(-zr,zr-wp),Zr=-Math.PI/2,mn=12-zr,lo=new ze(22-mn,-(kt.imageName?mn:0)),ui=new ze(...Ar);Ir._rotateAround(Zr,cr)._add(lo)._add(ui),ci._rotateAround(Zr,cr)._add(lo)._add(ui),xi._rotateAround(Zr,cr)._add(lo)._add(ui),Oi._rotateAround(Zr,cr)._add(lo)._add(ui)}if(St){const cr=Math.sin(St),Zr=Math.cos(St),mn=[Zr,-cr,cr,Zr];Ir._matMult(mn),ci._matMult(mn),xi._matMult(mn),Oi._matMult(mn)}const Hi=new ze(0,0),Zi=new ze(0,0);wt.push({tl:Ir,tr:ci,bl:xi,br:Oi,tex:yt,writingMode:Le.writingMode,glyphOffset:ko,sectionIndex:kt.sectionIndex,isSDF:Gt,pixelOffsetTL:Hi,pixelOffsetBR:Zi,minFontScaleX:0,minFontScaleY:0})}return wt}(0,l,C,g,x,w,h,a.allowVerticalPlacement),me=a.textSizeData;let $e=null;me.kind==="source"?($e=[fs*g.layout.get("text-size").evaluate(w,{})],$e[0]>ll&&V(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):me.kind==="composite"&&($e=[fs*te.compositeTextSizes[0].evaluate(w,{},ne),fs*te.compositeTextSizes[1].evaluate(w,{},ne)],($e[0]>ll||$e[1]>ll)&&V(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,_e,$e,C,x,w,N,r,A.lineStartIndex,A.lineLength,Q,ne);for(const qe of j)H[qe]=a.text.placedSymbolArray.length-1;return 4*_e.length}function cw(a){for(const r in a)return a[r];return null}function M4(a,r,l,h){const g=a.compareText;if(r in g){const x=g[r];for(let w=x.length-1;w>=0;w--)if(h.dist(x[w])<l)return!0}else g[r]=[];return g[r].push(h),!1}const D4=ol.VectorTileFeature.types,R4=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ap(a,r,l,h,g,x,w,C,A,N,j,H,Q){const te=C?Math.min(ll,Math.round(C[0])):0,ne=C?Math.min(ll,Math.round(C[1])):0;a.emplaceBack(r,l,Math.round(32*h),Math.round(32*g),x,w,(te<<1)+(A?1:0),ne,16*N,16*j,256*H,256*Q)}function Gg(a,r,l){a.emplaceBack(r.x,r.y,l),a.emplaceBack(r.x,r.y,l),a.emplaceBack(r.x,r.y,l),a.emplaceBack(r.x,r.y,l)}function L4(a){for(const r of a.sections)if(ip(r.text))return!0;return!1}class qg{constructor(r){this.layoutVertexArray=new Fo,this.indexArray=new Ri,this.programConfigurations=r,this.segments=new fn,this.dynamicLayoutVertexArray=new Eo,this.opacityVertexArray=new Uo,this.placedSymbolArray=new gt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,l,h,g){this.isEmpty()||(h&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,r4.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,i4.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,R4,!0),this.opacityVertexBuffer.itemSize=1),(h||g)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}$t("SymbolBuffers",qg);class Wg{constructor(r,l,h){this.layoutVertexArray=new r,this.layoutAttributes=l,this.indexArray=new h,this.segments=new fn,this.collisionVertexArray=new ao}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,o4.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}$t("CollisionBuffers",Wg);class xu{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(w=>w.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Tg([]),this.placementViewportMatrix=Tg([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jb(this.zoom,l["text-size"]),this.iconSizeData=Jb(this.zoom,l["icon-size"]);const h=this.layers[0].layout,g=h.get("symbol-sort-key"),x=h.get("symbol-z-order");this.canOverlap=Zg(h,"text-overlap","text-allow-overlap")!=="never"||Zg(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(w=>s.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=r.sourceID}createArrays(){this.text=new qg(new cc(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new qg(new cc(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new Tt,this.lineVertexArray=new Lt,this.symbolInstances=new Dt}calculateGlyphDependencies(r,l,h,g,x){for(let w=0;w<r.length;w++)if(l[r.charCodeAt(w)]=!0,(h||g)&&x){const C=ih[r.charAt(w)];C&&(l[C.charCodeAt(0)]=!0)}}populate(r,l,h){const g=this.layers[0],x=g.layout,w=x.get("text-font"),C=x.get("text-field"),A=x.get("icon-image"),N=(C.value.kind!=="constant"||C.value.value instanceof xe&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),j=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,H=x.get("symbol-sort-key");if(this.features=[],!N&&!j)return;const Q=l.iconDependencies,te=l.glyphDependencies,ne=l.availableImages,_e=new nr(this.zoom);for(const{feature:me,id:$e,index:qe,sourceLayerIndex:Le}of r){const Ve=g._featureFilter.needGeometry,st=dc(me,Ve);if(!g._featureFilter.filter(_e,st,h))continue;let ot,Nt;if(Ve||(st.geometry=uc(me)),N){const It=g.getValueAndResolveTokens("text-field",st,h,ne),St=xe.factory(It);L4(St)&&(this.hasRTLText=!0),(!this.hasRTLText||ac()==="unavailable"||this.hasRTLText&&oo.isParsed())&&(ot=s4(St,g,st))}if(j){const It=g.getValueAndResolveTokens("icon-image",st,h,ne);Nt=It instanceof Ce?It:Ce.fromString(It)}if(!ot&&!Nt)continue;const Vt=this.sortFeaturesByKey?H.evaluate(st,{},h):void 0;if(this.features.push({id:$e,text:ot,icon:Nt,index:qe,sourceLayerIndex:Le,geometry:st.geometry,properties:me.properties,type:D4[me.type],sortKey:Vt}),Nt&&(Q[Nt.name]=!0),ot){const It=w.evaluate(st,{},h).join(","),St=x.get("text-rotation-alignment")!=="viewport"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(s.WritingMode.vertical)>=0;for(const wt of ot.sections)if(wt.image)Q[wt.image.name]=!0;else{const Mt=lu(ot.toString()),kt=wt.fontStack||It,yt=te[kt]=te[kt]||{};this.calculateGlyphDependencies(wt.text,yt,St,this.allowVerticalPlacement,Mt)}}}x.get("symbol-placement")==="line"&&(this.features=function(me){const $e={},qe={},Le=[];let Ve=0;function st(It){Le.push(me[It]),Ve++}function ot(It,St,wt){const Mt=qe[It];return delete qe[It],qe[St]=Mt,Le[Mt].geometry[0].pop(),Le[Mt].geometry[0]=Le[Mt].geometry[0].concat(wt[0]),Mt}function Nt(It,St,wt){const Mt=$e[St];return delete $e[St],$e[It]=Mt,Le[Mt].geometry[0].shift(),Le[Mt].geometry[0]=wt[0].concat(Le[Mt].geometry[0]),Mt}function Vt(It,St,wt){const Mt=wt?St[0][St[0].length-1]:St[0][0];return`${It}:${Mt.x}:${Mt.y}`}for(let It=0;It<me.length;It++){const St=me[It],wt=St.geometry,Mt=St.text?St.text.toString():null;if(!Mt){st(It);continue}const kt=Vt(Mt,wt),yt=Vt(Mt,wt,!0);if(kt in qe&&yt in $e&&qe[kt]!==$e[yt]){const Zt=Nt(kt,yt,wt),Gt=ot(kt,yt,Le[Zt].geometry);delete $e[kt],delete qe[yt],qe[Vt(Mt,Le[Gt].geometry,!0)]=Gt,Le[Zt].geometry=null}else kt in qe?ot(kt,yt,wt):yt in $e?Nt(kt,yt,wt):(st(It),$e[kt]=Ve-1,qe[yt]=Ve-1)}return Le.filter(It=>It.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((me,$e)=>me.sortKey-$e.sortKey)}update(r,l,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,l,this.layers,h),this.icon.programConfigurations.updatePaintArrays(r,l,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,l){const h=this.lineVertexArray.length;if(r.segment!==void 0){let g=r.dist(l[r.segment+1]),x=r.dist(l[r.segment]);const w={};for(let C=r.segment+1;C<l.length;C++)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:g},C<l.length-1&&(g+=l[C+1].dist(l[C]));for(let C=r.segment||0;C>=0;C--)w[C]={x:l[C].x,y:l[C].y,tileUnitDistanceFromAnchor:x},C>0&&(x+=l[C-1].dist(l[C]));for(let C=0;C<l.length;C++){const A=w[C];this.lineVertexArray.emplaceBack(A.x,A.y,A.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(r,l,h,g,x,w,C,A,N,j,H,Q){const te=r.indexArray,ne=r.layoutVertexArray,_e=r.segments.prepareSegment(4*l.length,ne,te,this.canOverlap?w.sortKey:void 0),me=this.glyphOffsetArray.length,$e=_e.vertexLength,qe=this.allowVerticalPlacement&&C===s.WritingMode.vertical?Math.PI/2:0,Le=w.text&&w.text.sections;for(let Ve=0;Ve<l.length;Ve++){const{tl:st,tr:ot,bl:Nt,br:Vt,tex:It,pixelOffsetTL:St,pixelOffsetBR:wt,minFontScaleX:Mt,minFontScaleY:kt,glyphOffset:yt,isSDF:Zt,sectionIndex:Gt}=l[Ve],dn=_e.vertexLength,Jn=yt[1];Ap(ne,A.x,A.y,st.x,Jn+st.y,It.x,It.y,h,Zt,St.x,St.y,Mt,kt),Ap(ne,A.x,A.y,ot.x,Jn+ot.y,It.x+It.w,It.y,h,Zt,wt.x,St.y,Mt,kt),Ap(ne,A.x,A.y,Nt.x,Jn+Nt.y,It.x,It.y+It.h,h,Zt,St.x,wt.y,Mt,kt),Ap(ne,A.x,A.y,Vt.x,Jn+Vt.y,It.x+It.w,It.y+It.h,h,Zt,wt.x,wt.y,Mt,kt),Gg(r.dynamicLayoutVertexArray,A,qe),te.emplaceBack(dn,dn+1,dn+2),te.emplaceBack(dn+1,dn+2,dn+3),_e.vertexLength+=4,_e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yt[0]),Ve!==l.length-1&&Gt===l[Ve+1].sectionIndex||r.programConfigurations.populatePaintArrays(ne.length,w,w.index,{},Q,Le&&Le[Gt])}r.placedSymbolArray.emplaceBack(A.x,A.y,me,this.glyphOffsetArray.length-me,$e,N,j,A.segment,h?h[0]:0,h?h[1]:0,g[0],g[1],C,0,!1,0,H)}_addCollisionDebugVertex(r,l,h,g,x,w){return l.emplaceBack(0,0),r.emplaceBack(h.x,h.y,g,x,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(r,l,h,g,x,w,C){const A=x.segments.prepareSegment(4,x.layoutVertexArray,x.indexArray),N=A.vertexLength,j=x.layoutVertexArray,H=x.collisionVertexArray,Q=C.anchorX,te=C.anchorY;this._addCollisionDebugVertex(j,H,w,Q,te,new ze(r,l)),this._addCollisionDebugVertex(j,H,w,Q,te,new ze(h,l)),this._addCollisionDebugVertex(j,H,w,Q,te,new ze(h,g)),this._addCollisionDebugVertex(j,H,w,Q,te,new ze(r,g)),A.vertexLength+=4;const ne=x.indexArray;ne.emplaceBack(N,N+1),ne.emplaceBack(N+1,N+2),ne.emplaceBack(N+2,N+3),ne.emplaceBack(N+3,N),A.primitiveLength+=4}addDebugCollisionBoxes(r,l,h,g){for(let x=r;x<l;x++){const w=this.collisionBoxArray.get(x);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,g?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wg(Na,zb.members,aa),this.iconCollisionBox=new Wg(Na,zb.members,aa);for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(r,l,h,g,x,w,C,A,N){const j={};for(let H=l;H<h;H++){const Q=r.get(H);j.textBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},j.textFeatureIndex=Q.featureIndex;break}for(let H=g;H<x;H++){const Q=r.get(H);j.verticalTextBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},j.verticalTextFeatureIndex=Q.featureIndex;break}for(let H=w;H<C;H++){const Q=r.get(H);j.iconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},j.iconFeatureIndex=Q.featureIndex;break}for(let H=A;H<N;H++){const Q=r.get(H);j.verticalIconBox={x1:Q.x1,y1:Q.y1,x2:Q.x2,y2:Q.y2,anchorPointX:Q.anchorPointX,anchorPointY:Q.anchorPointY},j.verticalIconFeatureIndex=Q.featureIndex;break}return j}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const h=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,l){const h=r.placedSymbolArray.get(l),g=h.vertexStartIndex+4*h.numGlyphs;for(let x=h.vertexStartIndex;x<g;x+=4)r.indexArray.emplaceBack(x,x+1,x+2),r.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(r),h=Math.cos(r),g=[],x=[],w=[];for(let C=0;C<this.symbolInstances.length;++C){w.push(C);const A=this.symbolInstances.get(C);g.push(0|Math.round(l*A.anchorX+h*A.anchorY)),x.push(A.featureIndex)}return w.sort((C,A)=>g[C]-g[A]||x[A]-x[C]),w}addToSortKeyRanges(r,l){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===l?h.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const h=this.symbolInstances.get(l);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((g,x,w)=>{g>=0&&w.indexOf(g)===x&&this.addIndicesForPlacedSymbol(this.text,g)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}$t("SymbolBucket",xu,{omit:["layers","collisionBoxArray","features","compareText"]}),xu.MAX_GLYPHS=65535,xu.addDynamicAttributes=Gg;const N4=new ei({"symbol-placement":new jt(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new jt(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new jt(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Yt(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new jt(Ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new jt(Ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new jt(Ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new jt(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new jt(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new jt(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Yt(Ye.layout_symbol["icon-size"]),"icon-text-fit":new jt(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Yt(Ye.layout_symbol["icon-image"]),"icon-rotate":new Yt(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Yt(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new jt(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Yt(Ye.layout_symbol["icon-offset"]),"icon-anchor":new Yt(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new jt(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new jt(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new jt(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new Yt(Ye.layout_symbol["text-field"]),"text-font":new Yt(Ye.layout_symbol["text-font"]),"text-size":new Yt(Ye.layout_symbol["text-size"]),"text-max-width":new Yt(Ye.layout_symbol["text-max-width"]),"text-line-height":new jt(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Yt(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new Yt(Ye.layout_symbol["text-justify"]),"text-radial-offset":new Yt(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new jt(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new Yt(Ye.layout_symbol["text-anchor"]),"text-max-angle":new jt(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new jt(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new Yt(Ye.layout_symbol["text-rotate"]),"text-padding":new jt(Ye.layout_symbol["text-padding"]),"text-keep-upright":new jt(Ye.layout_symbol["text-keep-upright"]),"text-transform":new Yt(Ye.layout_symbol["text-transform"]),"text-offset":new Yt(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new jt(Ye.layout_symbol["text-allow-overlap"]),"text-overlap":new jt(Ye.layout_symbol["text-overlap"]),"text-ignore-placement":new jt(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new jt(Ye.layout_symbol["text-optional"])});var Hg={paint:new ei({"icon-opacity":new Yt(Ye.paint_symbol["icon-opacity"]),"icon-color":new Yt(Ye.paint_symbol["icon-color"]),"icon-halo-color":new Yt(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Yt(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Yt(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new jt(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new jt(Ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new Yt(Ye.paint_symbol["text-opacity"]),"text-color":new Yt(Ye.paint_symbol["text-color"],{runtimeType:er,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Yt(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new Yt(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Yt(Ye.paint_symbol["text-halo-blur"]),"text-translate":new jt(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new jt(Ye.paint_symbol["text-translate-anchor"])}),layout:N4};class uw{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:ai,this.defaultValue=r}evaluate(r){if(r.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(r.formattedSection))return l.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}$t("FormatSectionOverride",uw,{omit:["defaultValue"]});class Ip extends Bo{constructor(r){super(r,Hg)}recalculate(r,l){if(super.recalculate(r,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const g=[];for(const x of h)g.indexOf(x)<0&&g.push(x);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,l,h,g){const x=this.layout.get(r).evaluate(l,{},h,g),w=this._unevaluatedLayout._values[r];return w.isDataDriven()||Hl(w.value)||!x?x:function(C,A){return A.replace(/{([^{}]+)}/g,(N,j)=>j in C?String(C[j]):"")}(l.properties,x)}createBucket(r){return new xu(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Hg.paint.overridableProperties){if(!Ip.hasPaintOverride(this.layout,r))continue;const l=this.paint.get(r),h=new uw(l),g=new nu(h,l.property.specification);let x=null;x=l.value.kind==="constant"||l.value.kind==="source"?new Kl("source",g):new Dd("composite",g,l.value.zoomStops),this.paint._values[r]=new zo(l.property,x,l.parameters)}}_handleOverridablePaintPropertyUpdate(r,l,h){return!(!this.layout||l.isDataDriven()||h.isDataDriven())&&Ip.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,l){const h=r.get("text-field"),g=Hg.paint.properties[l];let x=!1;const w=C=>{for(const A of C)if(g.overrides&&g.overrides.hasOverride(A))return void(x=!0)};if(h.value.kind==="constant"&&h.value.value instanceof xe)w(h.value.value.sections);else if(h.value.kind==="source"){const C=N=>{x||(N instanceof Ut&&Ze(N.value)===zn?w(N.value.sections):N instanceof eu?w(N.sections):N.eachChild(C))},A=h.value;A._styleExpression&&C(A._styleExpression.expression)}return x}}function Zg(a,r,l){let h="never";const g=a.get(r);return g?h=g:a.get(l)&&(h="always"),h}var O4={paint:new ei({"background-color":new jt(Ye.paint_background["background-color"]),"background-pattern":new Gd(Ye.paint_background["background-pattern"]),"background-opacity":new jt(Ye.paint_background["background-opacity"])})},$4={paint:new ei({"raster-opacity":new jt(Ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new jt(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new jt(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new jt(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new jt(Ye.paint_raster["raster-saturation"]),"raster-contrast":new jt(Ye.paint_raster["raster-contrast"]),"raster-resampling":new jt(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new jt(Ye.paint_raster["raster-fade-duration"])})};class z4 extends Bo{constructor(r){super(r,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const B4={circle:class extends Bo{constructor(a){super(a,gI)}createBucket(a){return new bg(a)}queryRadius(a){const r=a;return Kd("circle-radius",this,r)+Kd("circle-stroke-width",this,r)+fp(this.paint.get("circle-translate"))}queryIntersectsFeature(a,r,l,h,g,x,w,C){const A=pp(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,w),N=this.paint.get("circle-radius").evaluate(r,l)+this.paint.get("circle-stroke-width").evaluate(r,l),j=this.paint.get("circle-pitch-alignment")==="map",H=j?A:function(te,ne){return te.map(_e=>bb(_e,ne))}(A,C),Q=j?N*w:N;for(const te of h)for(const ne of te){const _e=j?ne:bb(ne,C);let me=Q;const $e=mp([],[ne.x,ne.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?me*=$e[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(me*=x.cameraToCenterDistance/$e[3]),dI(H,_e,me))return!0}return!1}},heatmap:class extends Bo{constructor(a){super(a,vI),this._updateColorRamp()}createBucket(a){return new wb(a)}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Tb({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Bo{constructor(a){super(a,_I)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Bo{constructor(a){super(a,NI)}recalculate(a,r){super.recalculate(a,r);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new Rg(a)}queryRadius(){return fp(this.paint.get("fill-translate"))}queryIntersectsFeature(a,r,l,h,g,x,w){return fb(pp(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,w),h)}isTileClipped(){return!0}},"fill-extrusion":class extends Bo{constructor(a){super(a,KI)}createBucket(a){return new Ng(a)}queryRadius(){return fp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,r,l,h,g,x,w,C){const A=pp(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,w),N=this.paint.get("fill-extrusion-height").evaluate(r,l),j=this.paint.get("fill-extrusion-base").evaluate(r,l),H=function(te,ne,_e,me){const $e=[];for(const qe of te){const Le=[qe.x,qe.y,0,1];mp(Le,Le,ne),$e.push(new ze(Le[0]/Le[3],Le[1]/Le[3]))}return $e}(A,C),Q=function(te,ne,_e,me){const $e=[],qe=[],Le=me[8]*ne,Ve=me[9]*ne,st=me[10]*ne,ot=me[11]*ne,Nt=me[8]*_e,Vt=me[9]*_e,It=me[10]*_e,St=me[11]*_e;for(const wt of te){const Mt=[],kt=[];for(const yt of wt){const Zt=yt.x,Gt=yt.y,dn=me[0]*Zt+me[4]*Gt+me[12],Jn=me[1]*Zt+me[5]*Gt+me[13],ir=me[2]*Zt+me[6]*Gt+me[14],zr=me[3]*Zt+me[7]*Gt+me[15],ko=ir+st,si=zr+ot,Ar=dn+Nt,Hr=Jn+Vt,li=ir+It,_i=zr+St,Wi=new ze((dn+Le)/si,(Jn+Ve)/si);Wi.z=ko/si,Mt.push(Wi);const Ir=new ze(Ar/_i,Hr/_i);Ir.z=li/_i,kt.push(Ir)}$e.push(Mt),qe.push(kt)}return[$e,qe]}(h,j,N,C);return function(te,ne,_e){let me=1/0;fb(_e,ne)&&(me=Rb(_e,ne[0]));for(let $e=0;$e<ne.length;$e++){const qe=ne[$e],Le=te[$e];for(let Ve=0;Ve<qe.length-1;Ve++){const st=qe[Ve],ot=[st,qe[Ve+1],Le[Ve+1],Le[Ve],st];hb(_e,ot)&&(me=Math.min(me,Rb(_e,ot)))}}return me!==1/0&&me}(Q[0],Q[1],H)}},line:class extends Bo{constructor(a){super(a,Nb),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){a==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Qa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,r){super.recalculate(a,r),this.paint._values["line-floorwidth"]=Ob.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Og(a)}queryRadius(a){const r=a,l=$b(Kd("line-width",this,r),Kd("line-gap-width",this,r)),h=Kd("line-offset",this,r);return l/2+Math.abs(h)+fp(this.paint.get("line-translate"))}queryIntersectsFeature(a,r,l,h,g,x,w){const C=pp(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,w),A=w/2*$b(this.paint.get("line-width").evaluate(r,l),this.paint.get("line-gap-width").evaluate(r,l)),N=this.paint.get("line-offset").evaluate(r,l);return N&&(h=function(j,H){const Q=[];for(let te=0;te<j.length;te++){const ne=j[te],_e=[];for(let me=0;me<ne.length;me++){const $e=ne[me-1],qe=ne[me],Le=ne[me+1],Ve=me===0?new ze(0,0):qe.sub($e)._unit()._perp(),st=me===ne.length-1?new ze(0,0):Le.sub(qe)._unit()._perp(),ot=Ve._add(st)._unit(),Nt=ot.x*st.x+ot.y*st.y;Nt!==0&&ot._mult(1/Nt),_e.push(ot._mult(H)._add(qe))}Q.push(_e)}return Q}(h,N*w)),function(j,H,Q){for(let te=0;te<H.length;te++){const ne=H[te];if(j.length>=3){for(let _e=0;_e<ne.length;_e++)if(fu(j,ne[_e]))return!0}if(hI(j,ne,Q))return!0}return!1}(C,h,A)}isTileClipped(){return!0}},symbol:Ip,background:class extends Bo{constructor(a){super(a,O4)}},raster:class extends Bo{constructor(a){super(a,$4)}}};class F4{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const dw=63710088e-1;class gr{constructor(r,l){if(isNaN(r)||isNaN(l))throw new Error(`Invalid LngLat object: (${r}, ${l})`);if(this.lng=+r,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new gr(D(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const l=Math.PI/180,h=this.lat*l,g=r.lat*l,x=Math.sin(h)*Math.sin(g)+Math.cos(h)*Math.cos(g)*Math.cos((r.lng-this.lng)*l);return dw*Math.acos(Math.min(x,1))}toBounds(r=0){const l=360*r/40075017,h=l/Math.cos(Math.PI/180*this.lat);return new fc(new gr(this.lng-h,this.lat-l),new gr(this.lng+h,this.lat+l))}static convert(r){if(r instanceof gr)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new gr(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new gr(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class fc{constructor(r,l){r&&(l?this.setSouthWest(r).setNorthEast(l):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof gr?new gr(r.lng,r.lat):gr.convert(r),this}setSouthWest(r){return this._sw=r instanceof gr?new gr(r.lng,r.lat):gr.convert(r),this}extend(r){const l=this._sw,h=this._ne;let g,x;if(r instanceof gr)g=r,x=r;else{if(!(r instanceof fc))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(fc.convert(r)):this.extend(gr.convert(r)):this;if(g=r._sw,x=r._ne,!g||!x)return this}return l||h?(l.lng=Math.min(g.lng,l.lng),l.lat=Math.min(g.lat,l.lat),h.lng=Math.max(x.lng,h.lng),h.lat=Math.max(x.lat,h.lat)):(this._sw=new gr(g.lng,g.lat),this._ne=new gr(x.lng,x.lat)),this}getCenter(){return new gr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new gr(this.getWest(),this.getNorth())}getSouthEast(){return new gr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:l,lat:h}=gr.convert(r);let g=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&g}static convert(r){return r instanceof fc?r:r&&new fc(r)}}const hw=2*Math.PI*dw;function fw(a){return hw*Math.cos(a*Math.PI/180)}function pw(a){return(180+a)/360}function mw(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function gw(a,r){return a/fw(r)}function Kg(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}class Mp{constructor(r,l,h=0){this.x=+r,this.y=+l,this.z=+h}static fromLngLat(r,l=0){const h=gr.convert(r);return new Mp(pw(h.lng),mw(h.lat),gw(l,h.lat))}toLngLat(){return new gr(360*this.x-180,Kg(this.y))}toAltitude(){return this.z*fw(Kg(this.y))}meterInMercatorCoordinateUnits(){return 1/hw*(r=Kg(this.y),1/Math.cos(r*Math.PI/180));var r}}function yw(a,r,l){var h=2*Math.PI*6378137/256/Math.pow(2,l);return[a*h-2*Math.PI*6378137/2,r*h-2*Math.PI*6378137/2]}class Xg{constructor(r,l,h){if(r<0||r>25||h<0||h>=Math.pow(2,r)||l<0||l>=Math.pow(2,r))throw new Error(`x=${l}, y=${h}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=l,this.y=h,this.key=ah(0,r,r,l,h)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,l,h){const g=(w=this.y,C=this.z,A=yw(256*(x=this.x),256*(w=Math.pow(2,C)-w-1),C),N=yw(256*(x+1),256*(w+1),C),A[0]+","+A[1]+","+N[0]+","+N[1]);var x,w,C,A,N;const j=function(H,Q,te){let ne,_e="";for(let me=H;me>0;me--)ne=1<<me-1,_e+=(Q&ne?1:0)+(te&ne?2:0);return _e}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,j).replace(/{bbox-epsg-3857}/g,g)}isChildOf(r){const l=this.z-r.z;return l>0&&r.x===this.x>>l&&r.y===this.y>>l}getTilePoint(r){const l=Math.pow(2,this.z);return new ze((r.x*l-this.x)*$r,(r.y*l-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vw{constructor(r,l){this.wrap=r,this.canonical=l,this.key=ah(r,l.z,l.z,l.x,l.y)}}class So{constructor(r,l,h,g,x){if(r<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${h}`);this.overscaledZ=r,this.wrap=l,this.canonical=new Xg(h,+g,+x),this.key=ah(l,r,h,g,x)}clone(){return new So(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-r;return r>this.canonical.z?new So(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new So(r,this.wrap,r,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(r,l){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-r;return r>this.canonical.z?ah(this.wrap*+l,r,this.canonical.z,this.canonical.x,this.canonical.y):ah(this.wrap*+l,r,r,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const l=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>l&&r.canonical.y===this.canonical.y>>l}children(r){if(this.overscaledZ>=r)return[new So(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,h=2*this.canonical.x,g=2*this.canonical.y;return[new So(l,this.wrap,l,h,g),new So(l,this.wrap,l,h+1,g),new So(l,this.wrap,l,h,g+1),new So(l,this.wrap,l,h+1,g+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new So(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new So(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Mp(r.x-this.wrap,r.y))}}function ah(a,r,l,h,g){(a*=2)<0&&(a=-1*a-1);const x=1<<l;return(x*x*a+x*g+h).toString(36)+l.toString(36)+r.toString(36)}$t("CanonicalTileID",Xg),$t("OverscaledTileID",So,{omit:["posMatrix"]});class _w{constructor(r,l,h){if(this.uid=r,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void V(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const g=this.dim=l.height-2;this.data=new Uint32Array(l.data.buffer),this.encoding=h||"mapbox";for(let x=0;x<g;x++)this.data[this._idx(-1,x)]=this.data[this._idx(0,x)],this.data[this._idx(g,x)]=this.data[this._idx(g-1,x)],this.data[this._idx(x,-1)]=this.data[this._idx(x,0)],this.data[this._idx(x,g)]=this.data[this._idx(x,g-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(g,-1)]=this.data[this._idx(g-1,0)],this.data[this._idx(-1,g)]=this.data[this._idx(0,g-1)],this.data[this._idx(g,g)]=this.data[this._idx(g-1,g-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let x=0;x<g;x++)for(let w=0;w<g;w++){const C=this.get(x,w);C>this.max&&(this.max=C),C<this.min&&(this.min=C)}}get(r,l){const h=new Uint8Array(this.data.buffer),g=4*this._idx(r,l);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[g],h[g+1],h[g+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(r,l){if(r<-1||r>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(r+1)}_unpackMapbox(r,l,h){return(256*r*256+256*l+h)/10-1e4}_unpackTerrarium(r,l,h){return 256*r+l+h/256-32768}getPixels(){return new To({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,l,h){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let g=l*this.dim,x=l*this.dim+this.dim,w=h*this.dim,C=h*this.dim+this.dim;switch(l){case-1:g=x-1;break;case 1:x=g+1}switch(h){case-1:w=C-1;break;case 1:C=w+1}const A=-l*this.dim,N=-h*this.dim;for(let j=w;j<C;j++)for(let H=g;H<x;H++)this.data[this._idx(H,j)]=r.data[this._idx(H+A,j+N)]}}$t("DEMData",_w);class xw{constructor(r){this._stringToNumber={},this._numberToString=[];for(let l=0;l<r.length;l++){const h=r[l];this._stringToNumber[h]=l,this._numberToString[l]=h}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class bw{constructor(r,l,h,g,x){this.type="Feature",this._vectorTileFeature=r,r._z=l,r._x=h,r._y=g,this.properties=r.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(r[l]=this[l]);return r}}class ww{constructor(r,l){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new oc($r,16,0),this.grid3D=new oc($r,16,0),this.featureIndexArray=new un,this.promoteId=l}insert(r,l,h,g,x,w){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,g,x);const A=w?this.grid3D:this.grid;for(let N=0;N<l.length;N++){const j=l[N],H=[1/0,1/0,-1/0,-1/0];for(let Q=0;Q<j.length;Q++){const te=j[Q];H[0]=Math.min(H[0],te.x),H[1]=Math.min(H[1],te.y),H[2]=Math.max(H[2],te.x),H[3]=Math.max(H[3],te.y)}H[0]<$r&&H[1]<$r&&H[2]>=0&&H[3]>=0&&A.insert(C,H[0],H[1],H[2],H[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ol.VectorTile(new $g(this.rawTileData)).layers,this.sourceLayerCoder=new xw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,l,h,g){this.loadVTLayers();const x=r.params||{},w=$r/r.tileSize/r.scale,C=ou(x.filter),A=r.queryGeometry,N=r.queryPadding*w,j=Tw(A),H=this.grid.query(j.minX-N,j.minY-N,j.maxX+N,j.maxY+N),Q=Tw(r.cameraQueryGeometry),te=this.grid3D.query(Q.minX-N,Q.minY-N,Q.maxX+N,Q.maxY+N,(me,$e,qe,Le)=>function(Ve,st,ot,Nt,Vt){for(const St of Ve)if(st<=St.x&&ot<=St.y&&Nt>=St.x&&Vt>=St.y)return!0;const It=[new ze(st,ot),new ze(st,Vt),new ze(Nt,Vt),new ze(Nt,ot)];if(Ve.length>2){for(const St of It)if(fu(Ve,St))return!0}for(let St=0;St<Ve.length-1;St++)if(pI(Ve[St],Ve[St+1],It))return!0;return!1}(r.cameraQueryGeometry,me-N,$e-N,qe+N,Le+N));for(const me of te)H.push(me);H.sort(U4);const ne={};let _e;for(let me=0;me<H.length;me++){const $e=H[me];if($e===_e)continue;_e=$e;const qe=this.featureIndexArray.get($e);let Le=null;this.loadMatchingFeature(ne,qe.bucketIndex,qe.sourceLayerIndex,qe.featureIndex,C,x.layers,x.availableImages,l,h,g,(Ve,st,ot)=>(Le||(Le=uc(Ve)),st.queryIntersectsFeature(A,Ve,ot,Le,this.z,r.transform,w,r.pixelPosMatrix)))}return ne}loadMatchingFeature(r,l,h,g,x,w,C,A,N,j,H){const Q=this.bucketLayerIDs[l];if(w&&!function(me,$e){for(let qe=0;qe<me.length;qe++)if($e.indexOf(me[qe])>=0)return!0;return!1}(w,Q))return;const te=this.sourceLayerCoder.decode(h),ne=this.vtLayers[te].feature(g);if(x.needGeometry){const me=dc(ne,!0);if(!x.filter(new nr(this.tileID.overscaledZ),me,this.tileID.canonical))return}else if(!x.filter(new nr(this.tileID.overscaledZ),ne))return;const _e=this.getId(ne,te);for(let me=0;me<Q.length;me++){const $e=Q[me];if(w&&w.indexOf($e)<0)continue;const qe=A[$e];if(!qe)continue;let Le={};_e&&j&&(Le=j.getState(qe.sourceLayer||"_geojsonTileLayer",_e));const Ve=O({},N[$e]);Ve.paint=Ew(Ve.paint,qe.paint,ne,Le,C),Ve.layout=Ew(Ve.layout,qe.layout,ne,Le,C);const st=!H||H(ne,qe,Le);if(!st)continue;const ot=new bw(ne,this.z,this.x,this.y,_e);ot.layer=Ve;let Nt=r[$e];Nt===void 0&&(Nt=r[$e]=[]),Nt.push({featureIndex:g,feature:ot,intersectionZ:st})}}lookupSymbolFeatures(r,l,h,g,x,w,C,A){const N={};this.loadVTLayers();const j=ou(x);for(const H of r)this.loadMatchingFeature(N,h,g,H,j,w,C,A,l);return N}hasLayer(r){for(const l of this.bucketLayerIDs)for(const h of l)if(r===h)return!0;return!1}getId(r,l){let h=r.id;return this.promoteId&&(h=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof h=="boolean"&&(h=Number(h))),h}}function Ew(a,r,l,h,g){return $(a,(x,w)=>{const C=r instanceof lc?r.get(w):null;return C&&C.evaluate?C.evaluate(l,h,g):C})}function Tw(a){let r=1/0,l=1/0,h=-1/0,g=-1/0;for(const x of a)r=Math.min(r,x.x),l=Math.min(l,x.y),h=Math.max(h,x.x),g=Math.max(g,x.y);return{minX:r,minY:l,maxX:h,maxY:g}}function U4(a,r){return r-a}var Yg;$t("FeatureIndex",ww,{omit:["rawTileData","sourceLayerCoder"]}),s.PerformanceMarkers=void 0,(Yg=s.PerformanceMarkers||(s.PerformanceMarkers={})).create="create",Yg.load="load",Yg.fullLoad="fullLoad";let Dp=null,sh=[];const Jg=1e3/30,V4={mark(a){performance.mark(a)},frame(a){const r=a;Dp!=null&&sh.push(r-Dp),Dp=r},clearMetrics(){Dp=null,sh=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const a in s.PerformanceMarkers)performance.clearMarks(s.PerformanceMarkers[a])},getPerformanceMetrics(){performance.measure("loadTime",s.PerformanceMarkers.create,s.PerformanceMarkers.load),performance.measure("fullLoadTime",s.PerformanceMarkers.create,s.PerformanceMarkers.fullLoad);const a=performance.getEntriesByName("loadTime")[0].duration,r=performance.getEntriesByName("fullLoadTime")[0].duration,l=sh.length,h=1/(sh.reduce((x,w)=>x+w,0)/l/1e3),g=sh.filter(x=>x>Jg).reduce((x,w)=>x+(w-Jg)/Jg,0);return{loadTime:a,fullLoadTime:r,fps:h,percentDroppedFrames:g/(l+g)*100}}};s.AJAXError=lt,s.ARRAY_TYPE=Ni,s.Actor=class{constructor(a,r,l){this.target=a,this.parent=r,this.mapId=l,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},U(["receive","process"],this),this.invoker=new F4(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=W()?a:window}send(a,r,l,h,g=!1){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(this.callbacks[x]=l);const w=Ne(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:a,hasCallback:!!l,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:as(r,w)},w),{cancel:()=>{l&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(a){const r=a.data,l=r.id;if(l&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){delete this.tasks[l];const h=this.cancelCallbacks[l];delete this.cancelCallbacks[l],h&&h()}else W()||r.mustQueue?(this.tasks[l]=r,this.taskQueue.push(l),this.invoker.trigger()):this.processTask(l,r)}process(){if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),r=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),r&&this.processTask(a,r)}processTask(a,r){if(r.type==="<response>"){const l=this.callbacks[a];delete this.callbacks[a],l&&(r.error?l(Ia(r.error)):l(null,Ia(r.data)))}else{let l=!1;const h=Ne(this.globalScope)?void 0:[],g=r.hasCallback?(C,A)=>{l=!0,delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:C?as(C):null,data:as(A,h)},h)}:C=>{l=!0};let x=null;const w=Ia(r.data);if(this.parent[r.type])x=this.parent[r.type](r.sourceMapId,w,g);else if(this.parent.getWorkerSource){const C=r.type.split(".");x=this.parent.getWorkerSource(r.sourceMapId,C[0],w.source)[C[1]](w,g)}else g(new Error(`Could not find function ${r.type}`));!l&&x&&x.cancel&&(this.cancelCallbacks[a]=x.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.AlphaImage=Yd,s.CanonicalTileID=Xg,s.CollisionBoxArray=et,s.CollisionCircleLayoutArray=class extends q{},s.Color=oe,s.DEMData=_w,s.DataConstantProperty=jt,s.DictionaryCoder=xw,s.EXTENT=$r,s.ErrorEvent=Jr,s.EvaluationParameters=nr,s.Event=Qn,s.Evented=xr,s.FeatureIndex=ww,s.FillBucket=Rg,s.FillExtrusionBucket=Ng,s.GeoJSONFeature=bw,s.ImageAtlas=Wb,s.ImagePosition=Bg,s.LineBucket=Og,s.LineStripIndexArray=class extends pe{},s.LngLat=gr,s.LngLatBounds=fc,s.MercatorCoordinate=Mp,s.ONE_EM=ti,s.OverscaledTileID=So,s.PerformanceUtils=V4,s.PosArray=Ht,s.Properties=ei,s.QuadTriangleArray=class extends ee{},s.RGBAImage=To,s.RasterBoundsArray=class extends m{},s.RequestPerformance=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},s.ResourceType=Pe,s.SegmentVector=fn,s.SymbolBucket=xu,s.Transitionable=sp,s.TriangleIndexArray=Ri,s.Uniform1f=us,s.Uniform1i=class extends cs{constructor(a,r){super(a,r),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},s.Uniform2f=class extends cs{constructor(a,r){super(a,r),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},s.Uniform3f=class extends cs{constructor(a,r){super(a,r),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},s.Uniform4f=du,s.UniformColor=lb,s.UniformMatrix4f=class extends cs{constructor(a,r){super(a,r),this.current=cI}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let r=1;r<16;r++)if(a[r]!==this.current[r]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},s.UnwrappedTileID=vw,s.ValidationError=_t,s.ZoomHistory=Od,s.add=function(a,r,l){return a[0]=r[0]+l[0],a[1]=r[1]+l[1],a[2]=r[2]+l[2],a},s.addDynamicAttributes=Gg,s.asyncAll=function(a,r,l){if(!a.length)return l(null,[]);let h=a.length;const g=new Array(a.length);let x=null;a.forEach((w,C)=>{r(w,(A,N)=>{A&&(x=A),g[C]=N,--h==0&&l(x,g)})})},s.bezier=E,s.bindAll=U,s.cacheEntryPossiblyAdded=function(a){X++,X>Rt&&(a.getActor().send("enforceCacheSizeLimit",Qe),X=0)},s.clamp=S,s.clearTileCache=function(a){const r=caches.delete(Ae);a&&r.catch(a).then(()=>a())},s.clipLine=iw,s.clone=function(a){var r=new Ni(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r},s.clone$1=F,s.clone$2=function(a){var r=new Ni(3);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r},s.collisionCircleLayout=a4,s.config=We,s.copy=function(a,r){return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a},s.create=function(){var a=new Ni(16);return Ni!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},s.create$1=gb,s.createExpression=Zl,s.createFilter=ou,s.createLayout=Pr,s.createStyleLayer=function(a){return a.type==="custom"?new z4(a):new B4[a.type](a)},s.cross=function(a,r,l){var h=r[0],g=r[1],x=r[2],w=l[0],C=l[1],A=l[2];return a[0]=g*A-x*C,a[1]=x*w-h*A,a[2]=h*C-g*w,a},s.dot=function(a,r){return a[0]*r[0]+a[1]*r[1]+a[2]*r[2]},s.dot$1=function(a,r){return a[0]*r[0]+a[1]*r[1]+a[2]*r[2]+a[3]*r[3]},s.ease=T,s.emitValidationErrors=su,s.enforceCacheSizeLimit=function(a){zt(),He&&He.then(r=>{r.keys().then(l=>{for(let h=0;h<l.length-a;h++)r.delete(l[h])})})},s.equals=function(a,r){var l=a[0],h=a[1],g=a[2],x=a[3],w=a[4],C=a[5],A=a[6],N=a[7],j=a[8],H=a[9],Q=a[10],te=a[11],ne=a[12],_e=a[13],me=a[14],$e=a[15],qe=r[0],Le=r[1],Ve=r[2],st=r[3],ot=r[4],Nt=r[5],Vt=r[6],It=r[7],St=r[8],wt=r[9],Mt=r[10],kt=r[11],yt=r[12],Zt=r[13],Gt=r[14],dn=r[15];return Math.abs(l-qe)<=Li*Math.max(1,Math.abs(l),Math.abs(qe))&&Math.abs(h-Le)<=Li*Math.max(1,Math.abs(h),Math.abs(Le))&&Math.abs(g-Ve)<=Li*Math.max(1,Math.abs(g),Math.abs(Ve))&&Math.abs(x-st)<=Li*Math.max(1,Math.abs(x),Math.abs(st))&&Math.abs(w-ot)<=Li*Math.max(1,Math.abs(w),Math.abs(ot))&&Math.abs(C-Nt)<=Li*Math.max(1,Math.abs(C),Math.abs(Nt))&&Math.abs(A-Vt)<=Li*Math.max(1,Math.abs(A),Math.abs(Vt))&&Math.abs(N-It)<=Li*Math.max(1,Math.abs(N),Math.abs(It))&&Math.abs(j-St)<=Li*Math.max(1,Math.abs(j),Math.abs(St))&&Math.abs(H-wt)<=Li*Math.max(1,Math.abs(H),Math.abs(wt))&&Math.abs(Q-Mt)<=Li*Math.max(1,Math.abs(Q),Math.abs(Mt))&&Math.abs(te-kt)<=Li*Math.max(1,Math.abs(te),Math.abs(kt))&&Math.abs(ne-yt)<=Li*Math.max(1,Math.abs(ne),Math.abs(yt))&&Math.abs(_e-Zt)<=Li*Math.max(1,Math.abs(_e),Math.abs(Zt))&&Math.abs(me-Gt)<=Li*Math.max(1,Math.abs(me),Math.abs(Gt))&&Math.abs($e-dn)<=Li*Math.max(1,Math.abs($e),Math.abs(dn))},s.evaluateSizeForFeature=function(a,{uSize:r,uSizeT:l},{lowerSize:h,upperSize:g}){return a.kind==="source"?h/fs:a.kind==="composite"?qn(h/fs,g/fs,l):r},s.evaluateSizeForZoom=function(a,r){let l=0,h=0;if(a.kind==="constant")h=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:x,maxZoom:w}=a,C=g?S(Me.interpolationFactor(g,r,x,w),0,1):0;a.kind==="camera"?h=qn(a.minSize,a.maxSize,C):l=C}return{uSizeT:l,uSize:h}},s.evaluateVariableOffset=sw,s.evented=jd,s.exported=Oe,s.exported$1=tt,s.extend=O,s.filterObject=L,s.fromRotation=function(a,r){var l=Math.sin(r),h=Math.cos(r);return a[0]=h,a[1]=l,a[2]=0,a[3]=-l,a[4]=h,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},s.fromScaling=function(a,r){return a[0]=r[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=r[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},s.getAnchorAlignment=Ug,s.getAnchorJustification=jg,s.getArrayBuffer=Ke,s.getImage=on,s.getJSON=function(a,r){return Fe(O(a,{type:"json"}),r)},s.getOverlapMode=Zg,s.getRTLTextPluginStatus=ac,s.getReferrer=dt,s.getVideo=function(a,r){const l=window.document.createElement("video");l.muted=!0,l.onloadstart=function(){r(null,l)};for(let h=0;h<a.length;h++){const g=window.document.createElement("source");it(a[h])||(l.crossOrigin="Anonymous"),g.src=a[h],l.appendChild(g)}return{cancel:()=>{}}},s.identity=Tg,s.invert=function(a,r){var l=r[0],h=r[1],g=r[2],x=r[3],w=r[4],C=r[5],A=r[6],N=r[7],j=r[8],H=r[9],Q=r[10],te=r[11],ne=r[12],_e=r[13],me=r[14],$e=r[15],qe=l*C-h*w,Le=l*A-g*w,Ve=l*N-x*w,st=h*A-g*C,ot=h*N-x*C,Nt=g*N-x*A,Vt=j*_e-H*ne,It=j*me-Q*ne,St=j*$e-te*ne,wt=H*me-Q*_e,Mt=H*$e-te*_e,kt=Q*$e-te*me,yt=qe*kt-Le*Mt+Ve*wt+st*St-ot*It+Nt*Vt;return yt?(a[0]=(C*kt-A*Mt+N*wt)*(yt=1/yt),a[1]=(g*Mt-h*kt-x*wt)*yt,a[2]=(_e*Nt-me*ot+$e*st)*yt,a[3]=(Q*ot-H*Nt-te*st)*yt,a[4]=(A*St-w*kt-N*It)*yt,a[5]=(l*kt-g*St+x*It)*yt,a[6]=(me*Ve-ne*Nt-$e*Le)*yt,a[7]=(j*Nt-Q*Ve+te*Le)*yt,a[8]=(w*Mt-C*St+N*Vt)*yt,a[9]=(h*St-l*Mt-x*Vt)*yt,a[10]=(ne*ot-_e*Ve+$e*qe)*yt,a[11]=(H*Ve-j*ot-te*qe)*yt,a[12]=(C*It-w*wt-A*Vt)*yt,a[13]=(l*wt-h*It+g*Vt)*yt,a[14]=(_e*Le-ne*st-me*qe)*yt,a[15]=(j*st-H*Le+Q*qe)*yt,a):null},s.isImageBitmap=Ee,s.isSafari=Ne,s.isWorker=W,s.keysDifference=function(a,r){const l=[];for(const h in a)h in r||l.push(h);return l},s.lazyLoadRTLTextPlugin=function(){oo.isLoading()||oo.isLoaded()||ac()!=="deferred"||ap()},s.makeRequest=Fe,s.mapObject=$,s.mercatorXfromLng=pw,s.mercatorYfromLat=mw,s.mercatorZfromAltitude=gw,s.mul=yI,s.mul$1=function(a,r,l){return a[0]=r[0]*l[0],a[1]=r[1]*l[1],a[2]=r[2]*l[2],a[3]=r[3]*l[3],a},s.multiply=yb,s.nextPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},s.normalize=function(a,r){var l=r[0],h=r[1],g=r[2],x=l*l+h*h+g*g;return x>0&&(x=1/Math.sqrt(x)),a[0]=r[0]*x,a[1]=r[1]*x,a[2]=r[2]*x,a},s.number=qn,s.ortho=function(a,r,l,h,g,x,w){var C=1/(r-l),A=1/(h-g),N=1/(x-w);return a[0]=-2*C,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*A,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*N,a[11]=0,a[12]=(r+l)*C,a[13]=(g+h)*A,a[14]=(w+x)*N,a[15]=1,a},s.parseCacheControl=le,s.parseGlyphPbf=function(a){return new $g(a).readFields(y4,[])},s.pbf=$g,s.performSymbolLayout=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=$r/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const r=a.bucket.layers[0].layout,l=a.bucket.layers[0]._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new nr(a.bucket.zoom+1),a.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new nr(a.bucket.zoom+1),a.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new nr(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:A,maxZoom:N}=a.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new nr(A),a.canonical),l["text-size"].possiblyEvaluate(new nr(N),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:A,maxZoom:N}=a.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new nr(A),a.canonical),l["icon-size"].possiblyEvaluate(new nr(N),a.canonical)]}const g=r.get("text-line-height")*ti,x=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",w=r.get("text-keep-upright"),C=r.get("text-size");for(const A of a.bucket.features){const N=r.get("text-font").evaluate(A,{},a.canonical).join(","),j=C.evaluate(A,{},a.canonical),H=h.layoutTextSize.evaluate(A,{},a.canonical),Q=h.layoutIconSize.evaluate(A,{},a.canonical),te={horizontal:{},vertical:void 0},ne=A.text;let _e,me=[0,0];if(ne){const Le=ne.toString(),Ve=r.get("text-letter-spacing").evaluate(A,{},a.canonical)*ti,st=gg(Le)?Ve:0,ot=r.get("text-anchor").evaluate(A,{},a.canonical),Nt=r.get("text-variable-anchor");if(!Nt){const Mt=r.get("text-radial-offset").evaluate(A,{},a.canonical);me=Mt?sw(ot,[Mt*ti,Vg]):r.get("text-offset").evaluate(A,{},a.canonical).map(kt=>kt*ti)}let Vt=x?"center":r.get("text-justify").evaluate(A,{},a.canonical);const It=r.get("symbol-placement"),St=It==="point"?r.get("text-max-width").evaluate(A,{},a.canonical)*ti:0,wt=()=>{a.bucket.allowVerticalPlacement&&lu(Le)&&(te.vertical=Ep(ne,a.glyphMap,a.glyphPositions,a.imagePositions,N,St,g,ot,"left",st,me,s.WritingMode.vertical,!0,It,H,j))};if(!x&&Nt){const Mt=Vt==="auto"?Nt.map(yt=>jg(yt)):[Vt];let kt=!1;for(let yt=0;yt<Mt.length;yt++){const Zt=Mt[yt];if(!te.horizontal[Zt])if(kt)te.horizontal[Zt]=te.horizontal[0];else{const Gt=Ep(ne,a.glyphMap,a.glyphPositions,a.imagePositions,N,St,g,"center",Zt,st,me,s.WritingMode.horizontal,!1,It,H,j);Gt&&(te.horizontal[Zt]=Gt,kt=Gt.positionedLines.length===1)}}wt()}else{Vt==="auto"&&(Vt=jg(ot));const Mt=Ep(ne,a.glyphMap,a.glyphPositions,a.imagePositions,N,St,g,ot,Vt,st,me,s.WritingMode.horizontal,!1,It,H,j);Mt&&(te.horizontal[Vt]=Mt),wt(),lu(Le)&&x&&w&&(te.vertical=Ep(ne,a.glyphMap,a.glyphPositions,a.imagePositions,N,St,g,ot,Vt,st,me,s.WritingMode.vertical,!1,It,H,j))}}let $e=!1;if(A.icon&&A.icon.name){const Le=a.imageMap[A.icon.name];Le&&(_e=E4(a.imagePositions[A.icon.name],r.get("icon-offset").evaluate(A,{},a.canonical),r.get("icon-anchor").evaluate(A,{},a.canonical)),$e=!!Le.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=$e:a.bucket.sdfIcons!==$e&&V("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const qe=cw(te.horizontal)||te.vertical;a.bucket.iconsInText=!!qe&&qe.iconsInText,(qe||_e)&&I4(a.bucket,A,te,_e,a.imageMap,h,H,Q,me,$e,a.canonical)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},s.perspective=function(a,r,l,h,g){var x,w=1/Math.tan(r/2);return a[0]=w/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=w,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+h)*(x=1/(h-g)),a[14]=2*g*h*x):(a[10]=-1,a[14]=-2*h),a},s.pick=function(a,r){const l={};for(let h=0;h<r.length;h++){const g=r[h];g in a&&(l[g]=a[g])}return l},s.plugin=oo,s.pointGeometry=ze,s.polygonIntersectsPolygon=hb,s.potpack=qb,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.register=$t,s.registerForPluginStateChange=function(a){return a({pluginStatus:Di,pluginURL:Ma}),jd.on("pluginStateChange",a),a},s.renderColorRamp=Tb,s.rotateX=function(a,r,l){var h=Math.sin(l),g=Math.cos(l),x=r[4],w=r[5],C=r[6],A=r[7],N=r[8],j=r[9],H=r[10],Q=r[11];return r!==a&&(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[4]=x*g+N*h,a[5]=w*g+j*h,a[6]=C*g+H*h,a[7]=A*g+Q*h,a[8]=N*g-x*h,a[9]=j*g-w*h,a[10]=H*g-C*h,a[11]=Q*g-A*h,a},s.rotateZ=function(a,r,l){var h=Math.sin(l),g=Math.cos(l),x=r[0],w=r[1],C=r[2],A=r[3],N=r[4],j=r[5],H=r[6],Q=r[7];return r!==a&&(a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=x*g+N*h,a[1]=w*g+j*h,a[2]=C*g+H*h,a[3]=A*g+Q*h,a[4]=N*g-x*h,a[5]=j*g-w*h,a[6]=H*g-C*h,a[7]=Q*g-A*h,a},s.scale=function(a,r,l){var h=l[0],g=l[1],x=l[2];return a[0]=r[0]*h,a[1]=r[1]*h,a[2]=r[2]*h,a[3]=r[3]*h,a[4]=r[4]*g,a[5]=r[5]*g,a[6]=r[6]*g,a[7]=r[7]*g,a[8]=r[8]*x,a[9]=r[9]*x,a[10]=r[10]*x,a[11]=r[11]*x,a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a},s.scale$1=function(a,r,l){return a[0]=r[0]*l,a[1]=r[1]*l,a[2]=r[2]*l,a},s.setCacheLimits=function(a,r){Qe=a,Rt=r},s.setRTLTextPlugin=function(a,r,l=!1){if(Di===Bd||Di===Fd||Di===Ud)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ma=Oe.resolveURL(a),Di=Bd,Vd=r,tl(),l||ap()},s.spec=Ye,s.sphericalToCartesian=function([a,r,l]){return r+=90,r*=Math.PI/180,l*=Math.PI/180,{x:a*Math.cos(r)*Math.sin(l),y:a*Math.sin(r)*Math.sin(l),z:a*Math.cos(l)}},s.sqrLen=function(a){var r=a[0],l=a[1];return r*r+l*l},s.sub=function(a,r,l){return a[0]=r[0]-l[0],a[1]=r[1]-l[1],a[2]=r[2]-l[2],a},s.toEvaluationFeature=dc,s.transformMat3=function(a,r,l){var h=r[0],g=r[1],x=r[2];return a[0]=h*l[0]+g*l[3]+x*l[6],a[1]=h*l[1]+g*l[4]+x*l[7],a[2]=h*l[2]+g*l[5]+x*l[8],a},s.transformMat4=mp,s.transformMat4$1=function(a,r,l){var h=r[0],g=r[1];return a[0]=l[0]*h+l[4]*g+l[12],a[1]=l[1]*h+l[5]*g+l[13],a},s.translate=function(a,r,l){var h,g,x,w,C,A,N,j,H,Q,te,ne,_e=l[0],me=l[1],$e=l[2];return r===a?(a[12]=r[0]*_e+r[4]*me+r[8]*$e+r[12],a[13]=r[1]*_e+r[5]*me+r[9]*$e+r[13],a[14]=r[2]*_e+r[6]*me+r[10]*$e+r[14],a[15]=r[3]*_e+r[7]*me+r[11]*$e+r[15]):(g=r[1],x=r[2],w=r[3],C=r[4],A=r[5],N=r[6],j=r[7],H=r[8],Q=r[9],te=r[10],ne=r[11],a[0]=h=r[0],a[1]=g,a[2]=x,a[3]=w,a[4]=C,a[5]=A,a[6]=N,a[7]=j,a[8]=H,a[9]=Q,a[10]=te,a[11]=ne,a[12]=h*_e+C*me+H*$e+r[12],a[13]=g*_e+A*me+Q*$e+r[13],a[14]=x*_e+N*me+te*$e+r[14],a[15]=w*_e+j*me+ne*$e+r[15]),a},s.triggerPluginCompletionEvent=op,s.unicodeBlockLookup=At,s.uniqueId=function(){return M++},s.validateCustomStyleLayer=function(a){const r=[],l=a.id;return l===void 0&&r.push({message:`layers.${l}: missing required property "id"`}),a.render===void 0&&r.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&r.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),r},s.validateLight=Nd,s.validateStyle=ic,s.vectorTile=ol,s.warnOnce=V,s.wrap=D}),d(["./shared"],function(s){function _(ae){const B=typeof ae;if(B==="number"||B==="boolean"||B==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let oe="[";for(const ge of ae)oe+=`${_(ge)},`;return`${oe}]`}const K=Object.keys(ae).sort();let ie="{";for(let oe=0;oe<K.length;oe++)ie+=`${JSON.stringify(K[oe])}:${_(ae[K[oe]])},`;return`${ie}}`}function v(ae){let B="";for(const K of s.refProperties)B+=`/${_(ae[K])}`;return B}class E{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,K){for(const oe of B){this._layerConfigs[oe.id]=oe;const ge=this._layers[oe.id]=s.createStyleLayer(oe);ge._featureFilter=s.createFilter(ge.filter),this.keyCache[oe.id]&&delete this.keyCache[oe.id]}for(const oe of K)delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe];this.familiesBySource={};const ie=function(oe,ge){const Se={};for(let ye=0;ye<oe.length;ye++){const Ce=ge&&ge[oe[ye].id]||v(oe[ye]);ge&&(ge[oe[ye].id]=Ce);let Xe=Se[Ce];Xe||(Xe=Se[Ce]=[]),Xe.push(oe[ye])}const xe=[];for(const ye in Se)xe.push(Se[ye]);return xe}(Object.values(this._layerConfigs),this.keyCache);for(const oe of ie){const ge=oe.map(ut=>this._layers[ut.id]),Se=ge[0];if(Se.visibility==="none")continue;const xe=Se.source||"";let ye=this.familiesBySource[xe];ye||(ye=this.familiesBySource[xe]={});const Ce=Se.sourceLayer||"_geojsonTileLayer";let Xe=ye[Ce];Xe||(Xe=ye[Ce]=[]),Xe.push(ge)}}}class T{constructor(B){const K={},ie=[];for(const xe in B){const ye=B[xe],Ce=K[xe]={};for(const Xe in ye){const ut=ye[+Xe];if(!ut||ut.bitmap.width===0||ut.bitmap.height===0)continue;const Ze={x:0,y:0,w:ut.bitmap.width+2,h:ut.bitmap.height+2};ie.push(Ze),Ce[Xe]={rect:Ze,metrics:ut.metrics}}}const{w:oe,h:ge}=s.potpack(ie),Se=new s.AlphaImage({width:oe||1,height:ge||1});for(const xe in B){const ye=B[xe];for(const Ce in ye){const Xe=ye[+Ce];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const ut=K[xe][Ce].rect;s.AlphaImage.copy(Xe.bitmap,Se,{x:0,y:0},{x:ut.x+1,y:ut.y+1},Xe.bitmap)}}this.image=Se,this.positions=K}}s.register("GlyphAtlas",T);class S{constructor(B){this.tileID=new s.OverscaledTileID(B.tileID.overscaledZ,B.tileID.wrap,B.tileID.canonical.z,B.tileID.canonical.x,B.tileID.canonical.y),this.uid=B.uid,this.zoom=B.zoom,this.pixelRatio=B.pixelRatio,this.tileSize=B.tileSize,this.source=B.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=B.showCollisionBoxes,this.collectResourceTiming=!!B.collectResourceTiming,this.returnDependencies=!!B.returnDependencies,this.promoteId=B.promoteId}parse(B,K,ie,oe,ge){this.status="parsing",this.data=B,this.collisionBoxArray=new s.CollisionBoxArray;const Se=new s.DictionaryCoder(Object.keys(B.layers).sort()),xe=new s.FeatureIndex(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const ye={},Ce={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ie},Xe=K.familiesBySource[this.source];for(const en in Xe){const an=B.layers[en];if(!an)continue;an.version===1&&s.warnOnce(`Vector tile source "${this.source}" layer "${en}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const xn=Se.encode(en),bn=[];for(let Cr=0;Cr<an.length;Cr++){const Gn=an.feature(Cr),Vr=xe.getId(Gn,en);bn.push({feature:Gn,id:Vr,index:Cr,sourceLayerIndex:xn})}for(const Cr of Xe[en]){const Gn=Cr[0];Gn.source!==this.source&&s.warnOnce(`layer.source = ${Gn.source} does not equal this.source = ${this.source}`),Gn.minzoom&&this.zoom<Math.floor(Gn.minzoom)||Gn.maxzoom&&this.zoom>=Gn.maxzoom||Gn.visibility!=="none"&&(D(Cr,this.zoom,ie),(ye[Gn.id]=Gn.createBucket({index:xe.bucketLayerIDs.length,layers:Cr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(bn,Ce,this.tileID.canonical),xe.bucketLayerIDs.push(Cr.map(Vr=>Vr.id)))}}let ut,Ze,Ct,Ut;const Pt=s.mapObject(Ce.glyphDependencies,en=>Object.keys(en).map(Number));Object.keys(Pt).length?oe.send("getGlyphs",{uid:this.uid,stacks:Pt},(en,an)=>{ut||(ut=en,Ze=an,_n.call(this))}):Ze={};const Xt=Object.keys(Ce.iconDependencies);Xt.length?oe.send("getImages",{icons:Xt,source:this.source,tileID:this.tileID,type:"icons"},(en,an)=>{ut||(ut=en,Ct=an,_n.call(this))}):Ct={};const Qt=Object.keys(Ce.patternDependencies);function _n(){if(ut)return ge(ut);if(Ze&&Ct&&Ut){const en=new T(Ze),an=new s.ImageAtlas(Ct,Ut);for(const xn in ye){const bn=ye[xn];bn instanceof s.SymbolBucket?(D(bn.layers,this.zoom,ie),s.performSymbolLayout({bucket:bn,glyphMap:Ze,glyphPositions:en.positions,imageMap:Ct,imagePositions:an.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):bn.hasPattern&&(bn instanceof s.LineBucket||bn instanceof s.FillBucket||bn instanceof s.FillExtrusionBucket)&&(D(bn.layers,this.zoom,ie),bn.addFeatures(Ce,this.tileID.canonical,an.patternPositions))}this.status="done",ge(null,{buckets:Object.values(ye).filter(xn=>!xn.isEmpty()),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:en.image,imageAtlas:an,glyphMap:this.returnDependencies?Ze:null,iconMap:this.returnDependencies?Ct:null,glyphPositions:this.returnDependencies?en.positions:null})}}Qt.length?oe.send("getImages",{icons:Qt,source:this.source,tileID:this.tileID,type:"patterns"},(en,an)=>{ut||(ut=en,Ut=an,_n.call(this))}):Ut={},_n.call(this)}}function D(ae,B,K){const ie=new s.EvaluationParameters(B);for(const oe of ae)oe.recalculate(ie,K)}function O(ae,B){const K=s.getArrayBuffer(ae.request,(ie,oe,ge,Se)=>{ie?B(ie):oe&&B(null,{vectorTile:new s.vectorTile.VectorTile(new s.pbf(oe)),rawData:oe,cacheControl:ge,expires:Se})});return()=>{K.cancel(),B()}}class M{constructor(B,K,ie,oe){this.actor=B,this.layerIndex=K,this.availableImages=ie,this.loadVectorData=oe||O,this.loading={},this.loaded={}}loadTile(B,K){const ie=B.uid;this.loading||(this.loading={});const oe=!!(B&&B.request&&B.request.collectResourceTiming)&&new s.RequestPerformance(B.request),ge=this.loading[ie]=new S(B);ge.abort=this.loadVectorData(B,(Se,xe)=>{if(delete this.loading[ie],Se||!xe)return ge.status="done",this.loaded[ie]=ge,K(Se);const ye=xe.rawData,Ce={};xe.expires&&(Ce.expires=xe.expires),xe.cacheControl&&(Ce.cacheControl=xe.cacheControl);const Xe={};if(oe){const ut=oe.finish();ut&&(Xe.resourceTiming=JSON.parse(JSON.stringify(ut)))}ge.vectorTile=xe.vectorTile,ge.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(ut,Ze)=>{if(ut||!Ze)return K(ut);K(null,s.extend({rawTileData:ye.slice(0)},Ze,Ce,Xe))}),this.loaded=this.loaded||{},this.loaded[ie]=ge})}reloadTile(B,K){const ie=this.loaded,oe=B.uid,ge=this;if(ie&&ie[oe]){const Se=ie[oe];Se.showCollisionBoxes=B.showCollisionBoxes;const xe=(ye,Ce)=>{const Xe=Se.reloadCallback;Xe&&(delete Se.reloadCallback,Se.parse(Se.vectorTile,ge.layerIndex,this.availableImages,ge.actor,Xe)),K(ye,Ce)};Se.status==="parsing"?Se.reloadCallback=xe:Se.status==="done"&&(Se.vectorTile?Se.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,xe):xe())}}abortTile(B,K){const ie=this.loading,oe=B.uid;ie&&ie[oe]&&ie[oe].abort&&(ie[oe].abort(),delete ie[oe]),K()}removeTile(B,K){const ie=this.loaded,oe=B.uid;ie&&ie[oe]&&delete ie[oe],K()}}class U{constructor(){this.loaded={}}loadTile(B,K){const{uid:ie,encoding:oe,rawImageData:ge}=B,Se=s.isImageBitmap(ge)?this.getImageData(ge):ge,xe=new s.DEMData(ie,Se,oe);this.loaded=this.loaded||{},this.loaded[ie]=xe,K(null,xe)}getImageData(B){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(B.width,B.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=B.width,this.offscreenCanvas.height=B.height,this.offscreenCanvasContext.drawImage(B,0,0,B.width,B.height);const K=this.offscreenCanvasContext.getImageData(-1,-1,B.width+2,B.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new s.RGBAImage({width:K.width,height:K.height},K.data)}removeTile(B){const K=this.loaded,ie=B.uid;K&&K[ie]&&delete K[ie]}}var $=function ae(B,K){var ie,oe=B&&B.type;if(oe==="FeatureCollection")for(ie=0;ie<B.features.length;ie++)ae(B.features[ie],K);else if(oe==="GeometryCollection")for(ie=0;ie<B.geometries.length;ie++)ae(B.geometries[ie],K);else if(oe==="Feature")ae(B.geometry,K);else if(oe==="Polygon")L(B.coordinates,K);else if(oe==="MultiPolygon")for(ie=0;ie<B.coordinates.length;ie++)L(B.coordinates[ie],K);return B};function L(ae,B){if(ae.length!==0){F(ae[0],B);for(var K=1;K<ae.length;K++)F(ae[K],!B)}}function F(ae,B){for(var K=0,ie=0,oe=0,ge=ae.length,Se=ge-1;oe<ge;Se=oe++){var xe=(ae[oe][0]-ae[Se][0])*(ae[Se][1]+ae[oe][1]),ye=K+xe;ie+=Math.abs(K)>=Math.abs(xe)?K-ye+xe:xe-ye+K,K=ye}K+ie>=0!=!!B&&ae.reverse()}const J=s.vectorTile.VectorTileFeature.prototype.toGeoJSON;class V{constructor(B){this._feature=B,this.extent=s.EXTENT,this.type=B.type,this.properties=B.tags,"id"in B&&!isNaN(B.id)&&(this.id=parseInt(B.id,10))}loadGeometry(){if(this._feature.type===1){const B=[];for(const K of this._feature.geometry)B.push([new s.pointGeometry(K[0],K[1])]);return B}{const B=[];for(const K of this._feature.geometry){const ie=[];for(const oe of K)ie.push(new s.pointGeometry(oe[0],oe[1]));B.push(ie)}return B}}toGeoJSON(B,K,ie){return J.call(this,B,K,ie)}}class Z{constructor(B){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=B.length,this._features=B}feature(B){return new V(this._features[B])}}var G={exports:{}},W=s.pointGeometry,le=s.vectorTile.VectorTileFeature,Ie=be;function be(ae,B){this.options=B||{},this.features=ae,this.length=ae.length}function de(ae,B){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=B||4096}be.prototype.feature=function(ae){return new de(this.features[ae],this.options.extent)},de.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var B=0;B<ae.length;B++){for(var K=ae[B],ie=[],oe=0;oe<K.length;oe++)ie.push(new W(K[oe][0],K[oe][1]));this.geometry.push(ie)}return this.geometry},de.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,B=1/0,K=-1/0,ie=1/0,oe=-1/0,ge=0;ge<ae.length;ge++)for(var Se=ae[ge],xe=0;xe<Se.length;xe++){var ye=Se[xe];B=Math.min(B,ye.x),K=Math.max(K,ye.x),ie=Math.min(ie,ye.y),oe=Math.max(oe,ye.y)}return[B,ie,K,oe]},de.prototype.toGeoJSON=le.prototype.toGeoJSON;var Ne=s.pbf,Ee=Ie;function Oe(ae){var B=new Ne;return function(K,ie){for(var oe in K.layers)ie.writeMessage(3,ze,K.layers[oe])}(ae,B),B.finish()}function ze(ae,B){var K;B.writeVarintField(15,ae.version||1),B.writeStringField(1,ae.name||""),B.writeVarintField(5,ae.extent||4096);var ie={keys:[],values:[],keycache:{},valuecache:{}};for(K=0;K<ae.length;K++)ie.feature=ae.feature(K),B.writeMessage(2,rt,ie);var oe=ie.keys;for(K=0;K<oe.length;K++)B.writeStringField(3,oe[K]);var ge=ie.values;for(K=0;K<ge.length;K++)B.writeMessage(4,Qe,ge[K])}function rt(ae,B){var K=ae.feature;K.id!==void 0&&B.writeVarintField(1,K.id),B.writeMessage(2,We,ae),B.writeVarintField(3,K.type),B.writeMessage(4,ft,K)}function We(ae,B){var K=ae.feature,ie=ae.keys,oe=ae.values,ge=ae.keycache,Se=ae.valuecache;for(var xe in K.properties){var ye=K.properties[xe],Ce=ge[xe];if(ye!==null){Ce===void 0&&(ie.push(xe),ge[xe]=Ce=ie.length-1),B.writeVarint(Ce);var Xe=typeof ye;Xe!=="string"&&Xe!=="boolean"&&Xe!=="number"&&(ye=JSON.stringify(ye));var ut=Xe+":"+ye,Ze=Se[ut];Ze===void 0&&(oe.push(ye),Se[ut]=Ze=oe.length-1),B.writeVarint(Ze)}}}function Ae(ae,B){return(B<<3)+(7&ae)}function He(ae){return ae<<1^ae>>31}function ft(ae,B){for(var K=ae.loadGeometry(),ie=ae.type,oe=0,ge=0,Se=K.length,xe=0;xe<Se;xe++){var ye=K[xe],Ce=1;ie===1&&(Ce=ye.length),B.writeVarint(Ae(1,Ce));for(var Xe=ie===3?ye.length-1:ye.length,ut=0;ut<Xe;ut++){ut===1&&ie!==1&&B.writeVarint(Ae(2,Xe-1));var Ze=ye[ut].x-oe,Ct=ye[ut].y-ge;B.writeVarint(He(Ze)),B.writeVarint(He(Ct)),oe+=Ze,ge+=Ct}ie===3&&B.writeVarint(Ae(7,1))}}function Qe(ae,B){var K=typeof ae;K==="string"?B.writeStringField(1,ae):K==="boolean"?B.writeBooleanField(7,ae):K==="number"&&(ae%1!=0?B.writeDoubleField(3,ae):ae<0?B.writeSVarintField(6,ae):B.writeVarintField(5,ae))}function Rt(ae,B,K,ie,oe,ge){if(oe-ie<=K)return;const Se=ie+oe>>1;zt(ae,B,Se,ie,oe,ge%2),Rt(ae,B,K,ie,Se-1,ge+1),Rt(ae,B,K,Se+1,oe,ge+1)}function zt(ae,B,K,ie,oe,ge){for(;oe>ie;){if(oe-ie>600){const Ce=oe-ie+1,Xe=K-ie+1,ut=Math.log(Ce),Ze=.5*Math.exp(2*ut/3),Ct=.5*Math.sqrt(ut*Ze*(Ce-Ze)/Ce)*(Xe-Ce/2<0?-1:1);zt(ae,B,K,Math.max(ie,Math.floor(K-Xe*Ze/Ce+Ct)),Math.min(oe,Math.floor(K+(Ce-Xe)*Ze/Ce+Ct)),ge)}const Se=B[2*K+ge];let xe=ie,ye=oe;for(X(ae,B,ie,K),B[2*oe+ge]>Se&&X(ae,B,ie,oe);xe<ye;){for(X(ae,B,xe,ye),xe++,ye--;B[2*xe+ge]<Se;)xe++;for(;B[2*ye+ge]>Se;)ye--}B[2*ie+ge]===Se?X(ae,B,ie,ye):(ye++,X(ae,B,ye,oe)),ye<=K&&(ie=ye+1),K<=ye&&(oe=ye-1)}}function X(ae,B,K,ie){tt(ae,K,ie),tt(B,2*K,2*ie),tt(B,2*K+1,2*ie+1)}function tt(ae,B,K){const ie=ae[B];ae[B]=ae[K],ae[K]=ie}function je(ae,B,K,ie){const oe=ae-K,ge=B-ie;return oe*oe+ge*ge}G.exports=Oe,G.exports.fromVectorTileJs=Oe,G.exports.fromGeojsonVt=function(ae,B){B=B||{};var K={};for(var ie in ae)K[ie]=new Ee(ae[ie].features,B),K[ie].name=ie,K[ie].version=B.version,K[ie].extent=B.extent;return Oe({layers:K})},G.exports.GeoJSONWrapper=Ee;const ve=ae=>ae[0],ke=ae=>ae[1];class we{constructor(B,K=ve,ie=ke,oe=64,ge=Float64Array){this.nodeSize=oe,this.points=B;const Se=B.length<65536?Uint16Array:Uint32Array,xe=this.ids=new Se(B.length),ye=this.coords=new ge(2*B.length);for(let Ce=0;Ce<B.length;Ce++)xe[Ce]=Ce,ye[2*Ce]=K(B[Ce]),ye[2*Ce+1]=ie(B[Ce]);Rt(xe,ye,oe,0,xe.length-1,0)}range(B,K,ie,oe){return function(ge,Se,xe,ye,Ce,Xe,ut){const Ze=[0,ge.length-1,0],Ct=[];let Ut,Pt;for(;Ze.length;){const Xt=Ze.pop(),Qt=Ze.pop(),_n=Ze.pop();if(Qt-_n<=ut){for(let xn=_n;xn<=Qt;xn++)Ut=Se[2*xn],Pt=Se[2*xn+1],Ut>=xe&&Ut<=Ce&&Pt>=ye&&Pt<=Xe&&Ct.push(ge[xn]);continue}const en=Math.floor((_n+Qt)/2);Ut=Se[2*en],Pt=Se[2*en+1],Ut>=xe&&Ut<=Ce&&Pt>=ye&&Pt<=Xe&&Ct.push(ge[en]);const an=(Xt+1)%2;(Xt===0?xe<=Ut:ye<=Pt)&&(Ze.push(_n),Ze.push(en-1),Ze.push(an)),(Xt===0?Ce>=Ut:Xe>=Pt)&&(Ze.push(en+1),Ze.push(Qt),Ze.push(an))}return Ct}(this.ids,this.coords,B,K,ie,oe,this.nodeSize)}within(B,K,ie){return function(oe,ge,Se,xe,ye,Ce){const Xe=[0,oe.length-1,0],ut=[],Ze=ye*ye;for(;Xe.length;){const Ct=Xe.pop(),Ut=Xe.pop(),Pt=Xe.pop();if(Ut-Pt<=Ce){for(let an=Pt;an<=Ut;an++)je(ge[2*an],ge[2*an+1],Se,xe)<=Ze&&ut.push(oe[an]);continue}const Xt=Math.floor((Pt+Ut)/2),Qt=ge[2*Xt],_n=ge[2*Xt+1];je(Qt,_n,Se,xe)<=Ze&&ut.push(oe[Xt]);const en=(Ct+1)%2;(Ct===0?Se-ye<=Qt:xe-ye<=_n)&&(Xe.push(Pt),Xe.push(Xt-1),Xe.push(en)),(Ct===0?Se+ye>=Qt:xe+ye>=_n)&&(Xe.push(Xt+1),Xe.push(Ut),Xe.push(en))}return ut}(this.ids,this.coords,B,K,ie,this.nodeSize)}}const De={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},Pe=Math.fround||(lt=new Float32Array(1),ae=>(lt[0]=+ae,lt[0]));var lt;class dt{constructor(B){this.options=on(Object.create(De),B),this.trees=new Array(this.options.maxZoom+1)}load(B){const{log:K,minZoom:ie,maxZoom:oe,nodeSize:ge}=this.options;K&&console.time("total time");const Se=`prepare ${B.length} points`;K&&console.time(Se),this.points=B;let xe=[];for(let ye=0;ye<B.length;ye++)B[ye].geometry&&xe.push(Fe(B[ye],ye));this.trees[oe+1]=new we(xe,pn,sr,ge,Float32Array),K&&console.timeEnd(Se);for(let ye=oe;ye>=ie;ye--){const Ce=+Date.now();xe=this._cluster(xe,ye),this.trees[ye]=new we(xe,pn,sr,ge,Float32Array),K&&console.log("z%d: %d clusters in %dms",ye,xe.length,+Date.now()-Ce)}return K&&console.timeEnd("total time"),this}getClusters(B,K){let ie=((B[0]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,B[1]));let ge=B[2]===180?180:((B[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)ie=-180,ge=180;else if(ie>ge){const Xe=this.getClusters([ie,oe,180,Se],K),ut=this.getClusters([-180,oe,ge,Se],K);return Xe.concat(ut)}const xe=this.trees[this._limitZoom(K)],ye=xe.range(ct(ie),at(Se),ct(ge),at(oe)),Ce=[];for(const Xe of ye){const ut=xe.points[Xe];Ce.push(ut.numPoints?Ke(ut):this.points[ut.index])}return Ce}getChildren(B){const K=this._getOriginId(B),ie=this._getOriginZoom(B),oe="No cluster with the specified id.",ge=this.trees[ie];if(!ge)throw new Error(oe);const Se=ge.points[K];if(!Se)throw new Error(oe);const xe=this.options.radius/(this.options.extent*Math.pow(2,ie-1)),ye=ge.within(Se.x,Se.y,xe),Ce=[];for(const Xe of ye){const ut=ge.points[Xe];ut.parentId===B&&Ce.push(ut.numPoints?Ke(ut):this.points[ut.index])}if(Ce.length===0)throw new Error(oe);return Ce}getLeaves(B,K,ie){const oe=[];return this._appendLeaves(oe,B,K=K||10,ie=ie||0,0),oe}getTile(B,K,ie){const oe=this.trees[this._limitZoom(B)],ge=Math.pow(2,B),{extent:Se,radius:xe}=this.options,ye=xe/Se,Ce=(ie-ye)/ge,Xe=(ie+1+ye)/ge,ut={features:[]};return this._addTileFeatures(oe.range((K-ye)/ge,Ce,(K+1+ye)/ge,Xe),oe.points,K,ie,ge,ut),K===0&&this._addTileFeatures(oe.range(1-ye/ge,Ce,1,Xe),oe.points,ge,ie,ge,ut),K===ge-1&&this._addTileFeatures(oe.range(0,Ce,ye/ge,Xe),oe.points,-1,ie,ge,ut),ut.features.length?ut:null}getClusterExpansionZoom(B){let K=this._getOriginZoom(B)-1;for(;K<=this.options.maxZoom;){const ie=this.getChildren(B);if(K++,ie.length!==1)break;B=ie[0].properties.cluster_id}return K}_appendLeaves(B,K,ie,oe,ge){const Se=this.getChildren(K);for(const xe of Se){const ye=xe.properties;if(ye&&ye.cluster?ge+ye.point_count<=oe?ge+=ye.point_count:ge=this._appendLeaves(B,ye.cluster_id,ie,oe,ge):ge<oe?ge++:B.push(xe),B.length===ie)break}return ge}_addTileFeatures(B,K,ie,oe,ge,Se){for(const xe of B){const ye=K[xe],Ce=ye.numPoints;let Xe,ut,Ze;if(Ce)Xe=it(ye),ut=ye.x,Ze=ye.y;else{const Pt=this.points[ye.index];Xe=Pt.properties,ut=ct(Pt.geometry.coordinates[0]),Ze=at(Pt.geometry.coordinates[1])}const Ct={type:1,geometry:[[Math.round(this.options.extent*(ut*ge-ie)),Math.round(this.options.extent*(Ze*ge-oe))]],tags:Xe};let Ut;Ce?Ut=ye.id:this.options.generateId?Ut=ye.index:this.points[ye.index].id&&(Ut=this.points[ye.index].id),Ut!==void 0&&(Ct.id=Ut),Se.features.push(Ct)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(Math.floor(+B),this.options.maxZoom+1))}_cluster(B,K){const ie=[],{radius:oe,extent:ge,reduce:Se,minPoints:xe}=this.options,ye=oe/(ge*Math.pow(2,K));for(let Ce=0;Ce<B.length;Ce++){const Xe=B[Ce];if(Xe.zoom<=K)continue;Xe.zoom=K;const ut=this.trees[K+1],Ze=ut.within(Xe.x,Xe.y,ye),Ct=Xe.numPoints||1;let Ut=Ct;for(const Pt of Ze){const Xt=ut.points[Pt];Xt.zoom>K&&(Ut+=Xt.numPoints||1)}if(Ut>Ct&&Ut>=xe){let Pt=Xe.x*Ct,Xt=Xe.y*Ct,Qt=Se&&Ct>1?this._map(Xe,!0):null;const _n=(Ce<<5)+(K+1)+this.points.length;for(const en of Ze){const an=ut.points[en];if(an.zoom<=K)continue;an.zoom=K;const xn=an.numPoints||1;Pt+=an.x*xn,Xt+=an.y*xn,an.parentId=_n,Se&&(Qt||(Qt=this._map(Xe,!0)),Se(Qt,this._map(an)))}Xe.parentId=_n,ie.push(ue(Pt/Ut,Xt/Ut,_n,Ut,Qt))}else if(ie.push(Xe),Ut>1)for(const Pt of Ze){const Xt=ut.points[Pt];Xt.zoom<=K||(Xt.zoom=K,ie.push(Xt))}}return ie}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,K){if(B.numPoints)return K?on({},B.properties):B.properties;const ie=this.points[B.index].properties,oe=this.options.map(ie);return K&&oe===ie?on({},oe):oe}}function ue(ae,B,K,ie,oe){return{x:Pe(ae),y:Pe(B),zoom:1/0,id:K,parentId:-1,numPoints:ie,properties:oe}}function Fe(ae,B){const[K,ie]=ae.geometry.coordinates;return{x:Pe(ct(K)),y:Pe(at(ie)),zoom:1/0,index:B,parentId:-1}}function Ke(ae){return{type:"Feature",id:ae.id,properties:it(ae),geometry:{type:"Point",coordinates:[(B=ae.x,360*(B-.5)),Ot(ae.y)]}};var B}function it(ae){const B=ae.numPoints,K=B>=1e4?`${Math.round(B/1e3)}k`:B>=1e3?Math.round(B/100)/10+"k":B;return on(on({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:B,point_count_abbreviated:K})}function ct(ae){return ae/360+.5}function at(ae){const B=Math.sin(ae*Math.PI/180),K=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return K<0?0:K>1?1:K}function Ot(ae){const B=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function on(ae,B){for(const K in B)ae[K]=B[K];return ae}function pn(ae){return ae.x}function sr(ae){return ae.y}function Qn(ae,B,K,ie){for(var oe,ge=ie,Se=K-B>>1,xe=K-B,ye=ae[B],Ce=ae[B+1],Xe=ae[K],ut=ae[K+1],Ze=B+3;Ze<K;Ze+=3){var Ct=Jr(ae[Ze],ae[Ze+1],ye,Ce,Xe,ut);if(Ct>ge)oe=Ze,ge=Ct;else if(Ct===ge){var Ut=Math.abs(Ze-Se);Ut<xe&&(oe=Ze,xe=Ut)}}ge>ie&&(oe-B>3&&Qn(ae,B,oe,ie),ae[oe+2]=ge,K-oe>3&&Qn(ae,oe,K,ie))}function Jr(ae,B,K,ie,oe,ge){var Se=oe-K,xe=ge-ie;if(Se!==0||xe!==0){var ye=((ae-K)*Se+(B-ie)*xe)/(Se*Se+xe*xe);ye>1?(K=oe,ie=ge):ye>0&&(K+=Se*ye,ie+=xe*ye)}return(Se=ae-K)*Se+(xe=B-ie)*xe}function xr(ae,B,K,ie){var oe={id:ae===void 0?null:ae,type:B,geometry:K,tags:ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ge){var Se=ge.geometry,xe=ge.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Ye(ge,Se);else if(xe==="Polygon"||xe==="MultiLineString")for(var ye=0;ye<Se.length;ye++)Ye(ge,Se[ye]);else if(xe==="MultiPolygon")for(ye=0;ye<Se.length;ye++)for(var Ce=0;Ce<Se[ye].length;Ce++)Ye(ge,Se[ye][Ce])}(oe),oe}function Ye(ae,B){for(var K=0;K<B.length;K+=3)ae.minX=Math.min(ae.minX,B[K]),ae.minY=Math.min(ae.minY,B[K+1]),ae.maxX=Math.max(ae.maxX,B[K]),ae.maxY=Math.max(ae.maxY,B[K+1])}function _t(ae,B,K,ie){if(B.geometry){var oe=B.geometry.coordinates,ge=B.geometry.type,Se=Math.pow(K.tolerance/((1<<K.maxZoom)*K.extent),2),xe=[],ye=B.id;if(K.promoteId?ye=B.properties[K.promoteId]:K.generateId&&(ye=ie||0),ge==="Point")Kn(oe,xe);else if(ge==="MultiPoint")for(var Ce=0;Ce<oe.length;Ce++)Kn(oe[Ce],xe);else if(ge==="LineString")Dr(oe,xe,Se,!1);else if(ge==="MultiLineString"){if(K.lineMetrics){for(Ce=0;Ce<oe.length;Ce++)Dr(oe[Ce],xe=[],Se,!1),ae.push(xr(ye,"LineString",xe,B.properties));return}cn(oe,xe,Se,!1)}else if(ge==="Polygon")cn(oe,xe,Se,!0);else{if(ge!=="MultiPolygon"){if(ge==="GeometryCollection"){for(Ce=0;Ce<B.geometry.geometries.length;Ce++)_t(ae,{id:ye,geometry:B.geometry.geometries[Ce],properties:B.properties},K,ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ce=0;Ce<oe.length;Ce++){var Xe=[];cn(oe[Ce],Xe,Se,!0),xe.push(Xe)}}ae.push(xr(ye,ge,xe,B.properties))}}function Kn(ae,B){B.push(Rr(ae[0])),B.push(br(ae[1])),B.push(0)}function Dr(ae,B,K,ie){for(var oe,ge,Se=0,xe=0;xe<ae.length;xe++){var ye=Rr(ae[xe][0]),Ce=br(ae[xe][1]);B.push(ye),B.push(Ce),B.push(0),xe>0&&(Se+=ie?(oe*Ce-ye*ge)/2:Math.sqrt(Math.pow(ye-oe,2)+Math.pow(Ce-ge,2))),oe=ye,ge=Ce}var Xe=B.length-3;B[2]=1,Qn(B,0,Xe,K),B[Xe+2]=1,B.size=Math.abs(Se),B.start=0,B.end=B.size}function cn(ae,B,K,ie){for(var oe=0;oe<ae.length;oe++){var ge=[];Dr(ae[oe],ge,K,ie),B.push(ge)}}function Rr(ae){return ae/360+.5}function br(ae){var B=Math.sin(ae*Math.PI/180),K=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return K<0?0:K>1?1:K}function dr(ae,B,K,ie,oe,ge,Se,xe){if(ie/=B,ge>=(K/=B)&&Se<ie)return ae;if(Se<K||ge>=ie)return null;for(var ye=[],Ce=0;Ce<ae.length;Ce++){var Xe=ae[Ce],ut=Xe.geometry,Ze=Xe.type,Ct=oe===0?Xe.minX:Xe.minY,Ut=oe===0?Xe.maxX:Xe.maxY;if(Ct>=K&&Ut<ie)ye.push(Xe);else if(!(Ut<K||Ct>=ie)){var Pt=[];if(Ze==="Point"||Ze==="MultiPoint")ai(ut,Pt,K,ie,oe);else if(Ze==="LineString")xt(ut,Pt,K,ie,oe,!1,xe.lineMetrics);else if(Ze==="MultiLineString")Kt(ut,Pt,K,ie,oe,!1);else if(Ze==="Polygon")Kt(ut,Pt,K,ie,oe,!0);else if(Ze==="MultiPolygon")for(var Xt=0;Xt<ut.length;Xt++){var Qt=[];Kt(ut[Xt],Qt,K,ie,oe,!0),Qt.length&&Pt.push(Qt)}if(Pt.length){if(xe.lineMetrics&&Ze==="LineString"){for(Xt=0;Xt<Pt.length;Xt++)ye.push(xr(Xe.id,Ze,Pt[Xt],Xe.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(Pt.length===1?(Ze="LineString",Pt=Pt[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=Pt.length===3?"Point":"MultiPoint"),ye.push(xr(Xe.id,Ze,Pt,Xe.tags))}}}return ye.length?ye:null}function ai(ae,B,K,ie,oe){for(var ge=0;ge<ae.length;ge+=3){var Se=ae[ge+oe];Se>=K&&Se<=ie&&(B.push(ae[ge]),B.push(ae[ge+1]),B.push(ae[ge+2]))}}function xt(ae,B,K,ie,oe,ge,Se){for(var xe,ye,Ce=tn(ae),Xe=oe===0?gi:Jt,ut=ae.start,Ze=0;Ze<ae.length-3;Ze+=3){var Ct=ae[Ze],Ut=ae[Ze+1],Pt=ae[Ze+2],Xt=ae[Ze+3],Qt=ae[Ze+4],_n=oe===0?Ct:Ut,en=oe===0?Xt:Qt,an=!1;Se&&(xe=Math.sqrt(Math.pow(Ct-Xt,2)+Math.pow(Ut-Qt,2))),_n<K?en>K&&(ye=Xe(Ce,Ct,Ut,Xt,Qt,K),Se&&(Ce.start=ut+xe*ye)):_n>ie?en<ie&&(ye=Xe(Ce,Ct,Ut,Xt,Qt,ie),Se&&(Ce.start=ut+xe*ye)):er(Ce,Ct,Ut,Pt),en<K&&_n>=K&&(ye=Xe(Ce,Ct,Ut,Xt,Qt,K),an=!0),en>ie&&_n<=ie&&(ye=Xe(Ce,Ct,Ut,Xt,Qt,ie),an=!0),!ge&&an&&(Se&&(Ce.end=ut+xe*ye),B.push(Ce),Ce=tn(ae)),Se&&(ut+=xe)}var xn=ae.length-3;Ct=ae[xn],Ut=ae[xn+1],Pt=ae[xn+2],(_n=oe===0?Ct:Ut)>=K&&_n<=ie&&er(Ce,Ct,Ut,Pt),xn=Ce.length-3,ge&&xn>=3&&(Ce[xn]!==Ce[0]||Ce[xn+1]!==Ce[1])&&er(Ce,Ce[0],Ce[1],Ce[2]),Ce.length&&B.push(Ce)}function tn(ae){var B=[];return B.size=ae.size,B.start=ae.start,B.end=ae.end,B}function Kt(ae,B,K,ie,oe,ge){for(var Se=0;Se<ae.length;Se++)xt(ae[Se],B,K,ie,oe,ge,!1)}function er(ae,B,K,ie){ae.push(B),ae.push(K),ae.push(ie)}function gi(ae,B,K,ie,oe,ge){var Se=(ge-B)/(ie-B);return ae.push(ge),ae.push(K+(oe-K)*Se),ae.push(1),Se}function Jt(ae,B,K,ie,oe,ge){var Se=(ge-K)/(oe-K);return ae.push(B+(ie-B)*Se),ae.push(ge),ae.push(1),Se}function Ur(ae,B){for(var K=[],ie=0;ie<ae.length;ie++){var oe,ge=ae[ie],Se=ge.type;if(Se==="Point"||Se==="MultiPoint"||Se==="LineString")oe=zn(ge.geometry,B);else if(Se==="MultiLineString"||Se==="Polygon"){oe=[];for(var xe=0;xe<ge.geometry.length;xe++)oe.push(zn(ge.geometry[xe],B))}else if(Se==="MultiPolygon")for(oe=[],xe=0;xe<ge.geometry.length;xe++){for(var ye=[],Ce=0;Ce<ge.geometry[xe].length;Ce++)ye.push(zn(ge.geometry[xe][Ce],B));oe.push(ye)}K.push(xr(ge.id,Se,oe,ge.tags))}return K}function zn(ae,B){var K=[];K.size=ae.size,ae.start!==void 0&&(K.start=ae.start,K.end=ae.end);for(var ie=0;ie<ae.length;ie+=3)K.push(ae[ie]+B,ae[ie+1],ae[ie+2]);return K}function yi(ae,B){if(ae.transformed)return ae;var K,ie,oe,ge=1<<ae.z,Se=ae.x,xe=ae.y;for(K=0;K<ae.features.length;K++){var ye=ae.features[K],Ce=ye.geometry,Xe=ye.type;if(ye.geometry=[],Xe===1)for(ie=0;ie<Ce.length;ie+=2)ye.geometry.push(Bn(Ce[ie],Ce[ie+1],B,ge,Se,xe));else for(ie=0;ie<Ce.length;ie++){var ut=[];for(oe=0;oe<Ce[ie].length;oe+=2)ut.push(Bn(Ce[ie][oe],Ce[ie][oe+1],B,ge,Se,xe));ye.geometry.push(ut)}}return ae.transformed=!0,ae}function Bn(ae,B,K,ie,oe,ge){return[Math.round(K*(ae*ie-oe)),Math.round(K*(B*ie-ge))]}function lr(ae,B,K,ie,oe){for(var ge=B===oe.maxZoom?0:oe.tolerance/((1<<B)*oe.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:K,y:ie,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},xe=0;xe<ae.length;xe++){Se.numFeatures++,hn(Se,ae[xe],ge,oe);var ye=ae[xe].minX,Ce=ae[xe].minY,Xe=ae[xe].maxX,ut=ae[xe].maxY;ye<Se.minX&&(Se.minX=ye),Ce<Se.minY&&(Se.minY=Ce),Xe>Se.maxX&&(Se.maxX=Xe),ut>Se.maxY&&(Se.maxY=ut)}return Se}function hn(ae,B,K,ie){var oe=B.geometry,ge=B.type,Se=[];if(ge==="Point"||ge==="MultiPoint")for(var xe=0;xe<oe.length;xe+=3)Se.push(oe[xe]),Se.push(oe[xe+1]),ae.numPoints++,ae.numSimplified++;else if(ge==="LineString")Vi(Se,oe,ae,K,!1,!1);else if(ge==="MultiLineString"||ge==="Polygon")for(xe=0;xe<oe.length;xe++)Vi(Se,oe[xe],ae,K,ge==="Polygon",xe===0);else if(ge==="MultiPolygon")for(var ye=0;ye<oe.length;ye++){var Ce=oe[ye];for(xe=0;xe<Ce.length;xe++)Vi(Se,Ce[xe],ae,K,!0,xe===0)}if(Se.length){var Xe=B.tags||null;if(ge==="LineString"&&ie.lineMetrics){for(var ut in Xe={},B.tags)Xe[ut]=B.tags[ut];Xe.mapbox_clip_start=oe.start/oe.size,Xe.mapbox_clip_end=oe.end/oe.size}var Ze={geometry:Se,type:ge==="Polygon"||ge==="MultiPolygon"?3:ge==="LineString"||ge==="MultiLineString"?2:1,tags:Xe};B.id!==null&&(Ze.id=B.id),ae.features.push(Ze)}}function Vi(ae,B,K,ie,oe,ge){var Se=ie*ie;if(ie>0&&B.size<(oe?Se:ie))K.numPoints+=B.length/3;else{for(var xe=[],ye=0;ye<B.length;ye+=3)(ie===0||B[ye+2]>Se)&&(K.numSimplified++,xe.push(B[ye]),xe.push(B[ye+1])),K.numPoints++;oe&&function(Ce,Xe){for(var ut=0,Ze=0,Ct=Ce.length,Ut=Ct-2;Ze<Ct;Ut=Ze,Ze+=2)ut+=(Ce[Ze]-Ce[Ut])*(Ce[Ze+1]+Ce[Ut+1]);if(ut>0===Xe)for(Ze=0,Ct=Ce.length;Ze<Ct/2;Ze+=2){var Pt=Ce[Ze],Xt=Ce[Ze+1];Ce[Ze]=Ce[Ct-2-Ze],Ce[Ze+1]=Ce[Ct-1-Ze],Ce[Ct-2-Ze]=Pt,Ce[Ct-1-Ze]=Xt}}(xe,ge),ae.push(xe)}}function Qr(ae,B){var K=(B=this.options=function(oe,ge){for(var Se in ge)oe[Se]=ge[Se];return oe}(Object.create(this.options),B)).debug;if(K&&console.time("preprocess data"),B.maxZoom<0||B.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(B.promoteId&&B.generateId)throw new Error("promoteId and generateId cannot be used together.");var ie=function(oe,ge){var Se=[];if(oe.type==="FeatureCollection")for(var xe=0;xe<oe.features.length;xe++)_t(Se,oe.features[xe],ge,xe);else _t(Se,oe.type==="Feature"?oe:{geometry:oe},ge);return Se}(ae,B);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",B.indexMaxZoom,B.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ie=function(oe,ge){var Se=ge.buffer/ge.extent,xe=oe,ye=dr(oe,1,-1-Se,Se,0,-1,2,ge),Ce=dr(oe,1,1-Se,2+Se,0,-1,2,ge);return(ye||Ce)&&(xe=dr(oe,1,-Se,1+Se,0,-1,2,ge)||[],ye&&(xe=Ur(ye,1).concat(xe)),Ce&&(xe=xe.concat(Ur(Ce,-1)))),xe}(ie,B),ie.length&&this.splitTile(ie,0,0,0),K&&(ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Pi(ae,B,K){return 32*((1<<ae)*K+B)+ae}function Ai(ae,B){const K=ae.tileID.canonical;if(!this._geoJSONIndex)return B(null,null);const ie=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!ie)return B(null,null);const oe=new Z(ie.features);let ge=G.exports(oe);ge.byteOffset===0&&ge.byteLength===ge.buffer.byteLength||(ge=new Uint8Array(ge)),B(null,{vectorTile:oe,rawData:ge.buffer})}Qr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Qr.prototype.splitTile=function(ae,B,K,ie,oe,ge,Se){for(var xe=[ae,B,K,ie],ye=this.options,Ce=ye.debug;xe.length;){ie=xe.pop(),K=xe.pop(),B=xe.pop(),ae=xe.pop();var Xe=1<<B,ut=Pi(B,K,ie),Ze=this.tiles[ut];if(!Ze&&(Ce>1&&console.time("creation"),Ze=this.tiles[ut]=lr(ae,B,K,ie,ye),this.tileCoords.push({z:B,x:K,y:ie}),Ce)){Ce>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",B,K,ie,Ze.numFeatures,Ze.numPoints,Ze.numSimplified),console.timeEnd("creation"));var Ct="z"+B;this.stats[Ct]=(this.stats[Ct]||0)+1,this.total++}if(Ze.source=ae,oe){if(B===ye.maxZoom||B===oe)continue;var Ut=1<<oe-B;if(K!==Math.floor(ge/Ut)||ie!==Math.floor(Se/Ut))continue}else if(B===ye.indexMaxZoom||Ze.numPoints<=ye.indexMaxPoints)continue;if(Ze.source=null,ae.length!==0){Ce>1&&console.time("clipping");var Pt,Xt,Qt,_n,en,an,xn=.5*ye.buffer/ye.extent,bn=.5-xn,Cr=.5+xn,Gn=1+xn;Pt=Xt=Qt=_n=null,en=dr(ae,Xe,K-xn,K+Cr,0,Ze.minX,Ze.maxX,ye),an=dr(ae,Xe,K+bn,K+Gn,0,Ze.minX,Ze.maxX,ye),ae=null,en&&(Pt=dr(en,Xe,ie-xn,ie+Cr,1,Ze.minY,Ze.maxY,ye),Xt=dr(en,Xe,ie+bn,ie+Gn,1,Ze.minY,Ze.maxY,ye),en=null),an&&(Qt=dr(an,Xe,ie-xn,ie+Cr,1,Ze.minY,Ze.maxY,ye),_n=dr(an,Xe,ie+bn,ie+Gn,1,Ze.minY,Ze.maxY,ye),an=null),Ce>1&&console.timeEnd("clipping"),xe.push(Pt||[],B+1,2*K,2*ie),xe.push(Xt||[],B+1,2*K,2*ie+1),xe.push(Qt||[],B+1,2*K+1,2*ie),xe.push(_n||[],B+1,2*K+1,2*ie+1)}}},Qr.prototype.getTile=function(ae,B,K){var ie=this.options,oe=ie.extent,ge=ie.debug;if(ae<0||ae>24)return null;var Se=1<<ae,xe=Pi(ae,B=(B%Se+Se)%Se,K);if(this.tiles[xe])return yi(this.tiles[xe],oe);ge>1&&console.log("drilling down to z%d-%d-%d",ae,B,K);for(var ye,Ce=ae,Xe=B,ut=K;!ye&&Ce>0;)Ce--,Xe=Math.floor(Xe/2),ut=Math.floor(ut/2),ye=this.tiles[Pi(Ce,Xe,ut)];return ye&&ye.source?(ge>1&&console.log("found parent tile z%d-%d-%d",Ce,Xe,ut),ge>1&&console.time("drilling down"),this.splitTile(ye.source,Ce,Xe,ut,ae,B,K),ge>1&&console.timeEnd("drilling down"),this.tiles[xe]?yi(this.tiles[xe],oe):null):null};class ji extends M{constructor(B,K,ie,oe){super(B,K,ie,Ai),oe&&(this.loadGeoJSON=oe)}loadData(B,K){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const oe=!!(B&&B.request&&B.request.collectResourceTiming)&&new s.RequestPerformance(B.request);this._pendingCallback=K,this._pendingRequest=this.loadGeoJSON(B,(ge,Se)=>{if(delete this._pendingCallback,delete this._pendingRequest,ge||!Se)return K(ge);if(typeof Se!="object")return K(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));{$(Se,!0);try{if(B.filter){const ye=s.createExpression(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ye.result==="error")throw new Error(ye.value.map(Xe=>`${Xe.key}: ${Xe.message}`).join(", "));Se={type:"FeatureCollection",features:Se.features.filter(Xe=>ye.value.evaluate({zoom:0},Xe))}}this._geoJSONIndex=B.cluster?new dt(function({superclusterOptions:ye,clusterProperties:Ce}){if(!Ce||!ye)return ye;const Xe={},ut={},Ze={accumulated:null,zoom:0},Ct={properties:null},Ut=Object.keys(Ce);for(const Pt of Ut){const[Xt,Qt]=Ce[Pt],_n=s.createExpression(Qt),en=s.createExpression(typeof Xt=="string"?[Xt,["accumulated"],["get",Pt]]:Xt);Xe[Pt]=_n.value,ut[Pt]=en.value}return ye.map=Pt=>{Ct.properties=Pt;const Xt={};for(const Qt of Ut)Xt[Qt]=Xe[Qt].evaluate(Ze,Ct);return Xt},ye.reduce=(Pt,Xt)=>{Ct.properties=Xt;for(const Qt of Ut)Ze.accumulated=Pt[Qt],Pt[Qt]=ut[Qt].evaluate(Ze,Ct)},ye}(B)).load(Se.features):function(ye,Ce){return new Qr(ye,Ce)}(Se,B.geojsonVtOptions)}catch(ye){return K(ye)}this.loaded={};const xe={};if(oe){const ye=oe.finish();ye&&(xe.resourceTiming={},xe.resourceTiming[B.source]=JSON.parse(JSON.stringify(ye)))}K(null,xe)}})}reloadTile(B,K){const ie=this.loaded;return ie&&ie[B.uid]?super.reloadTile(B,K):this.loadTile(B,K)}loadGeoJSON(B,K){if(B.request)return s.getJSON(B.request,K);if(typeof B.data=="string")try{K(null,JSON.parse(B.data))}catch{K(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`))}else K(new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(B,K){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),K()}getClusterExpansionZoom(B,K){try{K(null,this._geoJSONIndex.getClusterExpansionZoom(B.clusterId))}catch(ie){K(ie)}}getClusterChildren(B,K){try{K(null,this._geoJSONIndex.getChildren(B.clusterId))}catch(ie){K(ie)}}getClusterLeaves(B,K){try{K(null,this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset))}catch(ie){K(ie)}}}class vi{constructor(B){this.self=B,this.actor=new s.Actor(B,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:M,geojson:ji},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(K,ie)=>{if(this.workerSourceTypes[K])throw new Error(`Worker source with name "${K}" already registered.`);this.workerSourceTypes[K]=ie},this.self.registerRTLTextPlugin=K=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=K.applyArabicShaping,s.plugin.processBidirectionalText=K.processBidirectionalText,s.plugin.processStyledBidirectionalText=K.processStyledBidirectionalText}}setReferrer(B,K){this.referrer=K}setImages(B,K,ie){this.availableImages[B]=K;for(const oe in this.workerSources[B]){const ge=this.workerSources[B][oe];for(const Se in ge)ge[Se].availableImages=K}ie()}setLayers(B,K,ie){this.getLayerIndex(B).replace(K),ie()}updateLayers(B,K,ie){this.getLayerIndex(B).update(K.layers,K.removedIds),ie()}loadTile(B,K,ie){this.getWorkerSource(B,K.type,K.source).loadTile(K,ie)}loadDEMTile(B,K,ie){this.getDEMWorkerSource(B,K.source).loadTile(K,ie)}reloadTile(B,K,ie){this.getWorkerSource(B,K.type,K.source).reloadTile(K,ie)}abortTile(B,K,ie){this.getWorkerSource(B,K.type,K.source).abortTile(K,ie)}removeTile(B,K,ie){this.getWorkerSource(B,K.type,K.source).removeTile(K,ie)}removeDEMTile(B,K){this.getDEMWorkerSource(B,K.source).removeTile(K)}removeSource(B,K,ie){if(!this.workerSources[B]||!this.workerSources[B][K.type]||!this.workerSources[B][K.type][K.source])return;const oe=this.workerSources[B][K.type][K.source];delete this.workerSources[B][K.type][K.source],oe.removeSource!==void 0?oe.removeSource(K,ie):ie()}loadWorkerSource(B,K,ie){try{this.self.importScripts(K.url),ie()}catch(oe){ie(oe.toString())}}syncRTLPluginState(B,K,ie){try{s.plugin.setState(K);const oe=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&oe!=null){this.self.importScripts(oe);const ge=s.plugin.isParsed();ie(ge?void 0:new Error(`RTL Text Plugin failed to import scripts from ${oe}`),ge)}}catch(oe){ie(oe.toString())}}getAvailableImages(B){let K=this.availableImages[B];return K||(K=[]),K}getLayerIndex(B){let K=this.layerIndexes[B];return K||(K=this.layerIndexes[B]=new E),K}getWorkerSource(B,K,ie){if(this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][K]||(this.workerSources[B][K]={}),!this.workerSources[B][K][ie]){const oe={send:(ge,Se,xe)=>{this.actor.send(ge,Se,xe,B)}};this.workerSources[B][K][ie]=new this.workerSourceTypes[K](oe,this.getLayerIndex(B),this.getAvailableImages(B))}return this.workerSources[B][K][ie]}getDEMWorkerSource(B,K){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][K]||(this.demWorkerSources[B][K]=new U),this.demWorkerSources[B][K]}enforceCacheSizeLimit(B,K){s.enforceCacheSizeLimit(K)}}return s.isWorker()&&(self.worker=new vi(self)),vi}),d(["./shared"],function(s){var _=v;function v(m){return!function(i){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,y,b=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(b);try{y=new Worker(k),f=!0}catch{f=!1}return y&&y.terminate(),URL.revokeObjectURL(k),f}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var f=document.createElement("canvas");f.width=f.height=1;var y=f.getContext("2d");if(!y)return!1;var b=y.getImageData(0,0,1,1);return b&&b.width===f.width}()?(E[u=i&&i.failIfMajorPerformanceCaveat]===void 0&&(E[u]=function(f){var y,b=function(k){var I=document.createElement("canvas"),R=Object.create(v.webGLContextAttributes);return R.failIfMajorPerformanceCaveat=k,I.getContext("webgl",R)||I.getContext("experimental-webgl",R)}(f);if(!b)return!1;try{y=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!y||b.isContextLost())&&(b.shaderSource(y,"void main() {}"),b.compileShader(y),b.getShaderParameter(y,b.COMPILE_STATUS)===!0)}(u)),E[u]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var u}(m)}var E={};function T(m,i){if(Array.isArray(m)){if(!Array.isArray(i)||m.length!==i.length)return!1;for(let u=0;u<m.length;u++)if(!T(m[u],i[u]))return!1;return!0}if(typeof m=="object"&&m!==null&&i!==null){if(typeof i!="object"||Object.keys(m).length!==Object.keys(i).length)return!1;for(const u in m)if(!T(m[u],i[u]))return!1;return!0}return m===i}v.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class S{static testProp(i){if(!S.docStyle)return i[0];for(let u=0;u<i.length;u++)if(i[u]in S.docStyle)return i[u];return i[0]}static create(i,u,f){const y=window.document.createElement(i);return u!==void 0&&(y.className=u),f&&f.appendChild(y),y}static createNS(i,u){return window.document.createElementNS(i,u)}static disableDrag(){S.docStyle&&S.selectProp&&(S.userSelect=S.docStyle[S.selectProp],S.docStyle[S.selectProp]="none")}static enableDrag(){S.docStyle&&S.selectProp&&(S.docStyle[S.selectProp]=S.userSelect)}static setTransform(i,u){i.style[S.transformProp]=u}static addEventListener(i,u,f,y={}){i.addEventListener(u,f,"passive"in y?y:y.capture)}static removeEventListener(i,u,f,y={}){i.removeEventListener(u,f,"passive"in y?y:y.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",S.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",S.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",S.suppressClickInternal,!0)},0)}static mousePos(i,u){const f=i.getBoundingClientRect();return new s.pointGeometry(u.clientX-f.left-i.clientLeft,u.clientY-f.top-i.clientTop)}static touchPos(i,u){const f=i.getBoundingClientRect(),y=[];for(let b=0;b<u.length;b++)y.push(new s.pointGeometry(u[b].clientX-f.left-i.clientLeft,u[b].clientY-f.top-i.clientTop));return y}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}S.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,S.selectProp=S.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),S.transformProp=S.testProp(["transform","WebkitTransform"]);class D{constructor(i){this._transformRequestFn=i}transformRequest(i,u){return this._transformRequestFn&&this._transformRequestFn(i,u)||{url:i}}normalizeSpriteURL(i,u,f){const y=function(b){const k=b.match(O);if(!k)throw new Error(`Unable to parse URL "${b}"`);return{protocol:k[1],authority:k[2],path:k[3]||"/",params:k[4]?k[4].split("&"):[]}}(i);return y.path+=`${u}${f}`,function(b){const k=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${k}`}(y)}setTransformRequest(i){this._transformRequestFn=i}}const O=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class M{constructor(i,u,f,y){this.context=i,this.format=f,this.texture=i.gl.createTexture(),this.update(u,y)}update(i,u,f){const{width:y,height:b}=i,k=!(this.size&&this.size[0]===y&&this.size[1]===b||f),{context:I}=this,{gl:R}=I;if(this.useMipmap=Boolean(u&&u.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!u||u.premultiply!==!1)),k)this.size=[y,b],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||s.isImageBitmap(i)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,i):R.texImage2D(R.TEXTURE_2D,0,this.format,y,b,0,this.format,R.UNSIGNED_BYTE,i.data);else{const{x:z,y:q}=f||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||s.isImageBitmap(i)?R.texSubImage2D(R.TEXTURE_2D,0,z,q,R.RGBA,R.UNSIGNED_BYTE,i):R.texSubImage2D(R.TEXTURE_2D,0,z,q,y,b,R.RGBA,R.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(i,u,f){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),f!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=b.LINEAR),i!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,i),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,f||i),this.filter=i),u!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function U(m){const{userImage:i}=m;return!!(i&&i.render&&i.render())&&(m.data.replace(new Uint8Array(i.data.buffer)),!0)}class $ extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,callback:f}of this.requestors)this._notify(u,f);this.requestors=[]}}getImage(i){return this.images[i]}addImage(i,u){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let f=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new s.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),f=!1),f}_validateStretch(i,u){if(!i)return!0;let f=0;for(const y of i){if(y[0]<f||y[1]<y[0]||u<y[1])return!1;f=y[1]}return!0}_validateContent(i,u){return!(i&&(i.length!==4||i[0]<0||u.data.width<i[0]||i[1]<0||u.data.height<i[1]||i[2]<0||u.data.width<i[2]||i[3]<0||u.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,u){const f=this.images[i];if(f.data.width!==u.data.width||f.data.height!==u.data.height)throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=f.version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,u){let f=!0;if(!this.isLoaded())for(const y of i)this.images[y]||(f=!1);this.isLoaded()||f?this._notify(i,u):this.requestors.push({ids:i,callback:u})}_notify(i,u){const f={};for(const y of i){this.images[y]||this.fire(new s.Event("styleimagemissing",{id:y}));const b=this.images[y];b?f[y]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:s.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,f)}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],f=this.getImage(i);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},b=new s.ImagePosition(y,f);this.patterns[i]={bin:y,position:b}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new M(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const b in this.patterns)i.push(this.patterns[b].bin);const{w:u,h:f}=s.potpack(i),y=this.atlasImage;y.resize({width:u||1,height:f||1});for(const b in this.patterns){const{bin:k}=this.patterns[b],I=k.x+1,R=k.y+1,z=this.images[b].data,q=z.width,Y=z.height;s.RGBAImage.copy(z,y,{x:0,y:0},{x:I,y:R},{width:q,height:Y}),s.RGBAImage.copy(z,y,{x:0,y:Y-1},{x:I,y:R-1},{width:q,height:1}),s.RGBAImage.copy(z,y,{x:0,y:0},{x:I,y:R+Y},{width:q,height:1}),s.RGBAImage.copy(z,y,{x:q-1,y:0},{x:I-1,y:R},{width:1,height:Y}),s.RGBAImage.copy(z,y,{x:0,y:0},{x:I+q,y:R},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.images[u];f||s.warnOnce(`Image with ID: "${u}" was not found`),U(f)&&this.updateImage(u,f)}}}const L=1e20;function F(m,i,u,f,y,b,k,I,R){for(let z=i;z<i+f;z++)J(m,u*b+z,b,y,k,I,R);for(let z=u;z<u+y;z++)J(m,z*b+i,1,f,k,I,R)}function J(m,i,u,f,y,b,k){b[0]=0,k[0]=-L,k[1]=L,y[0]=m[i];for(let I=1,R=0,z=0;I<f;I++){y[I]=m[i+I*u];const q=I*I;do{const Y=b[R];z=(y[I]-y[Y]+q-Y*Y)/(I-Y)/2}while(z<=k[R]&&--R>-1);R++,b[R]=I,k[R]=z,k[R+1]=L}for(let I=0,R=0;I<f;I++){for(;k[R+1]<I;)R++;const z=b[R],q=I-z;m[i+I*u]=y[z]+q*q}}class V{constructor(i,u){this.requestManager=i,this.localIdeographFontFamily=u,this.entries={}}setURL(i){this.url=i}getGlyphs(i,u){const f=[];for(const y in i)for(const b of i[y])f.push({stack:y,id:b});s.asyncAll(f,({stack:y,id:b},k)=>{let I=this.entries[y];I||(I=this.entries[y]={glyphs:{},requests:{},ranges:{}});let R=I.glyphs[b];if(R!==void 0)return void k(null,{stack:y,id:b,glyph:R});if(R=this._tinySDF(I,y,b),R)return I.glyphs[b]=R,void k(null,{stack:y,id:b,glyph:R});const z=Math.floor(b/256);if(256*z>65535)return void k(new Error("glyphs > 65535 not supported"));if(I.ranges[z])return void k(null,{stack:y,id:b,glyph:R});let q=I.requests[z];q||(q=I.requests[z]=[],V.loadGlyphRange(y,z,this.url,this.requestManager,(Y,ee)=>{if(ee){for(const fe in ee)this._doesCharSupportLocalGlyph(+fe)||(I.glyphs[+fe]=ee[+fe]);I.ranges[z]=!0}for(const fe of q)fe(Y,ee);delete I.requests[z]})),q.push((Y,ee)=>{Y?k(Y):ee&&k(null,{stack:y,id:b,glyph:ee[b]||null})})},(y,b)=>{if(y)u(y);else if(b){const k={};for(const{stack:I,id:R,glyph:z}of b)(k[I]||(k[I]={}))[R]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};u(null,k)}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(s.unicodeBlockLookup["CJK Unified Ideographs"](i)||s.unicodeBlockLookup["Hangul Syllables"](i)||s.unicodeBlockLookup.Hiragana(i)||s.unicodeBlockLookup.Katakana(i))}_tinySDF(i,u,f){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let b=i.tinySDF;if(!b){let I="400";/bold/i.test(u)?I="900":/medium/i.test(u)?I="500":/light/i.test(u)&&(I="200"),b=i.tinySDF=new V.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:y,fontWeight:I})}const k=b.draw(String.fromCharCode(f));return{id:f,bitmap:new s.AlphaImage({width:k.width||30,height:k.height||30},k.data),metrics:{width:k.glyphWidth||24,height:k.glyphHeight||24,left:k.glyphLeft||0,top:k.glyphTop-27||-8,advance:k.glyphAdvance||24}}}}V.loadGlyphRange=function(m,i,u,f,y){const b=256*i,k=b+255,I=f.transformRequest(u.replace("{fontstack}",m).replace("{range}",`${b}-${k}`),s.ResourceType.Glyphs);s.getArrayBuffer(I,(R,z)=>{if(R)y(R);else if(z){const q={};for(const Y of s.parseGlyphPbf(z))q[Y.id]=Y;y(null,q)}})},V.TinySDF=class{constructor({fontSize:m=24,buffer:i=3,radius:u=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:b="normal",fontStyle:k="normal"}={}){this.buffer=i,this.cutoff=f,this.radius=u;const I=this.size=m+4*i,R=this._createCanvas(I),z=this.ctx=R.getContext("2d",{willReadFrequently:!0});z.font=`${k} ${b} ${m}px ${y}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(m){const i=document.createElement("canvas");return i.width=i.height=m,i}draw(m){const{width:i,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:b}=this.ctx.measureText(m),k=Math.ceil(u),I=Math.min(this.size-this.buffer,Math.ceil(b-y)),R=Math.min(this.size-this.buffer,k+Math.ceil(f)),z=I+2*this.buffer,q=R+2*this.buffer,Y=Math.max(z*q,0),ee=new Uint8ClampedArray(Y),fe={data:ee,width:z,height:q,glyphWidth:I,glyphHeight:R,glyphTop:k,glyphLeft:0,glyphAdvance:i};if(I===0||R===0)return fe;const{ctx:se,buffer:ce,gridInner:Te,gridOuter:Re}=this;se.clearRect(ce,ce,I,R),se.fillText(m,ce,ce+k);const Be=se.getImageData(ce,ce,I,R);Re.fill(L,0,Y),Te.fill(0,0,Y);for(let pe=0;pe<R;pe++)for(let Ge=0;Ge<I;Ge++){const Ue=Be.data[4*(pe*I+Ge)+3]/255;if(Ue===0)continue;const et=(pe+ce)*z+Ge+ce;if(Ue===1)Re[et]=0,Te[et]=L;else{const nt=.5-Ue;Re[et]=nt>0?nt*nt:0,Te[et]=nt<0?nt*nt:0}}F(Re,0,0,z,q,z,this.f,this.v,this.z),F(Te,ce,ce,I,R,z,this.f,this.v,this.z);for(let pe=0;pe<Y;pe++){const Ge=Math.sqrt(Re[pe])-Math.sqrt(Te[pe]);ee[pe]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return fe}};const Z=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(m,i){return s.sphericalToCartesian(m.expression.evaluate(i))}interpolate(m,i,u){return{x:s.number(m.x,i.x,u),y:s.number(m.y,i.y,u),z:s.number(m.z,i.z,u)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),G="-transition";class W extends s.Evented{constructor(i){super(),this._transitionable=new s.Transitionable(Z),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(s.validateLight,i,u))for(const f in i){const y=i[f];f.endsWith(G)?this._transitionable.setTransition(f.slice(0,-G.length),y):this._transitionable.setValue(f,y)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,f){return(!f||f.validate!==!1)&&s.emitValidationErrors(this,i.call(s.validateStyle,s.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class le{constructor(i,u){this.width=i,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,u){const f=i.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(i,u)),this.dashEntry[f]}getDashRanges(i,u,f){const y=[];let b=i.length%2==1?-i[i.length-1]*f:0,k=i[0]*f,I=!0;y.push({left:b,right:k,isDash:I,zeroLength:i[0]===0});let R=i[0];for(let z=1;z<i.length;z++){I=!I;const q=i[z];b=R*f,R+=q,k=R*f,y.push({left:b,right:k,isDash:I,zeroLength:q===0})}return y}addRoundDash(i,u,f){const y=u/2;for(let b=-f;b<=f;b++){const k=this.width*(this.nextRow+f+b);let I=0,R=i[I];for(let z=0;z<this.width;z++){z/R.right>1&&(R=i[++I]);const q=Math.abs(z-R.left),Y=Math.abs(z-R.right),ee=Math.min(q,Y);let fe;const se=b/f*(y+1);if(R.isDash){const ce=y-Math.abs(se);fe=Math.sqrt(ee*ee+ce*ce)}else fe=y-Math.sqrt(ee*ee+se*se);this.data[k+z]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(i){for(let I=i.length-1;I>=0;--I){const R=i[I],z=i[I+1];R.zeroLength?i.splice(I,1):z&&z.isDash===R.isDash&&(z.left=R.left,i.splice(I,1))}const u=i[0],f=i[i.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const y=this.width*this.nextRow;let b=0,k=i[b];for(let I=0;I<this.width;I++){I/k.right>1&&(k=i[++b]);const R=Math.abs(I-k.left),z=Math.abs(I-k.right),q=Math.min(R,z);this.data[y+I]=Math.max(0,Math.min(255,(k.isDash?q:-q)+128))}}addDash(i,u){const f=u?7:0,y=2*f+1;if(this.nextRow+y>this.height)return s.warnOnce("LineAtlas out of space"),null;let b=0;for(let I=0;I<i.length;I++)b+=i[I];if(b!==0){const I=this.width/b,R=this.getDashRanges(i,this.width,I);u?this.addRoundDash(R,I,f):this.addRegularDash(R)}const k={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:b};return this.nextRow+=y,this.dirty=!0,k}bind(i){const u=i.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}class Ie{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const f=this.workerPool.acquire(this.id);for(let y=0;y<f.length;y++){const b=new Ie.Actor(f[y],u,this.id);b.name=`Worker ${y}`,this.actors.push(b)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,u,f){s.asyncAll(this.actors,(y,b)=>{y.send(i,u,b)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function be(m,i,u){const f=function(y,b){if(y)return u(y);if(b){const k=s.pick(s.extend(b,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);b.vector_layers&&(k.vectorLayers=b.vector_layers,k.vectorLayerIds=k.vectorLayers.map(I=>I.id)),u(null,k)}};return m.url?s.getJSON(i.transformRequest(m.url,s.ResourceType.Source),f):s.exported.frame(()=>f(null,m))}Ie.Actor=s.Actor;class de{constructor(i,u,f){this.bounds=s.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),f=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*u),y=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*u),k=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*u);return i.x>=f&&i.x<b&&i.y>=y&&i.y<k}}class Ne extends s.Evented{constructor(i,u,f,y){if(super(),this.id=i,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(u,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=be(this._options,this.map._requestManager,(i,u)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i?this.fire(new s.ErrorEvent(i)):u&&(s.extend(this,u),u.bounds&&(this.tileBounds=new de(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}loadTile(i,u){const f=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),y={request:this.map._requestManager.transformRequest(f,s.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function b(k,I){return delete i.request,i.aborted?u(null):k&&k.status!==404?u(k):(I&&I.resourceTiming&&(i.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&i.setExpiryData(I),i.loadVectorData(I,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),u(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=u:i.request=i.actor.send("reloadTile",y,b.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",y,b.bind(this)))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ee extends s.Evented{constructor(i,u,f,y){super(),this.id=i,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},u),s.extend(this,s.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=be(this._options,this.map._requestManager,(i,u)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new s.ErrorEvent(i)):u&&(s.extend(this,u),u.bounds&&(this.tileBounds=new de(u.bounds,this.minzoom,this.maxzoom)),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,u){const f=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.request=s.getImage(this.map._requestManager.transformRequest(f,s.ResourceType.Tile),(y,b,k)=>{if(delete i.request,i.aborted)i.state="unloaded",u(null);else if(y)i.state="errored",u(y);else if(b){this.map._refreshExpiredTiles&&i.setExpiryData(k);const I=this.map.painter.context,R=I.gl;i.texture=this.map.painter.getTileTexture(b.width),i.texture?i.texture.update(b,{useMipmap:!0}):(i.texture=new M(I,b,R.RGBA,{useMipmap:!0}),i.texture.bind(R.LINEAR,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),I.extTextureFilterAnisotropic&&R.texParameterf(R.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax)),i.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),u(null)}})}abortTile(i,u){i.request&&(i.request.cancel(),delete i.request),u()}unloadTile(i,u){i.texture&&this.map.painter.saveTileTexture(i.texture),u()}hasTransition(){return!1}}let Oe;class ze extends Ee{constructor(i,u,f,y){super(i,u,f,y),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(i,u){const f=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function y(b,k){b&&(i.state="errored",u(b)),k&&(i.dem=k,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded",u(null))}i.request=s.getImage(this.map._requestManager.transformRequest(f,s.ResourceType.Tile),function(b,k){if(delete i.request,i.aborted)i.state="unloaded",u(null);else if(b)i.state="errored",u(b);else if(k){this.map._refreshExpiredTiles&&i.setExpiryData(k),delete k.cacheControl,delete k.expires;const I=s.isImageBitmap(k)&&(Oe==null&&(Oe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Oe)?k:s.exported.getImageData(k,1),R={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:I,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",R,y.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)}_getNeighboringTiles(i){const u=i.canonical,f=Math.pow(2,u.z),y=(u.x-1+f)%f,b=u.x===0?i.wrap-1:i.wrap,k=(u.x+1+f)%f,I=u.x+1===f?i.wrap+1:i.wrap,R={};return R[new s.OverscaledTileID(i.overscaledZ,b,u.z,y,u.y).key]={backfilled:!1},R[new s.OverscaledTileID(i.overscaledZ,I,u.z,k,u.y).key]={backfilled:!1},u.y>0&&(R[new s.OverscaledTileID(i.overscaledZ,b,u.z,y,u.y-1).key]={backfilled:!1},R[new s.OverscaledTileID(i.overscaledZ,i.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},R[new s.OverscaledTileID(i.overscaledZ,I,u.z,k,u.y-1).key]={backfilled:!1}),u.y+1<f&&(R[new s.OverscaledTileID(i.overscaledZ,b,u.z,y,u.y+1).key]={backfilled:!1},R[new s.OverscaledTileID(i.overscaledZ,i.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},R[new s.OverscaledTileID(i.overscaledZ,I,u.z,k,u.y+1).key]={backfilled:!1}),R}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})}}class rt extends s.Evented{constructor(i,u,f,y){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(y),this._data=u.data,this._options=s.extend({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const b=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*b,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*b,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:s.EXTENT,radius:(u.clusterRadius||50)*b,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData("content"),this}getClusterExpansionZoom(i,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},u),this}getClusterChildren(i,u){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},u),this}getClusterLeaves(i,u,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:u,offset:f},y),this}_updateWorkerData(i){const u=s.extend({},this.workerOptions),f=this._data;typeof f=="string"?(u.request=this.map._requestManager.transformRequest(s.exported.resolveURL(f),s.ResourceType.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(f),this._pendingLoads++,this.fire(new s.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,u,(y,b)=>{if(this._pendingLoads--,this._removed||b&&b.abandoned)return void this.fire(new s.Event("dataabort",{dataType:"source",sourceDataType:i}));let k=null;if(b&&b.resourceTiming&&b.resourceTiming[this.id]&&(k=b.resourceTiming[this.id].slice(0)),y)return void this.fire(new s.ErrorEvent(y));const I={dataType:"source",sourceDataType:i};this._collectResourceTiming&&k&&k.length>0&&s.extend(I,{resourceTiming:k}),this.fire(new s.Event("data",I))})}loaded(){return this._pendingLoads===0}loadTile(i,u){const f=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const y={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request=this.actor.send(f,y,(b,k)=>(delete i.request,i.unloadVectorData(),i.aborted?u(null):b?u(b):(i.loadVectorData(k,this.map.painter,f==="reloadTile"),u(null))))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var We=s.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ae extends s.Evented{constructor(i,u,f,y){super(),this.id=i,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=u}load(i,u){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(f,y)=>{this._loaded=!0,f?this.fire(new s.ErrorEvent(f)):y&&(this.image=y,i&&(this.coordinates=i),u&&u(),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}setCoordinates(i){this.coordinates=i;const u=i.map(s.MercatorCoordinate.fromLngLat);this.tileID=function(y){let b=1/0,k=1/0,I=-1/0,R=-1/0;for(const ee of y)b=Math.min(b,ee.x),k=Math.min(k,ee.y),I=Math.max(I,ee.x),R=Math.max(R,ee.y);const z=Math.max(I-b,R-k),q=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),Y=Math.pow(2,q);return new s.CanonicalTileID(q,Math.floor((b+I)/2*Y),Math.floor((k+R)/2*Y))}(u),this.minzoom=this.maxzoom=this.tileID.z;const f=u.map(y=>this.tileID.getTilePoint(y)._round());return this._boundsArray=new s.RasterBoundsArray,this._boundsArray.emplaceBack(f[0].x,f[0].y,0,0),this._boundsArray.emplaceBack(f[1].x,f[1].y,s.EXTENT,0),this._boundsArray.emplaceBack(f[3].x,f[3].y,0,s.EXTENT),this._boundsArray.emplaceBack(f[2].x,f[2].y,s.EXTENT,s.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new M(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}loadTile(i,u){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},u(null)):(i.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class He extends Ae{constructor(i,u,f,y){super(i,u,f,y),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const i=this.options;this.urls=[];for(const u of i.urls)this.urls.push(this.map._requestManager.transformRequest(u,s.ResourceType.Source).url);s.getVideo(this.urls,(u,f)=>{this._loaded=!0,u?this.fire(new s.ErrorEvent(u)):f&&(this.video=f,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const u=this.video.seekable;i<u.start(0)||i>u.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new M(i,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const f in this.tiles){const y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ft extends Ae{constructor(i,u,f,y){super(i,u,f,y),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(b=>!Array.isArray(b)||b.length!==2||b.some(k=>typeof k!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${i}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${i}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,f=u.gl;this.boundsBuffer||(this.boundsBuffer=u.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new M(u,this.canvas,f.RGBA,{premultiply:!0});for(const y in this.tiles){const b=this.tiles[y];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const Qe={vector:Ne,raster:Ee,"raster-dem":ze,geojson:rt,video:He,image:Ae,canvas:ft};function Rt(m,i){const u=s.create();return s.translate(u,u,[1,1,0]),s.scale(u,u,[.5*m.width,.5*m.height,1]),s.multiply(u,u,m.calculatePosMatrix(i.toUnwrapped()))}function zt(m,i,u,f,y,b){const k=function(Y,ee,fe){if(Y)for(const se of Y){const ce=ee[se];if(ce&&ce.source===fe&&ce.type==="fill-extrusion")return!0}else for(const se in ee){const ce=ee[se];if(ce.source===fe&&ce.type==="fill-extrusion")return!0}return!1}(y&&y.layers,i,m.id),I=b.maxPitchScaleFactor(),R=m.tilesIn(f,I,k);R.sort(X);const z=[];for(const Y of R)z.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(i,u,m._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,y,b,I,Rt(m.transform,Y.tileID))});const q=function(Y){const ee={},fe={};for(const se of Y){const ce=se.queryResults,Te=se.wrappedTileID,Re=fe[Te]=fe[Te]||{};for(const Be in ce){const pe=ce[Be],Ge=Re[Be]=Re[Be]||{},Ue=ee[Be]=ee[Be]||[];for(const et of pe)Ge[et.featureIndex]||(Ge[et.featureIndex]=!0,Ue.push(et))}}return ee}(z);for(const Y in q)q[Y].forEach(ee=>{const fe=ee.feature,se=m.getFeatureState(fe.layer["source-layer"],fe.id);fe.source=fe.layer.source,fe.layer["source-layer"]&&(fe.sourceLayer=fe.layer["source-layer"]),fe.state=se});return q}function X(m,i){const u=m.tileID,f=i.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}class tt{constructor(i,u){this.tileID=i,this.uid=s.uniqueId(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const u=i+this.timeAdded;u<s.exported.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.textures.forEach(u=>i.saveTileTexture(u)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(i,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(y,b){const k={};if(!b)return k;for(const I of y){const R=I.layerIds.map(z=>b.getLayer(z)).filter(Boolean);if(R.length!==0){I.layers=R,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(z=>R.filter(q=>q.id===z)[0]));for(const z of R)k[z.id]=I}}return k}(i.buckets,u.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const b=this.buckets[y];if(b instanceof s.SymbolBucket){if(this.hasSymbolBuckets=!0,!f)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const b=this.buckets[y];if(b instanceof s.SymbolBucket&&b.hasRTLText){this.hasRTLText=!0,s.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const y in this.buckets){const b=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(y).queryRadius(b))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new s.CollisionBoxArray}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(i)}const u=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new M(i,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new M(i,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,u,f,y,b,k,I,R,z,q){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:b,scale:k,tileSize:this.tileSize,pixelPosMatrix:q,transform:R,params:I,queryPadding:this.queryPadding*z},i,u,f):{}}querySourceFeatures(i,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),b=u?u.sourceLayer:"",k=y._geojsonTileLayer||y[b];if(!k)return;const I=s.createFilter(u&&u.filter),{z:R,x:z,y:q}=this.tileID.canonical,Y={z:R,x:z,y:q};for(let ee=0;ee<k.length;ee++){const fe=k.feature(ee);if(I.needGeometry){const Te=s.toEvaluationFeature(fe,!0);if(!I.filter(new s.EvaluationParameters(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!I.filter(new s.EvaluationParameters(this.tileID.overscaledZ),fe))continue;const se=f.getId(fe,b),ce=new s.GeoJSONFeature(fe,R,z,q,se);ce.tile=Y,i.push(ce)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const u=this.expirationTime;if(i.cacheControl){const f=s.parseCacheControl(i.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(u)if(this.expirationTime<u)y=!0;else{const b=this.expirationTime-u;b?this.expirationTime=f+Math.max(b,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!u.style.hasLayer(y))continue;const b=this.buckets[y],k=b.layers[0].sourceLayer||"_geojsonTileLayer",I=f[k],R=i[k];if(!I||!R||Object.keys(R).length===0)continue;b.update(R,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=u&&u.style&&u.style.getLayer(y);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=s.exported.now()+i}setDependencies(i,u){const f={};for(const y of u)f[y]=!0;this.dependencies[i]=f}hasDependency(i,u){for(const f of i){const y=this.dependencies[f];if(y){for(const b of u)if(y[b])return!0}}return!1}}class je{constructor(i,u){this.max=i,this.onRemove=u,this.reset()}reset(){for(const i in this.data)for(const u of this.data[i])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(i,u,f){const y=i.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const b={value:u,timeout:void 0};if(f!==void 0&&(b.timeout=setTimeout(()=>{this.remove(i,b)},f)),this.data[y].push(b),this.order.push(y),this.order.length>this.max){const k=this._getAndRemoveByKey(this.order[0]);k&&this.onRemove(k)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const u=this.data[i].shift();return u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),u.value}getByKey(i){const u=this.data[i];return u?u[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,u){if(!this.has(i))return this;const f=i.wrapped().key,y=u===void 0?0:this.data[f].indexOf(u),b=this.data[f][y];return this.data[f].splice(y,1),b.timeout&&clearTimeout(b.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(b.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(i){const u=[];for(const f in this.data)for(const y of this.data[f])i(y.value)||u.push(y);for(const f of u)this.remove(f.value.tileID,f)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,u,f){const y=String(u);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][y]=this.stateChanges[i][y]||{},s.extend(this.stateChanges[i][y],f),this.deletedStates[i]===null){this.deletedStates[i]={};for(const b in this.state[i])b!==y&&(this.deletedStates[i][b]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][y]===null){this.deletedStates[i][y]={};for(const b in this.state[i][y])f[b]||(this.deletedStates[i][y][b]=null)}else for(const b in f)this.deletedStates[i]&&this.deletedStates[i][y]&&this.deletedStates[i][y][b]===null&&delete this.deletedStates[i][y][b]}removeFeatureState(i,u,f){if(this.deletedStates[i]===null)return;const y=String(u);if(this.deletedStates[i]=this.deletedStates[i]||{},f&&u!==void 0)this.deletedStates[i][y]!==null&&(this.deletedStates[i][y]=this.deletedStates[i][y]||{},this.deletedStates[i][y][f]=null);else if(u!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][y])for(f in this.deletedStates[i][y]={},this.stateChanges[i][y])this.deletedStates[i][y][f]=null;else this.deletedStates[i][y]=null;else this.deletedStates[i]=null}getState(i,u){const f=String(u),y=s.extend({},(this.state[i]||{})[f],(this.stateChanges[i]||{})[f]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const b=this.deletedStates[i][u];if(b===null)return{};for(const k in b)delete y[k]}return y}initializeTileState(i,u){i.setFeatureState(this.state,u)}coalesceChanges(i,u){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const b={};for(const k in this.stateChanges[y])this.state[y][k]||(this.state[y][k]={}),s.extend(this.state[y][k],this.stateChanges[y][k]),b[k]=this.state[y][k];f[y]=b}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const b={};if(this.deletedStates[y]===null)for(const k in this.state[y])b[k]={},this.state[y][k]={};else for(const k in this.deletedStates[y]){if(this.deletedStates[y][k]===null)this.state[y][k]={};else for(const I of Object.keys(this.deletedStates[y][k]))delete this.state[y][k][I];b[k]=this.state[y][k]}f[y]=f[y]||{},s.extend(f[y],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in i)i[y].setFeatureState(f,u)}}class ke extends s.Evented{constructor(i,u,f){super(),this.id=i,this.dispatcher=f,this.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(y,b,k,I){const R=new Qe[b.type](y,b,k,I);if(R.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${R.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],R),R}(i,u,f,this),this._tiles={},this._cache=new je(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const u=this._tiles[i];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,u){return this._source.loadTile(i,u)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){this._source.abortTile&&this._source.abortTile(i,()=>{}),this._source.fire(new s.Event("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(i),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(we).map(i=>i.key)}getRenderableIds(i){const u=[];for(const f in this._tiles)this._isIdRenderable(f,i)&&u.push(this._tiles[f]);return i?u.sort((f,y)=>{const b=f.tileID,k=y.tileID,I=new s.pointGeometry(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),R=new s.pointGeometry(k.canonical.x,k.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-k.overscaledZ||R.y-I.y||R.x-I.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(we).map(f=>f.key)}hasRenderableParent(i){const u=this.findLoadedParent(i,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(i,u){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(u||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,u){const f=this._tiles[i];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,i,u)))}_tileLoaded(i,u,f,y){if(y)return i.state="errored",void(y.status!==404?this._source.fire(new s.ErrorEvent(y,{tile:i})):this.update(this.transform,this.terrain));i.timeAdded=s.exported.now(),f==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(u,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new s.Event("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const u=this.getRenderableIds();for(let y=0;y<u.length;y++){const b=u[y];if(i.neighboringTiles&&i.neighboringTiles[b]){const k=this.getTileByID(b);f(i,k),f(k,i)}}function f(y,b){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let k=b.tileID.canonical.x-y.tileID.canonical.x;const I=b.tileID.canonical.y-y.tileID.canonical.y,R=Math.pow(2,y.tileID.canonical.z),z=b.tileID.key;k===0&&I===0||Math.abs(I)>1||(Math.abs(k)>1&&(Math.abs(k+R)===1?k+=R:Math.abs(k-R)===1&&(k-=R)),b.dem&&y.dem&&(y.dem.backfillBorder(b.dem,k,I),y.neighboringTiles&&y.neighboringTiles[z]&&(y.neighboringTiles[z].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,u,f,y){for(const b in this._tiles){let k=this._tiles[b];if(y[b]||!k.hasData()||k.tileID.overscaledZ<=u||k.tileID.overscaledZ>f)continue;let I=k.tileID;for(;k&&k.tileID.overscaledZ>u+1;){const z=k.tileID.scaledTo(k.tileID.overscaledZ-1);k=this._tiles[z.key],k&&k.hasData()&&(I=z)}let R=I;for(;R.overscaledZ>u;)if(R=R.scaledTo(R.overscaledZ-1),i[R.key]){y[I.key]=I;break}}}findLoadedParent(i,u){if(i.key in this._loadedParentTiles){const f=this._loadedParentTiles[i.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=i.overscaledZ-1;f>=u;f--){const y=i.scaledTo(f),b=this._getLoadedTile(y);if(b)return b}}_getLoadedTile(i){const u=this._tiles[i.key];return u&&u.hasData()?u:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const u=Math.ceil(i.width/this._source.tileSize)+1,f=Math.ceil(i.height/this._source.tileSize)+1,y=Math.floor(u*f*5),b=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(i){const u=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,u){const f={};for(const y in this._tiles){const b=this._tiles[y];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+u),f[b.tileID.key]=b}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}update(i,u){if(this.transform=i,this.terrain=u,!this._sourceLoaded||this._paused)return;let f;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new s.OverscaledTileID(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(f=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u}),this._source.hasTile&&(f=f.filter(z=>this._source.hasTile(z)))):f=[];const y=i.coveringZoomLevel(this._source),b=Math.max(y-ke.maxOverzooming,this._source.minzoom),k=Math.max(y+ke.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const q of f)if(q.canonical.z>this._source.minzoom){const Y=q.scaledTo(q.canonical.z-1);z[Y.key]=Y;const ee=q.scaledTo(Math.max(this._source.minzoom,Math.min(q.canonical.z,5)));z[ee.key]=ee}f=f.concat(Object.values(z))}const I=this._updateRetainedTiles(f,y);if(De(this._source.type)){const z={},q={},Y=Object.keys(I);for(const ee of Y){const fe=I[ee],se=this._tiles[ee];if(!se||se.fadeEndTime&&se.fadeEndTime<=s.exported.now())continue;const ce=this.findLoadedParent(fe,b);ce&&(this._addTile(ce.tileID),z[ce.tileID.key]=ce.tileID),q[ee]=fe}this._retainLoadedChildren(q,y,k,I);for(const ee in z)I[ee]||(this._coveredTiles[ee]=!0,I[ee]=z[ee]);if(u){const ee={},fe={};for(const se of f)this._tiles[se.key].hasData()?ee[se.key]=se:fe[se.key]=se;for(const se in fe){const ce=fe[se].children(this._source.maxzoom);this._tiles[ce[0].key]&&this._tiles[ce[1].key]&&this._tiles[ce[2].key]&&this._tiles[ce[3].key]&&(ee[ce[0].key]=I[ce[0].key]=ce[0],ee[ce[1].key]=I[ce[1].key]=ce[1],ee[ce[2].key]=I[ce[2].key]=ce[2],ee[ce[3].key]=I[ce[3].key]=ce[3],delete fe[se])}for(const se in fe){const ce=this.findLoadedParent(fe[se],this._source.minzoom);if(ce){ee[ce.tileID.key]=I[ce.tileID.key]=ce.tileID;for(const Te in ee)ee[Te].isChildOf(ce.tileID)&&delete ee[Te]}}for(const se in this._tiles)ee[se]||(this._coveredTiles[se]=!0)}}for(const z in I)this._tiles[z].clearFadeHold();const R=s.keysDifference(this._tiles,I);for(const z of R){const q=this._tiles[z];q.hasSymbolBuckets&&!q.holdingForFade()?q.setHoldDuration(this.map._fadeDuration):q.hasSymbolBuckets&&!q.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,u){const f={},y={},b=Math.max(u-ke.maxOverzooming,this._source.minzoom),k=Math.max(u+ke.maxUnderzooming,this._source.minzoom),I={};for(const R of i){const z=this._addTile(R);f[R.key]=R,z.hasData()||u<this._source.maxzoom&&(I[R.key]=R)}this._retainLoadedChildren(I,u,k,f);for(const R of i){let z=this._tiles[R.key];if(z.hasData())continue;if(u+1>this._source.maxzoom){const Y=R.children(this._source.maxzoom)[0],ee=this.getTile(Y);if(ee&&ee.hasData()){f[Y.key]=Y;continue}}else{const Y=R.children(this._source.maxzoom);if(f[Y[0].key]&&f[Y[1].key]&&f[Y[2].key]&&f[Y[3].key])continue}let q=z.wasRequested();for(let Y=R.overscaledZ-1;Y>=b;--Y){const ee=R.scaledTo(Y);if(y[ee.key]||(y[ee.key]=!0,z=this.getTile(ee),!z&&q&&(z=this._addTile(ee)),z&&(f[ee.key]=ee,q=z.wasRequested(),z.hasData())))break}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const u=[];let f,y=this._tiles[i].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}u.push(y.key);const b=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(b),f)break;y=b}for(const b of u)this._loadedParentTiles[b]=f}}_addTile(i){let u=this._tiles[i.key];if(u)return u;u=this._cache.getAndRemove(i),u&&(this._setTileReloadTimer(i.key,u),u.tileID=i,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,u)));const f=u;return u||(u=new tt(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(u,this._tileLoaded.bind(this,u,i.key,u.state))),u.uses++,this._tiles[i.key]=u,f||this._source.fire(new s.Event("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(i,u){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const f=u.getExpiryTimeout();f&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},f))}_removeTile(i){const u=this._tiles[i];u&&(u.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,u,f){const y=[],b=this.transform;if(!b)return y;const k=f?b.getCameraQueryGeometry(i):i,I=i.map(se=>b.pointCoordinate(se,this.terrain)),R=k.map(se=>b.pointCoordinate(se,this.terrain)),z=this.getIds();let q=1/0,Y=1/0,ee=-1/0,fe=-1/0;for(const se of R)q=Math.min(q,se.x),Y=Math.min(Y,se.y),ee=Math.max(ee,se.x),fe=Math.max(fe,se.y);for(let se=0;se<z.length;se++){const ce=this._tiles[z[se]];if(ce.holdingForFade())continue;const Te=ce.tileID,Re=Math.pow(2,b.zoom-ce.tileID.overscaledZ),Be=u*ce.queryPadding*s.EXTENT/ce.tileSize/Re,pe=[Te.getTilePoint(new s.MercatorCoordinate(q,Y)),Te.getTilePoint(new s.MercatorCoordinate(ee,fe))];if(pe[0].x-Be<s.EXTENT&&pe[0].y-Be<s.EXTENT&&pe[1].x+Be>=0&&pe[1].y+Be>=0){const Ge=I.map(et=>Te.getTilePoint(et)),Ue=R.map(et=>Te.getTilePoint(et));y.push({tile:ce,tileID:Te,queryGeometry:Ge,cameraQueryGeometry:Ue,scale:Re})}}return y}getVisibleCoordinates(i){const u=this.getRenderableIds(i).map(f=>this._tiles[f].tileID);for(const f of u)f.posMatrix=this.transform.calculatePosMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(De(this._source.type))for(const i in this._tiles){const u=this._tiles[i];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=s.exported.now())return!0}return!1}setFeatureState(i,u,f){this._state.updateState(i=i||"_geojsonTileLayer",u,f)}removeFeatureState(i,u,f){this._state.removeFeatureState(i=i||"_geojsonTileLayer",u,f)}getFeatureState(i,u){return this._state.getState(i=i||"_geojsonTileLayer",u)}setDependencies(i,u,f){const y=this._tiles[i];y&&y.setDependencies(u,f)}reloadTilesForDependencies(i,u){for(const f in this._tiles)this._tiles[f].hasDependency(i,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(i,u))}}function we(m,i){const u=Math.abs(2*m.wrap)-+(m.wrap<0),f=Math.abs(2*i.wrap)-+(i.wrap<0);return m.overscaledZ-i.overscaledZ||f-u||i.canonical.y-m.canonical.y||i.canonical.x-m.canonical.x}function De(m){return m==="raster"||m==="image"||m==="video"}ke.maxOverzooming=10,ke.maxUnderzooming=3;const Pe="mapboxgl_preloaded_worker_pool";class lt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<lt.workerCount;)this.workers.push(new Worker(ss.workerUrl));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pe]}numActive(){return Object.keys(this.active).length}}const dt=Math.floor(s.exported.hardwareConcurrency/2);let ue;function Fe(){return ue||(ue=new lt),ue}function Ke(m,i){const u={};for(const f in m)f!=="ref"&&(u[f]=m[f]);return s.refProperties.forEach(f=>{f in i&&(u[f]=i[f])}),u}function it(m){m=m.slice();const i=Object.create(null);for(let u=0;u<m.length;u++)i[m[u].id]=m[u];for(let u=0;u<m.length;u++)"ref"in m[u]&&(m[u]=Ke(m[u],i[m[u].ref]));return m}lt.workerCount=Math.max(Math.min(dt,6),1);const ct={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function at(m,i,u){u.push({command:ct.addSource,args:[m,i[m]]})}function Ot(m,i,u){i.push({command:ct.removeSource,args:[m]}),u[m]=!0}function on(m,i,u,f){Ot(m,u,f),at(m,i,u)}function pn(m,i,u){let f;for(f in m[u])if(Object.prototype.hasOwnProperty.call(m[u],f)&&f!=="data"&&!T(m[u][f],i[u][f]))return!1;for(f in i[u])if(Object.prototype.hasOwnProperty.call(i[u],f)&&f!=="data"&&!T(m[u][f],i[u][f]))return!1;return!0}function sr(m,i,u,f,y,b){let k;for(k in i=i||{},m=m||{})Object.prototype.hasOwnProperty.call(m,k)&&(T(m[k],i[k])||u.push({command:b,args:[f,k,i[k],y]}));for(k in i)Object.prototype.hasOwnProperty.call(i,k)&&!Object.prototype.hasOwnProperty.call(m,k)&&(T(m[k],i[k])||u.push({command:b,args:[f,k,i[k],y]}))}function Qn(m){return m.id}function Jr(m,i){return m[i.id]=i,m}class xr{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.clamp(i,0,1);let u=1,f=this._distances[u];const y=i*this.paddedLength+this.padding;for(;f<y&&u<this._distances.length;)f=this._distances[++u];const b=u-1,k=this._distances[b],I=f-k,R=I>0?(y-k)/I:0;return this.points[b].mult(1-R).add(this.points[u].mult(R))}}function Ye(m,i){let u=!0;return m==="always"||m!=="never"&&i!=="never"||(u=!1),u}class _t{constructor(i,u,f){const y=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(u/f);for(let k=0;k<this.xCellCount*this.yCellCount;k++)y.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,f,y,b){this._forEachCell(u,f,y,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(b)}insertCircle(i,u,f,y){this._forEachCell(u-y,f-y,u+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(f),this.circles.push(y)}_insertBoxCell(i,u,f,y,b,k){this.boxCells[b].push(k)}_insertCircleCell(i,u,f,y,b,k){this.circleCells[b].push(k)}_query(i,u,f,y,b,k,I){if(f<0||i>this.width||y<0||u>this.height)return[];const R=[];if(i<=0&&u<=0&&this.width<=f&&this.height<=y){if(b)return[{key:null,x1:i,y1:u,x2:f,y2:y}];for(let z=0;z<this.boxKeys.length;z++)R.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const q=this.circles[3*z],Y=this.circles[3*z+1],ee=this.circles[3*z+2];R.push({key:this.circleKeys[z],x1:q-ee,y1:Y-ee,x2:q+ee,y2:Y+ee})}}else this._forEachCell(i,u,f,y,this._queryCell,R,{hitTest:b,overlapMode:k,seenUids:{box:{},circle:{}}},I);return R}query(i,u,f,y){return this._query(i,u,f,y,!1,null)}hitTest(i,u,f,y,b,k){return this._query(i,u,f,y,!0,b,k).length>0}hitTestCircle(i,u,f,y,b){const k=i-f,I=i+f,R=u-f,z=u+f;if(I<0||k>this.width||z<0||R>this.height)return!1;const q=[];return this._forEachCell(k,R,I,z,this._queryCellCircle,q,{hitTest:!0,overlapMode:y,circle:{x:i,y:u,radius:f},seenUids:{box:{},circle:{}}},b),q.length>0}_queryCell(i,u,f,y,b,k,I,R){const{seenUids:z,hitTest:q,overlapMode:Y}=I,ee=this.boxCells[b];if(ee!==null){const se=this.bboxes;for(const ce of ee)if(!z.box[ce]){z.box[ce]=!0;const Te=4*ce,Re=this.boxKeys[ce];if(i<=se[Te+2]&&u<=se[Te+3]&&f>=se[Te+0]&&y>=se[Te+1]&&(!R||R(Re))&&(!q||!Ye(Y,Re.overlapMode))&&(k.push({key:Re,x1:se[Te],y1:se[Te+1],x2:se[Te+2],y2:se[Te+3]}),q))return!0}}const fe=this.circleCells[b];if(fe!==null){const se=this.circles;for(const ce of fe)if(!z.circle[ce]){z.circle[ce]=!0;const Te=3*ce,Re=this.circleKeys[ce];if(this._circleAndRectCollide(se[Te],se[Te+1],se[Te+2],i,u,f,y)&&(!R||R(Re))&&(!q||!Ye(Y,Re.overlapMode))){const Be=se[Te],pe=se[Te+1],Ge=se[Te+2];if(k.push({key:Re,x1:Be-Ge,y1:pe-Ge,x2:Be+Ge,y2:pe+Ge}),q)return!0}}}return!1}_queryCellCircle(i,u,f,y,b,k,I,R){const{circle:z,seenUids:q,overlapMode:Y}=I,ee=this.boxCells[b];if(ee!==null){const se=this.bboxes;for(const ce of ee)if(!q.box[ce]){q.box[ce]=!0;const Te=4*ce,Re=this.boxKeys[ce];if(this._circleAndRectCollide(z.x,z.y,z.radius,se[Te+0],se[Te+1],se[Te+2],se[Te+3])&&(!R||R(Re))&&!Ye(Y,Re.overlapMode))return k.push(!0),!0}}const fe=this.circleCells[b];if(fe!==null){const se=this.circles;for(const ce of fe)if(!q.circle[ce]){q.circle[ce]=!0;const Te=3*ce,Re=this.circleKeys[ce];if(this._circlesCollide(se[Te],se[Te+1],se[Te+2],z.x,z.y,z.radius)&&(!R||R(Re))&&!Ye(Y,Re.overlapMode))return k.push(!0),!0}}}_forEachCell(i,u,f,y,b,k,I,R){const z=this._convertToXCellCoord(i),q=this._convertToYCellCoord(u),Y=this._convertToXCellCoord(f),ee=this._convertToYCellCoord(y);for(let fe=z;fe<=Y;fe++)for(let se=q;se<=ee;se++)if(b.call(this,i,u,f,y,this.xCellCount*se+fe,k,I,R))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,f,y,b,k){const I=y-i,R=b-u,z=f+k;return z*z>I*I+R*R}_circleAndRectCollide(i,u,f,y,b,k,I){const R=(k-y)/2,z=Math.abs(i-(y+R));if(z>R+f)return!1;const q=(I-b)/2,Y=Math.abs(u-(b+q));if(Y>q+f)return!1;if(z<=R||Y<=q)return!0;const ee=z-R,fe=Y-q;return ee*ee+fe*fe<=f*f}}function Kn(m,i,u,f,y){const b=s.create();return i?(s.scale(b,b,[1/y,1/y,1]),u||s.rotateZ(b,b,f.angle)):s.multiply(b,f.labelPlaneMatrix,m),b}function Dr(m,i,u,f,y){if(i){const b=s.clone(m);return s.scale(b,b,[y,y,1]),u||s.rotateZ(b,b,-f.angle),b}return f.glCoordMatrix}function cn(m,i,u){let f;u?(f=[m.x,m.y,u(m.x,m.y),1],s.transformMat4(f,f,i)):(f=[m.x,m.y,0,1],Ur(f,f,i));const y=f[3];return{point:new s.pointGeometry(f[0]/y,f[1]/y),signedDistanceFromCamera:y}}function Rr(m,i){return .5+m/i*.5}function br(m,i){const u=m[0]/m[3],f=m[1]/m[3];return u>=-i[0]&&u<=i[0]&&f>=-i[1]&&f<=i[1]}function dr(m,i,u,f,y,b,k,I,R,z){const q=f?m.textSizeData:m.iconSizeData,Y=s.evaluateSizeForZoom(q,u.transform.zoom),ee=[256/u.width*2+1,256/u.height*2+1],fe=f?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;fe.clear();const se=m.lineVertexArray,ce=f?m.text.placedSymbolArray:m.icon.placedSymbolArray,Te=u.transform.width/u.transform.height;let Re=!1;for(let Be=0;Be<ce.length;Be++){const pe=ce.get(Be);if(pe.hidden||pe.writingMode===s.WritingMode.vertical&&!Re){Jt(pe.numGlyphs,fe);continue}let Ge;if(Re=!1,z?(Ge=[pe.anchorX,pe.anchorY,z(pe.anchorX,pe.anchorY),1],s.transformMat4(Ge,Ge,i)):(Ge=[pe.anchorX,pe.anchorY,0,1],Ur(Ge,Ge,i)),!br(Ge,ee)){Jt(pe.numGlyphs,fe);continue}const Ue=Rr(u.transform.cameraToCenterDistance,Ge[3]),et=s.evaluateSizeForFeature(q,Y,pe),nt=k?et/Ue:et*Ue,gt=new s.pointGeometry(pe.anchorX,pe.anchorY),Je=cn(gt,y,z).point,Dt={},Tt=tn(pe,nt,!1,I,i,y,b,m.glyphOffsetArray,se,fe,Je,gt,Dt,Te,R,z);Re=Tt.useVertical,(Tt.notEnoughRoom||Re||Tt.needsFlipping&&tn(pe,nt,!0,I,i,y,b,m.glyphOffsetArray,se,fe,Je,gt,Dt,Te,R,z).notEnoughRoom)&&Jt(pe.numGlyphs,fe)}f?m.text.dynamicLayoutVertexBuffer.updateData(fe):m.icon.dynamicLayoutVertexBuffer.updateData(fe)}function ai(m,i,u,f,y,b,k,I,R,z,q,Y,ee){const fe=I.glyphStartIndex+I.numGlyphs,se=I.lineStartIndex,ce=I.lineStartIndex+I.lineLength,Te=i.getoffsetX(I.glyphStartIndex),Re=i.getoffsetX(fe-1),Be=er(m*Te,u,f,y,b,k,I.segment,se,ce,R,z,q,Y,ee);if(!Be)return null;const pe=er(m*Re,u,f,y,b,k,I.segment,se,ce,R,z,q,Y,ee);return pe?{first:Be,last:pe}:null}function xt(m,i,u,f){return m===s.WritingMode.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*f?{useVertical:!0}:(m===s.WritingMode.vertical?i.y<u.y:i.x>u.x)?{needsFlipping:!0}:null}function tn(m,i,u,f,y,b,k,I,R,z,q,Y,ee,fe,se,ce){const Te=i/24,Re=m.lineOffsetX*Te,Be=m.lineOffsetY*Te;let pe;if(m.numGlyphs>1){const Ge=m.glyphStartIndex+m.numGlyphs,Ue=m.lineStartIndex,et=m.lineStartIndex+m.lineLength,nt=ai(Te,I,Re,Be,u,q,Y,m,R,b,ee,se,ce);if(!nt)return{notEnoughRoom:!0};const gt=cn(nt.first.point,k,ce).point,Je=cn(nt.last.point,k,ce).point;if(f&&!u){const Dt=xt(m.writingMode,gt,Je,fe);if(Dt)return Dt}pe=[nt.first];for(let Dt=m.glyphStartIndex+1;Dt<Ge-1;Dt++)pe.push(er(Te*I.getoffsetX(Dt),Re,Be,u,q,Y,m.segment,Ue,et,R,b,ee,se,ce));pe.push(nt.last)}else{if(f&&!u){const Ue=cn(Y,y,ce).point,et=m.lineStartIndex+m.segment+1,nt=new s.pointGeometry(R.getx(et),R.gety(et)),gt=cn(nt,y,ce),Je=gt.signedDistanceFromCamera>0?gt.point:Kt(Y,nt,Ue,1,y,ce),Dt=xt(m.writingMode,Ue,Je,fe);if(Dt)return Dt}const Ge=er(Te*I.getoffsetX(m.glyphStartIndex),Re,Be,u,q,Y,m.segment,m.lineStartIndex,m.lineStartIndex+m.lineLength,R,b,ee,se,ce);if(!Ge)return{notEnoughRoom:!0};pe=[Ge]}for(const Ge of pe)s.addDynamicAttributes(z,Ge.point,Ge.angle);return{}}function Kt(m,i,u,f,y,b){const k=cn(m.add(m.sub(i)._unit()),y,b).point,I=u.sub(k);return u.add(I._mult(f/I.mag()))}function er(m,i,u,f,y,b,k,I,R,z,q,Y,ee,fe){const se=f?m-i:m+i;let ce=se>0?1:-1,Te=0;f&&(ce*=-1,Te=Math.PI),ce<0&&(Te+=Math.PI);let Re=ce>0?I+k:I+k+1,Be=y,pe=y,Ge=0,Ue=0;const et=Math.abs(se),nt=[];for(;Ge+Ue<=et;){if(Re+=ce,Re<I||Re>=R)return null;if(pe=Be,nt.push(Be),Be=Y[Re],Be===void 0){const Lt=new s.pointGeometry(z.getx(Re),z.gety(Re)),rn=cn(Lt,q,fe);if(rn.signedDistanceFromCamera>0)Be=Y[Re]=rn.point;else{const un=Re-ce;Be=Kt(Ge===0?b:new s.pointGeometry(z.getx(un),z.gety(un)),Lt,pe,et-Ge+1,q,fe)}}Ge+=Ue,Ue=pe.dist(Be)}const gt=(et-Ge)/Ue,Je=Be.sub(pe),Dt=Je.mult(gt)._add(pe);Dt._add(Je._unit()._perp()._mult(u*ce));const Tt=Te+Math.atan2(Be.y-pe.y,Be.x-pe.x);return nt.push(Dt),{point:Dt,angle:ee?Tt:0,path:nt}}const gi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Jt(m,i){for(let u=0;u<m;u++){const f=i.length;i.resize(f+4),i.float32.set(gi,3*f)}}function Ur(m,i,u){const f=i[0],y=i[1];return m[0]=u[0]*f+u[4]*y+u[12],m[1]=u[1]*f+u[5]*y+u[13],m[3]=u[3]*f+u[7]*y+u[15],m}const zn=100;class yi{constructor(i,u=new _t(i.width+200,i.height+200,25),f=new _t(i.width+200,i.height+200,25)){this.transform=i,this.grid=u,this.ignoredGrid=f,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+zn,this.screenBottomBoundary=i.height+zn,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,u,f,y,b,k){const I=this.projectAndGetPerspectiveRatio(y,i.anchorPointX,i.anchorPointY,k),R=f*I.perspectiveRatio,z=i.x1*R+I.point.x,q=i.y1*R+I.point.y,Y=i.x2*R+I.point.x,ee=i.y2*R+I.point.y;return!this.isInsideGrid(z,q,Y,ee)||u!=="always"&&this.grid.hitTest(z,q,Y,ee,u,b)||I.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[z,q,Y,ee],offscreen:this.isOffscreen(z,q,Y,ee)}}placeCollisionCircles(i,u,f,y,b,k,I,R,z,q,Y,ee,fe,se){const ce=[],Te=new s.pointGeometry(u.anchorX,u.anchorY),Re=cn(Te,k,se),Be=Rr(this.transform.cameraToCenterDistance,Re.signedDistanceFromCamera),pe=(q?b/Be:b*Be)/s.ONE_EM,Ge=cn(Te,I,se).point,Ue=ai(pe,y,u.lineOffsetX*pe,u.lineOffsetY*pe,!1,Ge,Te,u,f,I,{},!1,se);let et=!1,nt=!1,gt=!0;if(Ue){const Je=.5*ee*Be+fe,Dt=new s.pointGeometry(-100,-100),Tt=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Lt=new xr,rn=Ue.first,un=Ue.last;let Ht=[];for(let wn=rn.path.length-1;wn>=1;wn--)Ht.push(rn.path[wn]);for(let wn=1;wn<un.path.length;wn++)Ht.push(un.path[wn]);const Dn=2.5*Je;if(R){const wn=Ht.map(Sn=>cn(Sn,R,se));Ht=wn.some(Sn=>Sn.signedDistanceFromCamera<=0)?[]:wn.map(Sn=>Sn.point)}let Rn=[];if(Ht.length>0){const wn=Ht[0].clone(),Sn=Ht[0].clone();for(let On=1;On<Ht.length;On++)wn.x=Math.min(wn.x,Ht[On].x),wn.y=Math.min(wn.y,Ht[On].y),Sn.x=Math.max(Sn.x,Ht[On].x),Sn.y=Math.max(Sn.y,Ht[On].y);Rn=wn.x>=Dt.x&&Sn.x<=Tt.x&&wn.y>=Dt.y&&Sn.y<=Tt.y?[Ht]:Sn.x<Dt.x||wn.x>Tt.x||Sn.y<Dt.y||wn.y>Tt.y?[]:s.clipLine([Ht],Dt.x,Dt.y,Tt.x,Tt.y)}for(const wn of Rn){Lt.reset(wn,.25*Je);let Sn=0;Sn=Lt.length<=.5*Je?1:Math.ceil(Lt.paddedLength/Dn)+1;for(let On=0;On<Sn;On++){const Gr=On/Math.max(Sn-1,1),Fo=Lt.lerp(Gr),Eo=Fo.x+zn,Uo=Fo.y+zn;ce.push(Eo,Uo,Je,0);const Na=Eo-Je,ao=Uo-Je,Ri=Eo+Je,aa=Uo+Je;if(gt=gt&&this.isOffscreen(Na,ao,Ri,aa),nt=nt||this.isInsideGrid(Na,ao,Ri,aa),i!=="always"&&this.grid.hitTestCircle(Eo,Uo,Je,i,Y)&&(et=!0,!z))return{circles:[],offscreen:!1,collisionDetected:et}}}}return{circles:!z&&et||!nt||Be<this.perspectiveRatioCutoff?[]:ce,offscreen:gt,collisionDetected:et}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let f=1/0,y=1/0,b=-1/0,k=-1/0;for(const q of i){const Y=new s.pointGeometry(q.x+zn,q.y+zn);f=Math.min(f,Y.x),y=Math.min(y,Y.y),b=Math.max(b,Y.x),k=Math.max(k,Y.y),u.push(Y)}const I=this.grid.query(f,y,b,k).concat(this.ignoredGrid.query(f,y,b,k)),R={},z={};for(const q of I){const Y=q.key;if(R[Y.bucketInstanceId]===void 0&&(R[Y.bucketInstanceId]={}),R[Y.bucketInstanceId][Y.featureIndex])continue;const ee=[new s.pointGeometry(q.x1,q.y1),new s.pointGeometry(q.x2,q.y1),new s.pointGeometry(q.x2,q.y2),new s.pointGeometry(q.x1,q.y2)];s.polygonIntersectsPolygon(u,ee)&&(R[Y.bucketInstanceId][Y.featureIndex]=!0,z[Y.bucketInstanceId]===void 0&&(z[Y.bucketInstanceId]=[]),z[Y.bucketInstanceId].push(Y.featureIndex))}return z}insertCollisionBox(i,u,f,y,b,k){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:b,collisionGroupID:k,overlapMode:u},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,f,y,b,k){const I=f?this.ignoredGrid:this.grid,R={bucketInstanceId:y,featureIndex:b,collisionGroupID:k,overlapMode:u};for(let z=0;z<i.length;z+=4)I.insertCircle(R,i[z],i[z+1],i[z+2])}projectAndGetPerspectiveRatio(i,u,f,y){let b;return y?(b=[u,f,y(u,f),1],s.transformMat4(b,b,i)):(b=[u,f,0,1],Ur(b,b,i)),{point:new s.pointGeometry((b[0]/b[3]+1)/2*this.transform.width+zn,(-b[1]/b[3]+1)/2*this.transform.height+zn),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b[3]*.5}}isOffscreen(i,u,f,y){return f<zn||i>=this.screenRightBoundary||y<zn||u>this.screenBottomBoundary}isInsideGrid(i,u,f,y){return f>=0&&i<this.gridRightBoundary&&y>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=s.identity([]);return s.translate(i,i,[-100,-100,0]),i}}function Bn(m,i,u){return i*(s.EXTENT/(m.tileSize*Math.pow(2,u-m.tileID.overscaledZ)))}class lr{constructor(i,u,f,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class hn{constructor(i,u,f,y,b){this.text=new lr(i?i.text:null,u,f,b),this.icon=new lr(i?i.icon:null,u,y,b)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vi{constructor(i,u,f){this.text=i,this.icon=u,this.skipFade=f}}class Qr{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Pi{constructor(i,u,f,y,b){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=b}}class Ai{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[i]}}function ji(m,i,u,f,y){const{horizontalAlign:b,verticalAlign:k}=s.getAnchorAlignment(m),I=-(b-.5)*i,R=-(k-.5)*u,z=s.evaluateVariableOffset(m,f);return new s.pointGeometry(I+z[0]*y,R+z[1]*y)}function vi(m,i,u,f,y,b){const{x1:k,x2:I,y1:R,y2:z,anchorPointX:q,anchorPointY:Y}=m,ee=new s.pointGeometry(i,u);return f&&ee._rotate(y?b:-b),{x1:k+ee.x,y1:R+ee.y,x2:I+ee.x,y2:z+ee.y,anchorPointX:q,anchorPointY:Y}}class ae{constructor(i,u,f,y,b){this.transform=i.clone(),this.terrain=u,this.collisionIndex=new yi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ai(y),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,u,f,y){const b=f.getBucket(u),k=f.latestFeatureIndex;if(!b||!k||u.id!==b.layerIds[0])return;const I=f.collisionBoxArray,R=b.layers[0].layout,z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),q=f.tileSize/s.EXTENT,Y=this.transform.calculatePosMatrix(f.tileID.toUnwrapped()),ee=R.get("text-pitch-alignment")==="map",fe=R.get("text-rotation-alignment")==="map",se=Bn(f,1,this.transform.zoom),ce=Kn(Y,ee,fe,this.transform,se);let Te=null;if(ee){const Be=Dr(Y,ee,fe,this.transform,se);Te=s.multiply([],this.transform.labelPlaneMatrix,Be)}this.retainedQueryData[b.bucketInstanceId]=new Pi(b.bucketInstanceId,k,b.sourceLayerIndex,b.index,f.tileID);const Re={bucket:b,layout:R,posMatrix:Y,textLabelPlaneMatrix:ce,labelToScreenMatrix:Te,scale:z,textPixelRatio:q,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(y)for(const Be of b.sortKeyRanges){const{sortKey:pe,symbolInstanceStart:Ge,symbolInstanceEnd:Ue}=Be;i.push({sortKey:pe,symbolInstanceStart:Ge,symbolInstanceEnd:Ue,parameters:Re})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Re})}attemptAnchorPlacement(i,u,f,y,b,k,I,R,z,q,Y,ee,fe,se,ce,Te){const Re=[ee.textOffset0,ee.textOffset1],Be=ji(i,f,y,Re,b),pe=this.collisionIndex.placeCollisionBox(vi(u,Be.x,Be.y,k,I,this.transform.angle),Y,R,z,q.predicate,Te);if((!ce||this.collisionIndex.placeCollisionBox(vi(ce,Be.x,Be.y,k,I,this.transform.angle),Y,R,z,q.predicate,Te).box.length!==0)&&pe.box.length>0){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),ee.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ee.crossTileID]={textOffset:Re,width:f,height:y,anchor:i,textBoxScale:b,prevAnchor:Ge},this.markUsedJustification(fe,i,ee,se),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,se,ee),this.placedOrientations[ee.crossTileID]=se),{shift:Be,placedGlyphBoxes:pe}}}placeLayerBucketPart(i,u,f){const{bucket:y,layout:b,posMatrix:k,textLabelPlaneMatrix:I,labelToScreenMatrix:R,textPixelRatio:z,holdingForFade:q,collisionBoxArray:Y,partiallyEvaluatedTextSize:ee,collisionGroup:fe}=i.parameters,se=b.get("text-optional"),ce=b.get("icon-optional"),Te=s.getOverlapMode(b,"text-overlap","text-allow-overlap"),Re=Te==="always",Be=s.getOverlapMode(b,"icon-overlap","icon-allow-overlap"),pe=Be==="always",Ge=b.get("text-rotation-alignment")==="map",Ue=b.get("text-pitch-alignment")==="map",et=b.get("icon-text-fit")!=="none",nt=b.get("symbol-z-order")==="viewport-y",gt=Re&&(pe||!y.hasIconData()||ce),Je=pe&&(Re||!y.hasTextData()||se);!y.collisionArrays&&Y&&y.deserializeCollisionBoxes(Y);const Dt=(Tt,Lt)=>{if(u[Tt.crossTileID])return;if(q)return void(this.placements[Tt.crossTileID]=new Vi(!1,!1,!1));let rn=!1,un=!1,Ht=!0,Dn=null,Rn={box:null,offscreen:null},wn={box:null,offscreen:null},Sn=null,On=null,Gr=null,Fo=0,Eo=0,Uo=0;Lt.textFeatureIndex?Fo=Lt.textFeatureIndex:Tt.useRuntimeCollisionCircles&&(Fo=Tt.featureIndex),Lt.verticalTextFeatureIndex&&(Eo=Lt.verticalTextFeatureIndex);const Na=this.retainedQueryData[y.bucketInstanceId].tileID,ao=this.terrain?(Or,fn)=>this.terrain.getElevation(Na,Or,fn):null;for(const Or of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const fn=Lt[Or];fn&&(fn.elevation=ao?ao(fn.anchorPointX,fn.anchorPointY):0)}const Ri=Lt.textBox;if(Ri){const Or=An=>{let qr=s.WritingMode.horizontal;if(y.allowVerticalPlacement&&!An&&this.prevPlacement){const Wr=this.prevPlacement.placedOrientations[Tt.crossTileID];Wr&&(this.placedOrientations[Tt.crossTileID]=Wr,qr=Wr,this.markUsedOrientation(y,qr,Tt))}return qr},fn=(An,qr)=>{if(y.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&Lt.verticalTextBox){for(const Wr of y.writingModes)if(Wr===s.WritingMode.vertical?(Rn=qr(),wn=Rn):Rn=An(),Rn&&Rn.box&&Rn.box.length)break}else Rn=An()};if(b.get("text-variable-anchor")){let An=b.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Tt.crossTileID]){const rr=this.prevPlacement.variableOffsets[Tt.crossTileID];An.indexOf(rr.anchor)>0&&(An=An.filter(so=>so!==rr.anchor),An.unshift(rr.anchor))}const qr=(rr,so,ls)=>{const Wd=rr.x2-rr.x1,rl=rr.y2-rr.y1,dp=Tt.textBoxScale,Hd=et&&Be==="never"?so:null;let Oa={box:[],offscreen:!1};const cs=Te!=="never"?2*An.length:An.length;for(let us=0;us<cs;++us){const du=this.attemptAnchorPlacement(An[us%An.length],rr,Wd,rl,dp,Ge,Ue,z,k,fe,us>=An.length?Te:"never",Tt,y,ls,Hd,ao);if(du&&(Oa=du.placedGlyphBoxes,Oa&&Oa.box&&Oa.box.length)){rn=!0,Dn=du.shift;break}}return Oa};fn(()=>qr(Ri,Lt.iconBox,s.WritingMode.horizontal),()=>{const rr=Lt.verticalTextBox;return y.allowVerticalPlacement&&!(Rn&&Rn.box&&Rn.box.length)&&Tt.numVerticalGlyphVertices>0&&rr?qr(rr,Lt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null}}),Rn&&(rn=Rn.box,Ht=Rn.offscreen);const Wr=Or(Rn&&Rn.box);if(!rn&&this.prevPlacement){const rr=this.prevPlacement.variableOffsets[Tt.crossTileID];rr&&(this.variableOffsets[Tt.crossTileID]=rr,this.markUsedJustification(y,rr.anchor,Tt,Wr))}}else{const An=(qr,Wr)=>{const rr=this.collisionIndex.placeCollisionBox(qr,Te,z,k,fe.predicate,ao);return rr&&rr.box&&rr.box.length&&(this.markUsedOrientation(y,Wr,Tt),this.placedOrientations[Tt.crossTileID]=Wr),rr};fn(()=>An(Ri,s.WritingMode.horizontal),()=>{const qr=Lt.verticalTextBox;return y.allowVerticalPlacement&&Tt.numVerticalGlyphVertices>0&&qr?An(qr,s.WritingMode.vertical):{box:null,offscreen:null}}),Or(Rn&&Rn.box&&Rn.box.length)}}if(Sn=Rn,rn=Sn&&Sn.box&&Sn.box.length>0,Ht=Sn&&Sn.offscreen,Tt.useRuntimeCollisionCircles){const Or=y.text.placedSymbolArray.get(Tt.centerJustifiedTextSymbolIndex),fn=s.evaluateSizeForFeature(y.textSizeData,ee,Or),An=b.get("text-padding");On=this.collisionIndex.placeCollisionCircles(Te,Or,y.lineVertexArray,y.glyphOffsetArray,fn,k,I,R,f,Ue,fe.predicate,Tt.collisionCircleDiameter,An,ao),On.circles.length&&On.collisionDetected&&!f&&s.warnOnce("Collisions detected, but collision boxes are not shown"),rn=Re||On.circles.length>0&&!On.collisionDetected,Ht=Ht&&On.offscreen}if(Lt.iconFeatureIndex&&(Uo=Lt.iconFeatureIndex),Lt.iconBox){const Or=fn=>{const An=et&&Dn?vi(fn,Dn.x,Dn.y,Ge,Ue,this.transform.angle):fn;return this.collisionIndex.placeCollisionBox(An,Be,z,k,fe.predicate,ao)};wn&&wn.box&&wn.box.length&&Lt.verticalIconBox?(Gr=Or(Lt.verticalIconBox),un=Gr.box.length>0):(Gr=Or(Lt.iconBox),un=Gr.box.length>0),Ht=Ht&&Gr.offscreen}const aa=se||Tt.numHorizontalGlyphVertices===0&&Tt.numVerticalGlyphVertices===0,uu=ce||Tt.numIconVertices===0;if(aa||uu?uu?aa||(un=un&&rn):rn=un&&rn:un=rn=un&&rn,rn&&Sn&&Sn.box&&this.collisionIndex.insertCollisionBox(Sn.box,Te,b.get("text-ignore-placement"),y.bucketInstanceId,wn&&wn.box&&Eo?Eo:Fo,fe.ID),un&&Gr&&this.collisionIndex.insertCollisionBox(Gr.box,Be,b.get("icon-ignore-placement"),y.bucketInstanceId,Uo,fe.ID),On&&(rn&&this.collisionIndex.insertCollisionCircles(On.circles,Te,b.get("text-ignore-placement"),y.bucketInstanceId,Fo,fe.ID),f)){const Or=y.bucketInstanceId;let fn=this.collisionCircleArrays[Or];fn===void 0&&(fn=this.collisionCircleArrays[Or]=new Qr);for(let An=0;An<On.circles.length;An+=4)fn.circles.push(On.circles[An+0]),fn.circles.push(On.circles[An+1]),fn.circles.push(On.circles[An+2]),fn.circles.push(On.collisionDetected?1:0)}if(Tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Tt.crossTileID]=new Vi(rn||gt,un||Je,Ht||y.justReloaded),u[Tt.crossTileID]=!0};if(nt){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Tt=y.getSortedSymbolIndexes(this.transform.angle);for(let Lt=Tt.length-1;Lt>=0;--Lt){const rn=Tt[Lt];Dt(y.symbolInstances.get(rn),y.collisionArrays[rn])}}else for(let Tt=i.symbolInstanceStart;Tt<i.symbolInstanceEnd;Tt++)Dt(y.symbolInstances.get(Tt),y.collisionArrays[Tt]);if(f&&y.bucketInstanceId in this.collisionCircleArrays){const Tt=this.collisionCircleArrays[y.bucketInstanceId];s.invert(Tt.invProjMatrix,k),Tt.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1}markUsedJustification(i,u,f,y){let b;b=y===s.WritingMode.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[s.getAnchorJustification(u)];const k=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const I of k)I>=0&&(i.text.placedSymbolArray.get(I).crossTileID=b>=0&&I!==b?0:f.crossTileID)}markUsedOrientation(i,u,f){const y=u===s.WritingMode.horizontal||u===s.WritingMode.horizontalOnly?u:0,b=u===s.WritingMode.vertical?u:0,k=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const I of k)i.text.placedSymbolArray.get(I).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const y=u?u.symbolFadeChange(i):1,b=u?u.opacities:{},k=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const R in this.placements){const z=this.placements[R],q=b[R];q?(this.opacities[R]=new hn(q,y,z.text,z.icon),f=f||z.text!==q.text.placed||z.icon!==q.icon.placed):(this.opacities[R]=new hn(null,y,z.text,z.icon,z.skipFade),f=f||z.text||z.icon)}for(const R in b){const z=b[R];if(!this.opacities[R]){const q=new hn(z,y,!1,!1);q.isHidden()||(this.opacities[R]=q,f=f||z.text.placed||z.icon.placed)}}for(const R in k)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=k[R]);for(const R in I)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=I[R]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const f={};for(const y of u){const b=y.getBucket(i);b&&y.latestFeatureIndex&&i.id===b.layerIds[0]&&this.updateBucketOpacities(b,f,y.collisionBoxArray)}}updateBucketOpacities(i,u,f){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const y=i.layers[0].layout,b=new hn(null,0,!1,!1,!0),k=y.get("text-allow-overlap"),I=y.get("icon-allow-overlap"),R=y.get("text-variable-anchor"),z=y.get("text-rotation-alignment")==="map",q=y.get("text-pitch-alignment")==="map",Y=y.get("icon-text-fit")!=="none",ee=new hn(null,0,k&&(I||!i.hasIconData()||y.get("icon-optional")),I&&(k||!i.hasTextData()||y.get("text-optional")),!0);!i.collisionArrays&&f&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(f);const fe=(se,ce,Te)=>{for(let Re=0;Re<ce/4;Re++)se.opacityVertexArray.emplaceBack(Te)};for(let se=0;se<i.symbolInstances.length;se++){const ce=i.symbolInstances.get(se),{numHorizontalGlyphVertices:Te,numVerticalGlyphVertices:Re,crossTileID:Be}=ce;let pe=this.opacities[Be];u[Be]?pe=b:pe||(pe=ee,this.opacities[Be]=pe),u[Be]=!0;const Ge=ce.numIconVertices>0,Ue=this.placedOrientations[ce.crossTileID],et=Ue===s.WritingMode.vertical,nt=Ue===s.WritingMode.horizontal||Ue===s.WritingMode.horizontalOnly;if(Te>0||Re>0){const gt=Ce(pe.text);fe(i.text,Te,et?Xe:gt),fe(i.text,Re,nt?Xe:gt);const Je=pe.text.isHidden();[ce.rightJustifiedTextSymbolIndex,ce.centerJustifiedTextSymbolIndex,ce.leftJustifiedTextSymbolIndex].forEach(Lt=>{Lt>=0&&(i.text.placedSymbolArray.get(Lt).hidden=Je||et?1:0)}),ce.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(ce.verticalPlacedTextSymbolIndex).hidden=Je||nt?1:0);const Dt=this.variableOffsets[ce.crossTileID];Dt&&this.markUsedJustification(i,Dt.anchor,ce,Ue);const Tt=this.placedOrientations[ce.crossTileID];Tt&&(this.markUsedJustification(i,"left",ce,Tt),this.markUsedOrientation(i,Tt,ce))}if(Ge){const gt=Ce(pe.icon),Je=!(Y&&ce.verticalPlacedIconSymbolIndex&&et);ce.placedIconSymbolIndex>=0&&(fe(i.icon,ce.numIconVertices,Je?gt:Xe),i.icon.placedSymbolArray.get(ce.placedIconSymbolIndex).hidden=pe.icon.isHidden()),ce.verticalPlacedIconSymbolIndex>=0&&(fe(i.icon,ce.numVerticalIconVertices,Je?Xe:gt),i.icon.placedSymbolArray.get(ce.verticalPlacedIconSymbolIndex).hidden=pe.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const gt=i.collisionArrays[se];if(gt){let Je=new s.pointGeometry(0,0);if(gt.textBox||gt.verticalTextBox){let Tt=!0;if(R){const Lt=this.variableOffsets[Be];Lt?(Je=ji(Lt.anchor,Lt.width,Lt.height,Lt.textOffset,Lt.textBoxScale),z&&Je._rotate(q?this.transform.angle:-this.transform.angle)):Tt=!1}gt.textBox&&B(i.textCollisionBox.collisionVertexArray,pe.text.placed,!Tt||et,Je.x,Je.y),gt.verticalTextBox&&B(i.textCollisionBox.collisionVertexArray,pe.text.placed,!Tt||nt,Je.x,Je.y)}const Dt=Boolean(!nt&&gt.verticalIconBox);gt.iconBox&&B(i.iconCollisionBox.collisionVertexArray,pe.icon.placed,Dt,Y?Je.x:0,Y?Je.y:0),gt.verticalIconBox&&B(i.iconCollisionBox.collisionVertexArray,pe.icon.placed,!Dt,Y?Je.x:0,Y?Je.y:0)}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=se.invProjMatrix,i.placementViewportMatrix=se.viewportMatrix,i.collisionCircleArray=se.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>i}setStale(){this.stale=!0}}function B(m,i,u,f,y){m.emplaceBack(i?1:0,u?1:0,f||0,y||0),m.emplaceBack(i?1:0,u?1:0,f||0,y||0),m.emplaceBack(i?1:0,u?1:0,f||0,y||0),m.emplaceBack(i?1:0,u?1:0,f||0,y||0)}const K=Math.pow(2,25),ie=Math.pow(2,24),oe=Math.pow(2,17),ge=Math.pow(2,16),Se=Math.pow(2,9),xe=Math.pow(2,8),ye=Math.pow(2,1);function Ce(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const i=m.placed?1:0,u=Math.floor(127*m.opacity);return u*K+i*ie+u*oe+i*ge+u*Se+i*xe+u*ye+i}const Xe=0;class ut{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,f,y,b){const k=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(k,y,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((I,R)=>I.sortKey-R.sortKey));this._currentPartIndex<k.length;)if(u.placeLayerBucketPart(k[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,b())return!0;return!1}}class Ze{constructor(i,u,f,y,b,k,I,R){this.placement=new ae(i,u,k,I,R),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(i,u,f){const y=s.exported.now(),b=()=>{const k=s.exported.now()-y;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=u[i[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=I)&&(!k.maxzoom||k.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new ut(k)),this._inProgressLayer.continuePlacement(f[k.source],this.placement,this._showCollisionBoxes,k,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Ct=512/s.EXTENT/2;class Ut{constructor(i,u,f){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(let y=0;y<u.length;y++){const b=u.get(y),k=b.key;this.indexedSymbolInstances[k]||(this.indexedSymbolInstances[k]=[]),this.indexedSymbolInstances[k].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,i)})}}getScaledCoordinates(i,u){const f=Ct/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*s.EXTENT+i.anchorX)*f),y:Math.floor((u.canonical.y*s.EXTENT+i.anchorY)*f)}}findMatches(i,u,f){const y=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let b=0;b<i.length;b++){const k=i.get(b);if(k.crossTileID)continue;const I=this.indexedSymbolInstances[k.key];if(!I)continue;const R=this.getScaledCoordinates(k,u);for(const z of I)if(Math.abs(z.coord.x-R.x)<=y&&Math.abs(z.coord.y-R.y)<=y&&!f[z.crossTileID]){f[z.crossTileID]=!0,k.crossTileID=z.crossTileID;break}}}}class Pt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(u!==0)for(const f in this.indexes){const y=this.indexes[f],b={};for(const k in y){const I=y[k];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),b[I.tileID.key]=I}this.indexes[f]=b}this.lng=i}addBucket(i,u,f){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let b=0;b<u.symbolInstances.length;b++)u.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const y=this.usedCrossTileIDs[i.overscaledZ];for(const b in this.indexes){const k=this.indexes[b];if(Number(b)>i.overscaledZ)for(const I in k){const R=k[I];R.tileID.isChildOf(i)&&R.findMatches(u.symbolInstances,i,y)}else{const I=k[i.scaledTo(Number(b)).key];I&&I.findMatches(u.symbolInstances,i,y)}}for(let b=0;b<u.symbolInstances.length;b++){const k=u.symbolInstances.get(b);k.crossTileID||(k.crossTileID=f.generate(),y[k.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Ut(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const f in u.indexedSymbolInstances)for(const y of u.indexedSymbolInstances[f])delete this.usedCrossTileIDs[i][y.crossTileID]}removeStaleBuckets(i){let u=!1;for(const f in this.indexes){const y=this.indexes[f];for(const b in y)i[y[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[b]),delete y[b],u=!0)}return u}}class Qt{constructor(){this.layerIndexes={},this.crossTileIDs=new Pt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,f){let y=this.layerIndexes[i.id];y===void 0&&(y=this.layerIndexes[i.id]=new Xt);let b=!1;const k={};y.handleWrapJump(f);for(const I of u){const R=I.getBucket(i);R&&i.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(I.tileID,R,this.crossTileIDs)&&(b=!0),k[R.bucketInstanceId]=!0)}return y.removeStaleBuckets(k)&&(b=!0),b}pruneUnusedLayers(i){const u={};i.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var _n=s.createLayout([{name:"a_pos",type:"Int16",components:2}]);class en extends s.Evented{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=i._cache.max,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const i in this._tiles){const u=this._tiles[i];u.textures.forEach(f=>f.destroy()),u.textures=[]}}update(i,u){this.sourceCache.update(i,u),this._renderableTilesKeys=[];for(const f of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u}))this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.posMatrix=new Float64Array(16),s.ortho(f.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),this._tiles[f.key]=new tt(f,this.tileSize))}removeOutdated(i){const u={};this.renderHistory=this.renderHistory.filter((f,y)=>this.renderHistory.indexOf(f)===y).slice(0,this.renderHistorySize);for(const f of this._renderableTilesKeys)u[f]=!0;for(const f of this.renderHistory)u[f]=!0;for(const f in this._tiles)u[f]||(this._tiles[f].clearTextures(i),delete this._tiles[f])}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const u={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID;if(y.canonical.equals(i.canonical)){const b=i.clone();b.posMatrix=new Float64Array(16),s.ortho(b.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),u[f]=b}else if(y.canonical.isChildOf(i.canonical)){const b=i.clone();b.posMatrix=new Float64Array(16);const k=y.canonical.z-i.canonical.z,I=y.canonical.x-(y.canonical.x>>k<<k),R=y.canonical.y-(y.canonical.y>>k<<k),z=s.EXTENT>>k;s.ortho(b.posMatrix,0,z,0,z,0,1),s.translate(b.posMatrix,b.posMatrix,[-I*z,-R*z,0]),u[f]=b}else if(i.canonical.isChildOf(y.canonical)){const b=i.clone();b.posMatrix=new Float64Array(16);const k=i.canonical.z-y.canonical.z,I=i.canonical.x-(i.canonical.x>>k<<k),R=i.canonical.y-(i.canonical.y>>k<<k),z=s.EXTENT>>k;s.ortho(b.posMatrix,0,s.EXTENT,0,s.EXTENT,0,1),s.translate(b.posMatrix,b.posMatrix,[I*z,R*z,0]),s.scale(b.posMatrix,b.posMatrix,[1/2**k,1/2**k,0]),u[f]=b}}return u}getSourceTile(i,u){const f=this.sourceCache._source;let y=i.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(y).key);let b=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!b||!b.dem)&&u)for(;y>=f.minzoom&&(!b||!b.dem);)b=this.sourceCache.getTileByID(i.scaledTo(y--).key);return b}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(u=>u.timeLoaded>=i)}}class an{constructor(i,u,f){this.style=i,this.sourceCache=new en(u),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.elevationOffset=typeof f.elevationOffset=="number"?f.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(i,u,f,y=s.EXTENT){if(!(u>=0&&u<y&&f>=0&&f<y))return this.elevationOffset;let b=0;const k=this.getTerrainData(i);if(k.tile&&k.tile.dem){const I=s.transformMat4$1([],[u/y*s.EXTENT,f/y*s.EXTENT],k.u_terrain_matrix),R=[I[0]*k.tile.dem.dim,I[1]*k.tile.dem.dim],z=[Math.floor(R[0]),Math.floor(R[1])],q=k.tile.dem.get(z[0],z[1]),Y=k.tile.dem.get(z[0],z[1]+1),ee=k.tile.dem.get(z[0]+1,z[1]),fe=k.tile.dem.get(z[0]+1,z[1]+1);b=s.number(s.number(q,Y,R[0]-z[0]),s.number(ee,fe,R[0]-z[0]),R[1]-z[1])}return b}rememberForRerender(i,u){for(const f in this.sourceCache._tiles){const y=this.sourceCache._tiles[f];(y.tileID.equals(u)||y.tileID.isChildOf(u))&&(i===this.sourceCache.sourceCache.id&&(y.timeLoaded=Date.now()),this._rerender[i]=this._rerender[i]||{},this._rerender[i][y.tileID.key]=!0)}}needsRerender(i,u){return this._rerender[i]&&this._rerender[i][u.key]}clearRerenderCache(){this._rerender={}}getElevation(i,u,f,y=s.EXTENT){return(this.getDEMElevation(i,u,f,y)+this.elevationOffset)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const y=this.style.map.painter.context,b=new s.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new M(y,b,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new M(y,new s.RGBAImage({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.identity([])}const u=this.sourceCache.getSourceTile(i,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const y=this.style.map.painter.context;u.demTexture=this.style.map.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new M(y,u.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),u.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+i.key;if(f&&!this._demMatrixCache[f]){const y=this.sourceCache.sourceCache._source.maxzoom;let b=i.canonical.z-u.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=y?b=i.canonical.z-y:s.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const k=i.canonical.x-(i.canonical.x>>b<<b),I=i.canonical.y-(i.canonical.y>>b<<b),R=s.fromScaling(new Float64Array(16),[1/(s.EXTENT<<b),1/(s.EXTENT<<b),0]);s.translate(R,R,[k*s.EXTENT,I*s.EXTENT,0]),this._demMatrixCache[i.key]={matrix:R,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getRTTFramebuffer(){const i=this.style.map.painter;if(!this._rttFramebuffer){const u=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=i.context.createFramebuffer(u,u,!0),this._rttFramebuffer.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,u,u))}return this._rttFramebuffer}getFramebuffer(i){const u=this.style.map.painter,f=u.width/devicePixelRatio,y=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new M(u.context,{width:f,height:y,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new M(u.context,{width:f,height:y,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,y,!0),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let b=0,k=0;b<this._coordsTextureSize;b++)for(let I=0;I<this._coordsTextureSize;I++,k+=4)u[k+0]=255&I,u[k+1]=255&b,u[k+2]=I>>8<<4|b>>8,u[k+3]=0;const f=new s.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),y=new M(i,f,i.gl.RGBA,{premultiply:!1});return y.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(i){const u=new Uint8Array(4),f=this.style.map.painter,y=f.context,b=y.gl;y.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),b.readPixels(i.x,f.height/devicePixelRatio-i.y-1,1,1,b.RGBA,b.UNSIGNED_BYTE,u),y.bindFramebuffer.set(null);const k=u[0]+(u[2]>>4<<8),I=u[1]+((15&u[2])<<8),R=this.coordsIndex[255-u[3]],z=R&&this.sourceCache.getTileByID(R);if(!z)return null;const q=this._coordsTextureSize,Y=(1<<z.tileID.canonical.z)*q;return new s.MercatorCoordinate((z.tileID.canonical.x*q+k)/Y,(z.tileID.canonical.y*q+I)/Y,this.getElevation(z.tileID,k,I,q))}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.style.map.painter.context,u=new s.PosArray,f=new s.TriangleIndexArray,y=this.meshSize,b=s.EXTENT/y,k=y*y;for(let I=0;I<=y;I++)for(let R=0;R<=y;R++)u.emplaceBack(R*b,I*b);for(let I=0;I<k;I+=y+1)for(let R=0;R<y;R++)f.emplaceBack(R+I,y+R+I+1,y+R+I+2),f.emplaceBack(R+I,y+R+I+2,R+I+1);return this._mesh={indexBuffer:i.createIndexBuffer(f),vertexBuffer:i.createVertexBuffer(u,_n.members),segments:s.SegmentVector.simpleSegment(0,0,u.length,f.length)},this._mesh}getMinMaxElevation(i){const u=this.getTerrainData(i).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=(u.dem.min+this.elevationOffset)*this.exaggeration,f.maxElevation=(u.dem.max+this.elevationOffset)*this.exaggeration),f}}const xn=(m,i)=>s.emitValidationErrors(m,i&&i.filter(u=>u.identifier!=="source.canvas")),bn=s.pick(ct,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Cr=s.pick(ct,["setCenter","setZoom","setBearing","setPitch"]),Gn=function(){const m={},i=s.spec.$version;for(const u in s.spec.$root){const f=s.spec.$root[u];if(f.required){let y=null;y=u==="version"?i:f.type==="array"?[]:{},y!=null&&(m[u]=y)}}return m}();class Vr extends s.Evented{constructor(i,u={}){super(),this.map=i,this.dispatcher=new Ie(Fe(),this),this.imageManager=new $,this.imageManager.setEventedParent(this),this.glyphManager=new V(i._requestManager,u.localIdeographFontFamily),this.lineAtlas=new le(256,512),this.crossTileSymbolIndex=new Qt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const f=this;this._rtlTextPluginCallback=Vr.registerForPluginStateChange(y=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(b,k)=>{if(s.triggerPluginCompletionEvent(b),k&&k.every(I=>I))for(const I in f.sourceCaches)f.sourceCaches[I].reload()})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const b=this.sourceCaches[y.sourceId];if(!b)return;const k=b.getSource();if(k&&k.vectorLayerIds)for(const I in this._layers){const R=this._layers[I];R.source===k.id&&this._validateLayer(R)}})}loadURL(i,u={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const f=typeof u.validate!="boolean"||u.validate,y=this.map._requestManager.transformRequest(i,s.ResourceType.Style);this._request=s.getJSON(y,(b,k)=>{this._request=null,b?this.fire(new s.ErrorEvent(b)):k&&this._load(k,f)})}loadJSON(i,u={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(i,u.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Gn,!1)}_load(i,u){if(u&&xn(this,s.validateStyle(i)))return;this._loaded=!0,this.stylesheet=i;for(const y in i.sources)this.addSource(y,i.sources[y],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);const f=it(this.stylesheet.layers);this._order=f.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of f)y=s.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new W(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}_loadSprite(i){this._spriteRequest=function(u,f,y,b){let k,I,R;const z=y>1?"@2x":"";let q=s.getJSON(f.transformRequest(f.normalizeSpriteURL(u,z,".json"),s.ResourceType.SpriteJSON),(fe,se)=>{q=null,R||(R=fe,k=se,ee())}),Y=s.getImage(f.transformRequest(f.normalizeSpriteURL(u,z,".png"),s.ResourceType.SpriteImage),(fe,se)=>{Y=null,R||(R=fe,I=se,ee())});function ee(){if(R)b(R);else if(k&&I){const fe=s.exported.getImageData(I),se={};for(const ce in k){const{width:Te,height:Re,x:Be,y:pe,sdf:Ge,pixelRatio:Ue,stretchX:et,stretchY:nt,content:gt}=k[ce],Je=new s.RGBAImage({width:Te,height:Re});s.RGBAImage.copy(fe,Je,{x:Be,y:pe},{x:0,y:0},{width:Te,height:Re}),se[ce]={data:Je,pixelRatio:Ue,sdf:Ge,stretchX:et,stretchY:nt,content:gt}}b(null,se)}}return{cancel(){q&&(q.cancel(),q=null),Y&&(Y.cancel(),Y=null)}}}(i,this.map._requestManager,this.map.getPixelRatio(),(u,f)=>{if(this._spriteRequest=null,u)this.fire(new s.ErrorEvent(u));else if(f)for(const y in f)this.imageManager.addImage(y,f[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(i){const u=this.sourceCaches[i.source];if(!u)return;const f=i.sourceLayer;if(!f)return;const y=u.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const u=[];for(const f of i){const y=this._layers[f];y.type!=="custom"&&u.push(y.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const u=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(y.length||b.length)&&this._updateWorkerLayers(y,b);for(const k in this._updatedSources){const I=this._updatedSources[k];if(I==="reload")this._reloadSource(k);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(k)}}this._updateTilesForChangedImages();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const f={};for(const y in this.sourceCaches){const b=this.sourceCaches[y];f[y]=b.used,b.used=!1}for(const y of this._order){const b=this._layers[y];b.recalculate(i,this._availableImages),!b.isHidden(i.zoom)&&b.source&&(this.sourceCaches[b.source].used=!0)}for(const y in f){const b=this.sourceCaches[y];f[y]!==b.used&&b.fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(i),this.z=i.zoom,u&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(i){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),i){const u=this.sourceCaches[i.source];if(!u)throw new Error(`cannot load terrain, because there exists no source with ID: ${i.source}`);this.terrain=new an(this,u,i),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=f=>{f.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=f=>{f.tile&&(f.sourceId===i.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(f.sourceId,f.tile.tileID)):f.source.type==="geojson"&&this.terrain.rememberForRerender(f.sourceId,f.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new s.Event("terrain",{terrain:i}))}setState(i){if(this._checkLoaded(),xn(this,s.validateStyle(i)))return!1;(i=s.clone$1(i)).layers=it(i.layers);const u=function(y,b){if(!y)return[{command:ct.setStyle,args:[b]}];let k=[];try{if(!T(y.version,b.version))return[{command:ct.setStyle,args:[b]}];T(y.center,b.center)||k.push({command:ct.setCenter,args:[b.center]}),T(y.zoom,b.zoom)||k.push({command:ct.setZoom,args:[b.zoom]}),T(y.bearing,b.bearing)||k.push({command:ct.setBearing,args:[b.bearing]}),T(y.pitch,b.pitch)||k.push({command:ct.setPitch,args:[b.pitch]}),T(y.sprite,b.sprite)||k.push({command:ct.setSprite,args:[b.sprite]}),T(y.glyphs,b.glyphs)||k.push({command:ct.setGlyphs,args:[b.glyphs]}),T(y.transition,b.transition)||k.push({command:ct.setTransition,args:[b.transition]}),T(y.light,b.light)||k.push({command:ct.setLight,args:[b.light]});const I={},R=[];(function(q,Y,ee,fe){let se;for(se in Y=Y||{},q=q||{})Object.prototype.hasOwnProperty.call(q,se)&&(Object.prototype.hasOwnProperty.call(Y,se)||Ot(se,ee,fe));for(se in Y)Object.prototype.hasOwnProperty.call(Y,se)&&(Object.prototype.hasOwnProperty.call(q,se)?T(q[se],Y[se])||(q[se].type==="geojson"&&Y[se].type==="geojson"&&pn(q,Y,se)?ee.push({command:ct.setGeoJSONSourceData,args:[se,Y[se].data]}):on(se,Y,ee,fe)):at(se,Y,ee))})(y.sources,b.sources,R,I);const z=[];y.layers&&y.layers.forEach(q=>{I[q.source]?k.push({command:ct.removeLayer,args:[q.id]}):z.push(q)}),k=k.concat(R),function(q,Y,ee){Y=Y||[];const fe=(q=q||[]).map(Qn),se=Y.map(Qn),ce=q.reduce(Jr,{}),Te=Y.reduce(Jr,{}),Re=fe.slice(),Be=Object.create(null);let pe,Ge,Ue,et,nt,gt,Je;for(pe=0,Ge=0;pe<fe.length;pe++)Ue=fe[pe],Object.prototype.hasOwnProperty.call(Te,Ue)?Ge++:(ee.push({command:ct.removeLayer,args:[Ue]}),Re.splice(Re.indexOf(Ue,Ge),1));for(pe=0,Ge=0;pe<se.length;pe++)Ue=se[se.length-1-pe],Re[Re.length-1-pe]!==Ue&&(Object.prototype.hasOwnProperty.call(ce,Ue)?(ee.push({command:ct.removeLayer,args:[Ue]}),Re.splice(Re.lastIndexOf(Ue,Re.length-Ge),1)):Ge++,gt=Re[Re.length-pe],ee.push({command:ct.addLayer,args:[Te[Ue],gt]}),Re.splice(Re.length-pe,0,Ue),Be[Ue]=!0);for(pe=0;pe<se.length;pe++)if(Ue=se[pe],et=ce[Ue],nt=Te[Ue],!Be[Ue]&&!T(et,nt))if(T(et.source,nt.source)&&T(et["source-layer"],nt["source-layer"])&&T(et.type,nt.type)){for(Je in sr(et.layout,nt.layout,ee,Ue,null,ct.setLayoutProperty),sr(et.paint,nt.paint,ee,Ue,null,ct.setPaintProperty),T(et.filter,nt.filter)||ee.push({command:ct.setFilter,args:[Ue,nt.filter]}),T(et.minzoom,nt.minzoom)&&T(et.maxzoom,nt.maxzoom)||ee.push({command:ct.setLayerZoomRange,args:[Ue,nt.minzoom,nt.maxzoom]}),et)Object.prototype.hasOwnProperty.call(et,Je)&&Je!=="layout"&&Je!=="paint"&&Je!=="filter"&&Je!=="metadata"&&Je!=="minzoom"&&Je!=="maxzoom"&&(Je.indexOf("paint.")===0?sr(et[Je],nt[Je],ee,Ue,Je.slice(6),ct.setPaintProperty):T(et[Je],nt[Je])||ee.push({command:ct.setLayerProperty,args:[Ue,Je,nt[Je]]}));for(Je in nt)Object.prototype.hasOwnProperty.call(nt,Je)&&!Object.prototype.hasOwnProperty.call(et,Je)&&Je!=="layout"&&Je!=="paint"&&Je!=="filter"&&Je!=="metadata"&&Je!=="minzoom"&&Je!=="maxzoom"&&(Je.indexOf("paint.")===0?sr(et[Je],nt[Je],ee,Ue,Je.slice(6),ct.setPaintProperty):T(et[Je],nt[Je])||ee.push({command:ct.setLayerProperty,args:[Ue,Je,nt[Je]]}))}else ee.push({command:ct.removeLayer,args:[Ue]}),gt=Re[Re.lastIndexOf(Ue)+1],ee.push({command:ct.addLayer,args:[nt,gt]})}(z,b.layers,k)}catch(I){console.warn("Unable to compute style diff:",I),k=[{command:ct.setStyle,args:[b]}]}return k}(this.serialize(),i).filter(y=>!(y.command in Cr));if(u.length===0)return!1;const f=u.filter(y=>!(y.command in bn));if(f.length>0)throw new Error(`Unimplemented: ${f.map(y=>y.command).join(", ")}.`);return u.forEach(y=>{y.command!=="setTransition"&&this[y.command].apply(this,y.args)}),this.stylesheet=i,!0}addImage(i,u){if(this.getImage(i))return this.fire(new s.ErrorEvent(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,u),this._afterImageUpdated(i)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new s.ErrorEvent(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,u,f={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(s.validateStyle.source,`sources.${i}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const y=this.sourceCaches[i]=new ke(i,u,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:y.serialize(),sourceId:i})),y.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===i)return this.fire(new s.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],u.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,u){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const f=this.sourceCaches[i].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,u,f={}){this._checkLoaded();const y=i.id;if(this.getLayer(y))return void this.fire(new s.ErrorEvent(new Error(`Layer "${y}" already exists on this map.`)));let b;if(i.type==="custom"){if(xn(this,s.validateCustomStyleLayer(i)))return;b=s.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(y,i.source),i=s.clone$1(i),i=s.extend(i,{source:y})),this._validate(s.validateStyle.layer,`layers.${y}`,i,{arrayIndex:-1},f))return;b=s.createStyleLayer(i),this._validateLayer(b),b.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[b.id]=b.serialize()}const k=u?this._order.indexOf(u):this._order.length;if(u&&k===-1)this.fire(new s.ErrorEvent(new Error(`Cannot add layer "${y}" before non-existing layer "${u}".`)));else{if(this._order.splice(k,0,y),this._layerOrderChanged=!0,this._layers[y]=b,this._removedLayers[y]&&b.source&&b.type!=="custom"){const I=this._removedLayers[y];delete this._removedLayers[y],I.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",this.sourceCaches[b.source].pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map)}}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new s.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const f=this._order.indexOf(i);this._order.splice(f,1);const y=u?this._order.indexOf(u):this._order.length;u&&y===-1?this.fire(new s.ErrorEvent(new Error(`Cannot move layer "${i}" before non-existing layer "${u}".`))):(this._order.splice(y,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new s.ErrorEvent(new Error(`Cannot remove non-existing layer "${i}".`)));u.setEventedParent(null);const f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map)}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,u,f){this._checkLoaded();const y=this.getLayer(i);y?y.minzoom===u&&y.maxzoom===f||(u!=null&&(y.minzoom=u),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new s.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,u,f={}){this._checkLoaded();const y=this.getLayer(i);if(y){if(!T(y.filter,u))return u==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(s.validateStyle.filter,`layers.${y.id}.filter`,u,null,f)||(y.filter=s.clone$1(u),this._updateLayer(y)))}else this.fire(new s.ErrorEvent(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return s.clone$1(this.getLayer(i).filter)}setLayoutProperty(i,u,f,y={}){this._checkLoaded();const b=this.getLayer(i);b?T(b.getLayoutProperty(u),f)||(b.setLayoutProperty(u,f,y),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,u){const f=this.getLayer(i);if(f)return f.getLayoutProperty(u);this.fire(new s.ErrorEvent(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,u,f,y={}){this._checkLoaded();const b=this.getLayer(i);b?T(b.getPaintProperty(u),f)||(b.setPaintProperty(u,f,y)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new s.ErrorEvent(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,u){return this.getLayer(i).getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const f=i.source,y=i.sourceLayer,b=this.sourceCaches[f];if(b===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const k=b.getSource().type;k==="geojson"&&y?this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):k!=="vector"||y?(i.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),b.setFeatureState(y,i.id,u)):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,u){this._checkLoaded();const f=i.source,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new s.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const b=y.getSource().type,k=b==="vector"?i.sourceLayer:void 0;b!=="vector"||k?u&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(k,i.id,u):this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const u=i.source,f=i.sourceLayer,y=this.sourceCaches[u];if(y!==void 0)return y.getSource().type!=="vector"||f?(i.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,i.id)):void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:s.mapObject(this.sourceCaches,i=>i.serialize()),layers:this._serializeLayers(this._order)},i=>i!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(i){const u=k=>this._layers[k].type==="fill-extrusion",f={},y=[];for(let k=this._order.length-1;k>=0;k--){const I=this._order[k];if(u(I)){f[I]=k;for(const R of i){const z=R[I];if(z)for(const q of z)y.push(q)}}}y.sort((k,I)=>I.intersectionZ-k.intersectionZ);const b=[];for(let k=this._order.length-1;k>=0;k--){const I=this._order[k];if(u(I))for(let R=y.length-1;R>=0;R--){const z=y[R].feature;if(f[z.layer.id]<k)break;b.push(z),y.pop()}else for(const R of i){const z=R[I];if(z)for(const q of z)b.push(q.feature)}}return b}queryRenderedFeatures(i,u,f){u&&u.filter&&this._validate(s.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const y={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of u.layers){const I=this._layers[k];if(!I)return this.fire(new s.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];y[I.source]=!0}}const b=[];u.availableImages=this._availableImages;for(const k in this.sourceCaches)u.layers&&!y[k]||b.push(zt(this.sourceCaches[k],this._layers,this._serializedLayers,i,u,f));return this.placement&&b.push(function(k,I,R,z,q,Y,ee){const fe={},se=Y.queryRenderedSymbols(z),ce=[];for(const Te of Object.keys(se).map(Number))ce.push(ee[Te]);ce.sort(X);for(const Te of ce){const Re=Te.featureIndex.lookupSymbolFeatures(se[Te.bucketInstanceId],I,Te.bucketIndex,Te.sourceLayerIndex,q.filter,q.layers,q.availableImages,k);for(const Be in Re){const pe=fe[Be]=fe[Be]||[],Ge=Re[Be];Ge.sort((Ue,et)=>{const nt=Te.featureSortOrder;if(nt){const gt=nt.indexOf(Ue.featureIndex);return nt.indexOf(et.featureIndex)-gt}return et.featureIndex-Ue.featureIndex});for(const Ue of Ge)pe.push(Ue)}}for(const Te in fe)fe[Te].forEach(Re=>{const Be=Re.feature,pe=R[k[Te].source].getFeatureState(Be.layer["source-layer"],Be.id);Be.source=Be.layer.source,Be.layer["source-layer"]&&(Be.sourceLayer=Be.layer["source-layer"]),Be.state=pe});return fe}(this._layers,this._serializedLayers,this.sourceCaches,i,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(i,u){u&&u.filter&&this._validate(s.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[i];return f?function(y,b){const k=y.getRenderableIds().map(z=>y.getTileByID(z)),I=[],R={};for(let z=0;z<k.length;z++){const q=k[z],Y=q.tileID.canonical.key;R[Y]||(R[Y]=!0,q.querySourceFeatures(I,b))}return I}(f,u):[]}addSourceType(i,u,f){return Vr.getSourceType(i)?f(new Error(`A source type called "${i}" already exists.`)):(Vr.setSourceType(i,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:u.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const k in i)if(!T(i[k],f[k])){y=!0;break}if(!y)return;const b={now:s.exported.now(),transition:s.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(b)}_validate(i,u,f,y,b={}){return(!b||b.validate!==!1)&&xn(this,i.call(s.validateStyle,s.extend({key:u,style:this.serialize(),value:f,styleSpec:s.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const u=this.sourceCaches[i];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const u in this.sourceCaches)this.sourceCaches[u].update(i,this.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,u,f,y,b=!1){let k=!1,I=!1;const R={};for(const z of this._order){const q=this._layers[z];if(q.type!=="symbol")continue;if(!R[q.source]){const ee=this.sourceCaches[q.source];R[q.source]=ee.getRenderableIds(!0).map(fe=>ee.getTileByID(fe)).sort((fe,se)=>se.tileID.overscaledZ-fe.tileID.overscaledZ||(fe.tileID.isLessThan(se.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(q,R[q.source],i.center.lng);k=k||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((b=b||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),i.zoom))&&(this.pauseablePlacement=new Ze(i,this.terrain,this._order,b,u,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),I=!0),k&&this.pauseablePlacement.placement.setStale()),I||k)for(const z of this._order){const q=this._layers[z];q.type==="symbol"&&this.placement.updateLayerOpacities(q,R[q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u,f){this.imageManager.getImages(u.icons,f),this._updateTilesForChangedImages();const y=this.sourceCaches[u.source];y&&y.setDependencies(u.tileID.key,u.type,u.icons)}getGlyphs(i,u,f){this.glyphManager.getGlyphs(u.stacks,f)}getResource(i,u,f){return s.makeRequest(u,f)}}Vr.getSourceType=function(m){return Qe[m]},Vr.setSourceType=function(m,i){Qe[m]=i},Vr.registerForPluginStateChange=s.registerForPluginStateChange;var Ea="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ja={prelude:Mn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Mn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Mn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Mn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Mn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Mn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Mn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Mn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Mn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Mn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Mn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Mn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Mn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Mn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Mn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Mn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Mn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Mn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Mn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Mn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Mn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ea),terrainDepth:Mn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ea),terrainCoords:Mn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ea)};function Mn(m,i){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=i.match(/attribute ([\w]+) ([\w]+)/g),y=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),k=b?b.concat(y):y,I={};return{fragmentSource:m=m.replace(u,(R,z,q,Y,ee)=>(I[ee]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
varying ${q} ${Y} ${ee};
#else
uniform ${q} ${Y} u_${ee};
#endif
`:`
#ifdef HAS_UNIFORM_u_${ee}
    ${q} ${Y} ${ee} = u_${ee};
#endif
`)),vertexSource:i=i.replace(u,(R,z,q,Y,ee)=>{const fe=Y==="float"?"vec2":"vec4",se=ee.match(/color/)?"color":fe;return I[ee]?z==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
attribute ${q} ${fe} a_${ee};
varying ${q} ${Y} ${ee};
#else
uniform ${q} ${Y} u_${ee};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = a_${ee};
#else
    ${q} ${Y} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${ee} = unpack_mix_${se}(a_${ee}, u_${ee}_t);
#else
    ${q} ${Y} ${ee} = u_${ee};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${ee}
uniform lowp float u_${ee}_t;
attribute ${q} ${fe} a_${ee};
#else
uniform ${q} ${Y} u_${ee};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${ee}
    ${q} ${Y} ${ee} = a_${ee};
#else
    ${q} ${Y} ${ee} = u_${ee};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ee}
    ${q} ${Y} ${ee} = unpack_mix_${se}(a_${ee}, u_${ee}_t);
#else
    ${q} ${Y} ${ee} = u_${ee};
#endif
`}),staticAttributes:f,staticUniforms:k}}class Ta{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,u,f,y,b,k,I,R,z){this.context=i;let q=this.boundPaintVertexBuffers.length!==y.length;for(let Y=0;!q&&Y<y.length;Y++)this.boundPaintVertexBuffers[Y]!==y[Y]&&(q=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===f&&!q&&this.boundIndexBuffer===b&&this.boundVertexOffset===k&&this.boundDynamicVertexBuffer===I&&this.boundDynamicVertexBuffer2===R&&this.boundDynamicVertexBuffer3===z?(i.bindVertexArrayOES.set(this.vao),I&&I.bind(),b&&b.dynamicDraw&&b.bind(),R&&R.bind(),z&&z.bind()):this.freshBind(u,f,y,b,k,I,R,z)}freshBind(i,u,f,y,b,k,I,R){let z;const q=i.numAttributes,Y=this.context,ee=Y.gl;if(Y.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Y.extVertexArrayObject.createVertexArrayOES(),Y.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=k,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=R;else{z=Y.currentNumAttributes||0;for(let fe=q;fe<z;fe++)ee.disableVertexAttribArray(fe)}u.enableAttributes(ee,i);for(const fe of f)fe.enableAttributes(ee,i);k&&k.enableAttributes(ee,i),I&&I.enableAttributes(ee,i),R&&R.enableAttributes(ee,i),u.bind(),u.setVertexAttribPointers(ee,i,b);for(const fe of f)fe.bind(),fe.setVertexAttribPointers(ee,i,b);k&&(k.bind(),k.setVertexAttribPointers(ee,i,b)),y&&y.bind(),I&&(I.bind(),I.setVertexAttribPointers(ee,i,b)),R&&(R.bind(),R.setVertexAttribPointers(ee,i,b)),Y.currentNumAttributes=q}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Bl(m){const i=[];for(let u=0;u<m.length;u++){if(m[u]===null)continue;const f=m[u].split(" ");i.push(f.pop())}return i}class Sa{constructor(i,u,f,y,b,k,I){const R=i.gl;this.program=R.createProgram();const z=Bl(f.staticAttributes),q=y?y.getBinderAttributes():[],Y=z.concat(q),ee=Ja.prelude.staticUniforms?Bl(Ja.prelude.staticUniforms):[],fe=f.staticUniforms?Bl(f.staticUniforms):[],se=y?y.getBinderUniforms():[],ce=ee.concat(fe).concat(se),Te=[];for(const nt of ce)Te.indexOf(nt)<0&&Te.push(nt);const Re=y?y.defines():[];k&&Re.push("#define OVERDRAW_INSPECTOR;"),I&&Re.push("#define TERRAIN3D;");const Be=Re.concat(Ja.prelude.fragmentSource,f.fragmentSource).join(`
`),pe=Re.concat(Ja.prelude.vertexSource,f.vertexSource).join(`
`),Ge=R.createShader(R.FRAGMENT_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(Ge,Be),R.compileShader(Ge),R.attachShader(this.program,Ge);const Ue=R.createShader(R.VERTEX_SHADER);if(R.isContextLost())return void(this.failedToCreate=!0);R.shaderSource(Ue,pe),R.compileShader(Ue),R.attachShader(this.program,Ue),this.attributes={};const et={};this.numAttributes=Y.length;for(let nt=0;nt<this.numAttributes;nt++)Y[nt]&&(R.bindAttribLocation(this.program,nt,Y[nt]),this.attributes[Y[nt]]=nt);R.linkProgram(this.program),R.deleteShader(Ue),R.deleteShader(Ge);for(let nt=0;nt<Te.length;nt++){const gt=Te[nt];if(gt&&!et[gt]){const Je=R.getUniformLocation(this.program,gt);Je&&(et[gt]=Je)}}this.fixedUniforms=b(i,et),this.terrainUniforms=((nt,gt)=>({u_depth:new s.Uniform1i(nt,gt.u_depth),u_terrain:new s.Uniform1i(nt,gt.u_terrain),u_terrain_dim:new s.Uniform1f(nt,gt.u_terrain_dim),u_terrain_matrix:new s.UniformMatrix4f(nt,gt.u_terrain_matrix),u_terrain_unpack:new s.Uniform4f(nt,gt.u_terrain_unpack),u_terrain_offset:new s.Uniform1f(nt,gt.u_terrain_offset),u_terrain_exaggeration:new s.Uniform1f(nt,gt.u_terrain_exaggeration)}))(i,et),this.binderUniforms=y?y.getUniforms(i,et):[]}draw(i,u,f,y,b,k,I,R,z,q,Y,ee,fe,se,ce,Te,Re,Be){const pe=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(f),i.setStencilMode(y),i.setColorMode(b),i.setCullFace(k),R){i.activeTexture.set(pe.TEXTURE2),pe.bindTexture(pe.TEXTURE_2D,R.depthTexture),i.activeTexture.set(pe.TEXTURE3),pe.bindTexture(pe.TEXTURE_2D,R.texture);for(const Ue in this.terrainUniforms)this.terrainUniforms[Ue].set(R[Ue])}for(const Ue in this.fixedUniforms)this.fixedUniforms[Ue].set(I[Ue]);ce&&ce.setUniforms(i,this.binderUniforms,fe,{zoom:se});let Ge=0;switch(u){case pe.LINES:Ge=2;break;case pe.TRIANGLES:Ge=3;break;case pe.LINE_STRIP:Ge=1}for(const Ue of ee.get()){const et=Ue.vaos||(Ue.vaos={});(et[z]||(et[z]=new Ta)).bind(i,this,q,ce?ce.getPaintVertexBuffers():[],Y,Ue.vertexOffset,Te,Re,Be),pe.drawElements(u,Ue.primitiveLength*Ge,pe.UNSIGNED_SHORT,Ue.primitiveOffset*Ge*2)}}}function Fl(m,i,u){const f=1/Bn(u,1,i.transform.tileZoom),y=Math.pow(2,u.tileID.overscaledZ),b=u.tileSize*Math.pow(2,i.transform.tileZoom)/y,k=b*(u.tileID.canonical.x+u.tileID.wrap*y),I=b*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[k>>16,I>>16],u_pixel_coord_lower:[65535&k,65535&I]}}const Bs=(m,i,u,f)=>{const y=i.style.light,b=y.properties.get("position"),k=[b.x,b.y,b.z],I=s.create$1();y.properties.get("anchor")==="viewport"&&s.fromRotation(I,-i.transform.angle),s.transformMat3(k,k,I);const R=y.properties.get("color");return{u_matrix:m,u_lightpos:k,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[R.r,R.g,R.b],u_vertical_gradient:+u,u_opacity:f}},Cd=(m,i,u,f,y,b,k)=>s.extend(Bs(m,i,u,f),Fl(b,i,k),{u_height_factor:-Math.pow(2,y.overscaledZ)/k.tileSize/8}),Fs=m=>({u_matrix:m}),Ul=(m,i,u,f)=>s.extend(Fs(m),Fl(u,i,f)),Xc=(m,i)=>({u_matrix:m,u_world:i}),Vl=(m,i,u,f,y)=>s.extend(Ul(m,i,u,f),{u_world:y}),Yc=(m,i,u,f)=>{const y=m.transform;let b,k;if(f.paint.get("circle-pitch-alignment")==="map"){const I=Bn(u,1,y.zoom);b=!0,k=[I,I]}else b=!1,k=y.pixelsToGLUnits;return{u_camera_to_center_distance:y.cameraToCenterDistance,u_scale_with_map:+(f.paint.get("circle-pitch-scale")==="map"),u_matrix:m.translatePosMatrix(i.posMatrix,u,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:k}},na=(m,i,u)=>{const f=Bn(u,1,i.zoom),y=Math.pow(2,i.zoom-u.tileID.overscaledZ),b=u.tileID.overscaleFactor();return{u_matrix:m,u_camera_to_center_distance:i.cameraToCenterDistance,u_pixels_to_tile_units:f,u_extrude_scale:[i.pixelsToGLUnits[0]/(f*y),i.pixelsToGLUnits[1]/(f*y)],u_overscale_factor:b}},ka=(m,i,u=1)=>({u_matrix:m,u_color:i,u_overlay:0,u_overlay_scale:u}),_o=m=>({u_matrix:m}),xo=(m,i,u,f)=>({u_matrix:m,u_extrude_scale:Bn(i,1,u),u_intensity:f});function Us(m,i){const u=Math.pow(2,i.canonical.z),f=i.canonical.y;return[new s.MercatorCoordinate(0,f/u).toLngLat().lat,new s.MercatorCoordinate(0,(f+1)/u).toLngLat().lat]}const Ca=(m,i,u,f)=>{const y=m.transform;return{u_matrix:es(m,i,u,f),u_ratio:1/Bn(i,1,y.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},io=(m,i,u,f,y)=>s.extend(Ca(m,i,u,y),{u_image:0,u_image_height:f}),Vs=(m,i,u,f,y)=>{const b=m.transform,k=qn(i,b);return{u_matrix:es(m,i,u,y),u_texsize:i.imageAtlasTexture.size,u_ratio:1/Bn(i,1,b.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[k,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Qa=(m,i,u,f,y,b)=>{const k=m.lineAtlas,I=qn(i,m.transform),R=u.layout.get("line-cap")==="round",z=k.getDash(f.from,R),q=k.getDash(f.to,R),Y=z.width*y.fromScale,ee=q.width*y.toScale;return s.extend(Ca(m,i,u,b),{u_patternscale_a:[I/Y,-z.height/2],u_patternscale_b:[I/ee,-q.height/2],u_sdfgamma:k.width/(256*Math.min(Y,ee)*m.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:q.y,u_mix:y.t})};function qn(m,i){return 1/Bn(m,1,i.tileZoom)}function es(m,i,u,f){return m.translatePosMatrix(f?f.posMatrix:i.tileID.posMatrix,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Jc=(m,i,u,f,y)=>{return{u_matrix:m,u_tl_parent:i,u_scale_parent:u,u_buffer_scale:1,u_fade_t:f.mix,u_opacity:f.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(k=y.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(b=y.paint.get("raster-contrast"),b>0?1/(1-b):1+b),u_spin_weights:Oo(y.paint.get("raster-hue-rotate"))};var b,k};function Oo(m){m*=Math.PI/180;const i=Math.sin(m),u=Math.cos(m);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const js=(m,i,u,f,y,b,k,I,R,z)=>{const q=y.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:q.cameraToCenterDistance,u_pitch:q.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:q.width/q.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:k,u_coord_matrix:I,u_is_text:+R,u_pitch_with_map:+f,u_texsize:z,u_texture:0}},Gs=(m,i,u,f,y,b,k,I,R,z,q)=>{const Y=y.transform;return s.extend(js(m,i,u,f,y,b,k,I,R,z),{u_gamma_scale:f?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:y.pixelRatio,u_is_halo:+q})},ts=(m,i,u,f,y,b,k,I,R,z)=>s.extend(Gs(m,i,u,f,y,b,k,I,!0,R,!0),{u_texsize_icon:z,u_texture_icon:1}),Pd=(m,i,u)=>({u_matrix:m,u_opacity:i,u_color:u}),jl=(m,i,u,f,y,b)=>s.extend(function(k,I,R,z){const q=R.imageManager.getPattern(k.from.toString()),Y=R.imageManager.getPattern(k.to.toString()),{width:ee,height:fe}=R.imageManager.getPixelSize(),se=Math.pow(2,z.tileID.overscaledZ),ce=z.tileSize*Math.pow(2,R.transform.tileZoom)/se,Te=ce*(z.tileID.canonical.x+z.tileID.wrap*se),Re=ce*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:q.tl,u_pattern_br_a:q.br,u_pattern_tl_b:Y.tl,u_pattern_br_b:Y.br,u_texsize:[ee,fe],u_mix:I.t,u_pattern_size_a:q.displaySize,u_pattern_size_b:Y.displaySize,u_scale_a:I.fromScale,u_scale_b:I.toScale,u_tile_units_to_pixels:1/Bn(z,1,R.transform.tileZoom),u_pixel_coord_upper:[Te>>16,Re>>16],u_pixel_coord_lower:[65535&Te,65535&Re]}}(f,b,u,y),{u_matrix:m,u_opacity:i}),Gl={fillExtrusion:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_lightpos:new s.Uniform3f(m,i.u_lightpos),u_lightintensity:new s.Uniform1f(m,i.u_lightintensity),u_lightcolor:new s.Uniform3f(m,i.u_lightcolor),u_vertical_gradient:new s.Uniform1f(m,i.u_vertical_gradient),u_opacity:new s.Uniform1f(m,i.u_opacity)}),fillExtrusionPattern:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_lightpos:new s.Uniform3f(m,i.u_lightpos),u_lightintensity:new s.Uniform1f(m,i.u_lightintensity),u_lightcolor:new s.Uniform3f(m,i.u_lightcolor),u_vertical_gradient:new s.Uniform1f(m,i.u_vertical_gradient),u_height_factor:new s.Uniform1f(m,i.u_height_factor),u_image:new s.Uniform1i(m,i.u_image),u_texsize:new s.Uniform2f(m,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(m,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(m,i.u_scale),u_fade:new s.Uniform1f(m,i.u_fade),u_opacity:new s.Uniform1f(m,i.u_opacity)}),fill:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix)}),fillPattern:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_image:new s.Uniform1i(m,i.u_image),u_texsize:new s.Uniform2f(m,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(m,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(m,i.u_scale),u_fade:new s.Uniform1f(m,i.u_fade)}),fillOutline:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_world:new s.Uniform2f(m,i.u_world)}),fillOutlinePattern:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_world:new s.Uniform2f(m,i.u_world),u_image:new s.Uniform1i(m,i.u_image),u_texsize:new s.Uniform2f(m,i.u_texsize),u_pixel_coord_upper:new s.Uniform2f(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(m,i.u_pixel_coord_lower),u_scale:new s.Uniform3f(m,i.u_scale),u_fade:new s.Uniform1f(m,i.u_fade)}),circle:(m,i)=>({u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_scale_with_map:new s.Uniform1i(m,i.u_scale_with_map),u_pitch_with_map:new s.Uniform1i(m,i.u_pitch_with_map),u_extrude_scale:new s.Uniform2f(m,i.u_extrude_scale),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_matrix:new s.UniformMatrix4f(m,i.u_matrix)}),collisionBox:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_pixels_to_tile_units:new s.Uniform1f(m,i.u_pixels_to_tile_units),u_extrude_scale:new s.Uniform2f(m,i.u_extrude_scale),u_overscale_factor:new s.Uniform1f(m,i.u_overscale_factor)}),collisionCircle:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_inv_matrix:new s.UniformMatrix4f(m,i.u_inv_matrix),u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_viewport_size:new s.Uniform2f(m,i.u_viewport_size)}),debug:(m,i)=>({u_color:new s.UniformColor(m,i.u_color),u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_overlay:new s.Uniform1i(m,i.u_overlay),u_overlay_scale:new s.Uniform1f(m,i.u_overlay_scale)}),clippingMask:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix)}),heatmap:(m,i)=>({u_extrude_scale:new s.Uniform1f(m,i.u_extrude_scale),u_intensity:new s.Uniform1f(m,i.u_intensity),u_matrix:new s.UniformMatrix4f(m,i.u_matrix)}),heatmapTexture:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_world:new s.Uniform2f(m,i.u_world),u_image:new s.Uniform1i(m,i.u_image),u_color_ramp:new s.Uniform1i(m,i.u_color_ramp),u_opacity:new s.Uniform1f(m,i.u_opacity)}),hillshade:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_image:new s.Uniform1i(m,i.u_image),u_latrange:new s.Uniform2f(m,i.u_latrange),u_light:new s.Uniform2f(m,i.u_light),u_shadow:new s.UniformColor(m,i.u_shadow),u_highlight:new s.UniformColor(m,i.u_highlight),u_accent:new s.UniformColor(m,i.u_accent)}),hillshadePrepare:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_image:new s.Uniform1i(m,i.u_image),u_dimension:new s.Uniform2f(m,i.u_dimension),u_zoom:new s.Uniform1f(m,i.u_zoom),u_unpack:new s.Uniform4f(m,i.u_unpack)}),line:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_ratio:new s.Uniform1f(m,i.u_ratio),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(m,i.u_units_to_pixels)}),lineGradient:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_ratio:new s.Uniform1f(m,i.u_ratio),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(m,i.u_units_to_pixels),u_image:new s.Uniform1i(m,i.u_image),u_image_height:new s.Uniform1f(m,i.u_image_height)}),linePattern:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_texsize:new s.Uniform2f(m,i.u_texsize),u_ratio:new s.Uniform1f(m,i.u_ratio),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_image:new s.Uniform1i(m,i.u_image),u_units_to_pixels:new s.Uniform2f(m,i.u_units_to_pixels),u_scale:new s.Uniform3f(m,i.u_scale),u_fade:new s.Uniform1f(m,i.u_fade)}),lineSDF:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_ratio:new s.Uniform1f(m,i.u_ratio),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_units_to_pixels:new s.Uniform2f(m,i.u_units_to_pixels),u_patternscale_a:new s.Uniform2f(m,i.u_patternscale_a),u_patternscale_b:new s.Uniform2f(m,i.u_patternscale_b),u_sdfgamma:new s.Uniform1f(m,i.u_sdfgamma),u_image:new s.Uniform1i(m,i.u_image),u_tex_y_a:new s.Uniform1f(m,i.u_tex_y_a),u_tex_y_b:new s.Uniform1f(m,i.u_tex_y_b),u_mix:new s.Uniform1f(m,i.u_mix)}),raster:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_tl_parent:new s.Uniform2f(m,i.u_tl_parent),u_scale_parent:new s.Uniform1f(m,i.u_scale_parent),u_buffer_scale:new s.Uniform1f(m,i.u_buffer_scale),u_fade_t:new s.Uniform1f(m,i.u_fade_t),u_opacity:new s.Uniform1f(m,i.u_opacity),u_image0:new s.Uniform1i(m,i.u_image0),u_image1:new s.Uniform1i(m,i.u_image1),u_brightness_low:new s.Uniform1f(m,i.u_brightness_low),u_brightness_high:new s.Uniform1f(m,i.u_brightness_high),u_saturation_factor:new s.Uniform1f(m,i.u_saturation_factor),u_contrast_factor:new s.Uniform1f(m,i.u_contrast_factor),u_spin_weights:new s.Uniform3f(m,i.u_spin_weights)}),symbolIcon:(m,i)=>({u_is_size_zoom_constant:new s.Uniform1i(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(m,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(m,i.u_size_t),u_size:new s.Uniform1f(m,i.u_size),u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(m,i.u_pitch),u_rotate_symbol:new s.Uniform1i(m,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(m,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(m,i.u_fade_change),u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(m,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(m,i.u_coord_matrix),u_is_text:new s.Uniform1i(m,i.u_is_text),u_pitch_with_map:new s.Uniform1i(m,i.u_pitch_with_map),u_texsize:new s.Uniform2f(m,i.u_texsize),u_texture:new s.Uniform1i(m,i.u_texture)}),symbolSDF:(m,i)=>({u_is_size_zoom_constant:new s.Uniform1i(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(m,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(m,i.u_size_t),u_size:new s.Uniform1f(m,i.u_size),u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(m,i.u_pitch),u_rotate_symbol:new s.Uniform1i(m,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(m,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(m,i.u_fade_change),u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(m,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(m,i.u_coord_matrix),u_is_text:new s.Uniform1i(m,i.u_is_text),u_pitch_with_map:new s.Uniform1i(m,i.u_pitch_with_map),u_texsize:new s.Uniform2f(m,i.u_texsize),u_texture:new s.Uniform1i(m,i.u_texture),u_gamma_scale:new s.Uniform1f(m,i.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(m,i.u_is_halo)}),symbolTextAndIcon:(m,i)=>({u_is_size_zoom_constant:new s.Uniform1i(m,i.u_is_size_zoom_constant),u_is_size_feature_constant:new s.Uniform1i(m,i.u_is_size_feature_constant),u_size_t:new s.Uniform1f(m,i.u_size_t),u_size:new s.Uniform1f(m,i.u_size),u_camera_to_center_distance:new s.Uniform1f(m,i.u_camera_to_center_distance),u_pitch:new s.Uniform1f(m,i.u_pitch),u_rotate_symbol:new s.Uniform1i(m,i.u_rotate_symbol),u_aspect_ratio:new s.Uniform1f(m,i.u_aspect_ratio),u_fade_change:new s.Uniform1f(m,i.u_fade_change),u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_label_plane_matrix:new s.UniformMatrix4f(m,i.u_label_plane_matrix),u_coord_matrix:new s.UniformMatrix4f(m,i.u_coord_matrix),u_is_text:new s.Uniform1i(m,i.u_is_text),u_pitch_with_map:new s.Uniform1i(m,i.u_pitch_with_map),u_texsize:new s.Uniform2f(m,i.u_texsize),u_texsize_icon:new s.Uniform2f(m,i.u_texsize_icon),u_texture:new s.Uniform1i(m,i.u_texture),u_texture_icon:new s.Uniform1i(m,i.u_texture_icon),u_gamma_scale:new s.Uniform1f(m,i.u_gamma_scale),u_device_pixel_ratio:new s.Uniform1f(m,i.u_device_pixel_ratio),u_is_halo:new s.Uniform1i(m,i.u_is_halo)}),background:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_opacity:new s.Uniform1f(m,i.u_opacity),u_color:new s.UniformColor(m,i.u_color)}),backgroundPattern:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_opacity:new s.Uniform1f(m,i.u_opacity),u_image:new s.Uniform1i(m,i.u_image),u_pattern_tl_a:new s.Uniform2f(m,i.u_pattern_tl_a),u_pattern_br_a:new s.Uniform2f(m,i.u_pattern_br_a),u_pattern_tl_b:new s.Uniform2f(m,i.u_pattern_tl_b),u_pattern_br_b:new s.Uniform2f(m,i.u_pattern_br_b),u_texsize:new s.Uniform2f(m,i.u_texsize),u_mix:new s.Uniform1f(m,i.u_mix),u_pattern_size_a:new s.Uniform2f(m,i.u_pattern_size_a),u_pattern_size_b:new s.Uniform2f(m,i.u_pattern_size_b),u_scale_a:new s.Uniform1f(m,i.u_scale_a),u_scale_b:new s.Uniform1f(m,i.u_scale_b),u_pixel_coord_upper:new s.Uniform2f(m,i.u_pixel_coord_upper),u_pixel_coord_lower:new s.Uniform2f(m,i.u_pixel_coord_lower),u_tile_units_to_pixels:new s.Uniform1f(m,i.u_tile_units_to_pixels)}),terrain:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_texture:new s.Uniform1i(m,i.u_texture)}),terrainDepth:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix)}),terrainCoords:(m,i)=>({u_matrix:new s.UniformMatrix4f(m,i.u_matrix),u_texture:new s.Uniform1i(m,i.u_texture),u_terrain_coords_id:new s.Uniform1f(m,i.u_terrain_coords_id)})};class qs{constructor(i,u,f){this.context=i;const y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ws={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Hs{constructor(i,u,f,y){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=y,this.context=i;const b=i.gl;this.buffer=b.createBuffer(),i.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let f=0;f<this.attributes.length;f++){const y=u.attributes[this.attributes[f].name];y!==void 0&&i.enableVertexAttribArray(y)}}setVertexAttribPointers(i,u,f){for(let y=0;y<this.attributes.length;y++){const b=this.attributes[y],k=u.attributes[b.name];k!==void 0&&i.vertexAttribPointer(k,b.components,i[Ws[b.type]],!1,this.itemSize,b.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ql extends yn{getDefault(){return s.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Ad extends yn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class ns extends yn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class rs extends yn{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class he extends yn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Me extends yn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class pt extends yn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Ft extends yn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Nn extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class sn extends yn{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Xn extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class hr extends yn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class wr extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class Wn extends yn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class jr extends yn{getDefault(){return s.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Ii extends yn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class Lr extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class Nr extends yn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Mi extends yn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class $o extends yn{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class bo extends yn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class ra extends yn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Qc extends yn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Zs extends yn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Pa extends yn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class eu extends yn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Id extends yn{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Md extends yn{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class Ks extends yn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Bf extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Ff extends yn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class tu extends yn{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class is extends tu{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Uf extends tu{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Xs{constructor(i,u,f,y){this.context=i,this.width=u,this.height=f;const b=i.gl,k=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new is(i,k),y&&(this.depthAttachment=new Uf(i,k)),b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&i.deleteRenderbuffer(f)}i.deleteFramebuffer(this.framebuffer)}}class Yn{constructor(i,u,f){this.blendFunction=i,this.blendColor=u,this.mask=f}}Yn.Replace=[1,0],Yn.disabled=new Yn(Yn.Replace,s.Color.transparent,[!1,!1,!1,!1]),Yn.unblended=new Yn(Yn.Replace,s.Color.transparent,[!0,!0,!0,!0]),Yn.alphaBlended=new Yn([1,771],s.Color.transparent,[!0,!0,!0,!0]);class Vf{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ql(this),this.clearDepth=new Ad(this),this.clearStencil=new ns(this),this.colorMask=new rs(this),this.depthMask=new he(this),this.stencilMask=new Me(this),this.stencilFunc=new pt(this),this.stencilOp=new Ft(this),this.stencilTest=new Nn(this),this.depthRange=new sn(this),this.depthTest=new Xn(this),this.depthFunc=new hr(this),this.blend=new wr(this),this.blendFunc=new Wn(this),this.blendColor=new jr(this),this.blendEquation=new Ii(this),this.cullFace=new Lr(this),this.cullFaceSide=new Nr(this),this.frontFace=new Mi(this),this.program=new $o(this),this.activeTexture=new bo(this),this.viewport=new ra(this),this.bindFramebuffer=new Qc(this),this.bindRenderbuffer=new Zs(this),this.bindTexture=new Pa(this),this.bindVertexBuffer=new eu(this),this.bindElementBuffer=new Id(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Md(this),this.pixelStoreUnpack=new Ks(this),this.pixelStoreUnpackPremultiplyAlpha=new Bf(this),this.pixelStoreUnpackFlipY=new Ff(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new qs(this,i,u)}createVertexBuffer(i,u,f){return new Hs(this,i,u,f)}createRenderbuffer(i,u,f){const y=this.gl,b=y.createRenderbuffer();return this.bindRenderbuffer.set(b),y.renderbufferStorage(y.RENDERBUFFER,i,u,f),this.bindRenderbuffer.set(null),b}createFramebuffer(i,u,f){return new Xs(this,i,u,f)}clear({color:i,depth:u}){const f=this.gl;let y=0;i&&(y|=f.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(y|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),f.clear(y)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){T(i.blendFunction,Yn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class vn{constructor(i,u,f){this.func=i,this.mask=u,this.range=f}}vn.ReadOnly=!1,vn.ReadWrite=!0,vn.disabled=new vn(519,vn.ReadOnly,[0,1]);const Pn=7680;class Hn{constructor(i,u,f,y,b,k){this.test=i,this.ref=u,this.mask=f,this.fail=y,this.depthFail=b,this.pass=k}}Hn.disabled=new Hn({func:519,mask:0},0,0,Pn,Pn,Pn);class tr{constructor(i,u,f){this.enable=i,this.mode=u,this.frontFace=f}}let Wl;function Ys(m,i,u,f,y,b,k){const I=m.context,R=I.gl,z=m.useProgram("collisionBox"),q=[];let Y=0,ee=0;for(let pe=0;pe<f.length;pe++){const Ge=f[pe],Ue=i.getTile(Ge),et=Ue.getBucket(u);if(!et)continue;let nt=Ge.posMatrix;y[0]===0&&y[1]===0||(nt=m.translatePosMatrix(Ge.posMatrix,Ue,y,b));const gt=k?et.textCollisionBox:et.iconCollisionBox,Je=et.collisionCircleArray;if(Je.length>0){const Dt=s.create(),Tt=nt;s.mul(Dt,et.placementInvProjMatrix,m.transform.glCoordMatrix),s.mul(Dt,Dt,et.placementViewportMatrix),q.push({circleArray:Je,circleOffset:ee,transform:Tt,invTransform:Dt,coord:Ge}),Y+=Je.length/4,ee=Y}gt&&z.draw(I,R.LINES,vn.disabled,Hn.disabled,m.colorModeForRenderPass(),tr.disabled,na(nt,m.transform,Ue),m.style.terrain&&m.style.terrain.getTerrainData(Ge),u.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,null,m.transform.zoom,null,null,gt.collisionVertexBuffer)}if(!k||!q.length)return;const fe=m.useProgram("collisionCircle"),se=new s.CollisionCircleLayoutArray;se.resize(4*Y),se._trim();let ce=0;for(const pe of q)for(let Ge=0;Ge<pe.circleArray.length/4;Ge++){const Ue=4*Ge,et=pe.circleArray[Ue+0],nt=pe.circleArray[Ue+1],gt=pe.circleArray[Ue+2],Je=pe.circleArray[Ue+3];se.emplace(ce++,et,nt,gt,Je,0),se.emplace(ce++,et,nt,gt,Je,1),se.emplace(ce++,et,nt,gt,Je,2),se.emplace(ce++,et,nt,gt,Je,3)}(!Wl||Wl.length<2*Y)&&(Wl=function(pe){const Ge=2*pe,Ue=new s.QuadTriangleArray;Ue.resize(Ge),Ue._trim();for(let et=0;et<Ge;et++){const nt=6*et;Ue.uint16[nt+0]=4*et+0,Ue.uint16[nt+1]=4*et+1,Ue.uint16[nt+2]=4*et+2,Ue.uint16[nt+3]=4*et+2,Ue.uint16[nt+4]=4*et+3,Ue.uint16[nt+5]=4*et+0}return Ue}(Y));const Te=I.createIndexBuffer(Wl,!0),Re=I.createVertexBuffer(se,s.collisionCircleLayout.members,!0);for(const pe of q){const Ge={u_matrix:pe.transform,u_inv_matrix:pe.invTransform,u_camera_to_center_distance:(Be=m.transform).cameraToCenterDistance,u_viewport_size:[Be.width,Be.height]};fe.draw(I,R.TRIANGLES,vn.disabled,Hn.disabled,m.colorModeForRenderPass(),tr.disabled,Ge,m.style.terrain&&m.style.terrain.getTerrainData(pe.coord),u.id,Re,Te,s.SegmentVector.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,m.transform.zoom,null,null,null)}var Be;Re.destroy(),Te.destroy()}tr.disabled=new tr(!1,1029,2305),tr.backCCW=new tr(!0,1029,2305);const cg=s.identity(new Float32Array(16));function ug(m,i,u,f,y,b){const{horizontalAlign:k,verticalAlign:I}=s.getAnchorAlignment(m),R=-(k-.5)*i,z=-(I-.5)*u,q=s.evaluateVariableOffset(m,f);return new s.pointGeometry((R/y+q[0])*b,(z/y+q[1])*b)}function jf(m,i,u,f,y,b,k,I,R,z,q){const Y=m.text.placedSymbolArray,ee=m.text.dynamicLayoutVertexArray,fe=m.icon.dynamicLayoutVertexArray,se={};ee.clear();for(let ce=0;ce<Y.length;ce++){const Te=Y.get(ce),Re=m.allowVerticalPlacement&&!Te.placedOrientation,Be=Te.hidden||!Te.crossTileID||Re?null:f[Te.crossTileID];if(Be){const pe=new s.pointGeometry(Te.anchorX,Te.anchorY),Ge=cn(pe,u?k:b,q),Ue=Rr(y.cameraToCenterDistance,Ge.signedDistanceFromCamera);let et=s.evaluateSizeForFeature(m.textSizeData,R,Te)*Ue/s.ONE_EM;u&&(et*=m.tilePixelRatio/I);const{width:nt,height:gt,anchor:Je,textOffset:Dt,textBoxScale:Tt}=Be,Lt=ug(Je,nt,gt,Dt,Tt,et),rn=u?cn(pe.add(Lt),b,q).point:Ge.point.add(i?Lt.rotate(-y.angle):Lt),un=m.allowVerticalPlacement&&Te.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<Te.numGlyphs;Ht++)s.addDynamicAttributes(ee,rn,un);z&&Te.associatedIconIndex>=0&&(se[Te.associatedIconIndex]={shiftedAnchor:rn,angle:un})}else Jt(Te.numGlyphs,ee)}if(z){fe.clear();const ce=m.icon.placedSymbolArray;for(let Te=0;Te<ce.length;Te++){const Re=ce.get(Te);if(Re.hidden)Jt(Re.numGlyphs,fe);else{const Be=se[Te];if(Be)for(let pe=0;pe<Re.numGlyphs;pe++)s.addDynamicAttributes(fe,Be.shiftedAnchor,Be.angle);else Jt(Re.numGlyphs,fe)}}m.icon.dynamicLayoutVertexBuffer.updateData(fe)}m.text.dynamicLayoutVertexBuffer.updateData(ee)}function dg(m,i,u){return u.iconsInText&&i?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function nu(m,i,u,f,y,b,k,I,R,z,q,Y){const ee=m.context,fe=ee.gl,se=m.transform,ce=I==="map",Te=R==="map",Re=I!=="viewport"&&u.layout.get("symbol-placement")!=="point",Be=ce&&!Te&&!Re,pe=!u.layout.get("symbol-sort-key").isConstant();let Ge=!1;const Ue=m.depthModeForSublayer(0,vn.ReadOnly),et=u.layout.get("text-variable-anchor"),nt=[];for(const gt of f){const Je=i.getTile(gt),Dt=Je.getBucket(u);if(!Dt)continue;const Tt=y?Dt.text:Dt.icon;if(!Tt||!Tt.segments.get().length)continue;const Lt=Tt.programConfigurations.get(u.id),rn=y||Dt.sdfIcons,un=y?Dt.textSizeData:Dt.iconSizeData,Ht=Te||se.pitch!==0,Dn=m.useProgram(dg(rn,y,Dt),Lt),Rn=s.evaluateSizeForZoom(un,se.zoom),wn=m.style.terrain&&m.style.terrain.getTerrainData(gt);let Sn,On,Gr,Fo,Eo=[0,0],Uo=null;if(y){if(On=Je.glyphAtlasTexture,Gr=fe.LINEAR,Sn=Je.glyphAtlasTexture.size,Dt.iconsInText){Eo=Je.imageAtlasTexture.size,Uo=Je.imageAtlasTexture;const so=un.kind==="composite"||un.kind==="camera";Fo=Ht||m.options.rotating||m.options.zooming||so?fe.LINEAR:fe.NEAREST}}else{const so=u.layout.get("icon-size").constantOr(0)!==1||Dt.iconsNeedLinear;On=Je.imageAtlasTexture,Gr=rn||m.options.rotating||m.options.zooming||so||Ht?fe.LINEAR:fe.NEAREST,Sn=Je.imageAtlasTexture.size}const Na=Bn(Je,1,m.transform.zoom),ao=Kn(gt.posMatrix,Te,ce,m.transform,Na),Ri=Dr(gt.posMatrix,Te,ce,m.transform,Na),aa=et&&Dt.hasTextData(),uu=u.layout.get("icon-text-fit")!=="none"&&aa&&Dt.hasIconData();if(Re){const so=m.style.terrain?(Wd,rl)=>m.style.terrain.getElevation(gt,Wd,rl):null,ls=u.layout.get("text-rotation-alignment")==="map";dr(Dt,gt.posMatrix,m,y,ao,Ri,Te,z,ls,so)}const Or=m.translatePosMatrix(gt.posMatrix,Je,b,k),fn=Re||y&&et||uu?cg:ao,An=m.translatePosMatrix(Ri,Je,b,k,!0),qr=rn&&u.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Wr;Wr=rn?Dt.iconsInText?ts(un.kind,Rn,Be,Te,m,Or,fn,An,Sn,Eo):Gs(un.kind,Rn,Be,Te,m,Or,fn,An,y,Sn,!0):js(un.kind,Rn,Be,Te,m,Or,fn,An,y,Sn);const rr={program:Dn,buffers:Tt,uniformValues:Wr,atlasTexture:On,atlasTextureIcon:Uo,atlasInterpolation:Gr,atlasInterpolationIcon:Fo,isSDF:rn,hasHalo:qr};if(pe&&Dt.canOverlap){Ge=!0;const so=Tt.segments.get();for(const ls of so)nt.push({segments:new s.SegmentVector([ls]),sortKey:ls.sortKey,state:rr,terrainData:wn})}else nt.push({segments:Tt.segments,sortKey:0,state:rr,terrainData:wn})}Ge&&nt.sort((gt,Je)=>gt.sortKey-Je.sortKey);for(const gt of nt){const Je=gt.state;if(ee.activeTexture.set(fe.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,fe.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(ee.activeTexture.set(fe.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,fe.CLAMP_TO_EDGE)),Je.isSDF){const Dt=Je.uniformValues;Je.hasHalo&&(Dt.u_is_halo=1,Hl(Je.buffers,gt.segments,u,m,Je.program,Ue,q,Y,Dt,gt.terrainData)),Dt.u_is_halo=0}Hl(Je.buffers,gt.segments,u,m,Je.program,Ue,q,Y,Je.uniformValues,gt.terrainData)}}function Hl(m,i,u,f,y,b,k,I,R,z){const q=f.context;y.draw(q,q.gl.TRIANGLES,b,k,I,tr.disabled,R,z,u.id,m.layoutVertexBuffer,m.indexBuffer,i,u.paint,f.transform.zoom,m.programConfigurations.get(u.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function Zl(m,i,u,f,y,b,k){const I=m.context.gl,R=u.paint.get("fill-pattern"),z=R&&R.constantOr(1),q=u.getCrossfadeParameters();let Y,ee,fe,se,ce;k?(ee=z&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=I.LINES):(ee=z?"fillPattern":"fill",Y=I.TRIANGLES);for(const Te of f){const Re=i.getTile(Te);if(z&&!Re.patternsLoaded())continue;const Be=Re.getBucket(u);if(!Be)continue;const pe=Be.programConfigurations.get(u.id),Ge=m.useProgram(ee,pe),Ue=m.style.terrain&&m.style.terrain.getTerrainData(Te);z&&(m.context.activeTexture.set(I.TEXTURE0),Re.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),pe.updatePaintBuffers(q));const et=R.constantOr(null);if(et&&Re.imageAtlas){const Je=Re.imageAtlas,Dt=Je.patternPositions[et.to.toString()],Tt=Je.patternPositions[et.from.toString()];Dt&&Tt&&pe.setConstantPatternPositions(Dt,Tt)}const nt=Ue?Te:null,gt=m.translatePosMatrix(nt?nt.posMatrix:Te.posMatrix,Re,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(k){se=Be.indexBuffer2,ce=Be.segments2;const Je=[I.drawingBufferWidth,I.drawingBufferHeight];fe=ee==="fillOutlinePattern"&&z?Vl(gt,m,q,Re,Je):Xc(gt,Je)}else se=Be.indexBuffer,ce=Be.segments,fe=z?Ul(gt,m,q,Re):Fs(gt);Ge.draw(m.context,Y,y,m.stencilModeForClipping(Te),b,tr.disabled,fe,Ue,u.id,Be.layoutVertexBuffer,se,ce,u.paint,m.transform.zoom,pe)}}function Kl(m,i,u,f,y,b,k){const I=m.context,R=I.gl,z=u.paint.get("fill-extrusion-pattern"),q=z.constantOr(1),Y=u.getCrossfadeParameters(),ee=u.paint.get("fill-extrusion-opacity");for(const fe of f){const se=i.getTile(fe),ce=se.getBucket(u);if(!ce)continue;const Te=m.style.terrain&&m.style.terrain.getTerrainData(fe),Re=ce.programConfigurations.get(u.id),Be=m.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Re);q&&(m.context.activeTexture.set(R.TEXTURE0),se.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Re.updatePaintBuffers(Y));const pe=z.constantOr(null);if(pe&&se.imageAtlas){const nt=se.imageAtlas,gt=nt.patternPositions[pe.to.toString()],Je=nt.patternPositions[pe.from.toString()];gt&&Je&&Re.setConstantPatternPositions(gt,Je)}const Ge=m.translatePosMatrix(fe.posMatrix,se,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Ue=u.paint.get("fill-extrusion-vertical-gradient"),et=q?Cd(Ge,m,Ue,ee,fe,Y,se):Bs(Ge,m,Ue,ee);Be.draw(I,I.gl.TRIANGLES,y,b,k,tr.backCCW,et,Te,u.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,u.paint,m.transform.zoom,Re,m.style.terrain&&ce.centroidVertexBuffer)}}function Dd(m,i,u,f,y,b,k){const I=m.context,R=I.gl,z=u.fbo;if(!z)return;const q=m.useProgram("hillshade"),Y=m.style.terrain&&m.style.terrain.getTerrainData(i);I.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,z.colorAttachment.get()),q.draw(I,R.TRIANGLES,y,b,k,tr.disabled,((ee,fe,se,ce)=>{const Te=se.paint.get("hillshade-shadow-color"),Re=se.paint.get("hillshade-highlight-color"),Be=se.paint.get("hillshade-accent-color");let pe=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);se.paint.get("hillshade-illumination-anchor")==="viewport"&&(pe-=ee.transform.angle);const Ge=!ee.options.moving;return{u_matrix:ce?ce.posMatrix:ee.transform.calculatePosMatrix(fe.tileID.toUnwrapped(),Ge),u_image:0,u_latrange:Us(0,fe.tileID),u_light:[se.paint.get("hillshade-exaggeration"),pe],u_shadow:Te,u_highlight:Re,u_accent:Be}})(m,u,f,Y?i:null),Y,f.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}function Gf(m,i,u,f,y,b){const k=m.context,I=k.gl,R=i.dem;if(R&&R.data){const z=R.dim,q=R.stride,Y=R.getPixels();if(k.activeTexture.set(I.TEXTURE1),k.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||m.getTileTexture(q),i.demTexture){const fe=i.demTexture;fe.update(Y,{premultiply:!1}),fe.bind(I.NEAREST,I.CLAMP_TO_EDGE)}else i.demTexture=new M(k,Y,I.RGBA,{premultiply:!1}),i.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);k.activeTexture.set(I.TEXTURE0);let ee=i.fbo;if(!ee){const fe=new M(k,{width:z,height:z,data:null},I.RGBA);fe.bind(I.LINEAR,I.CLAMP_TO_EDGE),ee=i.fbo=k.createFramebuffer(z,z,!0),ee.colorAttachment.set(fe.texture)}k.bindFramebuffer.set(ee.framebuffer),k.viewport.set([0,0,z,z]),m.useProgram("hillshadePrepare").draw(k,I.TRIANGLES,f,y,b,tr.disabled,((fe,se)=>{const ce=se.stride,Te=s.create();return s.ortho(Te,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(Te,Te,[0,-s.EXTENT,0]),{u_matrix:Te,u_image:1,u_dimension:[ce,ce],u_zoom:fe.overscaledZ,u_unpack:se.getUnpackVector()}})(i.tileID,R),null,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function ru(m,i,u,f,y,b){const k=f.paint.get("raster-fade-duration");if(!b&&k>0){const I=s.exported.now(),R=(I-m.timeAdded)/k,z=i?(I-i.timeAdded)/k:-1,q=u.getSource(),Y=y.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),ee=!i||Math.abs(i.tileID.overscaledZ-Y)>Math.abs(m.tileID.overscaledZ-Y),fe=ee&&m.refreshedUponExpiration?1:s.clamp(ee?R:1-z,0,1);return m.refreshedUponExpiration&&R>=1&&(m.refreshedUponExpiration=!1),i?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}const iu=new s.Color(1,0,0,1),wo=new s.Color(0,1,0,1),qf=new s.Color(0,0,1,1),Rd=new s.Color(1,0,1,1),Wf=new s.Color(0,1,1,1);function os(m,i,u,f){Js(m,0,i+u/2,m.transform.width,u,f)}function Xl(m,i,u,f){Js(m,i-u/2,0,u,m.transform.height,f)}function Js(m,i,u,f,y,b){const k=m.context,I=k.gl;I.enable(I.SCISSOR_TEST),I.scissor(i*m.pixelRatio,u*m.pixelRatio,f*m.pixelRatio,y*m.pixelRatio),k.clear({color:b}),I.disable(I.SCISSOR_TEST)}function hg(m,i,u){const f=m.context,y=f.gl,b=u.posMatrix,k=m.useProgram("debug"),I=vn.disabled,R=Hn.disabled,z=m.colorModeForRenderPass(),q="$debug",Y=m.style.terrain&&m.style.terrain.getTerrainData(u);f.activeTexture.set(y.TEXTURE0),m.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE);const ee=i.getTileByID(u.key).latestRawTileData,fe=Math.floor((ee&&ee.byteLength||0)/1024),se=i.getTile(u).tileSize,ce=512/Math.min(se,512)*(u.overscaledZ/m.transform.zoom)*.5;let Te=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(Te+=` => ${u.overscaledZ}`),function(Re,Be){Re.initDebugOverlayCanvas();const pe=Re.debugOverlayCanvas,Ge=Re.context.gl,Ue=Re.debugOverlayCanvas.getContext("2d");Ue.clearRect(0,0,pe.width,pe.height),Ue.shadowColor="white",Ue.shadowBlur=2,Ue.lineWidth=1.5,Ue.strokeStyle="white",Ue.textBaseline="top",Ue.font="bold 36px Open Sans, sans-serif",Ue.fillText(Be,5,5),Ue.strokeText(Be,5,5),Re.debugOverlayTexture.update(pe),Re.debugOverlayTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE)}(m,`${Te} ${fe}kB`),k.draw(f,y.TRIANGLES,I,R,Yn.alphaBlended,tr.disabled,ka(b,s.Color.transparent,ce),null,q,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),k.draw(f,y.LINE_STRIP,I,R,z,tr.disabled,ka(b,s.Color.red),Y,q,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function ou(m,i,u){const f=m.context,y=f.gl,b=m.colorModeForRenderPass(),k=new vn(y.LEQUAL,vn.ReadWrite,m.depthRangeFor3D),I=m.useProgram("terrain"),R=i.getTerrainMesh(),z=i.getTerrainData(u.tileID);f.bindFramebuffer.set(null),f.viewport.set([0,0,m.width,m.height]),f.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,i.getRTTFramebuffer().colorAttachment.get());const q=m.transform.calculatePosMatrix(u.tileID.toUnwrapped());I.draw(f,y.TRIANGLES,k,Hn.disabled,b,tr.backCCW,{u_matrix:q,u_texture:0},z,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}function Hf(m,i,u,f){const y=m.context,b=u.tileSize*i.qualityFactor;u.textures[f]||(u.textures[f]=m.getTileTexture(b)||new M(y,{width:b,height:b,data:null},y.gl.RGBA),u.textures[f].bind(y.gl.LINEAR,y.gl.CLAMP_TO_EDGE),f===0&&i.sourceCache.renderHistory.unshift(u.tileID.key));const k=i.getRTTFramebuffer();k.colorAttachment.set(u.textures[f].texture),y.bindFramebuffer.set(k.framebuffer),y.viewport.set([0,0,b,b])}class Zf{constructor(i){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=i,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=i.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const i=this.painter.style,u=i.terrain;for(const f in i.sourceCaches){this._coordsDescendingInv[f]={};const y=i.sourceCaches[f].getVisibleCoordinates();for(const b of y){const k=u.sourceCache.getTerrainCoords(b);for(const I in k)this._coordsDescendingInv[f][I]||(this._coordsDescendingInv[f][I]=[]),this._coordsDescendingInv[f][I].push(k[I])}}for(const f of i._order){const y=i._layers[f],b=y.source;if(this._renderToTexture[y.type]&&!this._coordsDescendingInvStr[b]){this._coordsDescendingInvStr[b]={};for(const k in this._coordsDescendingInv[b])this._coordsDescendingInvStr[b][k]=this._coordsDescendingInv[b][k].map(I=>I.key).sort().join()}}return this._renderableTiles.forEach(f=>{for(const y in this._coordsDescendingInvStr){const b=this._coordsDescendingInvStr[y][f.tileID.key];b&&b!==f.textureCoords[y]&&f.clearTextures(this.painter),u.needsRerender(y,f.tileID)&&f.clearTextures(this.painter)}this._rerender[f.tileID.key]=!f.textures.length}),u.clearRerenderCache(),u.sourceCache.removeOutdated(this.painter),this}renderLayer(i){const u=i.type,f=this.painter,y=f.style._order,b=f.currentLayer,k=b+1===y.length;if(this._renderToTexture[u]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(y[b]),!k))return!0;if(this._renderToTexture[this._prevType]||u==="hillshade"||this._renderToTexture[u]&&k){this._prevType=u;const I=this._stacks.length-1,R=this._stacks[I]||[];for(const z of this._renderableTiles){if(Hf(f,f.style.terrain,z,I),this._rerender[z.tileID.key]){f.context.clear({color:s.Color.transparent});for(let q=0;q<R.length;q++){const Y=f.style._layers[R[q]],ee=Y.source?this._coordsDescendingInv[Y.source][z.tileID.key]:[z.tileID];f._renderTileClippingMasks(Y,ee),f.renderLayer(f,f.style.sourceCaches[Y.source],Y,ee),Y.source&&(z.textureCoords[Y.source]=this._coordsDescendingInvStr[Y.source][z.tileID.key])}}ou(f,f.style.terrain,z)}if(u==="hillshade"){this._stacks.push([y[b]]);for(const z of this._renderableTiles){const q=this._coordsDescendingInv[i.source][z.tileID.key];Hf(f,f.style.terrain,z,this._stacks.length-1),f.context.clear({color:s.Color.transparent}),f._renderTileClippingMasks(i,q),f.renderLayer(f,f.style.sourceCaches[i.source],i,q),ou(f,f.style.terrain,z)}return!0}return this._renderToTexture[u]}return!1}}const Yl={symbol:function(m,i,u,f,y){if(m.renderPass!=="translucent")return;const b=Hn.disabled,k=m.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(I,R,z,q,Y,ee,fe){const se=R.transform,ce=Y==="map",Te=ee==="map";for(const Re of I){const Be=q.getTile(Re),pe=Be.getBucket(z);if(!pe||!pe.text||!pe.text.segments.get().length)continue;const Ge=s.evaluateSizeForZoom(pe.textSizeData,se.zoom),Ue=Bn(Be,1,R.transform.zoom),et=Kn(Re.posMatrix,Te,ce,R.transform,Ue),nt=z.layout.get("icon-text-fit")!=="none"&&pe.hasIconData();if(Ge){const gt=Math.pow(2,se.zoom-Be.tileID.overscaledZ);jf(pe,ce,Te,fe,se,et,Re.posMatrix,gt,Ge,nt,R.style.terrain?(Je,Dt)=>R.style.terrain.getElevation(Re,Je,Dt):null)}}}(f,m,u,i,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),y),u.paint.get("icon-opacity").constantOr(1)!==0&&nu(m,i,u,f,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),b,k),u.paint.get("text-opacity").constantOr(1)!==0&&nu(m,i,u,f,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),b,k),i.map.showCollisionBoxes&&(Ys(m,i,u,f,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Ys(m,i,u,f,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(m,i,u,f){if(m.renderPass!=="translucent")return;const y=u.paint.get("circle-opacity"),b=u.paint.get("circle-stroke-width"),k=u.paint.get("circle-stroke-opacity"),I=!u.layout.get("circle-sort-key").isConstant();if(y.constantOr(1)===0&&(b.constantOr(1)===0||k.constantOr(1)===0))return;const R=m.context,z=R.gl,q=m.depthModeForSublayer(0,vn.ReadOnly),Y=Hn.disabled,ee=m.colorModeForRenderPass(),fe=[];for(let se=0;se<f.length;se++){const ce=f[se],Te=i.getTile(ce),Re=Te.getBucket(u);if(!Re)continue;const Be=Re.programConfigurations.get(u.id),pe=m.useProgram("circle",Be),Ge=Re.layoutVertexBuffer,Ue=Re.indexBuffer,et=m.style.terrain&&m.style.terrain.getTerrainData(ce),nt={programConfiguration:Be,program:pe,layoutVertexBuffer:Ge,indexBuffer:Ue,uniformValues:Yc(m,ce,Te,u),terrainData:et};if(I){const gt=Re.segments.get();for(const Je of gt)fe.push({segments:new s.SegmentVector([Je]),sortKey:Je.sortKey,state:nt})}else fe.push({segments:Re.segments,sortKey:0,state:nt})}I&&fe.sort((se,ce)=>se.sortKey-ce.sortKey);for(const se of fe){const{programConfiguration:ce,program:Te,layoutVertexBuffer:Re,indexBuffer:Be,uniformValues:pe,terrainData:Ge}=se.state;Te.draw(R,z.TRIANGLES,q,Y,ee,tr.disabled,pe,Ge,u.id,Re,Be,se.segments,u.paint,m.transform.zoom,ce)}},heatmap:function(m,i,u,f){if(u.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const y=m.context,b=y.gl,k=Hn.disabled,I=new Yn([b.ONE,b.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(R,z,q){const Y=R.gl;R.activeTexture.set(Y.TEXTURE1),R.viewport.set([0,0,z.width/4,z.height/4]);let ee=q.heatmapFbo;if(ee)Y.bindTexture(Y.TEXTURE_2D,ee.colorAttachment.get()),R.bindFramebuffer.set(ee.framebuffer);else{const fe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,fe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),ee=q.heatmapFbo=R.createFramebuffer(z.width/4,z.height/4,!1),function(se,ce,Te,Re){const Be=se.gl;Be.texImage2D(Be.TEXTURE_2D,0,Be.RGBA,ce.width/4,ce.height/4,0,Be.RGBA,se.extRenderToTextureHalfFloat?se.extTextureHalfFloat.HALF_FLOAT_OES:Be.UNSIGNED_BYTE,null),Re.colorAttachment.set(Te)}(R,z,fe,ee)}})(y,m,u),y.clear({color:s.Color.transparent});for(let R=0;R<f.length;R++){const z=f[R];if(i.hasRenderableParent(z))continue;const q=i.getTile(z),Y=q.getBucket(u);if(!Y)continue;const ee=Y.programConfigurations.get(u.id),fe=m.useProgram("heatmap",ee),{zoom:se}=m.transform;fe.draw(y,b.TRIANGLES,vn.disabled,k,I,tr.disabled,xo(z.posMatrix,q,se,u.paint.get("heatmap-intensity")),null,u.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,u.paint,m.transform.zoom,ee)}y.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(y,b){const k=y.context,I=k.gl,R=b.heatmapFbo;if(!R)return;k.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get()),k.activeTexture.set(I.TEXTURE1);let z=b.colorRampTexture;z||(z=b.colorRampTexture=new M(k,b.colorRamp,I.RGBA)),z.bind(I.LINEAR,I.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(k,I.TRIANGLES,vn.disabled,Hn.disabled,y.colorModeForRenderPass(),tr.disabled,((q,Y,ee,fe)=>{const se=s.create();s.ortho(se,0,q.width,q.height,0,0,1);const ce=q.context.gl;return{u_matrix:se,u_world:[ce.drawingBufferWidth,ce.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Y.paint.get("heatmap-opacity")}})(y,b),null,b.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,b.paint,y.transform.zoom)}(m,u))},line:function(m,i,u,f){if(m.renderPass!=="translucent")return;const y=u.paint.get("line-opacity"),b=u.paint.get("line-width");if(y.constantOr(1)===0||b.constantOr(1)===0)return;const k=m.depthModeForSublayer(0,vn.ReadOnly),I=m.colorModeForRenderPass(),R=u.paint.get("line-dasharray"),z=u.paint.get("line-pattern"),q=z.constantOr(1),Y=u.paint.get("line-gradient"),ee=u.getCrossfadeParameters(),fe=q?"linePattern":R?"lineSDF":Y?"lineGradient":"line",se=m.context,ce=se.gl;let Te=!0;for(const Re of f){const Be=i.getTile(Re);if(q&&!Be.patternsLoaded())continue;const pe=Be.getBucket(u);if(!pe)continue;const Ge=pe.programConfigurations.get(u.id),Ue=m.context.program.get(),et=m.useProgram(fe,Ge),nt=Te||et.program!==Ue,gt=m.style.terrain&&m.style.terrain.getTerrainData(Re),Je=z.constantOr(null);if(Je&&Be.imageAtlas){const Lt=Be.imageAtlas,rn=Lt.patternPositions[Je.to.toString()],un=Lt.patternPositions[Je.from.toString()];rn&&un&&Ge.setConstantPatternPositions(rn,un)}const Dt=gt?Re:null,Tt=q?Vs(m,Be,u,ee,Dt):R?Qa(m,Be,u,R,ee,Dt):Y?io(m,Be,u,pe.lineClipsArray.length,Dt):Ca(m,Be,u,Dt);if(q)se.activeTexture.set(ce.TEXTURE0),Be.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),Ge.updatePaintBuffers(ee);else if(R&&(nt||m.lineAtlas.dirty))se.activeTexture.set(ce.TEXTURE0),m.lineAtlas.bind(se);else if(Y){const Lt=pe.gradients[u.id];let rn=Lt.texture;if(u.gradientVersion!==Lt.version){let un=256;if(u.stepInterpolant){const Ht=i.getSource().maxzoom,Dn=Re.canonical.z===Ht?Math.ceil(1<<m.transform.maxZoom-Re.canonical.z):1;un=s.clamp(s.nextPowerOfTwo(pe.maxLineLength/s.EXTENT*1024*Dn),256,se.maxTextureSize)}Lt.gradient=s.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:un,image:Lt.gradient||void 0,clips:pe.lineClipsArray}),Lt.texture?Lt.texture.update(Lt.gradient):Lt.texture=new M(se,Lt.gradient,ce.RGBA),Lt.version=u.gradientVersion,rn=Lt.texture}se.activeTexture.set(ce.TEXTURE0),rn.bind(u.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}et.draw(se,ce.TRIANGLES,k,m.stencilModeForClipping(Re),I,tr.disabled,Tt,gt,u.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,u.paint,m.transform.zoom,Ge,pe.layoutVertexBuffer2),Te=!1}},fill:function(m,i,u,f){const y=u.paint.get("fill-color"),b=u.paint.get("fill-opacity");if(b.constantOr(1)===0)return;const k=m.colorModeForRenderPass(),I=u.paint.get("fill-pattern"),R=m.opaquePassEnabledForLayer()&&!I.constantOr(1)&&y.constantOr(s.Color.transparent).a===1&&b.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===R){const z=m.depthModeForSublayer(1,m.renderPass==="opaque"?vn.ReadWrite:vn.ReadOnly);Zl(m,i,u,f,z,k,!1)}if(m.renderPass==="translucent"&&u.paint.get("fill-antialias")){const z=m.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,vn.ReadOnly);Zl(m,i,u,f,z,k,!0)}},"fill-extrusion":function(m,i,u,f){const y=u.paint.get("fill-extrusion-opacity");if(y!==0&&m.renderPass==="translucent"){const b=new vn(m.context.gl.LEQUAL,vn.ReadWrite,m.depthRangeFor3D);if(y!==1||u.paint.get("fill-extrusion-pattern").constantOr(1))Kl(m,i,u,f,b,Hn.disabled,Yn.disabled),Kl(m,i,u,f,b,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const k=m.colorModeForRenderPass();Kl(m,i,u,f,b,Hn.disabled,k)}}},hillshade:function(m,i,u,f){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const y=m.context,b=m.depthModeForSublayer(0,vn.ReadOnly),k=m.colorModeForRenderPass(),[I,R]=m.renderPass==="translucent"?m.stencilConfigForOverlap(f):[{},f];for(const z of R){const q=i.getTile(z);q.needsHillshadePrepare!==void 0&&q.needsHillshadePrepare&&m.renderPass==="offscreen"?Gf(m,q,u,b,Hn.disabled,k):m.renderPass==="translucent"&&Dd(m,z,q,u,b,I[z.overscaledZ],k)}y.viewport.set([0,0,m.width,m.height])},raster:function(m,i,u,f){if(m.renderPass!=="translucent"||u.paint.get("raster-opacity")===0||!f.length)return;const y=m.context,b=y.gl,k=i.getSource(),I=m.useProgram("raster"),R=m.colorModeForRenderPass(),[z,q]=k instanceof Ae?[{},f]:m.stencilConfigForOverlap(f),Y=q[q.length-1].overscaledZ,ee=!m.options.moving;for(const fe of q){const se=m.depthModeForSublayer(fe.overscaledZ-Y,u.paint.get("raster-opacity")===1?vn.ReadWrite:vn.ReadOnly,b.LESS),ce=i.getTile(fe);ce.registerFadeDuration(u.paint.get("raster-fade-duration"));const Te=i.findLoadedParent(fe,0),Re=ru(ce,Te,i,u,m.transform,m.style.terrain);let Be,pe;const Ge=u.paint.get("raster-resampling")==="nearest"?b.NEAREST:b.LINEAR;y.activeTexture.set(b.TEXTURE0),ce.texture.bind(Ge,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(b.TEXTURE1),Te?(Te.texture.bind(Ge,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),Be=Math.pow(2,Te.tileID.overscaledZ-ce.tileID.overscaledZ),pe=[ce.tileID.canonical.x*Be%1,ce.tileID.canonical.y*Be%1]):ce.texture.bind(Ge,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST);const Ue=m.style.terrain&&m.style.terrain.getTerrainData(fe),et=Ue?fe:null,nt=et?et.posMatrix:m.transform.calculatePosMatrix(fe.toUnwrapped(),ee),gt=Jc(nt,pe||[0,0],Be||1,Re,u);k instanceof Ae?I.draw(y,b.TRIANGLES,se,Hn.disabled,R,tr.disabled,gt,Ue,u.id,k.boundsBuffer,m.quadTriangleIndexBuffer,k.boundsSegments):I.draw(y,b.TRIANGLES,se,z[fe.overscaledZ],R,tr.disabled,gt,Ue,u.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}},background:function(m,i,u,f){const y=u.paint.get("background-color"),b=u.paint.get("background-opacity");if(b===0)return;const k=m.context,I=k.gl,R=m.transform,z=R.tileSize,q=u.paint.get("background-pattern");if(m.isPatternMissing(q))return;const Y=!q&&y.a===1&&b===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Y)return;const ee=Hn.disabled,fe=m.depthModeForSublayer(0,Y==="opaque"?vn.ReadWrite:vn.ReadOnly),se=m.colorModeForRenderPass(),ce=m.useProgram(q?"backgroundPattern":"background"),Te=f||R.coveringTiles({tileSize:z,terrain:m.style.terrain});q&&(k.activeTexture.set(I.TEXTURE0),m.imageManager.bind(m.context));const Re=u.getCrossfadeParameters();for(const Be of Te){const pe=f?Be.posMatrix:m.transform.calculatePosMatrix(Be.toUnwrapped()),Ge=q?jl(pe,b,m,q,{tileID:Be,tileSize:z},Re):Pd(pe,b,y),Ue=m.style.terrain&&m.style.terrain.getTerrainData(Be);ce.draw(k,I.TRIANGLES,fe,ee,se,tr.disabled,Ge,Ue,u.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}},debug:function(m,i,u){for(let f=0;f<u.length;f++)hg(m,i,u[f])},custom:function(m,i,u){const f=m.context,y=u.implementation;if(m.renderPass==="offscreen"){const b=y.prerender;b&&(m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),b.call(y,f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),f.setColorMode(m.colorModeForRenderPass()),f.setStencilMode(Hn.disabled);const b=y.renderingMode==="3d"?new vn(m.context.gl.LEQUAL,vn.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,vn.ReadOnly);f.setDepthMode(b),y.render(f.gl,m.transform.customLayerMatrix()),f.setDirty(),m.setBaseState(),f.bindFramebuffer.set(null)}}};class Ld{constructor(i,u){this.context=new Vf(i),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.create(),renderTime:0},this.setup(),this.numSublayers=ke.maxUnderzooming+ke.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Qt,this.gpuTimers={}}resize(i,u,f){if(this.width=i*f,this.height=u*f,this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const i=this.context,u=new s.PosArray;u.emplaceBack(0,0),u.emplaceBack(s.EXTENT,0),u.emplaceBack(0,s.EXTENT),u.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(u,_n.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const f=new s.PosArray;f.emplaceBack(0,0),f.emplaceBack(s.EXTENT,0),f.emplaceBack(0,s.EXTENT),f.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=i.createVertexBuffer(f,_n.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const y=new s.RasterBoundsArray;y.emplaceBack(0,0,0,0),y.emplaceBack(s.EXTENT,0,s.EXTENT,0),y.emplaceBack(0,s.EXTENT,0,s.EXTENT),y.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.rasterBoundsBuffer=i.createVertexBuffer(y,We.members),this.rasterBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.PosArray;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(b,_n.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const k=new s.LineStripIndexArray;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(k);const I=new s.TriangleIndexArray;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(I),this.emptyTexture=new M(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA);const R=this.context.gl;this.stencilClearMode=new Hn({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO)}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=s.create();s.ortho(f,0,this.width,this.height,0,0,1),s.scale(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,u.TRIANGLES,vn.disabled,this.stencilClearMode,Yn.disabled,tr.disabled,_o(f),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,u){if(this.currentStencilSource===i.source||!i.isTileClipped()||!u||!u.length)return;this.currentStencilSource=i.source;const f=this.context,y=f.gl;this.nextStencilID+u.length>256&&this.clearStencil(),f.setColorMode(Yn.disabled),f.setDepthMode(vn.disabled);const b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const k of u){const I=this._tileClippingMaskIDs[k.key]=this.nextStencilID++,R=this.style.terrain&&this.style.terrain.getTerrainData(k);b.draw(f,y.TRIANGLES,vn.disabled,new Hn({func:y.ALWAYS,mask:0},I,255,y.KEEP,y.KEEP,y.REPLACE),Yn.disabled,tr.disabled,_o(k.posMatrix),R,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new Hn({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){const u=this.context.gl;return new Hn({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(i){const u=this.context.gl,f=i.sort((k,I)=>I.overscaledZ-k.overscaledZ),y=f[f.length-1].overscaledZ,b=f[0].overscaledZ-y+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const k={};for(let I=0;I<b;I++)k[I+y]=new Hn({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=b,[k,f]}return[{[y]:Hn.disabled},f]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new Yn([i.CONSTANT_COLOR,i.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Yn.unblended:Yn.alphaBlended}depthModeForSublayer(i,u,f){if(!this.opaquePassEnabledForLayer())return vn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new vn(f||this.context.gl.LEQUAL,u,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const f=this.style._order,y=this.style.sourceCaches,b=this.style.terrain&&new Zf(this);for(const z in y){const q=y[z];q.used&&q.prepare(this.context)}const k={},I={},R={};for(const z in y){const q=y[z];k[z]=q.getVisibleCoordinates(),I[z]=k[z].slice().reverse(),R[z]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<f.length;z++)if(this.style._layers[f[z]].is3D()){this.opaquePassCutoff=z;break}if(b){this.opaquePassCutoff=0;const z=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!s.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||z.length)&&(s.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(q,Y){const ee=q.context,fe=ee.gl,se=Yn.unblended,ce=new vn(fe.LEQUAL,vn.ReadWrite,[0,1]),Te=Y.getTerrainMesh(),Re=Y.sourceCache.getRenderableTiles(),Be=q.useProgram("terrainDepth");ee.bindFramebuffer.set(Y.getFramebuffer("depth").framebuffer),ee.viewport.set([0,0,q.width/devicePixelRatio,q.height/devicePixelRatio]),ee.clear({color:s.Color.transparent,depth:1});for(const pe of Re){const Ge=Y.getTerrainData(pe.tileID),Ue=q.transform.calculatePosMatrix(pe.tileID.toUnwrapped());Be.draw(ee,fe.TRIANGLES,ce,Hn.disabled,se,tr.backCCW,{u_matrix:Ue},Ge,"terrain",Te.vertexBuffer,Te.indexBuffer,Te.segments)}ee.bindFramebuffer.set(null),ee.viewport.set([0,0,q.width,q.height])}(this,this.style.terrain),function(q,Y){const ee=q.context,fe=ee.gl,se=Yn.unblended,ce=new vn(fe.LEQUAL,vn.ReadWrite,[0,1]),Te=Y.getTerrainMesh(),Re=Y.getCoordsTexture(),Be=Y.sourceCache.getRenderableTiles(),pe=q.useProgram("terrainCoords");ee.bindFramebuffer.set(Y.getFramebuffer("coords").framebuffer),ee.viewport.set([0,0,q.width/devicePixelRatio,q.height/devicePixelRatio]),ee.clear({color:s.Color.transparent,depth:1}),Y.coordsIndex=[];for(const Ge of Be){const Ue=Y.getTerrainData(Ge.tileID);ee.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,Re.texture);const et=q.transform.calculatePosMatrix(Ge.tileID.toUnwrapped());pe.draw(ee,fe.TRIANGLES,ce,Hn.disabled,se,tr.backCCW,{u_matrix:et,u_terrain_coords_id:(255-Y.coordsIndex.length)/255,u_texture:0},Ue,"terrain",Te.vertexBuffer,Te.indexBuffer,Te.segments),Y.coordsIndex.push(Ge.tileID.key)}ee.bindFramebuffer.set(null),ee.viewport.set([0,0,q.width,q.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const z of f){const q=this.style._layers[z];if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const Y=I[q.source];(q.type==="custom"||Y.length)&&this.renderLayer(this,y[q.source],q,Y)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!b)for(this.renderPass="opaque",this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[f[this.currentLayer]],q=y[z.source],Y=k[z.source];this._renderTileClippingMasks(z,Y),this.renderLayer(this,q,z,Y)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const z=this.style._layers[f[this.currentLayer]],q=y[z.source];if(b&&b.renderLayer(z))continue;const Y=(z.type==="symbol"?R:I)[z.source];this._renderTileClippingMasks(z,k[z.source]),this.renderLayer(this,q,z,Y)}if(this.options.showTileBoundaries){let z,q;Object.values(this.style._layers).forEach(Y=>{Y.source&&!Y.isHidden(this.transform.zoom)&&(Y.source!==(q&&q.id)&&(q=this.style.sourceCaches[Y.source]),(!z||z.getSource().maxzoom<q.getSource().maxzoom)&&(z=q))}),z&&Yl.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const q=z.transform.padding;os(z,z.transform.height-(q.top||0),3,iu),os(z,q.bottom||0,3,wo),Xl(z,q.left||0,3,qf),Xl(z,z.transform.width-(q.right||0),3,Rd);const Y=z.transform.centerPoint;(function(ee,fe,se,ce){Js(ee,fe-1,se-10,2,20,ce),Js(ee,fe-10,se-1,20,2,ce)})(z,Y.x,z.transform.height-Y.y,Wf)}(this),this.context.setDefault()}renderLayer(i,u,f,y){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,this.gpuTimingStart(f),Yl[f.type](i,u,f,y,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let f=this.gpuTimers[i.id];f||(f=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),f.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,f.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){const u={};for(const f in i){const y=i[f],b=this.context.extTimerQuery,k=b.getQueryObjectEXT(y.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(y.query),u[f]=k}return u}translatePosMatrix(i,u,f,y,b){if(!f[0]&&!f[1])return i;const k=b?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(k){const z=Math.sin(k),q=Math.cos(k);f=[f[0]*q-f[1]*z,f[0]*z+f[1]*q]}const I=[b?f[0]:Bn(u,f[0],this.transform.zoom),b?f[1]:Bn(u,f[1],this.transform.zoom),0],R=new Float32Array(16);return s.translate(R,i,I),R}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),f=this.imageManager.getPattern(i.to.toString());return!u||!f}useProgram(i,u){this.cache=this.cache||{};const f=i+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[f]||(this.cache[f]=new Sa(this.context,i,Ja[i],u,Gl[i],this._showOverdrawInspector,this.style.terrain)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new M(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class au{constructor(i,u){this.points=i,this.planes=u}static fromInvProjectionMatrix(i,u,f){const y=Math.pow(2,f),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const R=1/(I=s.transformMat4([],I,i))[3]/u*y;return s.mul$1(I,I,[R,R,1/I[3],R])}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const R=s.sub([],b[I[0]],b[I[1]]),z=s.sub([],b[I[2]],b[I[1]]),q=s.normalize([],s.cross([],R,z)),Y=-s.dot(q,b[I[1]]);return q.concat(Y)});return new au(b,k)}}class Jl{constructor(i,u){this.min=i,this.max=u,this.center=s.scale$1([],s.add([],this.min,this.max),.5)}quadrant(i){const u=[i%2==0,i<2],f=s.clone$2(this.min),y=s.clone$2(this.max);for(let b=0;b<u.length;b++)f[b]=u[b]?this.min[b]:this.center[b],y[b]=u[b]?this.center[b]:this.max[b];return y[2]=this.max[2],new Jl(f,y)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let f=!0;for(let y=0;y<i.planes.length;y++){const b=i.planes[y];let k=0;for(let I=0;I<u.length;I++)s.dot$1(b,u[I])>=0&&k++;if(k===0)return 0;k!==u.length&&(f=!1)}if(f)return 2;for(let y=0;y<3;y++){let b=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(let I=0;I<i.points.length;I++){const R=i.points[I][y]-this.min[y];b=Math.min(b,R),k=Math.max(k,R)}if(k<0||b>this.max[y]-this.min[y])return 0}return 1}}class Qs{constructor(i=0,u=0,f=0,y=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=f,this.right=y}interpolate(i,u,f){return u.top!=null&&i.top!=null&&(this.top=s.number(i.top,u.top,f)),u.bottom!=null&&i.bottom!=null&&(this.bottom=s.number(i.bottom,u.bottom,f)),u.left!=null&&i.left!=null&&(this.left=s.number(i.left,u.left,f)),u.right!=null&&i.right!=null&&(this.right=s.number(i.right,u.right,f)),this}getCenter(i,u){const f=s.clamp((this.left+i-this.right)/2,0,i),y=s.clamp((this.top+u-this.bottom)/2,0,u);return new s.pointGeometry(f,y)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Qs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Ql{constructor(i,u,f,y,b){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=b===void 0||!!b,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=f??0,this._maxPitch=y??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Qs,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const i=new Ql(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i._center=this._center,i._elevation=this._elevation,i.zoom=this.zoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const u=-s.wrap(i,-180,180)*Math.PI/180;var f;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(f=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),function(y,b,k){var I=b[0],R=b[1],z=b[2],q=b[3],Y=Math.sin(k),ee=Math.cos(k);y[0]=I*ee+z*Y,y[1]=R*ee+q*Y,y[2]=I*-Y+z*ee,y[3]=R*-Y+q*ee}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const u=s.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const u=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,f){this._unmodified=!1,this._edgeInsets.interpolate(i,u,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const u=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(i){const u=[new s.UnwrappedTileID(0,i)];if(this._renderWorldCopies){const f=this.pointCoordinate(new s.pointGeometry(0,0)),y=this.pointCoordinate(new s.pointGeometry(this.width,0)),b=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),k=this.pointCoordinate(new s.pointGeometry(0,this.height)),I=Math.floor(Math.min(f.x,y.x,b.x,k.x)),R=Math.floor(Math.max(f.x,y.x,b.x,k.x)),z=1;for(let q=I-z;q<=R+z;q++)q!==0&&u.push(new s.UnwrappedTileID(q,i))}return u}coveringTiles(i){var u,f;let y=this.coveringZoomLevel(i);const b=y;if(i.minzoom!==void 0&&y<i.minzoom)return[];i.maxzoom!==void 0&&y>i.maxzoom&&(y=i.maxzoom);const k=this.pointCoordinate(this.getCameraPoint()),I=s.MercatorCoordinate.fromLngLat(this.center),R=Math.pow(2,y),z=[R*k.x,R*k.y,0],q=[R*I.x,R*I.y,0],Y=au.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,y);let ee=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(ee=y);const fe=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,se=pe=>({aabb:new Jl([pe*R,0,0],[(pe+1)*R,R,0]),zoom:0,x:0,y:0,wrap:pe,fullyVisible:!1}),ce=[],Te=[],Re=y,Be=i.reparseOverscaled?b:y;if(this._renderWorldCopies)for(let pe=1;pe<=3;pe++)ce.push(se(-pe)),ce.push(se(pe));for(ce.push(se(0));ce.length>0;){const pe=ce.pop(),Ge=pe.x,Ue=pe.y;let et=pe.fullyVisible;if(!et){const Lt=pe.aabb.intersects(Y);if(Lt===0)continue;et=Lt===2}const nt=i.terrain?z:q,gt=pe.aabb.distanceX(nt),Je=pe.aabb.distanceY(nt),Dt=Math.max(Math.abs(gt),Math.abs(Je)),Tt=fe+(1<<Re-pe.zoom)-2;if(pe.zoom===Re||Dt>Tt&&pe.zoom>=ee){const Lt=Re-pe.zoom,rn=z[0]-.5-(Ge<<Lt),un=z[1]-.5-(Ue<<Lt);Te.push({tileID:new s.OverscaledTileID(pe.zoom===Re?Be:pe.zoom,pe.wrap,pe.zoom,Ge,Ue),distanceSq:s.sqrLen([q[0]-.5-Ge,q[1]-.5-Ue]),tileDistanceToCamera:Math.sqrt(rn*rn+un*un)})}else for(let Lt=0;Lt<4;Lt++){const rn=(Ge<<1)+Lt%2,un=(Ue<<1)+(Lt>>1),Ht=pe.zoom+1;let Dn=pe.aabb.quadrant(Lt);if(i.terrain){const Rn=new s.OverscaledTileID(Ht,pe.wrap,Ht,rn,un),wn=i.terrain.getMinMaxElevation(Rn),Sn=(u=wn.minElevation)!==null&&u!==void 0?u:this.elevation,On=(f=wn.maxElevation)!==null&&f!==void 0?f:this.elevation;Dn=new Jl([Dn.min[0],Dn.min[1],Sn],[Dn.max[0],Dn.max[1],On])}ce.push({aabb:Dn,zoom:Ht,x:rn,y:un,wrap:pe.wrap,fullyVisible:et})}}return Te.sort((pe,Ge)=>pe.distanceSq-Ge.distanceSq).map(pe=>pe.tileID)}resize(i,u){this.width=i,this.height=u,this.pixelsToGLUnits=[2/i,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const u=s.clamp(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new s.pointGeometry(s.mercatorXfromLng(i.lng)*this.worldSize,s.mercatorYfromLat(u)*this.worldSize)}unproject(i){return new s.MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(i){this.freezeElevation||(this.elevation=i?this.getElevation(this._center,i):0)}getElevation(i,u){const f=s.MercatorCoordinate.fromLngLat(i),y=(1<<this.tileZoom)*s.EXTENT,b=f.x*y,k=f.y*y,I=Math.floor(b/s.EXTENT),R=Math.floor(k/s.EXTENT),z=new s.OverscaledTileID(this.tileZoom,0,this.tileZoom,I,R);return u.getElevation(z,b%s.EXTENT,k%s.EXTENT,s.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const u=this.pointLocation(this.centerPoint,i),f=this.getElevation(u,i);if(!(this.elevation-f))return;const y=this.getCameraPosition(),b=s.MercatorCoordinate.fromLngLat(y.lngLat,y.altitude),k=s.MercatorCoordinate.fromLngLat(u,f),I=b.x-k.x,R=b.y-k.y,z=b.z-k.z,q=Math.sqrt(I*I+R*R+z*z),Y=this.scaleZoom(this.cameraToCenterDistance/q/this.tileSize);this._elevation=f,this._center=u,this.zoom=Y}setLocationAtPoint(i,u){const f=this.pointCoordinate(u),y=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(i),k=new s.MercatorCoordinate(b.x-(f.x-y.x),b.y-(f.y-y.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,u){return u?this.coordinatePoint(this.locationCoordinate(i),this.getElevation(i,u),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,u){return this.coordinateLocation(this.pointCoordinate(i,u))}locationCoordinate(i){return s.MercatorCoordinate.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,u){if(u){const ee=u.pointCoordinate(i);if(ee!=null)return ee}const f=[i.x,i.y,0,1],y=[i.x,i.y,1,1];s.transformMat4(f,f,this.pixelMatrixInverse),s.transformMat4(y,y,this.pixelMatrixInverse);const b=f[3],k=y[3],I=f[1]/b,R=y[1]/k,z=f[2]/b,q=y[2]/k,Y=z===q?0:(0-z)/(q-z);return new s.MercatorCoordinate(s.number(f[0]/b,y[0]/k,Y)/this.worldSize,s.number(I,R,Y)/this.worldSize)}coordinatePoint(i,u=0,f=this.pixelMatrix){const y=[i.x*this.worldSize,i.y*this.worldSize,u,1];return s.transformMat4(y,y,f),new s.pointGeometry(y[0]/y[3],y[1]/y[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new s.LngLatBounds().extend(this.pointLocation(new s.pointGeometry(0,i))).extend(this.pointLocation(new s.pointGeometry(this.width,i))).extend(this.pointLocation(new s.pointGeometry(this.width,this.height))).extend(this.pointLocation(new s.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new s.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(i,u=!1){const f=i.key,y=u?this._alignedPosMatrixCache:this._posMatrixCache;if(y[f])return y[f];const b=i.canonical,k=this.worldSize/this.zoomScale(b.z),I=b.x+Math.pow(2,b.z)*i.wrap,R=s.identity(new Float64Array(16));return s.translate(R,R,[I*k,b.y*k,0]),s.scale(R,R,[k/s.EXTENT,k/s.EXTENT,1]),s.multiply(R,u?this.alignedProjMatrix:this.projMatrix,R),y[f]=new Float32Array(R),y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i,u,f,y,b=-90,k=90,I=-180,R=180;const z=this.size,q=this._unmodified;if(this.latRange){const fe=this.latRange;b=s.mercatorYfromLat(fe[1])*this.worldSize,k=s.mercatorYfromLat(fe[0])*this.worldSize,i=k-b<z.y?z.y/(k-b):0}if(this.lngRange){const fe=this.lngRange;I=s.wrap(s.mercatorXfromLng(fe[0])*this.worldSize,0,this.worldSize),R=s.wrap(s.mercatorXfromLng(fe[1])*this.worldSize,0,this.worldSize),R<I&&(R+=this.worldSize),u=R-I<z.x?z.x/(R-I):0}const Y=this.point,ee=Math.max(u||0,i||0);if(ee)return this.center=this.unproject(new s.pointGeometry(u?(R+I)/2:Y.x,i?(k+b)/2:Y.y)),this.zoom+=this.scaleZoom(ee),this._unmodified=q,void(this._constraining=!1);if(this.latRange){const fe=Y.y,se=z.y/2;fe-se<b&&(y=b+se),fe+se>k&&(y=k-se)}if(this.lngRange){const fe=(I+R)/2,se=s.wrap(Y.x,fe-this.worldSize/2,fe+this.worldSize/2),ce=z.x/2;se-ce<I&&(f=I+ce),se+ce>R&&(f=R-ce)}f===void 0&&y===void 0||(this.center=this.unproject(new s.pointGeometry(f!==void 0?f:Y.x,y!==void 0?y:Y.y)).wrap()),this._unmodified=q,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,u=this.point.x,f=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=s.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let y=s.identity(new Float64Array(16));s.scale(y,y,[this.width/2,-this.height/2,1]),s.translate(y,y,[1,-1,0]),this.labelPlaneMatrix=y,y=s.identity(new Float64Array(16)),s.scale(y,y,[1,-1,1]),s.translate(y,y,[-1,-1,0]),s.scale(y,y,[2/this.width,2/this.height,1]),this.glCoordMatrix=y,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const b=Math.PI/2+this._pitch,k=this._fov*(.5+i.y/this.height),I=Math.sin(k)*this.cameraToSeaLevelDistance/Math.sin(s.clamp(Math.PI-b-k,.01,Math.PI-.01)),R=this.getHorizon(),z=2*Math.atan(R/this.cameraToCenterDistance)*(.5+i.y/(2*R)),q=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(s.clamp(Math.PI-b-z,.01,Math.PI-.01)),Y=Math.cos(Math.PI/2-this._pitch)*I+this.cameraToSeaLevelDistance,ee=Math.cos(Math.PI/2-this._pitch)*q+this.cameraToSeaLevelDistance,fe=1.01*Math.min(Y,ee),se=this.height/50;y=new Float64Array(16),s.perspective(y,this._fov,this.width/this.height,se,fe),y[8]=2*-i.x/this.width,y[9]=2*i.y/this.height,s.scale(y,y,[1,-1,1]),s.translate(y,y,[0,0,-this.cameraToCenterDistance]),s.rotateX(y,y,this._pitch),s.rotateZ(y,y,this.angle),s.translate(y,y,[-u,-f,0]),this.mercatorMatrix=s.scale([],y,[this.worldSize,this.worldSize,this.worldSize]),s.scale(y,y,[1,1,this._pixelPerMeter]),this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,y),s.translate(y,y,[0,0,-this.elevation]),this.projMatrix=y,this.invProjMatrix=s.invert([],y),this.pixelMatrix3D=s.multiply(new Float64Array(16),this.labelPlaneMatrix,y);const ce=this.width%2/2,Te=this.height%2/2,Re=Math.cos(this.angle),Be=Math.sin(this.angle),pe=u-Math.round(u)+Re*ce+Be*Te,Ge=f-Math.round(f)+Re*Te+Be*ce,Ue=new Float64Array(y);if(s.translate(Ue,Ue,[pe>.5?pe-1:pe,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=Ue,y=s.invert(new Float64Array(16),this.pixelMatrix),!y)throw new Error("failed to invert matrix");this.pixelMatrixInverse=y,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new s.pointGeometry(0,0)),u=[i.x*this.worldSize,i.y*this.worldSize,0,1];return s.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,i))}getCameraQueryGeometry(i){const u=this.getCameraPoint();if(i.length===1)return[i[0],u];{let f=u.x,y=u.y,b=u.x,k=u.y;for(const I of i)f=Math.min(f,I.x),y=Math.min(y,I.y),b=Math.max(b,I.x),k=Math.max(k,I.y);return[new s.pointGeometry(f,y),new s.pointGeometry(b,y),new s.pointGeometry(b,k),new s.pointGeometry(f,k),new s.pointGeometry(f,y)]}}}class Kf{constructor(i){this._hashName=i&&encodeURIComponent(i),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(u,f){let y=!1,b=null;const k=()=>{b=null,y&&(u(),b=setTimeout(k,300),y=!1)};return()=>(y=!0,b||k(),b)}(this._updateHashUnthrottled.bind(this))}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,y),k=Math.round(u.lng*b)/b,I=Math.round(u.lat*b)/b,R=this._map.getBearing(),z=this._map.getPitch();let q="";if(q+=i?`/${k}/${I}/${f}`:`${f}/${I}/${k}`,(R||z)&&(q+="/"+Math.round(10*R)/10),z&&(q+=`/${Math.round(z)}`),this._hashName){const Y=this._hashName;let ee=!1;const fe=window.location.hash.slice(1).split("&").map(se=>{const ce=se.split("=")[0];return ce===Y?(ee=!0,`${ce}=${q}`):se}).filter(se=>se);return ee||fe.push(`${Y}=${q}`),`#${fe.join("&")}`}return`#${q}`}_getCurrentHash(){const i=window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(u=f)}),(u&&u[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._getCurrentHash();if(i.length>=3&&!i.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:u,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}}}const ec={linearity:.3,easing:s.bezier(0,0,.3,1)},Xf=s.extend({deceleration:2500,maxSpeed:1400},ec),Yf=s.extend({deceleration:20,maxSpeed:1400},ec),Jf=s.extend({deceleration:1e3,maxSpeed:360},ec),el=s.extend({deceleration:1e3,maxSpeed:90},ec);class Qf{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=s.exported.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(u.pan.mag()){const b=nc(u.pan.mag(),f,s.extend({},Xf,i||{}));y.offset=u.pan.mult(b.amount/u.pan.mag()),y.center=this._map.transform.center,tc(y,b)}if(u.zoom){const b=nc(u.zoom,f,Yf);y.zoom=this._map.transform.zoom+b.amount,tc(y,b)}if(u.bearing){const b=nc(u.bearing,f,Jf);y.bearing=this._map.transform.bearing+s.clamp(b.amount,-179,179),tc(y,b)}if(u.pitch){const b=nc(u.pitch,f,el);y.pitch=this._map.transform.pitch+b.amount,tc(y,b)}if(y.zoom||y.bearing){const b=u.pinchAround===void 0?u.around:u.pinchAround;y.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),s.extend(y,{noMoveStart:!0})}}function tc(m,i){(!m.duration||m.duration<i.duration)&&(m.duration=i.duration,m.easing=i.easing)}function nc(m,i,u){const{maxSpeed:f,linearity:y,deceleration:b}=u,k=s.clamp(m*y/(i/1e3),-f,f),I=Math.abs(k)/(b*y);return{easing:u.easing,duration:1e3*I,amount:k*(I/2)}}class Gi extends s.Event{constructor(i,u,f,y={}){const b=S.mousePos(u.getCanvasContainer(),f),k=u.unproject(b);super(i,s.extend({point:b,lngLat:k,originalEvent:f},y)),this._defaultPrevented=!1,this.target=u}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class rc extends s.Event{constructor(i,u,f){const y=i==="touchend"?f.changedTouches:f.touches,b=S.touchPos(u.getCanvasContainer(),y),k=b.map(R=>u.unproject(R)),I=b.reduce((R,z,q,Y)=>R.add(z.div(Y.length)),new s.pointGeometry(0,0));super(i,{points:b,point:I,lngLats:k,lngLat:u.unproject(I),originalEvent:f}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class qi extends s.Event{constructor(i,u,f){super(i,{originalEvent:f}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class fg{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new qi(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new Gi(i.type,this._map,i))}mouseup(i){this._map.fire(new Gi(i.type,this._map,i))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Gi(i.type,this._map,i))}dblclick(i){return this._firePreventable(new Gi(i.type,this._map,i))}mouseover(i){this._map.fire(new Gi(i.type,this._map,i))}mouseout(i){this._map.fire(new Gi(i.type,this._map,i))}touchstart(i){return this._firePreventable(new rc(i.type,this._map,i))}touchmove(i){this._map.fire(new rc(i.type,this._map,i))}touchend(i){this._map.fire(new rc(i.type,this._map,i))}touchcancel(i){this._map.fire(new rc(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Aa{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new Gi(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new Gi(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ep{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&i.button===0&&(S.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=S.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const b=Math.min(y.x,f.x),k=Math.max(y.x,f.x),I=Math.min(y.y,f.y),R=Math.max(y.y,f.y);S.setTransform(this._box,`translate(${b}px,${I}px)`),this._box.style.width=k-b+"px",this._box.style.height=R-I+"px"}mouseupWindow(i,u){if(!this._active||i.button!==0)return;const f=this._startPos,y=u;if(this.reset(),S.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:b=>b.fitScreenCoordinates(f,y,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(S.remove(this._box),this._box=null),S.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new s.Event(i,{originalEvent:u}))}}function ia(m,i){if(m.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${i.length}`);const u={};for(let f=0;f<m.length;f++)u[m[f].identifier]=i[f];return u}class ic{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){const b=new s.pointGeometry(0,0);for(const k of y)b._add(k);return b.div(y.length)}(u),this.touches=ia(f,u)))}touchmove(i,u,f){if(this.aborted||!this.centroid)return;const y=ia(f,u);for(const b in this.touches){const k=this.touches[b],I=y[b];(!I||I.dist(k)>30)&&(this.aborted=!0)}}touchend(i,u,f){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Nd{constructor(i){this.singleTap=new ic(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,u,f){this.singleTap.touchstart(i,u,f)}touchmove(i,u,f){this.singleTap.touchmove(i,u,f)}touchend(i,u,f){const y=this.singleTap.touchend(i,u,f);if(y){const b=i.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(y)<30;if(b&&k||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class pg{constructor(){this._zoomIn=new Nd({numTouches:1,numTaps:2}),this._zoomOut=new Nd({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,f){this._zoomIn.touchstart(i,u,f),this._zoomOut.touchstart(i,u,f)}touchmove(i,u,f){this._zoomIn.touchmove(i,u,f),this._zoomOut.touchmove(i,u,f)}touchend(i,u,f){const y=this._zoomIn.touchend(i,u,f),b=this._zoomOut.touchend(i,u,f);return y?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(y)},{originalEvent:i})}):b?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(b)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const mg={0:1,2:2};class su{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(i,u){return!1}_move(i,u){return{}}mousedown(i,u){if(this._lastPoint)return;const f=S.mouseButton(i);this._correctButton(i,f)&&(this._lastPoint=u,this._eventButton=f)}mousemoveWindow(i,u){const f=this._lastPoint;if(f){if(i.preventDefault(),function(y,b){const k=mg[b];return y.buttons===void 0||(y.buttons&k)!==k}(i,this._eventButton))this.reset();else if(this._moved||!(u.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(f,u)}}mouseupWindow(i){this._lastPoint&&S.mouseButton(i)===this._eventButton&&(this._moved&&S.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oc extends su{mousedown(i,u){super.mousedown(i,u),this._lastPoint&&(this._active=!0)}_correctButton(i,u){return u===0&&!i.ctrlKey}_move(i,u){return{around:u,panDelta:u.sub(i)}}}class oa extends su{_correctButton(i,u){return u===0&&i.ctrlKey||u===2}_move(i,u){const f=.8*(u.x-i.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(i){i.preventDefault()}}class $t extends su{_correctButton(i,u){return u===0&&i.ctrlKey||u===2}_move(i,u){const f=-.5*(u.y-i.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(i){i.preventDefault()}}class tp{constructor(i,u){this._minTouches=i.cooperativeGestures?2:1,this._clickTolerance=i.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(i,u,f){return this._calculateTransform(i,u,f)}touchmove(i,u,f){if(this._map._cooperativeGestures&&(this._minTouches===2&&f.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(i,!1,f.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(f.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,u,f)}touchend(i,u,f){this._calculateTransform(i,u,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,f){f.length>0&&(this._active=!0);const y=ia(f,u),b=new s.pointGeometry(0,0),k=new s.pointGeometry(0,0);let I=0;for(const z in y){const q=y[z],Y=this._touches[z];Y&&(b._add(q),k._add(q.sub(Y)),I++,y[z]=q)}if(this._touches=y,I<this._minTouches||!k.mag())return;const R=k.div(I);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(I),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class as{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(i){}_move(i,u,f){return{}}touchstart(i,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,f){if(!this._firstTwoTouches)return;i.preventDefault();const[y,b]=this._firstTwoTouches,k=Ia(f,u,y),I=Ia(f,u,b);if(!k||!I)return;const R=this._aroundCenter?null:k.add(I).div(2);return this._move([k,I],R,i)}touchend(i,u,f){if(!this._firstTwoTouches)return;const[y,b]=this._firstTwoTouches,k=Ia(f,u,y),I=Ia(f,u,b);k&&I||(this._active&&S.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ia(m,i,u){for(let f=0;f<m.length;f++)if(m[f].identifier===u)return i[f]}function Od(m,i){return Math.log(m/i)/Math.LN2}class At extends as{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Od(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Od(this._distance,f),pinchAround:u}}}function lu(m,i){return 180*m.angleWith(i)/Math.PI}class gg extends as{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u){const f=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:lu(this._vector,f),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,f=lu(i,this._startVector);return Math.abs(f)<u}}function $d(m){return Math.abs(m.y)>Math.abs(m.x)}class zd extends as{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,u,f){super.touchstart(i,u,f),this._currentTouchCount=f.length}_start(i){this._lastPoints=i,$d(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,f){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const y=i[0].sub(this._lastPoints[0]),b=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,b,f.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(y.y+b.y)/2*-.5}):void 0}gestureBeginsVertically(i,u,f){if(this._valid!==void 0)return this._valid;const y=i.mag()>=2,b=u.mag()>=2;if(!y&&!b)return;if(!y||!b)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const k=i.y>0==u.y>0;return $d(i)&&$d(u)&&k}}const np={panStep:100,bearingStep:15,pitchStep:10};class rp{constructor(){const i=np;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,f=0,y=0,b=0,k=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?f=-1:(i.preventDefault(),b=-1);break;case 39:i.shiftKey?f=1:(i.preventDefault(),b=1);break;case 38:i.shiftKey?y=1:(i.preventDefault(),k=-1);break;case 40:i.shiftKey?y=-1:(i.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:I=>{const R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:yg,zoom:u?Math.round(R)+u*(i.shiftKey?2:1):R,bearing:I.getBearing()+f*this._bearingStep,pitch:I.getPitch()+y*this._pitchStep,offset:[-b*this._panStep,-k*this._panStep],center:I.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function yg(m){return m*(2-m)}const ip=4.000244140625;class Bd{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;i.preventDefault()}let u=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const f=s.exported.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,u!==0&&u%ip==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(y*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=S.mousePos(this._el,i);this._around=s.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(u)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>ip?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&R!==0&&(R=1/R);const z=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(z*R))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,f=this._startZoom,y=this._easing;let b,k=!1;if(this._type==="wheel"&&f&&y){const I=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),R=y(I);b=s.number(f,u,R),I<1?this._frameId||(this._frameId=!0):k=!0}else b=u,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:b-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=s.ease;if(this._prevEase){const f=this._prevEase,y=(s.exported.now()-f.start)/f.duration,b=f.easing(y+.01)-f.easing(y),k=.27/Math.sqrt(b*b+1e-4)*.01,I=Math.sqrt(.0729-k*k);u=s.bezier(k,I,.25,1)}return this._prevEase={start:s.exported.now(),duration:i,easing:u},u}reset(){this._active=!1}}class Fd{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ud{constructor(){this.reset()}reset(){this._active=!1}dblclick(i,u){return i.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(i.shiftKey?-1:1),around:f.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vd{constructor(){this._tap=new Nd({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(i,u,f){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=u[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(i,u,f))}touchmove(i,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=u[0],b=y.y-this._swipePoint.y;return this._swipePoint=y,i.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(i,u,f)}touchend(i,u,f){this._tapTime?this._swipePoint&&f.length===0&&this.reset():this._tap.touchend(i,u,f)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Di{constructor(i,u,f){this._el=i,this._mousePan=u,this._touchPan=f}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ma{constructor(i,u,f){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=u,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class op{constructor(i,u,f,y){this._el=i,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const tl=m=>m.zoom||m.drag||m.pitch||m.rotate;class jd extends s.Event{}function ac(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class ap{constructor(i,u){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qf(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u),s.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,b,k]of this._listeners)S.addEventListener(y,b,y===document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[i,u,f]of this._listeners)S.removeEventListener(i,u,i===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(i){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new fg(u,i));const y=u.boxZoom=new ep(u,i);this._add("boxZoom",y);const b=new pg,k=new Ud;u.doubleClickZoom=new Fd(k,b),this._add("tapZoom",b),this._add("clickZoom",k);const I=new Vd;this._add("tapDragZoom",I);const R=u.touchPitch=new zd(u);this._add("touchPitch",R);const z=new oa(i),q=new $t(i);u.dragRotate=new Ma(i,z,q),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",q,["mouseRotate"]);const Y=new oc(i),ee=new tp(i,u);u.dragPan=new Di(f,Y,ee),this._add("mousePan",Y),this._add("touchPan",ee,["touchZoom","touchRotate"]);const fe=new gg,se=new At;u.touchZoomRotate=new op(f,se,fe,I),this._add("touchRotate",fe,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]);const ce=u.scrollZoom=new Bd(u,this);this._add("scrollZoom",ce,["mousePan"]);const Te=u.keyboard=new rp;this._add("keyboard",Te),this._add("blockableMapEvent",new Aa(u));for(const Re of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[Re]&&u[Re].enable(i[Re])}_add(i,u,f){this._handlers.push({handlerName:i,handler:u,allowed:f}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(tl(this._eventsInProgress))||this.isZooming()}_blockedByActive(i,u,f){for(const y in i)if(y!==f&&(!u||u.indexOf(y)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const u=[];for(const f of i)this._el.contains(f.target)&&u.push(f);return u}handleEvent(i,u){if(i.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const f=i.type==="renderFrame"?void 0:i,y={needsRenderFrame:!1},b={},k={},I=i.touches,R=I?this._getMapTouches(I):void 0,z=R?S.touchPos(this._el,R):S.mousePos(this._el,i);for(const{handlerName:ee,handler:fe,allowed:se}of this._handlers){if(!fe.isEnabled())continue;let ce;this._blockedByActive(k,se,ee)?fe.reset():fe[u||i.type]&&(ce=fe[u||i.type](i,z,R),this.mergeHandlerResult(y,b,ce,ee,f),ce&&ce.needsRenderFrame&&this._triggerRenderFrame()),(ce||fe.isActive())&&(k[ee]=fe)}const q={};for(const ee in this._previousActiveHandlers)k[ee]||(q[ee]=f);this._previousActiveHandlers=k,(Object.keys(q).length||ac(y))&&(this._changes.push([y,b,q]),this._triggerRenderFrame()),(Object.keys(k).length||ac(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Y}=y;Y&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Y(this._map))}mergeHandlerResult(i,u,f,y,b){if(!f)return;s.extend(i,f);const k={handlerName:y,originalEvent:f.originalEvent||b};f.zoomDelta!==void 0&&(u.zoom=k),f.panDelta!==void 0&&(u.drag=k),f.pitchDelta!==void 0&&(u.pitch=k),f.bearingDelta!==void 0&&(u.rotate=k)}_applyChanges(){const i={},u={},f={};for(const[y,b,k]of this._changes)y.panDelta&&(i.panDelta=(i.panDelta||new s.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(i.around=y.around),y.pinchAround!==void 0&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),s.extend(u,b),s.extend(f,k);this._updateMapTransform(i,u,f),this._changes=[]}_updateMapTransform(i,u,f){const y=this._map,b=y.transform,k=y.style&&y.style.terrain;if(!(ac(i)||k&&this._drag))return this._fireEvents(u,f,!0);let{panDelta:I,zoomDelta:R,bearingDelta:z,pitchDelta:q,around:Y,pinchAround:ee}=i;ee!==void 0&&(Y=ee),y._stop(!0),Y=Y||y.transform.centerPoint;const fe=b.pointLocation(I?Y.sub(I):Y);z&&(b.bearing+=z),q&&(b.pitch+=q),R&&(b.zoom+=R),k?u.drag&&!this._drag?(this._drag={center:b.centerPoint,lngLat:b.pointLocation(Y),point:Y,handlerName:u.drag.handlerName},y.fire(new s.Event("freezeElevation",{freeze:!0}))):this._drag&&f[this._drag.handlerName]?(y.fire(new s.Event("freezeElevation",{freeze:!1})),this._drag=null):u.drag&&this._drag&&(b.center=b.pointLocation(b.centerPoint.sub(I))):b.setLocationAtPoint(fe,Y),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,f,!0)}_fireEvents(i,u,f){const y=tl(this._eventsInProgress),b=tl(i),k={};for(const q in i){const{originalEvent:Y}=i[q];this._eventsInProgress[q]||(k[`${q}start`]=Y),this._eventsInProgress[q]=i[q]}!y&&b&&this._fireEvent("movestart",b.originalEvent);for(const q in k)this._fireEvent(q,k[q]);b&&this._fireEvent("move",b.originalEvent);for(const q in i){const{originalEvent:Y}=i[q];this._fireEvent(q,Y)}const I={};let R;for(const q in this._eventsInProgress){const{handlerName:Y,originalEvent:ee}=this._eventsInProgress[q];this._handlersById[Y].isActive()||(delete this._eventsInProgress[q],R=u[Y]||ee,I[`${q}end`]=R)}for(const q in I)this._fireEvent(q,I[q]);const z=tl(this._eventsInProgress);if(f&&(y||b)&&!z){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Y=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;q?(Y(q.bearing||this._map.getBearing())&&(q.bearing=0),this._map.easeTo(q,{originalEvent:R})):(this._map.fire(new s.Event("moveend",{originalEvent:R})),Y(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new s.Event(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new jd("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const oo={extend:(m,...i)=>s.extend(m,...i),run(m){m()},logToElement(m,i=!1,u="log"){const f=window.document.getElementById(u);f&&(i&&(f.innerHTML=""),f.innerHTML+=`<br>${m}`)}};class nr extends s.Evented{constructor(i,u){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=u.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}panBy(i,u,f){return i=s.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,s.extend({offset:i},u),f)}panTo(i,u,f){return this.easeTo(s.extend({center:i},u),f)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,f){return this.easeTo(s.extend({zoom:i},u),f)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,f){return this.easeTo(s.extend({bearing:i},u),f)}resetNorth(i,u){return this.rotateTo(0,s.extend({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}cameraForBounds(i,u){i=s.LngLatBounds.convert(i);const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),f,u)}_cameraForBoxAndBearing(i,u,f,y){const b={top:0,bottom:0,right:0,left:0};if(typeof(y=s.extend({padding:b,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const Ue=y.padding;y.padding={top:Ue,bottom:Ue,right:Ue,left:Ue}}y.padding=s.extend(b,y.padding);const k=this.transform,I=k.padding,R=k.project(s.LngLat.convert(i)),z=k.project(s.LngLat.convert(u)),q=R.rotate(-f*Math.PI/180),Y=z.rotate(-f*Math.PI/180),ee=new s.pointGeometry(Math.max(q.x,Y.x),Math.max(q.y,Y.y)),fe=new s.pointGeometry(Math.min(q.x,Y.x),Math.min(q.y,Y.y)),se=ee.sub(fe),ce=(k.width-(I.left+I.right+y.padding.left+y.padding.right))/se.x,Te=(k.height-(I.top+I.bottom+y.padding.top+y.padding.bottom))/se.y;if(Te<0||ce<0)return void s.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Re=Math.min(k.scaleZoom(k.scale*Math.min(ce,Te)),y.maxZoom),Be=s.pointGeometry.convert(y.offset),pe=new s.pointGeometry((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(f*Math.PI/180),Ge=Be.add(pe).mult(k.scale/k.zoomScale(Re));return{center:k.unproject(R.add(z).div(2).sub(Ge)),zoom:Re,bearing:f}}fitBounds(i,u,f){return this._fitInternal(this.cameraForBounds(i,u),u,f)}fitScreenCoordinates(i,u,f,y,b){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.pointGeometry.convert(i)),this.transform.pointLocation(s.pointGeometry.convert(u)),f,y),y,b)}_fitInternal(i,u,f){return i?(delete(u=s.extend(i,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(i,u){this.stop();const f=this.transform;let y=!1,b=!1,k=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(y=!0,f.zoom=+i.zoom),i.center!==void 0&&(f.center=s.LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(b=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(k=!0,f.pitch=+i.pitch),i.padding==null||f.isPaddingEqual(i.padding)||(f.padding=i.padding),this.fire(new s.Event("movestart",u)).fire(new s.Event("move",u)),y&&this.fire(new s.Event("zoomstart",u)).fire(new s.Event("zoom",u)).fire(new s.Event("zoomend",u)),b&&this.fire(new s.Event("rotatestart",u)).fire(new s.Event("rotate",u)).fire(new s.Event("rotateend",u)),k&&this.fire(new s.Event("pitchstart",u)).fire(new s.Event("pitch",u)).fire(new s.Event("pitchend",u)),this.fire(new s.Event("moveend",u))}calculateCameraOptionsFromTo(i,u,f,y=0){const b=s.MercatorCoordinate.fromLngLat(i,u),k=s.MercatorCoordinate.fromLngLat(f,y),I=k.x-b.x,R=k.y-b.y,z=k.z-b.z,q=Math.hypot(I,R,z);if(q===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(I,R),ee=this.transform.scaleZoom(this.transform.cameraToCenterDistance/q/this.transform.tileSize),fe=180*Math.atan2(I,-R)/Math.PI;let se=180*Math.acos(Y/q)/Math.PI;return se=z<0?90-se:90+se,{center:k.toLngLat(),zoom:ee,pitch:se,bearing:fe}}easeTo(i,u){this._stop(!1,i.easeId),((i=s.extend({offset:[0,0],duration:500,easing:s.ease},i)).animate===!1||!i.essential&&s.exported.prefersReducedMotion)&&(i.duration=0);const f=this.transform,y=this.getZoom(),b=this.getBearing(),k=this.getPitch(),I=this.getPadding(),R="zoom"in i?+i.zoom:y,z="bearing"in i?this._normalizeBearing(i.bearing,b):b,q="pitch"in i?+i.pitch:k,Y="padding"in i?i.padding:f.padding,ee=s.pointGeometry.convert(i.offset);let fe=f.centerPoint.add(ee);const se=f.pointLocation(fe),ce=s.LngLat.convert(i.center||se);this._normalizeCenter(ce);const Te=f.project(se),Re=f.project(ce).sub(Te),Be=f.zoomScale(R-y);let pe,Ge;i.around&&(pe=s.LngLat.convert(i.around),Ge=f.locationPoint(pe));const Ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||R!==y,this._rotating=this._rotating||b!==z,this._pitching=this._pitching||q!==k,this._padding=!f.isPaddingEqual(Y),this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,Ue),this._ease(et=>{if(this._zooming&&(f.zoom=s.number(y,R,et)),this._rotating&&(f.bearing=s.number(b,z,et)),this._pitching&&(f.pitch=s.number(k,q,et)),this._padding&&(f.interpolatePadding(I,Y,et),fe=f.centerPoint.add(ee)),pe)f.setLocationAtPoint(pe,Ge);else{const nt=f.zoomScale(f.zoom-y),gt=R>y?Math.min(2,Be):Math.max(.5,Be),Je=Math.pow(gt,1-et),Dt=f.unproject(Te.add(Re.mult(et*Je)).mult(nt));f.setLocationAtPoint(f.renderWorldCopies?Dt.wrap():Dt,fe)}this._fireMoveEvents(u)},et=>{this._afterEase(u,et)},i),this}_prepareEase(i,u,f={}){this._moving=!0,this.fire(new s.Event("freezeElevation",{freeze:!0})),u||f.moving||this.fire(new s.Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new s.Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new s.Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new s.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new s.Event("move",i)),this._zooming&&this.fire(new s.Event("zoom",i)),this._rotating&&this.fire(new s.Event("rotate",i)),this._pitching&&this.fire(new s.Event("pitch",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId,this.fire(new s.Event("freezeElevation",{freeze:!1}));const f=this._zooming,y=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new s.Event("zoomend",i)),y&&this.fire(new s.Event("rotateend",i)),b&&this.fire(new s.Event("pitchend",i)),this.fire(new s.Event("moveend",i))}flyTo(i,u){if(!i.essential&&s.exported.prefersReducedMotion){const Ht=s.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ht,u)}this.stop(),i=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},i);const f=this.transform,y=this.getZoom(),b=this.getBearing(),k=this.getPitch(),I=this.getPadding(),R="zoom"in i?s.clamp(+i.zoom,f.minZoom,f.maxZoom):y,z="bearing"in i?this._normalizeBearing(i.bearing,b):b,q="pitch"in i?+i.pitch:k,Y="padding"in i?i.padding:f.padding,ee=f.zoomScale(R-y),fe=s.pointGeometry.convert(i.offset);let se=f.centerPoint.add(fe);const ce=f.pointLocation(se),Te=s.LngLat.convert(i.center||ce);this._normalizeCenter(Te);const Re=f.project(ce),Be=f.project(Te).sub(Re);let pe=i.curve;const Ge=Math.max(f.width,f.height),Ue=Ge/ee,et=Be.mag();if("minZoom"in i){const Ht=s.clamp(Math.min(i.minZoom,y,R),f.minZoom,f.maxZoom),Dn=Ge/f.zoomScale(Ht-y);pe=Math.sqrt(Dn/et*2)}const nt=pe*pe;function gt(Ht){const Dn=(Ue*Ue-Ge*Ge+(Ht?-1:1)*nt*nt*et*et)/(2*(Ht?Ue:Ge)*nt*et);return Math.log(Math.sqrt(Dn*Dn+1)-Dn)}function Je(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function Dt(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}const Tt=gt(0);let Lt=function(Ht){return Dt(Tt)/Dt(Tt+pe*Ht)},rn=function(Ht){return Ge*((Dt(Tt)*(Je(Dn=Tt+pe*Ht)/Dt(Dn))-Je(Tt))/nt)/et;var Dn},un=(gt(1)-Tt)/pe;if(Math.abs(et)<1e-6||!isFinite(un)){if(Math.abs(Ge-Ue)<1e-6)return this.easeTo(i,u);const Ht=Ue<Ge?-1:1;un=Math.abs(Math.log(Ue/Ge))/pe,rn=function(){return 0},Lt=function(Dn){return Math.exp(Ht*pe*Dn)}}return i.duration="duration"in i?+i.duration:1e3*un/("screenSpeed"in i?+i.screenSpeed/pe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=b!==z,this._pitching=q!==k,this._padding=!f.isPaddingEqual(Y),this._prepareEase(u,!1),this._ease(Ht=>{const Dn=Ht*un,Rn=1/Lt(Dn);f.zoom=Ht===1?R:y+f.scaleZoom(Rn),this._rotating&&(f.bearing=s.number(b,z,Ht)),this._pitching&&(f.pitch=s.number(k,q,Ht)),this._padding&&(f.interpolatePadding(I,Y,Ht),se=f.centerPoint.add(fe));const wn=Ht===1?Te:f.unproject(Re.add(Be.mult(rn(Dn))).mult(Rn));f.setLocationAtPoint(f.renderWorldCopies?wn.wrap():wn,se),this._fireMoveEvents(u)},()=>this._afterEase(u),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,u)}if(!i){const f=this.handlers;f&&f.stop(!1)}return this}_ease(i,u,f){f.animate===!1||f.duration===0?(i(1),u()):(this._easeStart=s.exported.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,u){i=s.wrap(i,-180,180);const f=Math.abs(i-u);return Math.abs(i-360-u)<f&&(i-=360),Math.abs(i+360-u)<f&&(i+=360),i}_normalizeCenter(i){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const f=i.lng-u.center.lng;i.lng+=f>180?-360:f<-180?360:0}}class sc{constructor(i={}){this.options=i,s.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options&&this.options.compact,this._container=S.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=S.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=S.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){S.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const f=this._map._getUIString(`AttributionControl.${u}`);i.title=f,i.setAttribute("aria-label",f)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const u=this._map.style.sourceCaches;for(const y in u){const b=u[y];if(b.used||b.usedForTerrain){const k=b.getSource();k.attribution&&i.indexOf(k.attribution)<0&&i.push(k.attribution)}}i=i.filter(y=>String(y).trim()),i.sort((y,b)=>y.length-b.length),i=i.filter((y,b)=>{for(let k=b+1;k<i.length;k++)if(i[k].indexOf(y)>=0)return!1;return!0});const f=i.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,i.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class cu{constructor(i={}){this.options=i,s.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=S.create("div","maplibregl-ctrl mapboxgl-ctrl");const u=S.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){S.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact","mapboxgl-compact"):u.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class sp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const y of f)if(y.id===i)return void(y.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const lp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},cp={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},vg={showCompass:!0,showZoom:!0,visualizePitch:!1};class zo{constructor(i,u,f=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new oa({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,f&&(this.mousePitch=new $t({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),S.addEventListener(u,"mousedown",this.mousedown),S.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),S.addEventListener(u,"touchmove",this.touchmove),S.addEventListener(u,"touchend",this.touchend),S.addEventListener(u,"touchcancel",this.reset)}down(i,u){this.mouseRotate.mousedown(i,u),this.mousePitch&&this.mousePitch.mousedown(i,u),S.disableDrag()}move(i,u){const f=this.map,y=this.mouseRotate.mousemoveWindow(i,u);if(y&&y.bearingDelta&&f.setBearing(f.getBearing()+y.bearingDelta),this.mousePitch){const b=this.mousePitch.mousemoveWindow(i,u);b&&b.pitchDelta&&f.setPitch(f.getPitch()+b.pitchDelta)}}off(){const i=this.element;S.removeEventListener(i,"mousedown",this.mousedown),S.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),S.removeEventListener(i,"touchmove",this.touchmove),S.removeEventListener(i,"touchend",this.touchend),S.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){S.enableDrag(),S.removeEventListener(window,"mousemove",this.mousemove),S.removeEventListener(window,"mouseup",this.mouseup)}mousedown(i){this.down(s.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),S.mousePos(this.element,i)),S.addEventListener(window,"mousemove",this.mousemove),S.addEventListener(window,"mouseup",this.mouseup)}mousemove(i){this.move(i,S.mousePos(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=S.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=S.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function lc(m,i,u){if(m=new s.LngLat(m.lng,m.lat),i){const f=new s.LngLat(m.lng-360,m.lat),y=new s.LngLat(m.lng+360,m.lat),b=u.locationPoint(m).distSqr(i);u.locationPoint(f).distSqr(i)<b?m=f:u.locationPoint(y).distSqr(i)<b&&(m=y)}for(;Math.abs(m.lng-u.center.lng)>180;){const f=u.locationPoint(m);if(f.x>=0&&f.y>=0&&f.x<=u.width&&f.y<=u.height)break;m.lng>u.center.lng?m.lng-=360:m.lng+=360}return m}const jt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Yt(m,i,u){const f=m.classList;for(const y in jt)f.remove(`maplibregl-${u}-anchor-${y}`,`mapboxgl-${u}-anchor-${y}`);f.add(`maplibregl-${u}-anchor-${i}`,`mapboxgl-${u}-anchor-${i}`)}class nl extends s.Evented{constructor(i,u){if(super(),(i instanceof HTMLElement||u)&&(i=s.extend({element:i},u)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=s.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=S.create("div"),this._element.setAttribute("aria-label","Map marker");const f=S.createNS("http://www.w3.org/2000/svg","svg"),y=41,b=27;f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height",`${y}px`),f.setAttributeNS(null,"width",`${b}px`),f.setAttributeNS(null,"viewBox",`0 0 ${b} ${y}`);const k=S.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"stroke","none"),k.setAttributeNS(null,"stroke-width","1"),k.setAttributeNS(null,"fill","none"),k.setAttributeNS(null,"fill-rule","evenodd");const I=S.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill-rule","nonzero");const R=S.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Be of z){const pe=S.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",Be.rx),pe.setAttributeNS(null,"ry",Be.ry),R.appendChild(pe)}const q=S.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);const Y=S.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(Y);const ee=S.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"fill","#000000");const fe=S.createNS("http://www.w3.org/2000/svg","path");fe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ee.appendChild(fe);const se=S.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),se.setAttributeNS(null,"fill","#FFFFFF");const ce=S.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Te=S.createNS("http://www.w3.org/2000/svg","circle");Te.setAttributeNS(null,"fill","#000000"),Te.setAttributeNS(null,"opacity","0.25"),Te.setAttributeNS(null,"cx","5.5"),Te.setAttributeNS(null,"cy","5.5"),Te.setAttributeNS(null,"r","5.4999962");const Re=S.createNS("http://www.w3.org/2000/svg","circle");Re.setAttributeNS(null,"fill","#FFFFFF"),Re.setAttributeNS(null,"cx","5.5"),Re.setAttributeNS(null,"cy","5.5"),Re.setAttributeNS(null,"r","5.4999962"),ce.appendChild(Te),ce.appendChild(Re),I.appendChild(R),I.appendChild(q),I.appendChild(ee),I.appendChild(se),I.appendChild(ce),f.appendChild(I),f.setAttributeNS(null,"height",y*this._scale+"px"),f.setAttributeNS(null,"width",b*this._scale+"px"),this._element.appendChild(f),this._offset=s.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",f=>{f.preventDefault()}),this._element.addEventListener("mousedown",f=>{f.preventDefault()}),Yt(this._element,this._anchor,"marker"),this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),S.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(i){const u=i.code,f=i.charCode||i.keyCode;u!=="Space"&&u!=="Enter"&&f!==32&&f!==13||this.togglePopup()}_onMapClick(i){const u=i.originalEvent.target,f=this._element;this._popup&&(u===f||f.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this}_update(i){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=lc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let u="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?u=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),S.setTransform(this._element,`${jt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${f} ${u}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const y=this._map.unproject(this._pos),b=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=y.distanceTo(this._lngLat)>20*b?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(i){return this._offset=s.pointGeometry.convert(i),this._update(),this}_onMove(i){if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Gd={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Da,ei=0,Ra=!1;const Bo={maxWidth:100,unit:"metric"};function up(m,i,u){const f=u&&u.maxWidth||100,y=m._container.clientHeight/2,b=m.unproject([0,y]),k=m.unproject([f,y]),I=b.distanceTo(k);if(u&&u.unit==="imperial"){const R=3.2808*I;R>5280?La(i,f,R/5280,m._getUIString("ScaleControl.Miles")):La(i,f,R,m._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?La(i,f,I/1852,m._getUIString("ScaleControl.NauticalMiles")):I>=1e3?La(i,f,I/1e3,m._getUIString("ScaleControl.Kilometers")):La(i,f,I,m._getUIString("ScaleControl.Meters"))}function La(m,i,u,f){const y=function(b){const k=Math.pow(10,`${Math.floor(b)}`.length-1);let I=b/k;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(R){const z=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*z)/z}(I),k*I}(u);m.style.width=i*(y/u)+"px",m.innerHTML=`${y}&nbsp;${f}`}const mr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Pr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function qd(m){if(m){if(typeof m=="number"){const i=Math.round(Math.sqrt(.5*Math.pow(m,2)));return{center:new s.pointGeometry(0,0),top:new s.pointGeometry(0,m),"top-left":new s.pointGeometry(i,i),"top-right":new s.pointGeometry(-i,i),bottom:new s.pointGeometry(0,-m),"bottom-left":new s.pointGeometry(i,-i),"bottom-right":new s.pointGeometry(-i,-i),left:new s.pointGeometry(m,0),right:new s.pointGeometry(-m,0)}}if(m instanceof s.pointGeometry||Array.isArray(m)){const i=s.pointGeometry.convert(m);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:s.pointGeometry.convert(m.center||[0,0]),top:s.pointGeometry.convert(m.top||[0,0]),"top-left":s.pointGeometry.convert(m["top-left"]||[0,0]),"top-right":s.pointGeometry.convert(m["top-right"]||[0,0]),bottom:s.pointGeometry.convert(m.bottom||[0,0]),"bottom-left":s.pointGeometry.convert(m["bottom-left"]||[0,0]),"bottom-right":s.pointGeometry.convert(m["bottom-right"]||[0,0]),left:s.pointGeometry.convert(m.left||[0,0]),right:s.pointGeometry.convert(m.right||[0,0])}}return qd(new s.pointGeometry(0,0))}const ss={supported:_,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends nr{constructor(m){var i;if(s.PerformanceUtils.mark(s.PerformanceMarkers.create),(m=s.extend({},cp,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ql(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),{bearingSnap:m.bearingSnap}),this._interactive=m.interactive,this._cooperativeGestures=m.cooperativeGestures,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._crossSourceCollisions=m.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=m.collectResourceTiming,this._renderTaskQueue=new sp,this._controls=[],this._mapId=s.uniqueId(),this._locale=s.extend({},lp,m.locale),this._clickTolerance=m.clickTolerance,this._pixelRatio=(i=m.pixelRatio)!==null&&i!==void 0?i:devicePixelRatio,this._requestManager=new D(m.transformRequest),typeof m.container=="string"){if(this._container=document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(m.maxBounds&&this.setMaxBounds(m.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ap(this,m),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=m.hash&&new Kf(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,s.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localIdeographFontFamily:m.localIdeographFontFamily}),m.attributionControl&&this.addControl(new sc({customAttribution:m.customAttribution})),m.maplibreLogo&&this.addControl(new cu,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new s.Event(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new s.Event(`${u.dataType}dataloading`,u))}),this.on("dataabort",u=>{this.fire(new s.Event("sourcedataabort",u))})}_getMapId(){return this._mapId}addControl(m,i){if(i===void 0&&(i=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=m.onAdd(this);this._controls.push(m);const f=this._controlPositions[i];return i.indexOf("bottom")!==-1?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(m);return i>-1&&this._controls.splice(i,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}calculateCameraOptionsFromTo(m,i,u,f){return f==null&&this.style.terrain&&(f=this.transform.getElevation(u,this.style.terrain)),super.calculateCameraOptionsFromTo(m,i,u,f)}resize(m){const i=this._containerDimensions(),u=i[0],f=i[1];this._resizeCanvas(u,f,this.getPixelRatio()),this.transform.resize(u,f),this.painter.resize(u,f,this.getPixelRatio());const y=!this._moving;return y&&(this.stop(),this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m))),this.fire(new s.Event("resize",m)),y&&this.fire(new s.Event("moveend",m)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(m){const[i,u]=this._containerDimensions();this._pixelRatio=m,this._resizeCanvas(i,u,m),this.painter.resize(i,u,m)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(s.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m&&this.setZoom(m),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m&&this.setZoom(m),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this._update()}project(m){return this.transform.locationPoint(s.LngLat.convert(m),this.style&&this.style.terrain)}unproject(m){return this.transform.pointLocation(s.pointGeometry.convert(m),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(m,i,u){if(m==="mouseenter"||m==="mouseover"){let f=!1;return{layer:i,listener:u,delegates:{mousemove:b=>{const k=this.getLayer(i)?this.queryRenderedFeatures(b.point,{layers:[i]}):[];k.length?f||(f=!0,u.call(this,new Gi(m,this,b.originalEvent,{features:k}))):f=!1},mouseout:()=>{f=!1}}}}if(m==="mouseleave"||m==="mouseout"){let f=!1;return{layer:i,listener:u,delegates:{mousemove:k=>{(this.getLayer(i)?this.queryRenderedFeatures(k.point,{layers:[i]}):[]).length?f=!0:f&&(f=!1,u.call(this,new Gi(m,this,k.originalEvent)))},mouseout:k=>{f&&(f=!1,u.call(this,new Gi(m,this,k.originalEvent)))}}}}{const f=y=>{const b=this.getLayer(i)?this.queryRenderedFeatures(y.point,{layers:[i]}):[];b.length&&(y.features=b,u.call(this,y),delete y.features)};return{layer:i,listener:u,delegates:{[m]:f}}}}on(m,i,u){if(u===void 0)return super.on(m,i);const f=this._createDelegatedListener(m,i,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(f);for(const y in f.delegates)this.on(y,f.delegates[y]);return this}once(m,i,u){if(u===void 0)return super.once(m,i);const f=this._createDelegatedListener(m,i,u);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(m,i,u){return u===void 0?super.off(m,i):(this._delegatedListeners&&this._delegatedListeners[m]&&(f=>{const y=this._delegatedListeners[m];for(let b=0;b<y.length;b++){const k=y[b];if(k.layer===i&&k.listener===u){for(const I in k.delegates)this.off(I,k.delegates[I]);return y.splice(b,1),this}}})(),this)}queryRenderedFeatures(m,i){if(!this.style)return[];let u;if(i!==void 0||m===void 0||m instanceof s.pointGeometry||Array.isArray(m)||(i=m,m=void 0),i=i||{},(m=m||[[0,0],[this.transform.width,this.transform.height]])instanceof s.pointGeometry||typeof m[0]=="number")u=[s.pointGeometry.convert(m)];else{const f=s.pointGeometry.convert(m[0]),y=s.pointGeometry.convert(m[1]);u=[f,new s.pointGeometry(y.x,f.y),y,new s.pointGeometry(f.x,y.y),f]}return this.style.queryRenderedFeatures(u,i,this.transform)}querySourceFeatures(m,i){return this.style.querySourceFeatures(m,i)}setStyle(m,i){return(i=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(m,i))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const i=this._locale[m];if(i==null)throw new Error(`Missing UI string '${m}'`);return i}_updateStyle(m,i){return this.style&&(this.style.setEventedParent(null),this.style._remove()),m?(this.style=new Vr(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Vr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,i){if(typeof m=="string"){const u=this._requestManager.transformRequest(m,s.ResourceType.Style);s.getJSON(u,(f,y)=>{f?this.fire(new s.ErrorEvent(f)):y&&this._updateDiff(y,i)})}else typeof m=="object"&&this._updateDiff(m,i)}_updateDiff(m,i){try{this.style.setState(m)&&this._update(!0)}catch(u){s.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(m,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.warnOnce("There is no style added to the map.")}addSource(m,i){return this._lazyInitEmptyStyle(),this.style.addSource(m,i),this._update(!0)}isSourceLoaded(m){const i=this.style&&this.style.sourceCaches[m];if(i!==void 0)return i.loaded();this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${m}'`)))}setTerrain(m){return this.style.setTerrain(m),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const m=this.style&&this.style.sourceCaches;for(const i in m){const u=m[i]._tiles;for(const f in u){const y=u[f];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}addSourceType(m,i,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(m,i,u)}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,i,{pixelRatio:u=1,sdf:f=!1,stretchX:y,stretchY:b,content:k}={}){if(this._lazyInitEmptyStyle(),i instanceof HTMLImageElement||s.isImageBitmap(i)){const{width:I,height:R,data:z}=s.exported.getImageData(i);this.style.addImage(m,{data:new s.RGBAImage({width:I,height:R},z),pixelRatio:u,stretchX:y,stretchY:b,content:k,sdf:f,version:0})}else{if(i.width===void 0||i.height===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:I,height:R,data:z}=i,q=i;this.style.addImage(m,{data:new s.RGBAImage({width:I,height:R},new Uint8Array(z)),pixelRatio:u,stretchX:y,stretchY:b,content:k,sdf:f,version:0,userImage:q}),q.onAdd&&q.onAdd(this,m)}}}updateImage(m,i){const u=this.style.getImage(m);if(!u)return this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=i instanceof HTMLImageElement||s.isImageBitmap(i)?s.exported.getImageData(i):i,{width:y,height:b,data:k}=f;if(y===void 0||b===void 0)return this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==u.data.width||b!==u.data.height)return this.fire(new s.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(i instanceof HTMLImageElement||s.isImageBitmap(i));u.data.replace(k,I),this.style.updateImage(m,u)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,i){s.getImage(this._requestManager.transformRequest(m,s.ResourceType.Image),i)}listImages(){return this.style.listImages()}addLayer(m,i){return this._lazyInitEmptyStyle(),this.style.addLayer(m,i),this._update(!0)}moveLayer(m,i){return this.style.moveLayer(m,i),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,i,u){return this.style.setLayerZoomRange(m,i,u),this._update(!0)}setFilter(m,i,u={}){return this.style.setFilter(m,i,u),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,i,u,f={}){return this.style.setPaintProperty(m,i,u,f),this._update(!0)}getPaintProperty(m,i){return this.style.getPaintProperty(m,i)}setLayoutProperty(m,i,u,f={}){return this.style.setLayoutProperty(m,i,u,f),this._update(!0)}getLayoutProperty(m,i){return this.style.getLayoutProperty(m,i)}setLight(m,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(m,i){return this.style.setFeatureState(m,i),this._update()}removeFeatureState(m,i){return this.style.removeFeatureState(m,i),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,i=0;return this._container&&(m=this._container.clientWidth||400,i=this._container.clientHeight||300),[m,i]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map","mapboxgl-map");const i=this._canvasContainer=S.create("div","maplibregl-canvas-container mapboxgl-canvas-container",m);this._interactive&&i.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=S.create("canvas","maplibregl-canvas mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions();this._resizeCanvas(u[0],u[1],this.getPixelRatio());const f=this._controlContainer=S.create("div","maplibregl-control-container mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{y[b]=S.create("div",`maplibregl-ctrl-${b} mapboxgl-ctrl-${b}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const m=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=S.create("div","maplibregl-cooperative-gesture-screen",m);let i="Control",u=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(u=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",i="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${u}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",f=>{f.key===i&&(this._metaPress=!0)}),document.addEventListener("keyup",f=>{f.key===i&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",f=>{this._onCooperativeGesture(f,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(m,i,u){this._canvas.width=u*m,this._canvas.height=u*i,this._canvas.style.width=`${m}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const m=s.extend({},_.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);i?(this.painter=new Ld(i,this.transform),s.exported$1.testSupport(i)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(m,i,u){return!i&&u<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){let i,u=0;const f=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(i=f.createQueryEXT(),f.beginQueryEXT(f.TIME_ELAPSED_EXT,i),u=s.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let y=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const k=this.transform.zoom,I=s.exported.now();this.style.zoomHistory.update(k,I);const R=new s.EvaluationParameters(k,{now:I,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),z=R.crossFadingFactor();z===1&&z===this._crossFadingFactor||(y=!0,this._crossFadingFactor=z),this.style.update(R)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.PerformanceUtils.mark(s.PerformanceMarkers.load),this.fire(new s.Event("load"))),this.style&&(this.style.hasTransitions()||y)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const k=s.exported.now()-u;f.endQueryEXT(f.TIME_ELAPSED_EXT,i),setTimeout(()=>{const I=f.getQueryObjectEXT(i,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(i),this.fire(new s.Event("gpu-timing-frame",{cpuTime:k,gpuTime:I}))},50)}if(this.listens("gpu-timing-layer")){const k=this.painter.collectGpuTimers();setTimeout(()=>{const I=this.painter.queryGpuTimers(k);this.fire(new s.Event("gpu-timing-layer",{layerTimes:I}))},50)}const b=this._sourcesDirty||this._styleDirty||this._placementDirty;return b||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.Event("idle")),!this._loaded||this._fullyLoaded||b||(this._fullyLoaded=!0,s.PerformanceUtils.mark(s.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),S.remove(this._canvasContainer),S.remove(this._controlContainer),this._cooperativeGestures&&S.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),s.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=s.exported.frame(m=>{s.PerformanceUtils.frame(m),this._frame=null,this._render(m)}))}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}_setCacheLimits(m,i){s.setCacheLimits(m,i)}get version(){return"2.4.0"}},NavigationControl:class{constructor(m){this.options=s.extend({},vg,m),this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map.getZoom(),i=m===this._map.getMaxZoom(),u=m===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const m=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=m}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){S.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,i){const u=S.create("button",m,this._container);return u.type="button",u.addEventListener("click",i),u}_setButtonTitle(m,i){const u=this._map._getUIString(`NavigationControl.${i}`);m.title=u,m.setAttribute("aria-label",u)}},GeolocateControl:class extends s.Evented{constructor(m){super(),this.options=s.extend({},Gd,m),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(m){var i;return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,Da!==void 0?i(Da):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(u=>{Da=u.state!=="denied",i(Da)}):(Da=!!window.navigator.geolocation,i(Da)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),S.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,ei=0,Ra=!1}_isOutOfMapMaxBounds(m){const i=this._map.getMaxBounds(),u=m.coords;return i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",m)),this._finish()}}_updateCamera(m){const i=new s.LngLat(m.coords.longitude,m.coords.latitude),u=m.coords.accuracy,f=this._map.getBearing(),y=s.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(u),y,{geolocateSource:!0})}_updateMarker(m){if(m){const i=new s.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map._container.clientHeight/2,i=this._map.unproject([0,m]),u=this._map.unproject([1,m]),f=i.distanceTo(u),y=Math.ceil(2*this._accuracy/f);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&Ra)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=S.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=S.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new nl(this._dotElement),this._circleElement=S.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new nl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ei--,Ra=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ei++,ei>1?(m={maximumAge:6e5,timeout:0},Ra=!0):(m=this.options.positionOptions,Ra=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:sc,LogoControl:cu,ScaleControl:class{constructor(m){this.options=s.extend({},Bo,m),s.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){up(this._map,this._container,this.options)}onAdd(m){return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){S.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(m){this.options.unit=m,up(this._map,this._container,this.options)}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){S.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=S.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(m){this.options=m,s.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(m){return this._map=m,this._container=S.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=S.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),S.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends s.Evented{constructor(m){super(),this.options=s.extend(Object.create(mr),m),s.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&S.remove(this._content),this._container&&(S.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=s.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const i=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=m;f=u.firstChild,f;)i.appendChild(f);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=S.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){this._container&&this._container.classList.add(m)}removeClassName(m){this._container&&this._container.classList.remove(m)}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}_createCloseButton(){this.options.closeButton&&(this._closeButton=S.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(m){this._update(m.point)}_onMouseMove(m){this._update(m.point)}_onDrag(m){this._update(m.point)}_update(m){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=S.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=S.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(b=>this._container.classList.add(b)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=lc(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!m))return;const i=this._pos=this._trackPointer&&m?m:this._map.project(this._lngLat);let u=this.options.anchor;const f=qd(this.options.offset);if(!u){const b=this._container.offsetWidth,k=this._container.offsetHeight;let I;I=i.y+f.bottom.y<k?["top"]:i.y>this._map.transform.height-k?["bottom"]:[],i.x<b/2?I.push("left"):i.x>this._map.transform.width-b/2&&I.push("right"),u=I.length===0?"bottom":I.join("-")}const y=i.add(f[u]).round();S.setTransform(this._container,`${jt[u]} translate(${y.x}px,${y.y}px)`),Yt(this._container,u,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Pr);m&&m.focus()}_onClose(){this.remove()}},Marker:nl,Style:Vr,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,Evented:s.Evented,AJAXError:s.AJAXError,config:s.config,CanvasSource:ft,GeoJSONSource:rt,ImageSource:Ae,RasterDEMTileSource:ze,RasterTileSource:Ee,VectorTileSource:Ne,VideoSource:He,prewarm:function(){Fe().acquire(Pe)},clearPrewarmedResources:function(){const m=ue;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(Pe),ue=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return lt.workerCount},set workerCount(m){lt.workerCount=m},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){s.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){s.clearTileCache(m)},workerUrl:"",addProtocol(m,i){s.config.REGISTERED_PROTOCOLS[m]=i},removeProtocol(m){delete s.config.REGISTERED_PROTOCOLS[m]}};return oo.extend(ss,{isSafari:s.isSafari,getPerformanceMetrics:s.PerformanceUtils.getPerformanceMetrics}),ss});var p=c;return p})})(iz);const oz=B_;var qc={},J0={},Q0={},OP={},eg={};eg.__esModule=!0;eg.StandardFigures=void 0;eg.StandardFigures=[[0,8,9,9,9,9,0,8,8,0,0,0,9,9,8,8,0,0,0,9,9,0,8,9,9,9,9,0],[0,0,0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9,8,0,8,9,0,0,0,0,8,0,0,0,0,0,0,9,0,0,0],[0,0,0,9,0,0,0,0,0,0,8,0,0,0,0,9,8,0,8,9,0,0,0,0,0,0,0,0],[0,0,0,9,0,0,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,0,0,0,9,0,0,0],[0,0,0,0,0,9,0,0,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,0,0,0,9,0],[0,9,0,0,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,0,0,0,9,0,0,0,0,0],[0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0],[0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0],[0,0,0,0,0,0,0,8,9,9,0,0,9,8,8,9,9,0,0,9,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,0,0,0,0,0],[0,9,9,9,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,9,9,9,9,9,0,9,0,0,0,0,0,9,9,9,0,0,0,9,9,0,9,9,0,9,9,0],[0,9,9,0,9,9,0,9,9,0,0,0,9,9,9,0,0,0,0,0,9,0,9,9,9,9,9,0],[0,9,0,0,0,9,0,0,0,0,9,0,0,0,0,0,0,9,0,0,0,0,9,0,0,0,9,0],[0,8,8,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,0,8,8,0],[0,0,8,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,9,0,0],[0,9,8,0,9,8,0,8,0,0,0,0,0,9,9,0,0,0,0,0,8,0,8,9,0,8,9,0],[0,9,9,0,9,9,0,9,0,8,9,9,0,9,9,0,8,9,9,0,9,0,9,9,0,9,9,0],[0,9,0,0,9,0,0,0,0,8,9,9,0,9,9,0,8,9,9,0,0,0,0,9,0,0,9,0],[0,0,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9,0,0,0,8,0,0,9,0,0,0,8,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,9,9,9,9,9,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,9,0,9,0,0,0,9,9,9,9,0,0,0,9,9,9,0,0,0,0,0,9,0],[0,9,0,0,0,0,0,9,9,9,0,0,0,9,9,9,9,0,0,0,9,0,9,0,0,0,0,0],[0,9,0,0,9,9,0,9,9,9,0,0,9,9,9,9,9,0,0,9,9,0,9,0,0,9,9,0],[0,9,9,0,9,9,0,9,0,0,0,0,0,9,0,9,8,8,8,9,0,0,9,0,9,0,9,0],[0,9,0,9,0,9,0,0,9,8,8,8,9,0,9,0,0,0,0,0,9,0,9,9,0,9,9,0],[0,8,0,0,9,0,0,0,0,0,0,0,0,8,9,0,0,0,0,0,0,0,0,8,0,0,9,0],[0,0,9,0,0,8,0,8,0,0,0,0,0,0,0,0,0,0,0,0,9,0,9,0,0,8,0,0],[0,0,9,0,0,9,0,9,0,8,9,9,0,0,0,0,8,9,9,0,9,0,9,0,0,9,0,0],[0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,0,9,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,9,9,8,8,0,0,0,0,0,0,0],[0,0,0,9,0,0,0,9,0,9,9,9,0,9,9,0,9,9,9,0,9,0,0,0,9,0,0,0],[0,0,0,9,0,0,0,9,0,0,9,0,0,9,9,0,0,9,0,0,9,0,0,0,9,0,0,0],[0,9,9,9,9,9,0,9,9,9,9,9,9,9,9,9,9,0,9,9,9,0,9,0,0,0,9,0],[0,9,0,0,0,9,0,9,9,9,0,9,9,9,9,9,9,9,9,9,9,0,9,9,9,9,9,0],[0,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,9,0,9,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,9,9,9,0,0,0,0,0,0,0,0,0],[0,0,9,8,0,0,0,0,0,0,0,0,9,8,9,8,0,0,0,0,0,0,0,0,9,8,0,0],[0,0,0,0,0,0,0,0,9,8,0,0,0,0,0,0,0,0,9,8,0,0,0,0,0,0,0,0],[0,0,9,8,0,0,0,0,9,8,0,0,9,8,9,8,0,0,9,8,0,0,0,0,9,8,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,8,8,0],[0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0],[0,0,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0],[0,9,0,0,9,0,0,9,9,9,0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0,9,0],[0,9,0,0,0,9,0,0,9,9,0,9,9,0,0,9,9,0,9,9,0,0,9,0,0,0,9,0],[0,0,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,0,0],[0,0,0,9,9,0,0,9,9,9,9,9,9,0,0,9,9,9,9,9,9,0,0,9,9,0,0,0],[0,9,0,9,0,9,0,0,9,9,9,9,9,0,0,9,9,9,9,9,0,0,9,0,9,0,9,0],[0,0,0,9,8,0,0,9,8,0,0,0,0,0,0,0,0,0,0,9,8,0,0,9,8,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,9,8,0,0,9,8,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,9,8,0,0,9,8,0,0,9,8,0,0,9,8,0,0,9,8,0,0,9,8,0,0,0],[0,8,8,0,0,9,0,8,8,0,0,9,9,0,8,0,0,9,9,0,0,0,0,9,9,0,0,0],[0,0,0,0,0,0,0,8,8,0,0,9,9,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0],[0,8,8,9,9,0,0,8,8,9,9,0,0,0,0,0,0,8,8,9,9,0,0,8,8,9,9,0],[0,0,0,0,0,9,0,0,0,0,0,8,9,9,9,9,8,0,0,0,0,0,9,0,0,0,0,0],[0,9,9,0,9,9,0,9,9,0,8,0,9,9,9,0,8,0,8,0,9,0,9,9,9,9,9,0],[0,0,9,0,9,0,0,0,9,0,8,0,9,0,9,0,8,0,8,0,9,0,9,0,9,0,9,0],[0,9,0,9,0,9,0,9,0,8,0,8,0,9,0,9,0,8,0,9,0,0,0,9,0,9,0,0],[0,0,9,0,9,9,0,8,9,0,8,0,0,9,8,9,0,8,0,0,9,0,0,9,0,9,9,0],[0,9,9,0,9,9,0,8,9,0,8,0,0,9,8,9,0,8,0,0,9,0,9,9,0,9,9,0],[0,0,0,9,9,0,0,0,0,8,9,0,9,9,0,0,8,9,0,9,9,0,0,0,9,9,0,0],[0,0,0,0,0,0,0,9,9,9,8,8,8,0,0,0,0,9,8,0,0,0,0,9,9,0,0,0],[0,0,0,9,9,0,0,0,0,9,9,0,0,8,0,9,9,0,0,8,8,0,9,0,0,8,8,0],[0,0,0,0,0,0,0,9,9,9,9,9,8,8,0,0,0,0,0,9,8,0,0,0,0,9,9,0],[0,8,0,0,9,9,0,0,8,0,0,0,9,9,0,8,0,0,0,9,9,0,8,0,0,9,9,0],[0,8,0,0,0,9,0,0,0,0,0,0,9,9,0,0,0,0,0,9,9,0,8,0,0,0,9,0],[0,0,0,9,9,0,0,8,8,8,8,0,0,0,0,0,0,9,9,9,9,0,0,8,8,0,0,0],[0,0,0,9,0,0,0,0,0,0,8,8,8,8,9,9,9,9,0,0,0,0,0,0,8,0,0,0],[0,0,0,9,9,0,0,0,8,8,8,0,0,0,0,0,0,9,9,9,9,0,0,8,8,0,0,0],[0,9,9,9,9,0,0,0,0,8,8,0,0,0,0,0,0,9,9,0,0,0,0,8,8,8,8,0],[0,9,9,9,9,0,0,0,0,0,0,8,8,8,9,9,9,0,0,0,0,0,0,8,8,8,8,0],[0,0,9,9,0,0,0,8,9,0,9,8,0,0,8,9,0,9,8,0,0,0,0,9,9,0,0,0],[0,0,9,9,0,0,0,0,0,0,9,8,0,0,9,9,9,8,8,0,0,0,0,0,0,0,0,0],[0,8,8,0,0,0,0,8,8,0,0,0,0,9,8,0,0,0,0,9,9,0,0,0,0,9,9,0],[0,0,0,0,9,9,0,0,0,0,0,0,9,8,9,9,9,9,9,8,8,0,0,0,0,0,0,0],[0,0,8,0,9,0,0,0,0,8,0,9,0,0,0,0,8,0,9,0,0,0,0,8,0,9,0,0],[0,0,9,0,9,9,0,0,9,9,0,8,9,9,0,9,9,0,8,9,9,0,0,9,0,9,9,0],[0,8,9,0,9,9,0,0,8,9,0,9,9,0,0,8,9,0,9,9,0,0,8,9,0,9,9,0],[0,0,0,0,0,0,0,0,9,0,9,0,9,0,0,8,8,0,8,8,0,0,0,0,0,0,0,0],[0,0,0,9,0,9,0,8,9,0,9,0,9,8,8,9,0,9,0,9,8,0,0,0,9,0,9,0],[0,0,9,9,8,0,0,0,0,0,9,9,8,0,0,8,9,9,0,0,0,0,0,8,9,9,0,0],[0,8,9,9,9,9,0,8,8,8,0,0,0,0,0,0,0,0,8,8,8,0,9,9,9,9,8,0],[0,9,9,9,9,8,0,0,0,0,0,0,8,0,0,8,0,0,0,0,0,0,8,9,9,9,9,0],[0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,0,0,0,8,8,0,0,0,0,0,0,0],[0,8,9,9,0,0,0,0,8,8,9,9,0,0,0,0,8,8,9,9,0,0,0,0,8,9,9,0],[0,0,0,0,0,0,0,0,9,9,9,0,0,0,0,0,0,8,8,8,0,0,0,0,0,0,0,0],[0,0,9,9,8,8,0,0,9,0,0,0,8,8,8,8,0,0,0,9,0,0,8,8,9,9,0,0],[0,0,0,8,9,9,0,0,0,0,8,0,9,9,9,9,0,8,0,0,0,0,9,9,8,0,0,0],[0,9,8,0,0,0,0,0,0,0,0,0,9,8,8,9,0,0,0,0,0,0,0,0,0,8,9,0],[0,0,0,0,9,8,0,9,8,0,0,0,0,0,0,0,0,0,0,9,8,0,9,8,0,0,0,0],[0,9,0,9,9,0,0,0,9,9,9,0,0,8,0,0,9,0,0,8,8,0,0,0,0,8,8,0],[0,0,8,9,9,0,0,0,8,9,9,0,0,0,0,0,0,9,9,8,0,0,0,9,9,8,0,0],[0,9,9,9,9,9,0,0,0,0,0,8,8,8,8,8,8,0,0,0,0,0,9,9,9,9,9,0],[0,8,9,9,9,9,0,0,8,0,0,0,0,0,0,0,0,0,0,8,0,0,9,9,9,9,8,0],[0,0,0,0,0,0,0,0,0,8,9,0,0,0,0,0,0,9,8,0,0,0,0,0,0,0,0,0],[0,8,9,0,9,8,0,9,8,0,0,0,8,9,9,8,0,0,0,8,9,0,8,9,0,9,8,0],[0,0,0,8,9,0,0,0,0,0,8,9,0,0,0,0,0,8,9,0,0,0,0,0,8,9,0,0],[0,0,8,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,9,9,0,0],[0,0,8,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,9,0,0],[0,9,0,8,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,8,0,9,0],[0,9,0,8,0,0,0,0,0,0,0,0,9,0,0,0,0,0,0,9,0,0,9,0,8,0,0,0],[0,8,0,9,9,0,0,0,8,9,9,0,9,9,9,9,0,9,8,8,0,0,0,9,9,0,9,0],[0,0,9,9,9,0,0,8,9,9,0,8,0,9,8,9,9,0,8,0,9,0,0,9,9,9,0,0],[0,0,9,9,0,9,0,8,0,9,0,8,9,0,8,0,9,0,8,9,0,0,0,9,9,0,9,0],[0,0,0,9,9,0,0,9,0,8,9,0,9,8,9,0,8,9,0,9,8,0,0,0,9,9,0,0],[0,0,0,9,9,0,0,9,0,8,9,8,9,0,9,0,8,9,8,9,0,0,0,0,9,9,0,0],[0,9,9,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0],[0,0,0,9,0,0,0,0,0,8,9,8,0,0,0,0,8,9,8,0,0,0,0,0,9,0,0,0],[0,0,9,8,9,0,0,0,0,8,0,9,0,0,0,0,8,0,9,0,0,0,0,9,8,9,0,0],[0,8,8,9,9,9,0,8,8,0,0,0,0,0,8,9,0,0,0,0,0,0,9,9,0,0,0,0],[0,9,9,0,0,0,0,8,9,0,0,0,0,0,8,8,0,0,0,0,0,0,8,8,9,9,9,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,0,0,8,8,0,9,0,0,8,8,0],[0,9,0,0,8,8,0,9,9,9,0,0,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,9,0,0,8,0,0,9,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,9,0,8,9,9,0,0,0,0,8,9,9,0,9,0,0,0,0,0,0,0],[0,8,8,0,9,9,0,8,0,0,9,0,0,9,9,0,0,9,0,0,8,0,9,9,0,8,8,0],[0,0,9,0,9,0,0,0,8,0,0,0,8,0,0,8,0,0,0,8,0,0,0,9,0,9,0,0],[0,9,0,0,0,8,0,8,9,0,0,0,8,8,8,8,0,0,0,9,8,0,8,0,0,0,9,0],[0,9,9,0,0,0,0,8,9,0,0,0,0,0,8,9,0,0,0,0,0,0,9,9,0,0,0,0],[0,8,8,0,9,9,0,0,8,0,0,0,9,0,0,9,0,0,0,8,0,0,9,9,0,8,8,0],[0,0,9,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,9,9,0,0,8,8,8,8,8,0],[0,8,8,8,8,8,0,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0,0,9,9,0,0,0],[0,0,0,0,9,9,0,0,0,0,0,0,9,9,8,8,9,0,0,0,9,0,8,0,0,0,0,0],[0,8,0,0,9,9,0,9,8,8,0,0,9,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,9,0,0,0,0,0,9,0,0,9,0,0],[0,0,0,0,0,0,0,0,0,8,9,9,0,9,9,0,8,9,9,0,0,0,0,0,0,0,0,0],[0,0,9,0,9,0,0,9,0,0,0,0,0,9,8,0,0,0,0,0,8,0,0,8,0,8,0,0],[0,9,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,9,0],[0,0,9,0,9,0,0,8,0,0,0,0,0,9,8,0,0,0,0,0,9,0,0,9,0,9,0,0],[0,0,0,9,9,0,0,0,0,8,9,0,0,0,0,0,8,9,0,0,0,0,0,0,9,9,0,0],[0,0,9,0,9,0,0,0,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,9,0,9,0,0],[0,0,0,0,0,8,0,8,9,9,9,9,8,8,8,8,9,9,9,9,8,0,8,0,0,0,0,0],[0,0,0,0,0,9,0,0,0,8,8,8,8,8,9,8,8,9,9,0,0,0,8,0,0,0,0,0],[0,0,0,0,0,9,0,0,0,0,0,8,0,9,9,0,8,0,0,0,0,0,9,0,0,0,0,0],[0,0,0,8,8,8,0,0,0,0,0,0,9,9,9,9,0,0,0,0,0,0,8,8,8,0,0,0],[0,0,9,9,8,8,0,9,8,8,0,0,0,0,0,0,0,0,9,9,8,0,9,9,8,8,0,0],[0,0,9,9,9,9,0,8,8,0,0,0,0,0,0,0,0,0,0,8,8,0,9,9,9,9,0,0],[0,0,0,8,8,0,0,0,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,8,8,0,0,0],[0,0,0,8,9,9,0,0,9,9,8,0,0,0,0,0,0,8,9,9,0,0,9,9,8,0,0,0],[0,0,0,0,8,8,0,0,0,9,9,9,9,0,0,9,9,9,9,0,0,0,8,8,0,0,0,0],[0,0,0,0,0,9,0,0,0,0,0,8,9,0,0,0,0,0,8,9,0,0,0,0,0,0,9,0],[0,9,9,9,8,8,0,0,0,9,0,0,8,8,8,8,0,0,9,0,0,0,8,8,9,9,9,0],[0,8,0,0,0,0,0,8,8,9,9,9,9,9,8,9,9,9,9,9,9,0,0,0,0,0,8,0],[0,8,0,0,0,0,0,9,8,8,9,9,0,0,0,0,8,8,9,9,8,0,0,0,0,0,9,0],[0,9,0,0,0,0,0,9,0,8,0,0,0,0,0,0,0,0,8,0,9,0,0,0,0,0,9,0],[0,8,8,9,9,0,0,8,8,0,0,0,0,0,0,0,0,0,0,8,8,0,9,9,9,8,8,0],[0,9,9,9,9,0,0,0,0,0,0,8,9,9,9,8,8,0,0,0,0,0,0,9,9,9,9,0],[0,9,9,9,9,0,0,0,0,0,0,0,8,8,8,8,0,0,0,0,0,0,0,9,9,9,9,0],[0,0,8,8,0,0,0,0,0,9,9,9,9,0,0,9,9,9,9,0,0,0,0,0,8,8,0,0],[0,9,9,8,0,0,0,0,0,0,8,9,9,0,0,9,9,8,0,0,0,0,0,0,8,9,9,0],[0,9,9,0,0,0,0,0,9,8,9,9,0,0,0,0,8,9,9,8,0,0,0,0,0,8,8,0],[0,9,9,0,0,8,0,9,9,0,0,8,8,0,9,9,0,0,8,8,0,0,9,9,0,0,8,0],[0,8,9,9,9,9,0,8,8,0,0,9,0,0,0,0,9,0,0,8,8,0,9,9,9,8,8,0],[0,0,0,9,0,0,0,0,9,9,0,8,9,0,0,9,9,0,8,9,0,0,0,0,9,0,0,0],[0,0,0,0,0,0,0,8,8,0,9,0,9,0,0,9,0,9,0,8,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9,0,9,0,8,8,8,8,0,9,0,9,0,0,0,0,0,0,0,0],[0,0,0,0,0,9,0,0,0,9,9,0,0,8,9,0,0,8,8,0,0,0,8,0,0,0,0,0],[0,8,0,0,0,0,0,9,0,0,8,8,0,0,0,0,9,9,0,0,8,0,0,0,0,0,9,0],[0,0,0,8,8,0,0,0,9,9,0,0,0,0,0,0,0,0,8,8,0,0,0,9,9,0,0,0],[0,0,8,8,0,0,0,0,0,0,0,9,9,0,0,8,8,0,0,0,0,0,0,0,9,9,0,0],[0,0,9,0,9,0,0,0,0,0,0,0,0,0,9,8,8,0,9,8,8,0,8,0,0,0,8,0],[0,8,0,0,0,8,0,9,8,8,0,9,8,8,0,0,0,0,0,0,0,0,0,9,0,9,0,0],[0,0,8,9,9,0,0,8,9,0,9,0,9,9,8,9,0,9,0,9,9,0,0,8,9,9,0,0],[0,0,0,0,0,9,0,0,9,8,0,0,9,8,0,9,8,0,0,9,8,0,0,0,0,0,9,0],[0,9,0,8,0,9,0,8,0,0,0,0,0,8,0,9,0,0,0,9,0,0,0,8,0,9,0,0],[0,0,9,0,9,0,0,0,8,0,0,0,8,0,9,0,0,0,0,0,9,0,9,0,8,0,9,0],[0,0,0,9,0,8,0,0,0,0,0,0,0,9,9,0,0,0,0,0,0,0,8,0,9,0,0,0],[0,0,0,0,0,0,0,9,0,0,0,0,0,9,0,8,0,0,0,8,0,0,0,9,0,9,0,0],[0,0,9,0,9,0,0,0,8,0,0,0,8,0,9,0,0,0,0,0,9,0,0,0,0,0,0,0],[0,0,8,9,9,0,0,8,9,9,0,8,9,9,8,9,9,0,8,9,9,0,0,8,9,9,0,0],[0,0,8,9,9,0,0,8,9,0,0,0,9,9,8,9,0,0,0,9,9,0,0,8,9,9,0,0],[0,0,9,0,9,0,0,8,9,9,0,8,9,9,8,9,9,0,8,9,9,0,0,9,0,9,0,0],[0,0,8,8,8,0,0,0,0,0,8,0,0,0,0,0,0,9,0,0,0,0,0,9,9,9,0,0],[0,0,0,0,0,0,0,8,9,9,0,8,9,9,8,9,9,0,8,9,9,0,0,0,0,0,0,0],[0,0,8,8,8,0,0,0,0,0,8,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0,0],[0,0,0,0,9,9,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,9,9,0],[0,0,9,9,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,9,9,0,0,0],[0,9,0,0,0,0,0,0,9,8,0,0,0,0,0,9,8,0,0,0,0,0,9,0,0,0,0,0],[0,8,0,0,9,9,0,0,8,8,0,0,9,9,0,8,8,0,0,9,9,0,8,0,0,9,9,0],[0,0,0,0,9,9,0,0,9,9,0,8,9,9,0,9,9,0,8,9,9,0,0,0,0,9,9,0],[0,0,9,9,9,0,0,8,0,0,9,0,0,8,8,0,0,9,0,0,8,0,0,9,9,9,0,0],[0,0,9,0,9,0,0,0,9,9,0,8,9,0,0,9,9,0,8,9,0,0,0,9,0,9,0,0],[0,0,9,0,9,0,0,8,9,0,0,0,9,9,8,9,0,0,0,9,9,0,0,9,0,9,0,0],[0,0,9,9,9,0,0,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,9,8,9,9,9,8,9,0,0,0,0,0,0,0,0,8,8,8,8,8,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,0,0,0,0,0,9,9,9,0,0],[0,0,0,0,0,0,0,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,8,8,9,9,9,0],[0,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,8,8,9,9,9,0,0,0,0,0,0,0],[0,0,9,9,0,0,0,0,0,0,8,8,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,9,9,0,0,0,9,0,0,8,8,9,9,9,9,0,0,0,0,0,0,9,9,9,9,9,0],[0,0,9,9,9,0,0,0,8,8,9,8,8,0,0,8,8,9,8,8,0,0,0,9,9,9,0,0],[0,0,9,9,9,0,0,8,9,9,9,8,9,9,8,9,9,9,8,9,9,0,0,9,9,9,0,0],[0,8,9,0,9,9,0,0,8,9,0,0,9,8,0,0,9,9,0,9,8,0,0,0,9,9,9,0],[0,0,0,9,9,9,0,0,0,9,9,0,9,8,0,8,9,0,0,9,8,0,8,9,0,9,9,0],[0,0,9,9,9,0,0,0,0,0,9,0,0,0,8,8,8,0,9,9,9,0,8,0,0,0,9,0],[0,8,8,8,8,8,0,0,0,0,0,0,0,0,9,9,9,9,9,9,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,9,9,9,9,9,9,9,0,0,0,8,0,0,0,0,0,8,8,8,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,9,0,0,0,0,0,9,9,0,9,9,9,9,9,0],[0,0,0,0,0,9,0,0,0,0,0,9,9,0,9,9,9,8,8,0,0,0,0,0,0,0,0,0],[0,0,0,9,9,0,0,9,9,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,9,9,0,0,9,9,8,8,0,0,9,0,0,0,0,0,9,9,0,9,9,9,8,8,0],[0,0,0,0,0,0,0,9,8,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,8,9,9,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,8,0,9,9,0,0,0,8,9,9,0],[0,0,0,8,9,9,0,0,0,9,8,0,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,9,9,9,0,0,0,9,9,0,9,8,0,9,9,0,0,9,8,0,9,0,0,9,9,0],[0,9,0,0,0,8,0,9,9,9,0,8,8,8,0,0,0,9,0,0,0,0,0,9,9,9,0,0],[0,8,0,0,0,9,0,8,8,0,0,9,9,0,8,0,0,9,9,0,0,0,0,0,9,0,0,0],[0,0,8,8,8,0,0,9,0,0,8,0,0,9,9,9,0,0,0,9,9,0,9,9,0,9,9,0],[0,9,9,9,9,9,0,0,0,0,0,0,9,9,0,0,0,0,0,0,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,9,9,9,8,8,0,0,0,0,0,0,9,9,0,0,0,0,0,0,9,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,9,8,8,0,0,0,0,0,0,9,9,0,0],[0,9,9,9,8,8,0,0,0,0,0,0,9,9,9,9,8,8,0,0,9,0,0,0,9,9,0,0],[0,9,0,8,0,9,0,0,9,0,8,0,9,0,0,8,0,9,0,8,0,0,8,0,9,0,8,0],[0,9,8,9,8,9,0,0,9,0,9,0,9,0,0,9,0,9,0,9,0,0,9,8,9,8,9,0],[0,8,0,8,0,8,0,9,0,9,0,9,0,9,9,0,9,0,9,0,9,0,8,0,8,0,8,0],[0,9,9,0,9,9,0,9,9,0,8,0,9,9,9,9,0,8,0,9,9,0,9,9,0,9,9,0],[0,8,8,9,9,0,0,9,9,0,0,9,0,0,9,9,0,0,9,0,0,0,8,8,9,9,0,0],[0,0,0,9,0,0,0,0,0,9,9,0,0,8,0,9,9,0,0,8,8,0,9,0,0,0,8,0],[0,9,9,0,9,9,0,9,9,0,0,0,9,9,9,0,0,8,0,0,9,0,0,8,8,8,0,0],[0,8,8,9,9,9,0,9,9,0,0,0,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,8,8,9,9,9,0,9,9,0,0,0,0,0,9,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,9,9,0,0,9,9,0,0,0],[0,8,8,9,9,9,0,9,9,0,0,0,0,0,9,0,0,8,8,9,9,0,0,9,9,0,0,0],[0,9,9,8,9,9,0,0,9,0,0,0,9,0,0,9,0,0,0,9,0,0,9,9,8,9,9,0],[0,8,9,9,0,0,0,0,8,8,9,9,0,0,0,8,8,9,9,0,0,0,8,9,9,0,0,0],[0,0,0,8,9,9,0,0,0,0,8,8,9,9,0,0,0,8,8,9,9,0,0,0,8,9,9,0],[0,9,9,8,9,9,0,0,0,0,8,0,0,0,0,0,0,8,0,0,0,0,9,9,8,9,9,0],[0,9,9,9,9,8,0,0,0,0,0,0,8,8,0,0,0,0,0,8,8,0,9,9,9,9,8,0],[0,0,0,8,9,9,0,0,0,8,8,9,9,0,0,8,8,9,9,0,0,0,8,9,9,0,0,0],[0,8,9,9,9,9,0,8,8,0,0,0,0,0,8,8,0,0,0,0,0,0,8,9,9,9,9,0],[0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,9,9,9,0,0,8,9,9,9,9,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,8,9,9,9,9,0,0,8,9,9,9,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,9,0,8,9,9,8,9,9,0,8,9,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,0,9,8,0,0,8,9,0,9,8,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,8,9,0,9,8,0,0,8,9,0,9,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,9,9,9,9,9,8,0,9,9,9,9,9,8,0,0,0,0,0,0,0],[0,9,8,8,8,9,0,9,9,0,0,0,9,9,9,9,0,0,0,9,9,0,9,8,8,8,9,0],[0,0,0,0,0,0,0,8,9,9,9,9,9,0,8,9,9,9,9,9,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0],[0,0,0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,8,9,9,0,0,0,0,8,9,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,0,9,0,9,8,8,9,0,9,0,9,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,0,9,0,8,0,9,8,0,9,0,8,0,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,0,0,0,9,8,8,9,0,0,0,9,8,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,8,9,0,0,8,9,9,8,9,0,0,8,9,9,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,9,9,9,8,0,0,0,9,9,9,8,0,0,0,0,0,0,0]];var tg={};tg.__esModule=!0;tg.Sprites=void 0;tg.Sprites=[{x:0,y:0,shape:1,hidden:!0},{x:0,y:0,shape:0,light:"top"},{x:0,y:.25,shape:1,light:"left"},{x:0,y:.25,shape:0,light:"left"},{x:0,y:.5,shape:1,light:"left"},{x:0,y:.5,shape:0,light:"left"},{x:0,y:.75,shape:1,hidden:!0},{x:.25,y:-.125,shape:0,light:"top"},{x:.25,y:.125,shape:1,light:"top"},{x:.25,y:.125,shape:0,light:"top"},{x:.25,y:.375,shape:1,light:"left"},{x:.25,y:.375,shape:0,light:"left"},{x:.25,y:.625,shape:1,light:"left"},{x:.25,y:.625,shape:0,light:"left"},{x:.5,y:0,shape:1,light:"top"},{x:.5,y:0,shape:0,light:"top"},{x:.5,y:.25,shape:1,light:"top"},{x:.5,y:.25,shape:0,light:"right"},{x:.5,y:.5,shape:1,light:"right"},{x:.5,y:.5,shape:0,light:"right"},{x:.5,y:.75,shape:1,light:"right"},{x:.75,y:-.125,shape:0,hidden:!0},{x:.75,y:.125,shape:1,light:"top"},{x:.75,y:.125,shape:0,light:"right"},{x:.75,y:.375,shape:1,light:"right"},{x:.75,y:.375,shape:0,light:"right"},{x:.75,y:.625,shape:1,light:"right"},{x:.75,y:.625,shape:0,hidden:!0}];var ng={};ng.__esModule=!0;ng.Shapes=void 0;ng.Shapes=[{x1:0,y1:.25,x2:.25,y2:.125,x3:.25,y3:.375},{x1:0,y1:0,x2:.25,y2:.125,x3:0,y3:.25}];(function(e){e.__esModule=!0;var t=eg,n=tg,o=ng;function c(p,s){return p.min+s%(p.max-p.min)}function d(p,s){var _=c(s.hue,p[0]),v=c(s.saturation,p[1]),E=c(s.lightness,p[2]),T=c(s.shift,p[3]),S=c(s.figureAlpha,p[4]),D=p[5]%t.StandardFigures.length,O=s.createCanvas,M=s.size||100,U=O(M,M),$=U.getContext("2d");return n.Sprites.forEach(function(L,F){var J=s.light.enabled?s.light[L.light]:1,V=Math.round(p[6]/(F+1)),Z=s.variation.enabled?c(s.variation,V):0;if($.beginPath(),!L.hidden){var G=o.Shapes[L.shape];$.moveTo(M*(G.x1+L.x),M*(G.y1+L.y)),$.lineTo(M*(G.x2+L.x),M*(G.y2+L.y)),$.lineTo(M*(G.x3+L.x),M*(G.y3+L.y))}$.fillStyle="hsla("+(_+Z)+", "+v+"%, "+(E+J)+"%, 1)",$.fill();var W=t.StandardFigures[D];if(W[F]>0){var le=W[F]*S/10;$.fillStyle="hsla("+(_+T+Z)+", "+v+"%, "+(E+J)+"%, "+le+")",$.fill()}}),U}e.default=d})(OP);var rg={},Oc={};Oc.__esModule=!0;Oc.createCanvas=Oc.deepMerge=void 0;var $P=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(o){return o&&typeof o=="object"};return e.reduce(function(o,c){return Object.keys(c).forEach(function(d){var p=o[d],s=c[d];Array.isArray(p)&&Array.isArray(s)?o[d]=p.concat.apply(p,s):n(p)&&n(s)?o[d]=$P(p,s):o[d]=s}),o},{})};Oc.deepMerge=$P;var az=function(e,t){var n=document.createElement("canvas");n.style.width=e+"px",n.style.height=t+"px";var o=window.devicePixelRatio||1;n.width=e*o,n.height=t*o;var c=n.getContext("2d");return c.scale(o,o),n};Oc.createCanvas=az;rg.__esModule=!0;rg.DefaultParams=void 0;var sz=Oc;rg.DefaultParams={hasher:"blake2",hue:{min:0,max:360},saturation:{min:70,max:100},lightness:{min:45,max:65},variation:{min:5,max:20,enabled:!0},shift:{min:60,max:300},figureAlpha:{min:.7,max:1.2},light:{top:10,right:-8,left:-4,enabled:!0},createCanvas:sz.createCanvas};var F_={},lz={get exports(){return F_},set exports(e){F_=e}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",n="finalize already called",o=typeof window=="object",c=o?window:{};c.JS_SHA3_NO_WINDOW&&(o=!1);var d=!o&&typeof self=="object",p=!c.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;p?c=pi:d&&(c=self);var s=!c.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,_=!c.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",v="0123456789abcdef".split(""),E=[31,7936,2031616,520093696],T=[4,1024,262144,67108864],S=[1,256,65536,16777216],D=[6,1536,393216,100663296],O=[0,8,16,24],M=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],U=[224,256,384,512],$=[128,256],L=["hex","buffer","arrayBuffer","array","digest"],F={128:168,256:136};(c.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(X){return Object.prototype.toString.call(X)==="[object Array]"}),_&&(c.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(X){return typeof X=="object"&&X.buffer&&X.buffer.constructor===ArrayBuffer});for(var J=function(X,tt,je){return function(ve){return new Qe(X,tt,X).update(ve)[je]()}},V=function(X,tt,je){return function(ve,ke){return new Qe(X,tt,ke).update(ve)[je]()}},Z=function(X,tt,je){return function(ve,ke,we,De){return Ee["cshake"+X].update(ve,ke,we,De)[je]()}},G=function(X,tt,je){return function(ve,ke,we,De){return Ee["kmac"+X].update(ve,ke,we,De)[je]()}},W=function(X,tt,je,ve){for(var ke=0;ke<L.length;++ke){var we=L[ke];X[we]=tt(je,ve,we)}return X},le=function(X,tt){var je=J(X,tt,"hex");return je.create=function(){return new Qe(X,tt,X)},je.update=function(ve){return je.create().update(ve)},W(je,J,X,tt)},Ie=function(X,tt){var je=V(X,tt,"hex");return je.create=function(ve){return new Qe(X,tt,ve)},je.update=function(ve,ke){return je.create(ke).update(ve)},W(je,V,X,tt)},be=function(X,tt){var je=F[X],ve=Z(X,tt,"hex");return ve.create=function(ke,we,De){return!we&&!De?Ee["shake"+X].create(ke):new Qe(X,tt,ke).bytepad([we,De],je)},ve.update=function(ke,we,De,Pe){return ve.create(we,De,Pe).update(ke)},W(ve,Z,X,tt)},de=function(X,tt){var je=F[X],ve=G(X,tt,"hex");return ve.create=function(ke,we,De){return new Rt(X,tt,we).bytepad(["KMAC",De],je).bytepad([ke],je)},ve.update=function(ke,we,De,Pe){return ve.create(ke,De,Pe).update(we)},W(ve,G,X,tt)},Ne=[{name:"keccak",padding:S,bits:U,createMethod:le},{name:"sha3",padding:D,bits:U,createMethod:le},{name:"shake",padding:E,bits:$,createMethod:Ie},{name:"cshake",padding:T,bits:$,createMethod:be},{name:"kmac",padding:T,bits:$,createMethod:de}],Ee={},Oe=[],ze=0;ze<Ne.length;++ze)for(var rt=Ne[ze],We=rt.bits,Ae=0;Ae<We.length;++Ae){var He=rt.name+"_"+We[Ae];if(Oe.push(He),Ee[He]=rt.createMethod(We[Ae],rt.padding),rt.name!=="sha3"){var ft=rt.name+We[Ae];Oe.push(ft),Ee[ft]=Ee[He]}}function Qe(X,tt,je){this.blocks=[],this.s=[],this.padding=tt,this.outputBits=je,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(X<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=je>>5,this.extraBytes=(je&31)>>3;for(var ve=0;ve<50;++ve)this.s[ve]=0}Qe.prototype.update=function(X){if(this.finalized)throw new Error(n);var tt,je=typeof X;if(je!=="string"){if(je==="object"){if(X===null)throw new Error(t);if(_&&X.constructor===ArrayBuffer)X=new Uint8Array(X);else if(!Array.isArray(X)&&(!_||!ArrayBuffer.isView(X)))throw new Error(t)}else throw new Error(t);tt=!0}for(var ve=this.blocks,ke=this.byteCount,we=X.length,De=this.blockCount,Pe=0,lt=this.s,dt,ue;Pe<we;){if(this.reset)for(this.reset=!1,ve[0]=this.block,dt=1;dt<De+1;++dt)ve[dt]=0;if(tt)for(dt=this.start;Pe<we&&dt<ke;++Pe)ve[dt>>2]|=X[Pe]<<O[dt++&3];else for(dt=this.start;Pe<we&&dt<ke;++Pe)ue=X.charCodeAt(Pe),ue<128?ve[dt>>2]|=ue<<O[dt++&3]:ue<2048?(ve[dt>>2]|=(192|ue>>6)<<O[dt++&3],ve[dt>>2]|=(128|ue&63)<<O[dt++&3]):ue<55296||ue>=57344?(ve[dt>>2]|=(224|ue>>12)<<O[dt++&3],ve[dt>>2]|=(128|ue>>6&63)<<O[dt++&3],ve[dt>>2]|=(128|ue&63)<<O[dt++&3]):(ue=65536+((ue&1023)<<10|X.charCodeAt(++Pe)&1023),ve[dt>>2]|=(240|ue>>18)<<O[dt++&3],ve[dt>>2]|=(128|ue>>12&63)<<O[dt++&3],ve[dt>>2]|=(128|ue>>6&63)<<O[dt++&3],ve[dt>>2]|=(128|ue&63)<<O[dt++&3]);if(this.lastByteIndex=dt,dt>=ke){for(this.start=dt-ke,this.block=ve[De],dt=0;dt<De;++dt)lt[dt]^=ve[dt];zt(lt),this.reset=!0}else this.start=dt}return this},Qe.prototype.encode=function(X,tt){var je=X&255,ve=1,ke=[je];for(X=X>>8,je=X&255;je>0;)ke.unshift(je),X=X>>8,je=X&255,++ve;return tt?ke.push(ve):ke.unshift(ve),this.update(ke),ke.length},Qe.prototype.encodeString=function(X){var tt,je=typeof X;if(je!=="string"){if(je==="object"){if(X===null)throw new Error(t);if(_&&X.constructor===ArrayBuffer)X=new Uint8Array(X);else if(!Array.isArray(X)&&(!_||!ArrayBuffer.isView(X)))throw new Error(t)}else throw new Error(t);tt=!0}var ve=0,ke=X.length;if(tt)ve=ke;else for(var we=0;we<X.length;++we){var De=X.charCodeAt(we);De<128?ve+=1:De<2048?ve+=2:De<55296||De>=57344?ve+=3:(De=65536+((De&1023)<<10|X.charCodeAt(++we)&1023),ve+=4)}return ve+=this.encode(ve*8),this.update(X),ve},Qe.prototype.bytepad=function(X,tt){for(var je=this.encode(tt),ve=0;ve<X.length;++ve)je+=this.encodeString(X[ve]);var ke=tt-je%tt,we=[];return we.length=ke,this.update(we),this},Qe.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var X=this.blocks,tt=this.lastByteIndex,je=this.blockCount,ve=this.s;if(X[tt>>2]|=this.padding[tt&3],this.lastByteIndex===this.byteCount)for(X[0]=X[je],tt=1;tt<je+1;++tt)X[tt]=0;for(X[je-1]|=2147483648,tt=0;tt<je;++tt)ve[tt]^=X[tt];zt(ve)}},Qe.prototype.toString=Qe.prototype.hex=function(){this.finalize();for(var X=this.blockCount,tt=this.s,je=this.outputBlocks,ve=this.extraBytes,ke=0,we=0,De="",Pe;we<je;){for(ke=0;ke<X&&we<je;++ke,++we)Pe=tt[ke],De+=v[Pe>>4&15]+v[Pe&15]+v[Pe>>12&15]+v[Pe>>8&15]+v[Pe>>20&15]+v[Pe>>16&15]+v[Pe>>28&15]+v[Pe>>24&15];we%X===0&&(zt(tt),ke=0)}return ve&&(Pe=tt[ke],De+=v[Pe>>4&15]+v[Pe&15],ve>1&&(De+=v[Pe>>12&15]+v[Pe>>8&15]),ve>2&&(De+=v[Pe>>20&15]+v[Pe>>16&15])),De},Qe.prototype.arrayBuffer=function(){this.finalize();var X=this.blockCount,tt=this.s,je=this.outputBlocks,ve=this.extraBytes,ke=0,we=0,De=this.outputBits>>3,Pe;ve?Pe=new ArrayBuffer(je+1<<2):Pe=new ArrayBuffer(De);for(var lt=new Uint32Array(Pe);we<je;){for(ke=0;ke<X&&we<je;++ke,++we)lt[we]=tt[ke];we%X===0&&zt(tt)}return ve&&(lt[ke]=tt[ke],Pe=Pe.slice(0,De)),Pe},Qe.prototype.buffer=Qe.prototype.arrayBuffer,Qe.prototype.digest=Qe.prototype.array=function(){this.finalize();for(var X=this.blockCount,tt=this.s,je=this.outputBlocks,ve=this.extraBytes,ke=0,we=0,De=[],Pe,lt;we<je;){for(ke=0;ke<X&&we<je;++ke,++we)Pe=we<<2,lt=tt[ke],De[Pe]=lt&255,De[Pe+1]=lt>>8&255,De[Pe+2]=lt>>16&255,De[Pe+3]=lt>>24&255;we%X===0&&zt(tt)}return ve&&(Pe=we<<2,lt=tt[ke],De[Pe]=lt&255,ve>1&&(De[Pe+1]=lt>>8&255),ve>2&&(De[Pe+2]=lt>>16&255)),De};function Rt(X,tt,je){Qe.call(this,X,tt,je)}Rt.prototype=new Qe,Rt.prototype.finalize=function(){return this.encode(this.outputBits,!0),Qe.prototype.finalize.call(this)};var zt=function(X){var tt,je,ve,ke,we,De,Pe,lt,dt,ue,Fe,Ke,it,ct,at,Ot,on,pn,sr,Qn,Jr,xr,Ye,_t,Kn,Dr,cn,Rr,br,dr,ai,xt,tn,Kt,er,gi,Jt,Ur,zn,yi,Bn,lr,hn,Vi,Qr,Pi,Ai,ji,vi,ae,B,K,ie,oe,ge,Se,xe,ye,Ce,Xe,ut,Ze,Ct;for(ve=0;ve<48;ve+=2)ke=X[0]^X[10]^X[20]^X[30]^X[40],we=X[1]^X[11]^X[21]^X[31]^X[41],De=X[2]^X[12]^X[22]^X[32]^X[42],Pe=X[3]^X[13]^X[23]^X[33]^X[43],lt=X[4]^X[14]^X[24]^X[34]^X[44],dt=X[5]^X[15]^X[25]^X[35]^X[45],ue=X[6]^X[16]^X[26]^X[36]^X[46],Fe=X[7]^X[17]^X[27]^X[37]^X[47],Ke=X[8]^X[18]^X[28]^X[38]^X[48],it=X[9]^X[19]^X[29]^X[39]^X[49],tt=Ke^(De<<1|Pe>>>31),je=it^(Pe<<1|De>>>31),X[0]^=tt,X[1]^=je,X[10]^=tt,X[11]^=je,X[20]^=tt,X[21]^=je,X[30]^=tt,X[31]^=je,X[40]^=tt,X[41]^=je,tt=ke^(lt<<1|dt>>>31),je=we^(dt<<1|lt>>>31),X[2]^=tt,X[3]^=je,X[12]^=tt,X[13]^=je,X[22]^=tt,X[23]^=je,X[32]^=tt,X[33]^=je,X[42]^=tt,X[43]^=je,tt=De^(ue<<1|Fe>>>31),je=Pe^(Fe<<1|ue>>>31),X[4]^=tt,X[5]^=je,X[14]^=tt,X[15]^=je,X[24]^=tt,X[25]^=je,X[34]^=tt,X[35]^=je,X[44]^=tt,X[45]^=je,tt=lt^(Ke<<1|it>>>31),je=dt^(it<<1|Ke>>>31),X[6]^=tt,X[7]^=je,X[16]^=tt,X[17]^=je,X[26]^=tt,X[27]^=je,X[36]^=tt,X[37]^=je,X[46]^=tt,X[47]^=je,tt=ue^(ke<<1|we>>>31),je=Fe^(we<<1|ke>>>31),X[8]^=tt,X[9]^=je,X[18]^=tt,X[19]^=je,X[28]^=tt,X[29]^=je,X[38]^=tt,X[39]^=je,X[48]^=tt,X[49]^=je,ct=X[0],at=X[1],Pi=X[11]<<4|X[10]>>>28,Ai=X[10]<<4|X[11]>>>28,Rr=X[20]<<3|X[21]>>>29,br=X[21]<<3|X[20]>>>29,Xe=X[31]<<9|X[30]>>>23,ut=X[30]<<9|X[31]>>>23,lr=X[40]<<18|X[41]>>>14,hn=X[41]<<18|X[40]>>>14,Kt=X[2]<<1|X[3]>>>31,er=X[3]<<1|X[2]>>>31,Ot=X[13]<<12|X[12]>>>20,on=X[12]<<12|X[13]>>>20,ji=X[22]<<10|X[23]>>>22,vi=X[23]<<10|X[22]>>>22,dr=X[33]<<13|X[32]>>>19,ai=X[32]<<13|X[33]>>>19,Ze=X[42]<<2|X[43]>>>30,Ct=X[43]<<2|X[42]>>>30,oe=X[5]<<30|X[4]>>>2,ge=X[4]<<30|X[5]>>>2,gi=X[14]<<6|X[15]>>>26,Jt=X[15]<<6|X[14]>>>26,pn=X[25]<<11|X[24]>>>21,sr=X[24]<<11|X[25]>>>21,ae=X[34]<<15|X[35]>>>17,B=X[35]<<15|X[34]>>>17,xt=X[45]<<29|X[44]>>>3,tn=X[44]<<29|X[45]>>>3,_t=X[6]<<28|X[7]>>>4,Kn=X[7]<<28|X[6]>>>4,Se=X[17]<<23|X[16]>>>9,xe=X[16]<<23|X[17]>>>9,Ur=X[26]<<25|X[27]>>>7,zn=X[27]<<25|X[26]>>>7,Qn=X[36]<<21|X[37]>>>11,Jr=X[37]<<21|X[36]>>>11,K=X[47]<<24|X[46]>>>8,ie=X[46]<<24|X[47]>>>8,Vi=X[8]<<27|X[9]>>>5,Qr=X[9]<<27|X[8]>>>5,Dr=X[18]<<20|X[19]>>>12,cn=X[19]<<20|X[18]>>>12,ye=X[29]<<7|X[28]>>>25,Ce=X[28]<<7|X[29]>>>25,yi=X[38]<<8|X[39]>>>24,Bn=X[39]<<8|X[38]>>>24,xr=X[48]<<14|X[49]>>>18,Ye=X[49]<<14|X[48]>>>18,X[0]=ct^~Ot&pn,X[1]=at^~on&sr,X[10]=_t^~Dr&Rr,X[11]=Kn^~cn&br,X[20]=Kt^~gi&Ur,X[21]=er^~Jt&zn,X[30]=Vi^~Pi&ji,X[31]=Qr^~Ai&vi,X[40]=oe^~Se&ye,X[41]=ge^~xe&Ce,X[2]=Ot^~pn&Qn,X[3]=on^~sr&Jr,X[12]=Dr^~Rr&dr,X[13]=cn^~br&ai,X[22]=gi^~Ur&yi,X[23]=Jt^~zn&Bn,X[32]=Pi^~ji&ae,X[33]=Ai^~vi&B,X[42]=Se^~ye&Xe,X[43]=xe^~Ce&ut,X[4]=pn^~Qn&xr,X[5]=sr^~Jr&Ye,X[14]=Rr^~dr&xt,X[15]=br^~ai&tn,X[24]=Ur^~yi&lr,X[25]=zn^~Bn&hn,X[34]=ji^~ae&K,X[35]=vi^~B&ie,X[44]=ye^~Xe&Ze,X[45]=Ce^~ut&Ct,X[6]=Qn^~xr&ct,X[7]=Jr^~Ye&at,X[16]=dr^~xt&_t,X[17]=ai^~tn&Kn,X[26]=yi^~lr&Kt,X[27]=Bn^~hn&er,X[36]=ae^~K&Vi,X[37]=B^~ie&Qr,X[46]=Xe^~Ze&oe,X[47]=ut^~Ct&ge,X[8]=xr^~ct&Ot,X[9]=Ye^~at&on,X[18]=xt^~_t&Dr,X[19]=tn^~Kn&cn,X[28]=lr^~Kt&gi,X[29]=hn^~er&Jt,X[38]=K^~Vi&Pi,X[39]=ie^~Qr&Ai,X[48]=Ze^~oe&Se,X[49]=Ct^~ge&xe,X[0]^=M[ve],X[1]^=M[ve+1]};if(s)e.exports=Ee;else for(ze=0;ze<Oe.length;++ze)c[Oe[ze]]=Ee[Oe[ze]]})()})(lz);var zP={},kn={},BP={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(s,_){var v=s>>>16&65535,E=s&65535,T=_>>>16&65535,S=_&65535;return E*S+(v*S+E*T<<16>>>0)|0}e.mul=Math.imul||t;function n(s,_){return s+_|0}e.add=n;function o(s,_){return s-_|0}e.sub=o;function c(s,_){return s<<_|s>>>32-_}e.rotl=c;function d(s,_){return s<<32-_|s>>>_}e.rotr=d;function p(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s}e.isInteger=Number.isInteger||p,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(s){return e.isInteger(s)&&s>=-e.MAX_SAFE_INTEGER&&s<=e.MAX_SAFE_INTEGER}})(BP);Object.defineProperty(kn,"__esModule",{value:!0});var FP=BP;function cz(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}kn.readInt16BE=cz;function uz(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}kn.readUint16BE=uz;function dz(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}kn.readInt16LE=dz;function hz(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}kn.readUint16LE=hz;function UP(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}kn.writeUint16BE=UP;kn.writeInt16BE=UP;function VP(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}kn.writeUint16LE=VP;kn.writeInt16LE=VP;function U_(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}kn.readInt32BE=U_;function V_(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}kn.readUint32BE=V_;function j_(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}kn.readInt32LE=j_;function G_(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}kn.readUint32LE=G_;function m0(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}kn.writeUint32BE=m0;kn.writeInt32BE=m0;function g0(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}kn.writeUint32LE=g0;kn.writeInt32LE=g0;function fz(e,t){t===void 0&&(t=0);var n=U_(e,t),o=U_(e,t+4);return n*4294967296+o-(o>>31)*4294967296}kn.readInt64BE=fz;function pz(e,t){t===void 0&&(t=0);var n=V_(e,t),o=V_(e,t+4);return n*4294967296+o}kn.readUint64BE=pz;function mz(e,t){t===void 0&&(t=0);var n=j_(e,t),o=j_(e,t+4);return o*4294967296+n-(n>>31)*4294967296}kn.readInt64LE=mz;function gz(e,t){t===void 0&&(t=0);var n=G_(e,t),o=G_(e,t+4);return o*4294967296+n}kn.readUint64LE=gz;function jP(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),m0(e/4294967296>>>0,t,n),m0(e>>>0,t,n+4),t}kn.writeUint64BE=jP;kn.writeInt64BE=jP;function GP(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),g0(e>>>0,t,n),g0(e/4294967296>>>0,t,n+4),t}kn.writeUint64LE=GP;kn.writeInt64LE=GP;function yz(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var o=0,c=1,d=e/8+n-1;d>=n;d--)o+=t[d]*c,c*=256;return o}kn.readUintBE=yz;function vz(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var o=0,c=1,d=n;d<n+e/8;d++)o+=t[d]*c,c*=256;return o}kn.readUintLE=vz;function _z(e,t,n,o){if(n===void 0&&(n=new Uint8Array(e/8)),o===void 0&&(o=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!FP.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var c=1,d=e/8+o-1;d>=o;d--)n[d]=t/c&255,c*=256;return n}kn.writeUintBE=_z;function xz(e,t,n,o){if(n===void 0&&(n=new Uint8Array(e/8)),o===void 0&&(o=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!FP.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var c=1,d=o;d<o+e/8;d++)n[d]=t/c&255,c*=256;return n}kn.writeUintLE=xz;function bz(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t)}kn.readFloat32BE=bz;function wz(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t,!0)}kn.readFloat32LE=wz;function Ez(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t)}kn.readFloat64BE=Ez;function Tz(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t,!0)}kn.readFloat64LE=Tz;function Sz(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var o=new DataView(t.buffer,t.byteOffset,t.byteLength);return o.setFloat32(n,e),t}kn.writeFloat32BE=Sz;function kz(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var o=new DataView(t.buffer,t.byteOffset,t.byteLength);return o.setFloat32(n,e,!0),t}kn.writeFloat32LE=kz;function Cz(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var o=new DataView(t.buffer,t.byteOffset,t.byteLength);return o.setFloat64(n,e),t}kn.writeFloat64BE=Cz;function Pz(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var o=new DataView(t.buffer,t.byteOffset,t.byteLength);return o.setFloat64(n,e,!0),t}kn.writeFloat64LE=Pz;var Jx={};Object.defineProperty(Jx,"__esModule",{value:!0});function Az(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Jx.wipe=Az;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=kn,n=Jx;e.BLOCK_SIZE=64,e.DIGEST_LENGTH=32,e.KEY_LENGTH=32,e.PERSONALIZATION_LENGTH=8,e.SALT_LENGTH=8,e.MAX_LEAF_SIZE=Math.pow(2,32)-1,e.MAX_NODE_OFFSET=Math.pow(2,48)-1,e.MAX_FANOUT=255,e.MAX_MAX_DEPTH=255;var o=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=function(){function p(s,_){if(s===void 0&&(s=32),this.digestLength=s,this.blockSize=e.BLOCK_SIZE,this._state=new Uint32Array(o),this._buffer=new Uint8Array(e.BLOCK_SIZE),this._bufferLength=0,this._ctr0=0,this._ctr1=0,this._flag0=0,this._flag1=0,this._lastNode=!1,this._finished=!1,s<1||s>e.DIGEST_LENGTH)throw new Error("blake2s: wrong digest length");_&&this.validateConfig(_);var v=0;_&&_.key&&(v=_.key.length);var E=1,T=1;if(_&&_.tree&&(E=_.tree.fanout,T=_.tree.maxDepth),this._state[0]^=s|v<<8|E<<16|T<<24,_&&_.tree){this._state[1]^=_.tree.leafSize;var S=_.tree.nodeOffset/4294967296>>>0,D=_.tree.nodeOffset>>>0;this._state[2]^=D,this._state[3]^=S|_.tree.nodeDepth<<16|_.tree.innerDigestLength<<24,this._lastNode=_.tree.lastNode}_&&_.salt&&(this._state[4]^=t.readUint32LE(_.salt,0),this._state[5]^=t.readUint32LE(_.salt,4)),_&&_.personalization&&(this._state[6]^=t.readUint32LE(_.personalization,0),this._state[7]^=t.readUint32LE(_.personalization,4)),this._initialState=new Uint32Array(this._state),_&&_.key&&v>0&&(this._paddedKey=new Uint8Array(e.BLOCK_SIZE),this._paddedKey.set(_.key),this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE)}return p.prototype.reset=function(){return this._state.set(this._initialState),this._paddedKey?(this._buffer.set(this._paddedKey),this._bufferLength=e.BLOCK_SIZE):this._bufferLength=0,this._ctr0=0,this._ctr1=0,this._flag0=0,this._flag1=0,this._finished=!1,this},p.prototype.validateConfig=function(s){if(s.key&&s.key.length>e.KEY_LENGTH)throw new Error("blake2s: wrong key length");if(s.salt&&s.salt.length!==e.SALT_LENGTH)throw new Error("blake2s: wrong salt length");if(s.personalization&&s.personalization.length!==e.PERSONALIZATION_LENGTH)throw new Error("blake2s: wrong personalization length");if(s.tree){if(s.tree.fanout<0||s.tree.fanout>e.MAX_FANOUT)throw new Error("blake2s: wrong tree fanout");if(s.tree.maxDepth<0||s.tree.maxDepth>e.MAX_MAX_DEPTH)throw new Error("blake2s: wrong tree depth");if(s.tree.leafSize<0||s.tree.leafSize>e.MAX_LEAF_SIZE)throw new Error("blake2s: wrong leaf size");if(s.tree.innerDigestLength<0||s.tree.innerDigestLength>e.DIGEST_LENGTH)throw new Error("blake2s: wrong tree inner digest length");if(s.tree.nodeOffset<0||s.tree.nodeOffset>e.MAX_NODE_OFFSET)throw new Error("blake2s: tree node offset is too large")}},p.prototype.update=function(s,_){if(_===void 0&&(_=s.length),this._finished)throw new Error("blake2s: can't update because hash was finished.");var v=e.BLOCK_SIZE-this._bufferLength,E=0;if(_===0)return this;if(_>v){for(var T=0;T<v;T++)this._buffer[this._bufferLength+T]=s[E+T];this._processBlock(e.BLOCK_SIZE),E+=v,_-=v,this._bufferLength=0}for(;_>e.BLOCK_SIZE;){for(var T=0;T<e.BLOCK_SIZE;T++)this._buffer[T]=s[E+T];this._processBlock(e.BLOCK_SIZE),E+=e.BLOCK_SIZE,_-=e.BLOCK_SIZE,this._bufferLength=0}for(var T=0;T<_;T++)this._buffer[this._bufferLength+T]=s[E+T];return this._bufferLength+=_,this},p.prototype.finish=function(s){if(!this._finished){for(var _=this._bufferLength;_<e.BLOCK_SIZE;_++)this._buffer[_]=0;this._flag0=4294967295,this._lastNode&&(this._flag1=4294967295),this._processBlock(this._bufferLength),this._finished=!0}for(var v=this._buffer.subarray(0,32),_=0;_<8;_++)t.writeUint32LE(this._state[_],v,_*4);return s.set(v.subarray(0,s.length)),this},p.prototype.digest=function(){var s=new Uint8Array(this.digestLength);return this.finish(s),s},p.prototype.clean=function(){n.wipe(this._state),n.wipe(this._buffer),n.wipe(this._initialState),this._paddedKey&&n.wipe(this._paddedKey),this._bufferLength=0,this._ctr0=0,this._ctr1=0,this._flag0=0,this._flag1=0,this._lastNode=!1,this._finished=!1},p.prototype.saveState=function(){if(this._finished)throw new Error("blake2s: cannot save finished state");return{state:new Uint32Array(this._state),buffer:new Uint8Array(this._buffer),bufferLength:this._bufferLength,ctr0:this._ctr0,ctr1:this._ctr1,flag0:this._flag0,flag1:this._flag1,lastNode:this._lastNode,paddedKey:this._paddedKey?new Uint8Array(this._paddedKey):void 0,initialState:new Uint32Array(this._initialState)}},p.prototype.restoreState=function(s){return this._state.set(s.state),this._buffer.set(s.buffer),this._bufferLength=s.bufferLength,this._ctr0=s.ctr0,this._ctr1=s.ctr1,this._flag0=s.flag0,this._flag1=s.flag1,this._lastNode=s.lastNode,this._paddedKey&&n.wipe(this._paddedKey),this._paddedKey=s.paddedKey?new Uint8Array(s.paddedKey):void 0,this._initialState.set(s.initialState),this},p.prototype.cleanSavedState=function(s){n.wipe(s.state),n.wipe(s.buffer),n.wipe(s.initialState),s.paddedKey&&n.wipe(s.paddedKey),s.bufferLength=0,s.ctr0=0,s.ctr1=0,s.flag0=0,s.flag1=0,s.lastNode=!1},p.prototype._processBlock=function(s){var _=this._ctr0+s;this._ctr0=_>>>0,_!==this._ctr0&&this._ctr1++;var v=this._state[0],E=this._state[1],T=this._state[2],S=this._state[3],D=this._state[4],O=this._state[5],M=this._state[6],U=this._state[7],$=o[0],L=o[1],F=o[2],J=o[3],V=o[4]^this._ctr0,Z=o[5]^this._ctr1,G=o[6]^this._flag0,W=o[7]^this._flag1,le=this._buffer,Ie=le[3]<<24|le[2]<<16|le[1]<<8|le[0],be=le[7]<<24|le[6]<<16|le[5]<<8|le[4],de=le[11]<<24|le[10]<<16|le[9]<<8|le[8],Ne=le[15]<<24|le[14]<<16|le[13]<<8|le[12],Ee=le[19]<<24|le[18]<<16|le[17]<<8|le[16],Oe=le[23]<<24|le[22]<<16|le[21]<<8|le[20],ze=le[27]<<24|le[26]<<16|le[25]<<8|le[24],rt=le[31]<<24|le[30]<<16|le[29]<<8|le[28],We=le[35]<<24|le[34]<<16|le[33]<<8|le[32],Ae=le[39]<<24|le[38]<<16|le[37]<<8|le[36],He=le[43]<<24|le[42]<<16|le[41]<<8|le[40],ft=le[47]<<24|le[46]<<16|le[45]<<8|le[44],Qe=le[51]<<24|le[50]<<16|le[49]<<8|le[48],Rt=le[55]<<24|le[54]<<16|le[53]<<8|le[52],zt=le[59]<<24|le[58]<<16|le[57]<<8|le[56],X=le[63]<<24|le[62]<<16|le[61]<<8|le[60];v=v+Ie|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+de|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Ee|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+ze|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+Oe|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+rt|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+Ne|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+be|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+We|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+He|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+Qe|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+zt|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+Rt|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+X|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+ft|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+Ae|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+zt|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+Ee|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Ae|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+Rt|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+X|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+ze|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+We|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+He|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+be|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+Ie|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+ft|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+Oe|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+rt|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Ne|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+de|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+Qe|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+ft|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+Qe|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Oe|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+X|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+de|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+Rt|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+Ie|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+We|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+He|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+Ne|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+rt|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+Ae|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+be|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Ee|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+ze|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+zt|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+rt|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+Ne|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Rt|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+ft|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+Qe|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+zt|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+be|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+Ae|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+de|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+Oe|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+Ee|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+X|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+Ie|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+We|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+He|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+ze|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+Ae|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+Oe|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+de|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+He|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+Ee|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+X|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+rt|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+Ie|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+zt|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+ft|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+ze|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+Ne|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+We|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Rt|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+Qe|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+be|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+de|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+ze|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Ie|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+We|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+ft|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+Ne|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+He|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+Qe|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+Ee|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+rt|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+X|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+be|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+zt|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Ae|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+Oe|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+Rt|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+Qe|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+be|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+zt|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+Ee|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+Rt|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+He|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+X|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+Oe|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+Ie|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+ze|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+Ae|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+We|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+de|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+ft|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+Ne|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+rt|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+Rt|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+rt|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+Qe|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+Ne|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+be|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+Ae|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+zt|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+ft|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+Oe|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+X|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+We|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+de|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+ze|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+He|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+Ee|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+Ie|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+ze|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+zt|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+ft|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+Ie|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+Ne|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+We|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+Ae|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+X|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+Qe|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+Rt|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+be|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+He|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+Ee|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Oe|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+rt|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+de|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,v=v+He|0,v=v+D|0,V^=v,V=V<<32-16|V>>>16,$=$+V|0,D^=$,D=D<<32-12|D>>>12,E=E+We|0,E=E+O|0,Z^=E,Z=Z<<32-16|Z>>>16,L=L+Z|0,O^=L,O=O<<32-12|O>>>12,T=T+rt|0,T=T+M|0,G^=T,G=G<<32-16|G>>>16,F=F+G|0,M^=F,M=M<<32-12|M>>>12,S=S+be|0,S=S+U|0,W^=S,W=W<<32-16|W>>>16,J=J+W|0,U^=J,U=U<<32-12|U>>>12,T=T+ze|0,T=T+M|0,G^=T,G=G<<32-8|G>>>8,F=F+G|0,M^=F,M=M<<32-7|M>>>7,S=S+Oe|0,S=S+U|0,W^=S,W=W<<32-8|W>>>8,J=J+W|0,U^=J,U=U<<32-7|U>>>7,E=E+Ee|0,E=E+O|0,Z^=E,Z=Z<<32-8|Z>>>8,L=L+Z|0,O^=L,O=O<<32-7|O>>>7,v=v+de|0,v=v+D|0,V^=v,V=V<<32-8|V>>>8,$=$+V|0,D^=$,D=D<<32-7|D>>>7,v=v+X|0,v=v+O|0,W^=v,W=W<<32-16|W>>>16,F=F+W|0,O^=F,O=O<<32-12|O>>>12,E=E+Ae|0,E=E+M|0,V^=E,V=V<<32-16|V>>>16,J=J+V|0,M^=J,M=M<<32-12|M>>>12,T=T+Ne|0,T=T+U|0,Z^=T,Z=Z<<32-16|Z>>>16,$=$+Z|0,U^=$,U=U<<32-12|U>>>12,S=S+Rt|0,S=S+D|0,G^=S,G=G<<32-16|G>>>16,L=L+G|0,D^=L,D=D<<32-12|D>>>12,T=T+Qe|0,T=T+U|0,Z^=T,Z=Z<<32-8|Z>>>8,$=$+Z|0,U^=$,U=U<<32-7|U>>>7,S=S+Ie|0,S=S+D|0,G^=S,G=G<<32-8|G>>>8,L=L+G|0,D^=L,D=D<<32-7|D>>>7,E=E+zt|0,E=E+M|0,V^=E,V=V<<32-8|V>>>8,J=J+V|0,M^=J,M=M<<32-7|M>>>7,v=v+ft|0,v=v+O|0,W^=v,W=W<<32-8|W>>>8,F=F+W|0,O^=F,O=O<<32-7|O>>>7,this._state[0]^=v^$,this._state[1]^=E^L,this._state[2]^=T^F,this._state[3]^=S^J,this._state[4]^=D^V,this._state[5]^=O^Z,this._state[6]^=M^G,this._state[7]^=U^W},p}();e.BLAKE2s=c;function d(p,s,_){s===void 0&&(s=e.DIGEST_LENGTH);var v=new c(s,_);v.update(p);var E=v.digest();return v.clean(),E}e.hash=d})(zP);var Wu=pi&&pi.__assign||function(){return Wu=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Wu.apply(this,arguments)};Q0.__esModule=!0;Q0.hashicon=void 0;var Iz=OP,Mz=rg,Dz=Oc,Rz=F_,Lz=zP,qP=new TextEncoder,Nz=new Uint8Array(qP.encode("emerald/hashicon"));function Oz(e){return new Uint8Array(Rz.keccak256.arrayBuffer(e))}function $z(e){var t=new Lz.BLAKE2s(16,{key:Nz});return t.update(qP.encode(e)),t.digest()}function zz(e,t){t===void 0&&(t={});var n={};typeof t=="number"?n=Wu(Wu({},n),{size:t}):typeof t=="object"&&(n=Wu(Wu({},n),t));var o=Dz.deepMerge(Mz.DefaultParams,n),c;if(o.hasher==="blake2")c=new Uint16Array($z(e));else if(o.hasher==="legacy"||o.hasher==="keccak")c=new Uint16Array(Oz(e));else throw Error("Unsupported hasher: "+o.hasher);return Iz.default(c,o)}Q0.hashicon=zz;var Bz=pi&&pi.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)c.hasOwnProperty(d)&&(o[d]=c[d])},e(t,n)};return function(t,n){e(t,n);function o(){this.constructor=t}t.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}(),xs=pi&&pi.__assign||function(){return xs=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},xs.apply(this,arguments)},Fz=pi&&pi.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};J0.__esModule=!0;J0.Hashicon=void 0;var Uz=Fz(P),Vz=P,jz=Q0,Gz=function(e){Bz(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var n=this.props.value,o={};typeof o<"u"&&(o=xs(xs({},o),this.props.options)),typeof this.props.size=="number"&&(o=xs(xs({},o),{size:this.props.size})),typeof this.props.hasher=="string"&&(o=xs(xs({},o),{hasher:this.props.hasher}));var c=jz.hashicon(n,o).toDataURL(),d={src:c,alt:n};return typeof this.props.size=="number"&&(d.width=this.props.size),Uz.default.createElement("img",xs({},d))},t}(Vz.Component);J0.Hashicon=Gz;(function(e){var t=pi&&pi.__createBinding||(Object.create?function(o,c,d,p){p===void 0&&(p=d),Object.defineProperty(o,p,{enumerable:!0,get:function(){return c[d]}})}:function(o,c,d,p){p===void 0&&(p=d),o[p]=c[d]});e.__esModule=!0;var n=J0;t(e,n,"Hashicon")})(qc);function qz(e,t,n){n===void 0&&(n={});var o={type:"Feature"};return(n.id===0||n.id)&&(o.id=n.id),n.bbox&&(o.bbox=n.bbox),o.properties=t||{},o.geometry=e,o}function Wz(e,t,n){if(n===void 0&&(n={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var o={type:"LineString",coordinates:e};return qz(o,t,n)}function WP(e,t,n){if(e!==null)for(var o,c,d,p,s,_,v,E=0,T=0,S,D=e.type,O=D==="FeatureCollection",M=D==="Feature",U=O?e.features.length:1,$=0;$<U;$++){v=O?e.features[$].geometry:M?e.geometry:e,S=v?v.type==="GeometryCollection":!1,s=S?v.geometries.length:1;for(var L=0;L<s;L++){var F=0,J=0;if(p=S?v.geometries[L]:v,p!==null){_=p.coordinates;var V=p.type;switch(E=n&&(V==="Polygon"||V==="MultiPolygon")?1:0,V){case null:break;case"Point":if(t(_,T,$,F,J)===!1)return!1;T++,F++;break;case"LineString":case"MultiPoint":for(o=0;o<_.length;o++){if(t(_[o],T,$,F,J)===!1)return!1;T++,V==="MultiPoint"&&F++}V==="LineString"&&F++;break;case"Polygon":case"MultiLineString":for(o=0;o<_.length;o++){for(c=0;c<_[o].length-E;c++){if(t(_[o][c],T,$,F,J)===!1)return!1;T++}V==="MultiLineString"&&F++,V==="Polygon"&&J++}V==="Polygon"&&F++;break;case"MultiPolygon":for(o=0;o<_.length;o++){for(J=0,c=0;c<_[o].length;c++){for(d=0;d<_[o][c].length-E;d++){if(t(_[o][c][d],T,$,F,J)===!1)return!1;T++}J++}F++}break;case"GeometryCollection":for(o=0;o<p.geometries.length;o++)if(WP(p.geometries[o],t,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function q_(e){var t=[1/0,1/0,-1/0,-1/0];return WP(e,function(n){t[0]>n[0]&&(t[0]=n[0]),t[1]>n[1]&&(t[1]=n[1]),t[2]<n[0]&&(t[2]=n[0]),t[3]<n[1]&&(t[3]=n[1])}),t}q_.default=q_;const Hz=()=>{const{nodes:e,waypoints:t}=In(),{rasterSources:n}=$s(),{default:o}=jM(),[c,d]=P.useState(0),p=Array.from(e.values()),s=()=>{if(!o)return;const _=p.filter(S=>S.position?.latitudeI);if(!_.length)return;if(_.length===1){o.easeTo({zoom:12,center:[(_[0].position?.longitudeI??0)/1e7,(_[0].position?.latitudeI??0)/1e7]});return}const v=Wz(_.map(S=>[(S.position?.latitudeI??0)/1e7,(S.position?.longitudeI??0)/1e7])),E=q_(v),T=o.cameraForBounds([[E[1],E[0]],[E[3],E[2]]],{padding:{top:10,bottom:10,left:10,right:10}});T&&o.easeTo(T)};return P.useEffect(()=>{o?.on("zoom",()=>{d(o?.getZoom()??0)})},[o,c]),P.useEffect(()=>{o&&s()},[o]),vt(Jo,{children:[re(Af,{children:re(mf,{label:"Sources",children:n.map((_,v)=>re(pd,{label:_.title},v))})}),re(V0,{label:"Map",noPadding:!0,actions:[{icon:ER,onClick(){o?.zoomIn()}},{icon:TR,onClick(){o?.zoomOut()}},{icon:JC,onClick(){s()}}],children:vt(cx,{mapStyle:"https://raw.githubusercontent.com/hc-oss/maplibre-gl-styles/master/styles/osm-mapnik/v8/default.json",mapLib:oz,attributionControl:!1,renderWorldCopies:!1,maxPitch:0,dragRotate:!1,touchZoomRotate:!1,initialViewState:{zoom:10,latitude:-38,longitude:145},children:[t.map(_=>re(J2,{longitude:_.longitudeI/1e7,latitude:_.latitudeI/1e7,anchor:"bottom",children:re("div",{children:re(dR,{size:16})})},_.id)),p.map(_=>{if(_.position?.latitudeI)return re(J2,{longitude:_.position.longitudeI/1e7,latitude:_.position.latitudeI/1e7,anchor:"bottom",children:vt("div",{className:"flex cursor-pointer gap-2 rounded-md border bg-backgroundPrimary p-1.5",onClick:()=>{o?.easeTo({zoom:12,center:[(_.position?.longitudeI??0)/1e7,(_.position?.latitudeI??0)/1e7]})},children:[re(qc.Hashicon,{value:_.num.toString(),size:22}),re(Rl,{className:En(c<12&&"hidden"),children:_.user?.longName})]})},_.num)})]})})]})},Zz=({lastMsgSameUser:e,message:t,sender:n})=>e?vt("div",{className:"ml-5 flex",children:[t.state==="ack"?re(vE,{size:16,className:"my-auto text-textSecondary"}):t.state==="waiting"?re(_E,{size:16,className:"my-auto text-textSecondary"}):re(yE,{size:16,className:"my-auto text-textSecondary"}),re("span",{className:`ml-4 border-l-2 border-l-backgroundPrimary pl-2 ${t.state==="ack"?"text-textPrimary":"text-textSecondary"}`,children:t.data})]}):vt("div",{className:"mx-4 mt-2 gap-2",children:[vt("div",{className:"flex gap-2",children:[re("div",{className:"w-6 cursor-pointer",children:re(qc.Hashicon,{value:(n?.num??0).toString(),size:32})}),re("span",{className:"cursor-pointer font-medium text-textPrimary",children:n?.user?.longName??"UNK"}),re("span",{className:"mt-1 font-mono text-xs text-textSecondary",children:t.rxTime.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})})]}),vt("div",{className:"ml-1 flex",children:[t.state==="ack"?re(vE,{size:16,className:"my-auto text-textSecondary"}):t.state==="waiting"?re(_E,{size:16,className:"my-auto text-textSecondary"}):re(yE,{size:16,className:"my-auto text-textSecondary"}),re("span",{className:`ml-4 border-l-2 border-l-backgroundPrimary pl-2 ${t.state==="ack"?"text-textPrimary":"text-textSecondary"}`,children:t.data})]})]}),Kz=({to:e,channel:t})=>{const{connection:n,setMessageState:o,messageDraft:c,setMessageDraft:d,hardware:p}=In(),s=p.myNodeNum,_=async v=>{await n?.sendText(v,e,!0,t).then(E=>o(e==="broadcast"?"broadcast":"direct",t,e,s,E,"ack")).catch(E=>o(e==="broadcast"?"broadcast":"direct",t,e,s,E.id,E.error))};return re("div",{className:"flex gap-2",children:re("form",{className:"w-full",onSubmit:v=>{v.preventDefault(),_(c),d("")},children:vt("div",{className:"flex flex-grow gap-2",children:[re("span",{className:"w-full",children:re(Ha,{autoFocus:!0,minLength:2,placeholder:"Enter Message",value:c,onChange:v=>d(v.target.value)})}),re(to,{children:re(gR,{size:16})})]})})})},iT=({messages:e,channel:t,to:n})=>{const{nodes:o}=In();return vt("div",{className:"flex flex-grow flex-col",children:[re("div",{className:"flex flex-grow flex-col",children:e?e.map((c,d)=>re(Zz,{message:c,lastMsgSameUser:d===0?!1:e[d-1].from===c.from,sender:o.get(c.from)},d)):vt("div",{className:"m-auto",children:[re(aR,{className:"m-auto"}),re(Rl,{children:"No Messages"})]})}),re("div",{className:"p-3",children:re(Kz,{to:n,channel:t})})]})},Xz=()=>{const{channels:e,nodes:t,hardware:n,messages:o}=In(),[c,d]=P.useState("broadcast"),[p,s]=P.useState(ks.PRIMARY),_=Array.from(t.values()).filter(S=>S.num!==n.myNodeNum),v=Array.from(e.values()),E=v.filter(S=>S.role!==Nc.DISABLED),T=e.get(p);return vt(Jo,{children:[vt(Af,{children:[re(mf,{label:"Channels",children:E.map(S=>re(pd,{label:S.settings?.name.length?S.settings?.name:S.index===0?"Primary":`Ch ${S.index}`,active:p===S.index,onClick:()=>{d("broadcast"),s(S.index)},element:re(rR,{size:16,className:"mr-2"})},S.index))}),re(mf,{label:"Peers",children:_.map(S=>re(pd,{label:S.user?.longName??"Unknown",active:p===S.num,onClick:()=>{d("direct"),s(S.num)},element:re(qc.Hashicon,{size:20,value:S.num.toString()})},S.num))})]}),vt(V0,{label:`Messages: ${c==="broadcast"&&T?z_(T):c==="direct"&&t.get(p)?t.get(p)?.user?.longName??"Unknown":"Loading..."}`,children:[v.map(S=>p===S.index&&re(iT,{to:"broadcast",messages:o.broadcast.get(S.index),channel:S.index},S.index)),_.map(S=>p===S.num&&re(iT,{to:p,messages:o.direct.get(S.num),channel:ks.PRIMARY},S.num))]})]})};var No={};Object.defineProperty(No,"__esModule",{value:!0});function Ed(e,t,n){var o;if(n===void 0&&(n={}),!t.codes){t.codes={};for(var c=0;c<t.chars.length;++c)t.codes[t.chars[c]]=c}if(!n.loose&&e.length*t.bits&7)throw new SyntaxError("Invalid padding");for(var d=e.length;e[d-1]==="=";)if(--d,!n.loose&&!((e.length-d)*t.bits&7))throw new SyntaxError("Invalid padding");for(var p=new((o=n.out)!=null?o:Uint8Array)(d*t.bits/8|0),s=0,_=0,v=0,E=0;E<d;++E){var T=t.codes[e[E]];if(T===void 0)throw new SyntaxError("Invalid character "+e[E]);_=_<<t.bits|T,s+=t.bits,s>=8&&(s-=8,p[v++]=255&_>>s)}if(s>=t.bits||255&_<<8-s)throw new SyntaxError("Unexpected end of data");return p}function Td(e,t,n){n===void 0&&(n={});for(var o=n,c=o.pad,d=c===void 0?!0:c,p=(1<<t.bits)-1,s="",_=0,v=0,E=0;E<e.length;++E)for(v=v<<8|255&e[E],_+=8;_>t.bits;)_-=t.bits,s+=t.chars[p&v>>_];if(_&&(s+=t.chars[p&v<<t.bits-_]),d)for(;s.length*t.bits&7;)s+="=";return s}var oT={chars:"0123456789ABCDEF",bits:4},aT={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bits:5},sT={chars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bits:5},lT={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bits:6},cT={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},Yz={parse:function(t,n){return Ed(t.toUpperCase(),oT,n)},stringify:function(t,n){return Td(t,oT,n)}},Jz={parse:function(t,n){return n===void 0&&(n={}),Ed(n.loose?t.toUpperCase().replace(/0/g,"O").replace(/1/g,"L").replace(/8/g,"B"):t,aT,n)},stringify:function(t,n){return Td(t,aT,n)}},Qz={parse:function(t,n){return Ed(t,sT,n)},stringify:function(t,n){return Td(t,sT,n)}},eB={parse:function(t,n){return Ed(t,lT,n)},stringify:function(t,n){return Td(t,lT,n)}},tB={parse:function(t,n){return Ed(t,cT,n)},stringify:function(t,n){return Td(t,cT,n)}},nB={parse:Ed,stringify:Td};No.base16=Yz;No.base32=Jz;No.base32hex=Qz;No.base64=eB;No.base64url=tB;No.codec=nB;const uT=No.base16;No.base32;No.base32hex;No.base64;No.base64url;No.codec;const qh=({children:e,className:t,...n})=>re("span",{className:`font-mono text-sm text-textSecondary ${t??""}`,...n,children:e}),rB=({headings:e,rows:t})=>vt("table",{className:"min-w-full",children:[re("thead",{className:"bg-backgroundPrimary text-sm font-semibold text-textPrimary",children:re("tr",{children:e.map((n,o)=>re("th",{scope:"col",className:`py-2 pr-3 pl-6 text-left ${n.sortable?"cursor-pointer hover:brightness-hover active:brightness-press":""}`,children:vt("div",{className:"flex gap-2",children:[n.title,n.sortable&&re(JD,{size:16,className:"my-auto"})]})},o))})}),re("tbody",{children:t.map((n,o)=>re("tr",{children:n.map((c,d)=>re("td",{className:"whitespace-nowrap py-2 text-sm text-textSecondary first:pl-2",children:c},d))},o))})]});var iB=["second","minute","hour","day","week","month","year"];function oB(e,t){if(t===0)return["just now","right now"];var n=iB[Math.floor(t/2)];return e>1&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]}var aB=["","","","","","",""];function sB(e,t){if(t===0)return["",""];var n=aB[~~(t/2)];return[e+" "+n+"",e+" "+n+""]}var W_={},HP=function(e,t){W_[e]=t},ZP=function(e){return W_[e]||W_.en_US},kc=[60,60,24,7,365/7/12,12];function dT(e){return e instanceof Date?e:!isNaN(e)||/^\d+$/.test(e)?new Date(parseInt(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(e))}function KP(e,t){var n=e<0?1:0;e=Math.abs(e);for(var o=e,c=0;e>=kc[c]&&c<kc.length;c++)e/=kc[c];return e=Math.floor(e),c*=2,e>(c===0?9:1)&&(c+=1),t(e,c,o)[n].replace("%s",e.toString())}function XP(e,t){var n=t?dT(t):new Date;return(+n-+dT(e))/1e3}function lB(e){for(var t=1,n=0,o=Math.abs(e);e>=kc[n]&&n<kc.length;n++)e/=kc[n],t*=kc[n];return o=o%t,o=o?t-o:t,Math.ceil(o)}var cB=function(e,t,n){var o=XP(e,n&&n.relativeDate);return KP(o,ZP(t))},YP="timeago-id";function uB(e){return e.getAttribute("datetime")}function dB(e,t){e.setAttribute(YP,t)}function JP(e){return parseInt(e.getAttribute(YP))}var Qx={},H_=function(e){clearTimeout(e),delete Qx[e]};function QP(e,t,n,o){H_(JP(e));var c=o.relativeDate,d=o.minInterval,p=XP(t,c);e.innerText=KP(p,n);var s=setTimeout(function(){QP(e,t,n,o)},Math.min(Math.max(lB(p),d||1)*1e3,2147483647));Qx[s]=0,dB(e,s)}function hT(e){e?H_(JP(e)):Object.keys(Qx).forEach(H_)}function hB(e,t,n){var o=e.length?e:[e];return o.forEach(function(c){QP(c,uB(c),ZP(t),n||{})}),o}HP("en_US",oB);HP("zh_CN",sB);var fB=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)c.hasOwnProperty(d)&&(o[d]=c[d])},e(t,n)};return function(t,n){e(t,n);function o(){this.constructor=t}t.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}(),Z_=globalThis&&globalThis.__assign||function(){return Z_=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Z_.apply(this,arguments)},pB=globalThis&&globalThis.__rest||function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,o=Object.getOwnPropertySymbols(e);c<o.length;c++)t.indexOf(o[c])<0&&Object.prototype.propertyIsEnumerable.call(e,o[c])&&(n[o[c]]=e[o[c]]);return n},mB=function(e){return""+(e instanceof Date?e.getTime():e)},gB=function(e){fB(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n.dom=null,n}return t.prototype.componentDidMount=function(){this.renderTimeAgo()},t.prototype.componentDidUpdate=function(){this.renderTimeAgo()},t.prototype.renderTimeAgo=function(){var n=this.props,o=n.live,c=n.datetime,d=n.locale,p=n.opts;hT(this.dom),o!==!1&&(this.dom.setAttribute("datetime",mB(c)),hB(this.dom,d,p))},t.prototype.componentWillUnmount=function(){hT(this.dom)},t.prototype.render=function(){var n=this,o=this.props,c=o.datetime;o.live;var d=o.locale,p=o.opts,s=pB(o,["datetime","live","locale","opts"]);return P.createElement("time",Z_({ref:function(_){n.dom=_}},s),cB(c,d,p))},t.defaultProps={live:!0,className:""},t}(P.PureComponent);const yB=({timestamp:e})=>re(gB,{datetime:e,opts:{minInterval:10}}),vB=()=>{const{nodes:e,hardware:t}=In(),n=Array.from(e.values()).filter(o=>o.num!==t.myNodeNum);return vt(Jo,{children:[re(Af,{}),re("div",{className:"w-full overflow-y-auto",children:re(rB,{headings:[{title:"",type:"blank",sortable:!1},{title:"Name",type:"normal",sortable:!0},{title:"Model",type:"normal",sortable:!0},{title:"MAC Address",type:"normal",sortable:!0},{title:"Last Heard",type:"normal",sortable:!0},{title:"SNR",type:"normal",sortable:!0}],rows:n.map(o=>[re(qc.Hashicon,{size:24,value:o.num.toString()}),re("h1",{children:o.user?.longName??(o.user?.macaddr?`Meshtastic ${uT.stringify(o.user?.macaddr.subarray(4,6)??[]).toLowerCase()}`:`UNK: ${o.num}`)}),re(qh,{children:_x[o.user?.hwModel??0]}),re(qh,{children:uT.stringify(o.user?.macaddr??[]).match(/.{1,2}/g)?.join(":")??"UNK"}),o.lastHeard===0?re("p",{children:"Never"}):re(yB,{timestamp:o.lastHeard*1e3}),vt(qh,{children:[o.snr,"db/",Math.min(Math.max((o.snr+10)*5,0),100),"%/",(o.snr+10)*5,"raw"]})])})})]})},_B=()=>{const{activePage:e}=In();return vt(Jo,{children:[e==="messages"&&re(Xz,{}),e==="map"&&re(Hz,{}),e==="config"&&re(rz,{}),e==="channels"&&re(B$,{}),e==="peers"&&re(vB,{})]})},eb=P.forwardRef((e,t)=>{const{children:n,...o}=e,c=P.Children.toArray(n),d=c.find(bB);if(d){const p=d.props.children,s=c.map(_=>_===d?P.Children.count(p)>1?P.Children.only(null):P.isValidElement(p)?p.props.children:null:_);return P.createElement(K_,Bt({},o,{ref:t}),P.isValidElement(p)?P.cloneElement(p,void 0,s):null)}return P.createElement(K_,Bt({},o,{ref:t}),n)});eb.displayName="Slot";const K_=P.forwardRef((e,t)=>{const{children:n,...o}=e;return P.isValidElement(n)?P.cloneElement(n,{...wB(o,n.props),ref:Rx(t,n.ref)}):P.Children.count(n)>1?P.Children.only(null):null});K_.displayName="SlotClone";const xB=({children:e})=>P.createElement(P.Fragment,null,e);function bB(e){return P.isValidElement(e)&&e.type===xB}function wB(e,t){const n={...t};for(const o in t){const c=e[o],d=t[o];/^on[A-Z]/.test(o)?n[o]=(...s)=>{d?.(...s),c?.(...s)}:o==="style"?n[o]={...c,...d}:o==="className"&&(n[o]=[c,d].filter(Boolean).join(" "))}return{...e,...n}}const EB=["a","button","div","h2","h3","img","li","nav","ol","p","span","svg","ul"],ig=EB.reduce((e,t)=>{const n=P.forwardRef((o,c)=>{const{asChild:d,...p}=o,s=d?eb:t;return P.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),P.createElement(s,Bt({},p,{ref:c}))});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function TB(e,t){e&&yo.flushSync(()=>e.dispatchEvent(t))}function SB(e){const t=oi(e);P.useEffect(()=>{const n=o=>{o.key==="Escape"&&t(o)};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t])}const X_="dismissableLayer.update",kB="dismissableLayer.pointerDownOutside",CB="dismissableLayer.focusOutside";let fT;const PB=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),AB=P.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:p,onDismiss:s,..._}=e,v=P.useContext(PB),[E,T]=P.useState(null),[,S]=P.useState({}),D=ar(t,Z=>T(Z)),O=Array.from(v.layers),[M]=[...v.layersWithOutsidePointerEventsDisabled].slice(-1),U=O.indexOf(M),$=E?O.indexOf(E):-1,L=v.layersWithOutsidePointerEventsDisabled.size>0,F=$>=U,J=IB(Z=>{const G=Z.target,W=[...v.branches].some(le=>le.contains(G));!F||W||(c?.(Z),p?.(Z),Z.defaultPrevented||s?.())}),V=MB(Z=>{const G=Z.target;[...v.branches].some(le=>le.contains(G))||(d?.(Z),p?.(Z),Z.defaultPrevented||s?.())});return SB(Z=>{$===v.layers.size-1&&(o?.(Z),!Z.defaultPrevented&&s&&(Z.preventDefault(),s()))}),P.useEffect(()=>{if(E)return n&&(v.layersWithOutsidePointerEventsDisabled.size===0&&(fT=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),v.layersWithOutsidePointerEventsDisabled.add(E)),v.layers.add(E),pT(),()=>{n&&v.layersWithOutsidePointerEventsDisabled.size===1&&(document.body.style.pointerEvents=fT)}},[E,n,v]),P.useEffect(()=>()=>{E&&(v.layers.delete(E),v.layersWithOutsidePointerEventsDisabled.delete(E),pT())},[E,v]),P.useEffect(()=>{const Z=()=>S({});return document.addEventListener(X_,Z),()=>document.removeEventListener(X_,Z)},[]),P.createElement(ig.div,Bt({},_,{ref:D,style:{pointerEvents:L?F?"auto":"none":void 0,...e.style},onFocusCapture:ln(e.onFocusCapture,V.onFocusCapture),onBlurCapture:ln(e.onBlurCapture,V.onBlurCapture),onPointerDownCapture:ln(e.onPointerDownCapture,J.onPointerDownCapture)}))});function IB(e){const t=oi(e),n=P.useRef(!1),o=P.useRef(()=>{});return P.useEffect(()=>{const c=p=>{if(p.target&&!n.current){let v=function(){eA(kB,t,_,{discrete:!0})};var s=v;const _={originalEvent:p};p.pointerType==="touch"?(document.removeEventListener("click",o.current),o.current=v,document.addEventListener("click",o.current,{once:!0})):v()}n.current=!1},d=window.setTimeout(()=>{document.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(d),document.removeEventListener("pointerdown",c),document.removeEventListener("click",o.current)}},[t]),{onPointerDownCapture:()=>n.current=!0}}function MB(e){const t=oi(e),n=P.useRef(!1);return P.useEffect(()=>{const o=c=>{c.target&&!n.current&&eA(CB,t,{originalEvent:c},{discrete:!1})};return document.addEventListener("focusin",o),()=>document.removeEventListener("focusin",o)},[t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function pT(){const e=new CustomEvent(X_);document.dispatchEvent(e)}function eA(e,t,n,{discrete:o}){const c=n.originalEvent.target,d=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&c.addEventListener(e,t,{once:!0}),o?TB(c,d):c.dispatchEvent(d)}const nv="focusScope.autoFocusOnMount",rv="focusScope.autoFocusOnUnmount",mT={bubbles:!1,cancelable:!0},DB=P.forwardRef((e,t)=>{const{loop:n=!1,trapped:o=!1,onMountAutoFocus:c,onUnmountAutoFocus:d,...p}=e,[s,_]=P.useState(null),v=oi(c),E=oi(d),T=P.useRef(null),S=ar(t,M=>_(M)),D=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(o){let $=function(F){if(D.paused||!s)return;const J=F.target;s.contains(J)?T.current=J:bc(T.current,{select:!0})},L=function(F){D.paused||!s||s.contains(F.relatedTarget)||bc(T.current,{select:!0})};var M=$,U=L;return document.addEventListener("focusin",$),document.addEventListener("focusout",L),()=>{document.removeEventListener("focusin",$),document.removeEventListener("focusout",L)}}},[o,s,D.paused]),P.useEffect(()=>{if(s){yT.add(D);const M=document.activeElement;if(!s.contains(M)){const $=new CustomEvent(nv,mT);s.addEventListener(nv,v),s.dispatchEvent($),$.defaultPrevented||(RB(zB(tA(s)),{select:!0}),document.activeElement===M&&bc(s))}return()=>{s.removeEventListener(nv,v),setTimeout(()=>{const $=new CustomEvent(rv,mT);s.addEventListener(rv,E),s.dispatchEvent($),$.defaultPrevented||bc(M??document.body,{select:!0}),s.removeEventListener(rv,E),yT.remove(D)},0)}}},[s,v,E,D]);const O=P.useCallback(M=>{if(!n&&!o||D.paused)return;const U=M.key==="Tab"&&!M.altKey&&!M.ctrlKey&&!M.metaKey,$=document.activeElement;if(U&&$){const L=M.currentTarget,[F,J]=LB(L);F&&J?!M.shiftKey&&$===J?(M.preventDefault(),n&&bc(F,{select:!0})):M.shiftKey&&$===F&&(M.preventDefault(),n&&bc(J,{select:!0})):$===L&&M.preventDefault()}},[n,o,D.paused]);return P.createElement(ig.div,Bt({tabIndex:-1},p,{ref:S,onKeyDown:O}))});function RB(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(bc(o,{select:t}),document.activeElement!==n)return}function LB(e){const t=tA(e),n=gT(t,e),o=gT(t.reverse(),e);return[n,o]}function tA(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const c=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||c?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function gT(e,t){for(const n of e)if(!NB(n,{upTo:t}))return n}function NB(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function OB(e){return e instanceof HTMLInputElement&&"select"in e}function bc(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&OB(e)&&t&&e.select()}}const yT=$B();function $B(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=vT(e,t),e.unshift(t)},remove(t){var n;e=vT(e,t),(n=e[0])===null||n===void 0||n.resume()}}}function vT(e,t){const n=[...e],o=n.indexOf(t);return o!==-1&&n.splice(o,1),n}function zB(e){return e.filter(t=>t.tagName!=="A")}const BB=P.forwardRef((e,t)=>{var n;const{container:o=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...c}=e;return o?Uk.createPortal(P.createElement(ig.div,Bt({},c,{ref:t})),o):null});var nA=tP(),iv=function(){},og=P.forwardRef(function(e,t){var n=P.useRef(null),o=P.useState({onScrollCapture:iv,onWheelCapture:iv,onTouchMoveCapture:iv}),c=o[0],d=o[1],p=e.forwardProps,s=e.children,_=e.className,v=e.removeScrollBar,E=e.enabled,T=e.shards,S=e.sideCar,D=e.noIsolation,O=e.inert,M=e.allowPinchZoom,U=e.as,$=U===void 0?"div":U,L=$0(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),F=S,J=eP([n,t]),V=Si(Si({},L),c);return P.createElement(P.Fragment,null,E&&P.createElement(F,{sideCar:nA,removeScrollBar:v,shards:T,noIsolation:D,inert:O,setCallbacks:d,allowPinchZoom:!!M,lockRef:n}),p?P.cloneElement(P.Children.only(s),Si(Si({},V),{ref:J})):P.createElement($,Si({},V,{className:_,ref:J}),s))});og.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};og.classNames={fullWidth:jh,zeroRight:Vh};var Y_=!1;if(typeof window<"u")try{var am=Object.defineProperty({},"passive",{get:function(){return Y_=!0,!0}});window.addEventListener("test",am,am),window.removeEventListener("test",am,am)}catch{Y_=!1}var Pu=Y_?{passive:!1}:!1,FB=function(e){var t=window.getComputedStyle(e);return t.overflowY!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowY==="visible")},UB=function(e){var t=window.getComputedStyle(e);return t.overflowX!=="hidden"&&!(t.overflowY===t.overflowX&&t.overflowX==="visible")},_T=function(e,t){var n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=rA(e,n);if(o){var c=iA(e,n),d=c[1],p=c[2];if(d>p)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},VB=function(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;return[t,n,o]},jB=function(e){var t=e.scrollLeft,n=e.scrollWidth,o=e.clientWidth;return[t,n,o]},rA=function(e,t){return e==="v"?FB(t):UB(t)},iA=function(e,t){return e==="v"?VB(t):jB(t)},GB=function(e,t){return e==="h"&&t==="rtl"?-1:1},qB=function(e,t,n,o,c){var d=GB(e,window.getComputedStyle(t).direction),p=d*o,s=n.target,_=t.contains(s),v=!1,E=p>0,T=0,S=0;do{var D=iA(e,s),O=D[0],M=D[1],U=D[2],$=M-U-d*O;(O||$)&&rA(e,s)&&(T+=$,S+=O),s=s.parentNode}while(!_&&s!==document.body||_&&(t.contains(s)||t===s));return(E&&(c&&T===0||!c&&p>T)||!E&&(c&&S===0||!c&&-p>S))&&(v=!0),v},sm=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},xT=function(e){return[e.deltaX,e.deltaY]},bT=function(e){return e&&"current"in e?e.current:e},WB=function(e,t){return e[0]===t[0]&&e[1]===t[1]},HB=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},ZB=0,Au=[];function KB(e){var t=P.useRef([]),n=P.useRef([0,0]),o=P.useRef(),c=P.useState(ZB++)[0],d=P.useState(function(){return Wx()})[0],p=P.useRef(e);P.useEffect(function(){p.current=e},[e]),P.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(c));var M=fx([e.lockRef.current],(e.shards||[]).map(bT),!0).filter(Boolean);return M.forEach(function(U){return U.classList.add("allow-interactivity-".concat(c))}),function(){document.body.classList.remove("block-interactivity-".concat(c)),M.forEach(function(U){return U.classList.remove("allow-interactivity-".concat(c))})}}},[e.inert,e.lockRef.current,e.shards]);var s=P.useCallback(function(M,U){if("touches"in M&&M.touches.length===2)return!p.current.allowPinchZoom;var $=sm(M),L=n.current,F="deltaX"in M?M.deltaX:L[0]-$[0],J="deltaY"in M?M.deltaY:L[1]-$[1],V,Z=M.target,G=Math.abs(F)>Math.abs(J)?"h":"v";if("touches"in M&&G==="h"&&Z.type==="range")return!1;var W=_T(G,Z);if(!W)return!0;if(W?V=G:(V=G==="v"?"h":"v",W=_T(G,Z)),!W)return!1;if(!o.current&&"changedTouches"in M&&(F||J)&&(o.current=V),!V)return!0;var le=o.current||V;return qB(le,U,M,le==="h"?F:J,!0)},[]),_=P.useCallback(function(M){var U=M;if(!(!Au.length||Au[Au.length-1]!==d)){var $="deltaY"in U?xT(U):sm(U),L=t.current.filter(function(V){return V.name===U.type&&V.target===U.target&&WB(V.delta,$)})[0];if(L&&L.should){U.preventDefault();return}if(!L){var F=(p.current.shards||[]).map(bT).filter(Boolean).filter(function(V){return V.contains(U.target)}),J=F.length>0?s(U,F[0]):!p.current.noIsolation;J&&U.preventDefault()}}},[]),v=P.useCallback(function(M,U,$,L){var F={name:M,delta:U,target:$,should:L};t.current.push(F),setTimeout(function(){t.current=t.current.filter(function(J){return J!==F})},1)},[]),E=P.useCallback(function(M){n.current=sm(M),o.current=void 0},[]),T=P.useCallback(function(M){v(M.type,xT(M),M.target,s(M,e.lockRef.current))},[]),S=P.useCallback(function(M){v(M.type,sm(M),M.target,s(M,e.lockRef.current))},[]);P.useEffect(function(){return Au.push(d),e.setCallbacks({onScrollCapture:T,onWheelCapture:T,onTouchMoveCapture:S}),document.addEventListener("wheel",_,Pu),document.addEventListener("touchmove",_,Pu),document.addEventListener("touchstart",E,Pu),function(){Au=Au.filter(function(M){return M!==d}),document.removeEventListener("wheel",_,Pu),document.removeEventListener("touchmove",_,Pu),document.removeEventListener("touchstart",E,Pu)}},[]);var D=e.removeScrollBar,O=e.inert;return P.createElement(P.Fragment,null,O?P.createElement(d,{styles:HB(c)}):null,D?P.createElement(oP,{gapMode:"margin"}):null)}const XB=rP(nA,KB);var oA=P.forwardRef(function(e,t){return P.createElement(og,Si({},e,{ref:t,sideCar:XB}))});oA.classNames=og.classNames;const YB=oA,aA="Dialog",[sA,mU]=Ka(aA),[JB,Wc]=sA(aA),QB=e=>{const{__scopeDialog:t,children:n,open:o,defaultOpen:c,onOpenChange:d,modal:p=!0}=e,s=P.useRef(null),_=P.useRef(null),[v=!1,E]=Ns({prop:o,defaultProp:c,onChange:d});return P.createElement(JB,{scope:t,triggerRef:s,contentRef:_,contentId:Wa(),titleId:Wa(),descriptionId:Wa(),open:v,onOpenChange:E,onOpenToggle:P.useCallback(()=>E(T=>!T),[E]),modal:p},n)},lA="DialogPortal",[eF,cA]=sA(lA,{forceMount:void 0}),tF=e=>{const{__scopeDialog:t,forceMount:n,children:o,container:c}=e,d=Wc(lA,t);return P.createElement(eF,{scope:t,forceMount:n},P.Children.map(o,p=>P.createElement(Xa,{present:n||d.open},P.createElement(BB,{asChild:!0,container:c},p))))},J_="DialogOverlay",nF=P.forwardRef((e,t)=>{const n=cA(J_,e.__scopeDialog),{forceMount:o=n.forceMount,...c}=e,d=Wc(J_,e.__scopeDialog);return d.modal?P.createElement(Xa,{present:o||d.open},P.createElement(rF,Bt({},c,{ref:t}))):null}),rF=P.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,c=Wc(J_,n);return P.createElement(YB,{as:eb,allowPinchZoom:!0,shards:[c.contentRef]},P.createElement(ig.div,Bt({"data-state":dA(c.open)},o,{ref:t,style:{pointerEvents:"auto",...o.style}})))}),yf="DialogContent",iF=P.forwardRef((e,t)=>{const n=cA(yf,e.__scopeDialog),{forceMount:o=n.forceMount,...c}=e,d=Wc(yf,e.__scopeDialog);return P.createElement(Xa,{present:o||d.open},d.modal?P.createElement(oF,Bt({},c,{ref:t})):P.createElement(aF,Bt({},c,{ref:t})))}),oF=P.forwardRef((e,t)=>{const n=Wc(yf,e.__scopeDialog),o=P.useRef(null),c=ar(t,n.contentRef,o);return P.useEffect(()=>{const d=o.current;if(d)return qx(d)},[]),P.createElement(uA,Bt({},e,{ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ln(e.onCloseAutoFocus,d=>{var p;d.preventDefault(),(p=n.triggerRef.current)===null||p===void 0||p.focus()}),onPointerDownOutside:ln(e.onPointerDownOutside,d=>{const p=d.detail.originalEvent,s=p.button===0&&p.ctrlKey===!0;(p.button===2||s)&&d.preventDefault()}),onFocusOutside:ln(e.onFocusOutside,d=>d.preventDefault())}))}),aF=P.forwardRef((e,t)=>{const n=Wc(yf,e.__scopeDialog),o=P.useRef(!1);return P.createElement(uA,Bt({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d;if((d=e.onCloseAutoFocus)===null||d===void 0||d.call(e,c),!c.defaultPrevented){var p;o.current||(p=n.triggerRef.current)===null||p===void 0||p.focus(),c.preventDefault()}o.current=!1},onInteractOutside:c=>{var d,p;(d=e.onInteractOutside)===null||d===void 0||d.call(e,c),c.defaultPrevented||(o.current=!0);const s=c.target;((p=n.triggerRef.current)===null||p===void 0?void 0:p.contains(s))&&c.preventDefault()}}))}),uA=P.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:o,onOpenAutoFocus:c,onCloseAutoFocus:d,...p}=e,s=Wc(yf,n),_=P.useRef(null),v=ar(t,_);return Bx(),P.createElement(P.Fragment,null,P.createElement(DB,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:c,onUnmountAutoFocus:d},P.createElement(AB,Bt({role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":dA(s.open)},p,{ref:v,onDismiss:()=>s.onOpenChange(!1)}))),!1)});function dA(e){return e?"open":"closed"}const sF=QB,lF=tF,cF=nF,uF=iF;var wT=1,dF=.9,hF=.3,ov=.1,fF=0,av=.999,pF=.9999,mF=.99,ET=/[\\\/\-_+.# \t"@\[\(\{&]/,gF=/[\\\/\-_+.# \t"@\[\(\{&]/g;function Q_(e,t,n,o,c,d){if(d===t.length)return c===e.length?wT:mF;for(var p=o.charAt(d),s=n.indexOf(p,c),_=0,v,E,T;s>=0;)v=Q_(e,t,n,o,s+1,d+1),v>_&&(s===c?v*=wT:ET.test(e.charAt(s-1))?(v*=dF,T=e.slice(c,s-1).match(gF),T&&c>0&&(v*=Math.pow(av,T.length))):ET.test(e.slice(c,s-1))?(v*=fF,c>0&&(v*=Math.pow(av,s-c))):(v*=hF,c>0&&(v*=Math.pow(av,s-c))),e.charAt(s)!==t.charAt(d)&&(v*=pF)),v<ov&&n.charAt(s-1)===o.charAt(d+1)&&n.charAt(s-1)!==o.charAt(d)&&(E=Q_(e,t,n,o,s+1,d+2),E*ov>v&&(v=E*ov)),v>_&&(_=v),s=n.indexOf(p,s+1);return _}function yF(e,t){return Q_(e,t,e.toLowerCase(),t.toLowerCase(),0,0)}var vF=yF,_F='[cmdk-list-sizer=""]',Eh='[cmdk-group=""]',sv='[cmdk-group-items=""]',xF='[cmdk-group-heading=""]',hA='[cmdk-item=""]',TT=`${hA}:not([aria-disabled="true"])`,e1="cmdk-item-select",fl="data-value",bF=(e,t)=>vF(e,t),fA=P.createContext(void 0),$f=()=>P.useContext(fA),pA=P.createContext(void 0),tb=()=>P.useContext(pA),mA=P.createContext(void 0),gA=P.forwardRef((e,t)=>{let n=P.useRef(null),o=Mu(()=>({search:"",value:"",filtered:{count:0,items:new Map,groups:new Set}})),c=Mu(()=>new Set),d=Mu(()=>new Map),p=Mu(()=>new Map),s=Mu(()=>new Set),_=yA(e),{label:v,children:E,value:T,onValueChange:S,filter:D,shouldFilter:O,...M}=e,U=P.useId(),$=P.useId(),L=P.useId(),F=DF();Sd(()=>{if(T!==void 0){let Ae=T.trim().toLowerCase();o.current.value=Ae,F(6,Ie),J.emit()}},[T]);let J=P.useMemo(()=>({subscribe:Ae=>(s.current.add(Ae),()=>s.current.delete(Ae)),snapshot:()=>o.current,setState:(Ae,He,ft)=>{var Qe,Rt,zt;if(!Object.is(o.current[Ae],He)){if(o.current[Ae]=He,Ae==="search")le(),G(),F(1,W);else if(Ae==="value")if(((Qe=_.current)==null?void 0:Qe.value)!==void 0){(zt=(Rt=_.current).onValueChange)==null||zt.call(Rt,He);return}else ft||F(5,Ie);J.emit()}},emit:()=>{s.current.forEach(Ae=>Ae())}}),[]),V=P.useMemo(()=>({value:(Ae,He)=>{He!==p.current.get(Ae)&&(p.current.set(Ae,He),o.current.filtered.items.set(Ae,Z(He)),F(2,()=>{G(),J.emit()}))},item:(Ae,He)=>(c.current.add(Ae),He&&(d.current.has(He)?d.current.get(He).add(Ae):d.current.set(He,new Set([Ae]))),F(3,()=>{le(),G(),o.current.value||W(),J.emit()}),()=>{p.current.delete(Ae),c.current.delete(Ae),o.current.filtered.items.delete(Ae),F(4,()=>{le(),W(),J.emit()})}),group:Ae=>(d.current.has(Ae)||d.current.set(Ae,new Set),()=>{p.current.delete(Ae),d.current.delete(Ae)}),filter:()=>_.current.shouldFilter,label:v||e["aria-label"],listId:U,inputId:L,labelId:$}),[]);function Z(Ae){var He;let ft=((He=_.current)==null?void 0:He.filter)??bF;return Ae?ft(Ae,o.current.search):0}function G(){if(!n.current||!o.current.search||_.current.shouldFilter===!1)return;let Ae=o.current.filtered.items,He=[];o.current.filtered.groups.forEach(Qe=>{let Rt=d.current.get(Qe),zt=0;Rt.forEach(X=>{let tt=Ae.get(X);zt=Math.max(tt,zt)}),He.push([Qe,zt])});let ft=n.current.querySelector(_F);de().sort((Qe,Rt)=>{let zt=Qe.getAttribute(fl),X=Rt.getAttribute(fl);return(Ae.get(X)??0)-(Ae.get(zt)??0)}).forEach(Qe=>{let Rt=Qe.closest(sv);Rt?Rt.appendChild(Qe.parentElement===Rt?Qe:Qe.closest(`${sv} > *`)):ft.appendChild(Qe.parentElement===ft?Qe:Qe.closest(`${sv} > *`))}),He.sort((Qe,Rt)=>Rt[1]-Qe[1]).forEach(Qe=>{let Rt=n.current.querySelector(`${Eh}[${fl}="${Qe[0]}"]`);Rt?.parentElement.appendChild(Rt)})}function W(){let Ae=de().find(ft=>!ft.ariaDisabled),He=Ae?.getAttribute(fl);J.setState("value",He||void 0)}function le(){if(!o.current.search||_.current.shouldFilter===!1){o.current.filtered.count=c.current.size;return}o.current.filtered.groups=new Set;let Ae=0;for(let He of c.current){let ft=p.current.get(He),Qe=Z(ft);o.current.filtered.items.set(He,Qe),Qe>0&&Ae++}for(let[He,ft]of d.current)for(let Qe of ft)if(o.current.filtered.items.get(Qe)>0){o.current.filtered.groups.add(He);break}o.current.filtered.count=Ae}function Ie(){var Ae,He,ft;let Qe=be();Qe&&(((Ae=Qe.parentElement)==null?void 0:Ae.firstChild)===Qe&&((ft=(He=Qe.closest(Eh))==null?void 0:He.querySelector(xF))==null||ft.scrollIntoView({block:"nearest"})),Qe.scrollIntoView({block:"nearest"}))}function be(){return n.current.querySelector(`${hA}[aria-selected="true"]`)}function de(){return Array.from(n.current.querySelectorAll(TT))}function Ne(Ae){let He=de()[Ae];He&&J.setState("value",He.getAttribute(fl))}function Ee(Ae){var He;let ft=be(),Qe=de(),Rt=Qe.findIndex(X=>X===ft),zt=Qe[Rt+Ae];(He=_.current)!=null&&He.loop&&(zt=Rt+Ae<0?Qe[Qe.length-1]:Rt+Ae===Qe.length?Qe[0]:Qe[Rt+Ae]),zt&&J.setState("value",zt.getAttribute(fl))}function Oe(Ae){let He=be(),ft=He?.closest(Eh),Qe;for(;ft&&!Qe;)ft=Ae>0?IF(ft,Eh):MF(ft,Eh),Qe=ft?.querySelector(TT);Qe?J.setState("value",Qe.getAttribute(fl)):Ee(Ae)}let ze=()=>Ne(de().length-1),rt=Ae=>{Ae.preventDefault(),Ae.metaKey?ze():Ae.altKey?Oe(1):Ee(1)},We=Ae=>{Ae.preventDefault(),Ae.metaKey?Ne(0):Ae.altKey?Oe(-1):Ee(-1)};return P.createElement("div",{ref:zf([n,t]),...M,"cmdk-root":"",onKeyDown:Ae=>{var He;if((He=M.onKeyDown)==null||He.call(M,Ae),!Ae.defaultPrevented)switch(Ae.key){case"n":case"j":{Ae.ctrlKey&&rt(Ae);break}case"ArrowDown":{rt(Ae);break}case"p":case"k":{Ae.ctrlKey&&We(Ae);break}case"ArrowUp":{We(Ae);break}case"Home":{Ae.preventDefault(),Ne(0);break}case"End":{Ae.preventDefault(),ze();break}case"Enter":{Ae.preventDefault();let ft=be();if(ft){let Qe=new Event(e1);ft.dispatchEvent(Qe)}}}}},P.createElement("label",{"cmdk-label":"",htmlFor:V.inputId,id:V.labelId,style:RF},v),P.createElement(pA.Provider,{value:J},P.createElement(fA.Provider,{value:V},E)))}),wF=P.forwardRef((e,t)=>{let n=P.useId(),o=P.useRef(null),c=P.useContext(mA),d=$f(),p=yA(e);Sd(()=>d.item(n,c),[]);let s=vA(n,o,[e.value,e.children,o]),_=tb(),v=$c($=>$.value&&$.value===s.current),E=$c($=>d.filter()===!1?!0:$.search?$.filtered.items.get(n)>0:!0);P.useEffect(()=>{let $=o.current;if(!(!$||e.disabled))return $.addEventListener(e1,T),()=>$.removeEventListener(e1,T)},[E,e.onSelect,e.disabled]);function T(){var $,L;(L=($=p.current).onSelect)==null||L.call($,s.current)}function S(){_.setState("value",s.current,!0)}if(!E)return null;let{disabled:D,value:O,onSelect:M,...U}=e;return P.createElement("div",{ref:zf([o,t]),...U,"cmdk-item":"",role:"option","aria-disabled":D||void 0,"aria-selected":v||void 0,"data-selected":v||void 0,onPointerMove:D?void 0:S,onClick:D?void 0:T},e.children)}),EF=P.forwardRef((e,t)=>{let{heading:n,children:o,...c}=e,d=P.useId(),p=P.useRef(null),s=P.useRef(null),_=P.useId(),v=$f(),E=$c(S=>v.filter()===!1?!0:S.search?S.filtered.groups.has(d):!0);Sd(()=>v.group(d),[]),vA(d,p,[e.value,e.heading,s]);let T=P.createElement(mA.Provider,{value:d},o);return P.createElement("div",{ref:zf([p,t]),...c,"cmdk-group":"",role:"presentation",hidden:E?void 0:!0},n&&P.createElement("div",{ref:s,"cmdk-group-heading":"","aria-hidden":!0,id:_},n),P.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?_:void 0},T))}),TF=P.forwardRef((e,t)=>{let{alwaysRender:n,...o}=e,c=P.useRef(null),d=$c(p=>!p.search);return!n&&!d?null:P.createElement("div",{ref:zf([c,t]),...o,"cmdk-separator":"",role:"separator"})}),SF=P.forwardRef((e,t)=>{let{onValueChange:n,...o}=e,c=e.value!=null,d=tb(),p=$c(_=>_.search),s=$f();return P.useEffect(()=>{e.value!=null&&d.setState("search",e.value)},[e.value]),P.createElement("input",{ref:t,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":s.listId,"aria-labelledby":s.labelId,id:s.inputId,type:"text",value:c?e.value:p,onChange:_=>{c||d.setState("search",_.target.value),n?.(_.target.value)}})}),kF=P.forwardRef((e,t)=>{let{children:n,...o}=e,c=P.useRef(null),d=P.useRef(null),p=$f();return P.useEffect(()=>{if(d.current&&c.current){let s=d.current,_=c.current,v,E=new ResizeObserver(()=>{v=requestAnimationFrame(()=>{let T=s.getBoundingClientRect().height;_.style.setProperty("--cmdk-list-height",T.toFixed(1)+"px")})});return E.observe(s),()=>{cancelAnimationFrame(v),E.unobserve(s)}}},[]),P.createElement("div",{ref:zf([c,t]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:p.listId,"aria-labelledby":p.inputId},P.createElement("div",{ref:d,"cmdk-list-sizer":""},n))}),CF=P.forwardRef((e,t)=>{let{open:n,onOpenChange:o,container:c,...d}=e;return P.createElement(sF,{open:n,onOpenChange:o},P.createElement(lF,{container:c},P.createElement(cF,{"cmdk-overlay":""}),P.createElement(uF,{"aria-label":e.label,"cmdk-dialog":""},P.createElement(gA,{ref:t,...d}))))}),PF=P.forwardRef((e,t)=>{let n=P.useRef(!0),o=$c(c=>c.filtered.count===0);return P.useEffect(()=>{n.current=!1},[]),n.current||!o?null:P.createElement("div",{ref:t,...e,"cmdk-empty":"",role:"presentation"})}),AF=P.forwardRef((e,t)=>{let{progress:n,children:o,...c}=e;return P.createElement("div",{ref:t,...c,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},P.createElement("div",{"aria-hidden":!0},o))}),vo=Object.assign(gA,{List:kF,Item:wF,Input:SF,Group:EF,Separator:TF,Dialog:CF,Empty:PF,Loading:AF});function IF(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function MF(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function yA(e){let t=P.useRef(e);return Sd(()=>{t.current=e}),t}var Sd=typeof window>"u"?P.useEffect:P.useLayoutEffect;function Mu(e){let t=P.useRef();return t.current===void 0&&(t.current=e()),t}function zf(e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}function $c(e){let t=tb(),n=()=>e(t.snapshot());return P.useSyncExternalStore(t.subscribe,n,n)}function vA(e,t,n){let o=P.useRef(),c=$f();return Sd(()=>{var d;let p=(()=>{var s;for(let _ of n){if(typeof _=="string")return _.trim().toLowerCase();if(typeof _=="object"&&"current"in _&&_.current)return(s=_.current.textContent)==null?void 0:s.trim().toLowerCase()}})();c.value(e,p),(d=t.current)==null||d.setAttribute(fl,p),o.current=p}),o}var DF=()=>{let[e,t]=P.useState(),n=Mu(()=>new Map);return Sd(()=>{n.current.forEach(o=>o()),n.current=new Map},[e]),(o,c)=>{n.current.set(o,c),t({})}},RF={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const _A="Dialog",[xA,gU]=Ka(_A),[LF,Ya]=xA(_A),NF=e=>{const{__scopeDialog:t,children:n,open:o,defaultOpen:c,onOpenChange:d,modal:p=!0}=e,s=P.useRef(null),_=P.useRef(null),[v=!1,E]=Ns({prop:o,defaultProp:c,onChange:d});return P.createElement(LF,{scope:t,triggerRef:s,contentRef:_,contentId:Wa(),titleId:Wa(),descriptionId:Wa(),open:v,onOpenChange:E,onOpenToggle:P.useCallback(()=>E(T=>!T),[E]),modal:p},n)},bA="DialogPortal",[OF,wA]=xA(bA,{forceMount:void 0}),$F=e=>{const{__scopeDialog:t,forceMount:n,children:o,container:c}=e,d=Ya(bA,t);return P.createElement(OF,{scope:t,forceMount:n},P.Children.map(o,p=>P.createElement(Xa,{present:n||d.open},P.createElement(jx,{asChild:!0,container:c},p))))},t1="DialogOverlay",zF=P.forwardRef((e,t)=>{const n=wA(t1,e.__scopeDialog),{forceMount:o=n.forceMount,...c}=e,d=Ya(t1,e.__scopeDialog);return d.modal?P.createElement(Xa,{present:o||d.open},P.createElement(BF,Bt({},c,{ref:t}))):null}),BF=P.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,c=Ya(t1,n);return P.createElement(uP,{as:md,allowPinchZoom:!0,shards:[c.contentRef]},P.createElement(Tn.div,Bt({"data-state":TA(c.open)},o,{ref:t,style:{pointerEvents:"auto",...o.style}})))}),vf="DialogContent",FF=P.forwardRef((e,t)=>{const n=wA(vf,e.__scopeDialog),{forceMount:o=n.forceMount,...c}=e,d=Ya(vf,e.__scopeDialog);return P.createElement(Xa,{present:o||d.open},d.modal?P.createElement(UF,Bt({},c,{ref:t})):P.createElement(VF,Bt({},c,{ref:t})))}),UF=P.forwardRef((e,t)=>{const n=Ya(vf,e.__scopeDialog),o=P.useRef(null),c=ar(t,n.contentRef,o);return P.useEffect(()=>{const d=o.current;if(d)return qx(d)},[]),P.createElement(EA,Bt({},e,{ref:c,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ln(e.onCloseAutoFocus,d=>{var p;d.preventDefault(),(p=n.triggerRef.current)===null||p===void 0||p.focus()}),onPointerDownOutside:ln(e.onPointerDownOutside,d=>{const p=d.detail.originalEvent,s=p.button===0&&p.ctrlKey===!0;(p.button===2||s)&&d.preventDefault()}),onFocusOutside:ln(e.onFocusOutside,d=>d.preventDefault())}))}),VF=P.forwardRef((e,t)=>{const n=Ya(vf,e.__scopeDialog),o=P.useRef(!1);return P.createElement(EA,Bt({},e,{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var d;if((d=e.onCloseAutoFocus)===null||d===void 0||d.call(e,c),!c.defaultPrevented){var p;o.current||(p=n.triggerRef.current)===null||p===void 0||p.focus(),c.preventDefault()}o.current=!1},onInteractOutside:c=>{var d,p;(d=e.onInteractOutside)===null||d===void 0||d.call(e,c),c.defaultPrevented||(o.current=!0);const s=c.target;((p=n.triggerRef.current)===null||p===void 0?void 0:p.contains(s))&&c.preventDefault()}}))}),EA=P.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:o,onOpenAutoFocus:c,onCloseAutoFocus:d,...p}=e,s=Ya(vf,n),_=P.useRef(null),v=ar(t,_);return Bx(),P.createElement(P.Fragment,null,P.createElement(z3,{asChild:!0,loop:!0,trapped:o,onMountAutoFocus:c,onUnmountAutoFocus:d},P.createElement(zx,Bt({role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":TA(s.open)},p,{ref:v,onDismiss:()=>s.onOpenChange(!1)}))),!1)}),jF="DialogTitle",GF=P.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,c=Ya(jF,n);return P.createElement(Tn.h2,Bt({id:c.titleId},o,{ref:t}))}),qF="DialogDescription",WF=P.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,c=Ya(qF,n);return P.createElement(Tn.p,Bt({id:c.descriptionId},o,{ref:t}))}),HF="DialogClose",ZF=P.forwardRef((e,t)=>{const{__scopeDialog:n,...o}=e,c=Ya(HF,n);return P.createElement(Tn.button,Bt({type:"button"},o,{ref:t,onClick:ln(e.onClick,()=>c.onOpenChange(!1))}))});function TA(e){return e?"open":"closed"}const KF=NF,SA=$F,kA=zF,CA=FF,PA=GF,AA=WF,XF=ZF,Hc=KF,IA=({className:e,children:t,...n})=>re(SA,{className:En(e),...n,children:re("div",{className:"fixed inset-0 z-50 flex items-start justify-center sm:items-center",children:t})});IA.displayName=SA.displayName;const MA=P.forwardRef(({className:e,children:t,...n},o)=>re(kA,{className:En("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm transition-opacity animate-in fade-in",e),...n,ref:o}));MA.displayName=kA.displayName;const zl=P.forwardRef(({className:e,children:t,...n},o)=>vt(IA,{children:[re(MA,{}),vt(CA,{ref:o,className:En("fixed z-50 grid w-full scale-100 gap-4 bg-white p-6 opacity-100 animate-in fade-in-90 slide-in-from-bottom-10 sm:max-w-lg sm:rounded-lg sm:zoom-in-90 sm:slide-in-from-bottom-0","dark:bg-slate-900",e),...n,children:[t,vt(XF,{className:"absolute top-4 right-4 rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900 dark:data-[state=open]:bg-slate-800",children:[re(a3,{className:"h-4 w-4"}),re("span",{className:"sr-only",children:"Close"})]})]})]}));zl.displayName=CA.displayName;const Zc=({className:e,...t})=>re("div",{className:En("flex flex-col space-y-2 text-center sm:text-left",e),...t});Zc.displayName="DialogHeader";const ag=({className:e,...t})=>re("div",{className:En("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ag.displayName="DialogFooter";const Kc=P.forwardRef(({className:e,...t},n)=>re(PA,{ref:n,className:En("text-lg font-semibold text-slate-900","dark:text-slate-50",e),...t}));Kc.displayName=PA.displayName;const kd=P.forwardRef(({className:e,...t},n)=>re(AA,{ref:n,className:En("text-sm text-slate-500","dark:text-slate-400",e),...t}));kd.displayName=AA.displayName;const DA=P.forwardRef(({className:e,...t},n)=>re(vo,{ref:n,className:En("flex h-full w-full flex-col overflow-hidden rounded-lg bg-white dark:bg-slate-800",e),...t}));DA.displayName=vo.displayName;const YF=({children:e,...t})=>re(Hc,{...t,children:re(zl,{className:"overflow-hidden p-0 shadow-2xl [&_[dialog-overlay]]:bg-red-100",children:re(DA,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-slate-500 [&_[cmdk-group]]:px-2 [&_[cmdk-group]_+[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:e})})}),RA=P.forwardRef(({className:e,...t},n)=>vt("div",{className:"flex items-center border-b border-b-slate-100 px-4 dark:border-b-slate-700","cmdk-input-wrapper":"",children:[re(mR,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),re(vo.Input,{ref:n,className:En("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-slate-400 disabled:cursor-not-allowed disabled:opacity-50 dark:text-slate-50",e),...t})]}));RA.displayName=vo.Input.displayName;const LA=P.forwardRef(({className:e,...t},n)=>re(vo.List,{ref:n,className:En("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));LA.displayName=vo.List.displayName;const NA=P.forwardRef((e,t)=>re(vo.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));NA.displayName=vo.Empty.displayName;const OA=P.forwardRef(({className:e,...t},n)=>re(vo.Group,{ref:n,className:En("overflow-hidden py-3 px-2 text-slate-700 dark:text-slate-400 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:pb-1.5 [&_[cmdk-group-heading]]:text-sm [&_[cmdk-group-heading]]:font-semibold [&_[cmdk-group-heading]]:text-slate-900 [&_[cmdk-group-heading]]:dark:text-slate-300",e),...t}));OA.displayName=vo.Group.displayName;const JF=P.forwardRef(({className:e,...t},n)=>re(vo.Separator,{ref:n,className:En("-mx-1 h-px bg-slate-100 dark:bg-slate-700",e),...t}));JF.displayName=vo.Separator.displayName;const nb=P.forwardRef(({className:e,...t},n)=>re(vo.Item,{ref:n,className:En("relative flex cursor-default select-none items-center rounded-md py-1.5 px-2 text-sm font-medium outline-none aria-selected:bg-slate-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 dark:aria-selected:bg-slate-700",e),...t}));nb.displayName=vo.Item.displayName;const QF=()=>{const{commandPaletteOpen:e,setCommandPaletteOpen:t,setSelectedDevice:n,removeDevice:o,selectedDevice:c,darkMode:d,setDarkMode:p,setAccent:s}=$s(),{getDevices:_}=Uc(),{setDialogOpen:v,setActivePage:E,connection:T}=In(),S=[{label:"Goto",icon:cR,commands:[{label:"Messages",icon:r3,action(){E("messages")}},{label:"Map",icon:n3,action(){E("map")}},{label:"Config",icon:Ex,action(){E("config")},tags:["settings"]},{label:"Channels",icon:t3,action(){E("channels")}},{label:"Peers",icon:Tx,action(){E("peers")}}]},{label:"Manage",icon:yR,commands:[{label:"Switch Node",icon:HD,subItems:_().map(D=>({label:D.nodes.get(D.hardware.myNodeNum)?.user?.longName??D.hardware.myNodeNum.toString(),icon:re(qc.Hashicon,{size:16,value:D.hardware.myNodeNum.toString()}),action(){n(D.id)}}))},{label:"Connect New Node",icon:wx,action(){n(0)}}]},{label:"Contextual",icon:JC,commands:[{label:"QR Code",icon:Tm,subItems:[{label:"Generator",icon:re(Tm,{size:16}),action(){v("QR",!0)}},{label:"Import",icon:re(Tm,{size:16}),action(){v("import",!0)}}]},{label:"Disconnect",icon:wR,action(){T?.disconnect(),n(0),o(c??0)}},{label:"Schedule Shutdown",icon:o3,action(){v("shutdown",!0)}},{label:"Schedule Reboot",icon:S_,action(){v("reboot",!0)}},{label:"Reset Peers",icon:xR,action(){T?.resetPeers()}},{label:"Factory Reset",icon:nR,action(){T?.factoryReset()}}]},{label:"Debug",icon:XD,commands:[{label:"Reconfigure",icon:S_,action(){T?.configure()}},{label:"[WIP] Clear Messages",icon:tR,action(){alert("This feature is not implemented")}}]},{label:"Application",icon:lR,commands:[{label:"Toggle Dark Mode",icon:i3,action(){p(!d)}},{label:"Accent Color",icon:fR,subItems:[{label:"Red",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#f25555]":"bg-[#f28585]"}`}),action(){s("red")}},{label:"Orange",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#e1720b]":"bg-[#edb17a]"}`}),action(){s("orange")}},{label:"Yellow",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#ac8c1a]":"bg-[#e0cc87]"}`}),action(){s("yellow")}},{label:"Green",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#27a341]":"bg-[#8bc9c5]"}`}),action(){s("green")}},{label:"Blue",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#2093fe]":"bg-[#70afea]"}`}),action(){s("blue")}},{label:"Purple",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#926bff]":"bg-[#a09eef]"}`}),action(){s("purple")}},{label:"Pink",icon:re("span",{className:`h-3 w-3 rounded-full ${d?"bg-[#e454c4]":"bg-[#dba0c7]"}`}),action(){s("pink")}}]}]}];return P.useEffect(()=>{const D=O=>{O.key==="k"&&(O.metaKey||O.ctrlKey)&&(O.preventDefault(),t(!0))};return window.addEventListener("keydown",D),()=>window.removeEventListener("keydown",D)},[]),vt(YF,{open:e,onOpenChange:t,children:[re(RA,{placeholder:"Type a command or search..."}),vt(LA,{children:[re(NA,{children:"No results found."}),S.map((D,O)=>re(OA,{heading:D.label,children:D.commands.map((M,U)=>vt("div",{children:[vt(nb,{onSelect:()=>{M.action&&M.action(),t(!1)},children:[re(M.icon,{size:16,className:"mr-2"}),M.label]}),M.subItems&&M.subItems.map(($,L)=>re(e7,{label:$.label,icon:$.icon,action:$.action},L))]},U))},O))]})]})},e7=({label:e,icon:t,action:n})=>$c(c=>c.search)?vt(nb,{onSelect:n,children:[t,e]}):null,n1="horizontal",t7=["horizontal","vertical"],$A=P.forwardRef((e,t)=>{const{decorative:n,orientation:o=n1,...c}=e,d=zA(o)?o:n1,s=n?{role:"none"}:{"aria-orientation":d==="vertical"?d:void 0,role:"separator"};return P.createElement(Tn.div,Bt({"data-orientation":d},s,c,{ref:t}))});$A.propTypes={orientation(e,t,n){const o=e[t],c=String(o);return o&&!zA(o)?new Error(n7(c,n)):null}};function n7(e,t){return`Invalid prop \`orientation\` of value \`${e}\` supplied to \`${t}\`, expected one of:
  - horizontal
  - vertical

Defaulting to \`${n1}\`.`}function zA(e){return t7.includes(e)}const BA=$A,y0=P.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...o},c)=>re(BA,{ref:c,decorative:n,orientation:t,className:En("bg-slate-200 dark:bg-slate-700",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...o}));y0.displayName=BA.displayName;const r7=({children:e})=>re("code",{className:"relative rounded bg-slate-100 py-[0.2rem] px-[0.3rem] font-mono text-sm font-semibold text-slate-900 dark:bg-slate-800 dark:text-slate-400",children:e}),ST=({active:e,onClick:t,children:n})=>vt("li",{className:"aspect-w-1 aspect-h-1 relative w-full",onClick:t,children:[e&&re("div",{className:"absolute -left-2 h-10 w-1.5 rounded-full bg-accent"}),re("div",{className:"flex aspect-square cursor-pointer flex-col items-center justify-center",children:n})]}),i7=()=>{const{getDevices:e}=Uc(),{selectedDevice:t,setSelectedDevice:n,darkMode:o,setDarkMode:c,setCommandPaletteOpen:d,setConnectDialogOpen:p}=$s();return vt("nav",{className:"flex flex-col justify-between border-r-[0.5px] border-slate-300 bg-transparent pt-2 dark:border-slate-700",children:[re("div",{className:"flex flex-col overflow-y-hidden",children:vt("ul",{className:"flex w-20 grow flex-col items-center space-y-4 bg-transparent py-4 px-5",children:[re(ST,{active:t===0,onClick:()=>{n(0)},children:re(iR,{})}),e().map(s=>re(ST,{onClick:()=>{n(s.id)},active:t===s.id,children:re(qc.Hashicon,{size:24,value:s.hardware.myNodeNum.toString()})},s.id)),re(y0,{}),re("button",{onClick:()=>p(!0),className:"transition-all duration-300 hover:text-accent",children:re(wx,{})})]})}),vt("div",{className:"flex w-20 flex-col items-center space-y-5 bg-transparent px-5 pb-5",children:[re("button",{className:"transition-all hover:text-accent",onClick:()=>c(!o),children:o?re(vR,{}):re(i3,{})}),re("button",{className:"transition-all hover:text-accent",onClick:()=>d(!0),children:re(_R,{})}),re("button",{className:"transition-all hover:text-accent",children:re(sR,{})}),re(y0,{}),re(r7,{children:"a284502"})]})]})};var rb={},v0={},o7={get exports(){return v0},set exports(e){v0=e}};(function(e,t){var n=200,o="__lodash_hash_undefined__",c=1,d=2,p=9007199254740991,s="[object Arguments]",_="[object Array]",v="[object AsyncFunction]",E="[object Boolean]",T="[object Date]",S="[object Error]",D="[object Function]",O="[object GeneratorFunction]",M="[object Map]",U="[object Number]",$="[object Null]",L="[object Object]",F="[object Promise]",J="[object Proxy]",V="[object RegExp]",Z="[object Set]",G="[object String]",W="[object Symbol]",le="[object Undefined]",Ie="[object WeakMap]",be="[object ArrayBuffer]",de="[object DataView]",Ne="[object Float32Array]",Ee="[object Float64Array]",Oe="[object Int8Array]",ze="[object Int16Array]",rt="[object Int32Array]",We="[object Uint8Array]",Ae="[object Uint8ClampedArray]",He="[object Uint16Array]",ft="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Rt=/^\[object .+?Constructor\]$/,zt=/^(?:0|[1-9]\d*)$/,X={};X[Ne]=X[Ee]=X[Oe]=X[ze]=X[rt]=X[We]=X[Ae]=X[He]=X[ft]=!0,X[s]=X[_]=X[be]=X[E]=X[de]=X[T]=X[S]=X[D]=X[M]=X[U]=X[L]=X[V]=X[Z]=X[G]=X[Ie]=!1;var tt=typeof pi=="object"&&pi&&pi.Object===Object&&pi,je=typeof self=="object"&&self&&self.Object===Object&&self,ve=tt||je||Function("return this")(),ke=t&&!t.nodeType&&t,we=ke&&!0&&e&&!e.nodeType&&e,De=we&&we.exports===ke,Pe=De&&tt.process,lt=function(){try{return Pe&&Pe.binding&&Pe.binding("util")}catch{}}(),dt=lt&&lt.isTypedArray;function ue(he,Me){for(var pt=-1,Ft=he==null?0:he.length,Nn=0,sn=[];++pt<Ft;){var Xn=he[pt];Me(Xn,pt,he)&&(sn[Nn++]=Xn)}return sn}function Fe(he,Me){for(var pt=-1,Ft=Me.length,Nn=he.length;++pt<Ft;)he[Nn+pt]=Me[pt];return he}function Ke(he,Me){for(var pt=-1,Ft=he==null?0:he.length;++pt<Ft;)if(Me(he[pt],pt,he))return!0;return!1}function it(he,Me){for(var pt=-1,Ft=Array(he);++pt<he;)Ft[pt]=Me(pt);return Ft}function ct(he){return function(Me){return he(Me)}}function at(he,Me){return he.has(Me)}function Ot(he,Me){return he?.[Me]}function on(he){var Me=-1,pt=Array(he.size);return he.forEach(function(Ft,Nn){pt[++Me]=[Nn,Ft]}),pt}function pn(he,Me){return function(pt){return he(Me(pt))}}function sr(he){var Me=-1,pt=Array(he.size);return he.forEach(function(Ft){pt[++Me]=Ft}),pt}var Qn=Array.prototype,Jr=Function.prototype,xr=Object.prototype,Ye=ve["__core-js_shared__"],_t=Jr.toString,Kn=xr.hasOwnProperty,Dr=function(){var he=/[^.]+$/.exec(Ye&&Ye.keys&&Ye.keys.IE_PROTO||"");return he?"Symbol(src)_1."+he:""}(),cn=xr.toString,Rr=RegExp("^"+_t.call(Kn).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),br=De?ve.Buffer:void 0,dr=ve.Symbol,ai=ve.Uint8Array,xt=xr.propertyIsEnumerable,tn=Qn.splice,Kt=dr?dr.toStringTag:void 0,er=Object.getOwnPropertySymbols,gi=br?br.isBuffer:void 0,Jt=pn(Object.keys,Object),Ur=xo(ve,"DataView"),zn=xo(ve,"Map"),yi=xo(ve,"Promise"),Bn=xo(ve,"Set"),lr=xo(ve,"WeakMap"),hn=xo(Object,"create"),Vi=Oo(Ur),Qr=Oo(zn),Pi=Oo(yi),Ai=Oo(Bn),ji=Oo(lr),vi=dr?dr.prototype:void 0,ae=vi?vi.valueOf:void 0;function B(he){var Me=-1,pt=he==null?0:he.length;for(this.clear();++Me<pt;){var Ft=he[Me];this.set(Ft[0],Ft[1])}}function K(){this.__data__=hn?hn(null):{},this.size=0}function ie(he){var Me=this.has(he)&&delete this.__data__[he];return this.size-=Me?1:0,Me}function oe(he){var Me=this.__data__;if(hn){var pt=Me[he];return pt===o?void 0:pt}return Kn.call(Me,he)?Me[he]:void 0}function ge(he){var Me=this.__data__;return hn?Me[he]!==void 0:Kn.call(Me,he)}function Se(he,Me){var pt=this.__data__;return this.size+=this.has(he)?0:1,pt[he]=hn&&Me===void 0?o:Me,this}B.prototype.clear=K,B.prototype.delete=ie,B.prototype.get=oe,B.prototype.has=ge,B.prototype.set=Se;function xe(he){var Me=-1,pt=he==null?0:he.length;for(this.clear();++Me<pt;){var Ft=he[Me];this.set(Ft[0],Ft[1])}}function ye(){this.__data__=[],this.size=0}function Ce(he){var Me=this.__data__,pt=Ta(Me,he);if(pt<0)return!1;var Ft=Me.length-1;return pt==Ft?Me.pop():tn.call(Me,pt,1),--this.size,!0}function Xe(he){var Me=this.__data__,pt=Ta(Me,he);return pt<0?void 0:Me[pt][1]}function ut(he){return Ta(this.__data__,he)>-1}function Ze(he,Me){var pt=this.__data__,Ft=Ta(pt,he);return Ft<0?(++this.size,pt.push([he,Me])):pt[Ft][1]=Me,this}xe.prototype.clear=ye,xe.prototype.delete=Ce,xe.prototype.get=Xe,xe.prototype.has=ut,xe.prototype.set=Ze;function Ct(he){var Me=-1,pt=he==null?0:he.length;for(this.clear();++Me<pt;){var Ft=he[Me];this.set(Ft[0],Ft[1])}}function Ut(){this.size=0,this.__data__={hash:new B,map:new(zn||xe),string:new B}}function Pt(he){var Me=_o(this,he).delete(he);return this.size-=Me?1:0,Me}function Xt(he){return _o(this,he).get(he)}function Qt(he){return _o(this,he).has(he)}function _n(he,Me){var pt=_o(this,he),Ft=pt.size;return pt.set(he,Me),this.size+=pt.size==Ft?0:1,this}Ct.prototype.clear=Ut,Ct.prototype.delete=Pt,Ct.prototype.get=Xt,Ct.prototype.has=Qt,Ct.prototype.set=_n;function en(he){var Me=-1,pt=he==null?0:he.length;for(this.__data__=new Ct;++Me<pt;)this.add(he[Me])}function an(he){return this.__data__.set(he,o),this}function xn(he){return this.__data__.has(he)}en.prototype.add=en.prototype.push=an,en.prototype.has=xn;function bn(he){var Me=this.__data__=new xe(he);this.size=Me.size}function Cr(){this.__data__=new xe,this.size=0}function Gn(he){var Me=this.__data__,pt=Me.delete(he);return this.size=Me.size,pt}function Vr(he){return this.__data__.get(he)}function Ea(he){return this.__data__.has(he)}function Ja(he,Me){var pt=this.__data__;if(pt instanceof xe){var Ft=pt.__data__;if(!zn||Ft.length<n-1)return Ft.push([he,Me]),this.size=++pt.size,this;pt=this.__data__=new Ct(Ft)}return pt.set(he,Me),this.size=pt.size,this}bn.prototype.clear=Cr,bn.prototype.delete=Gn,bn.prototype.get=Vr,bn.prototype.has=Ea,bn.prototype.set=Ja;function Mn(he,Me){var pt=ts(he),Ft=!pt&&Gs(he),Nn=!pt&&!Ft&&jl(he),sn=!pt&&!Ft&&!Nn&&ql(he),Xn=pt||Ft||Nn||sn,hr=Xn?it(he.length,String):[],wr=hr.length;for(var Wn in he)(Me||Kn.call(he,Wn))&&!(Xn&&(Wn=="length"||Nn&&(Wn=="offset"||Wn=="parent")||sn&&(Wn=="buffer"||Wn=="byteLength"||Wn=="byteOffset")||Vs(Wn,wr)))&&hr.push(Wn);return hr}function Ta(he,Me){for(var pt=he.length;pt--;)if(js(he[pt][0],Me))return pt;return-1}function Bl(he,Me,pt){var Ft=Me(he);return ts(he)?Ft:Fe(Ft,pt(he))}function Sa(he){return he==null?he===void 0?le:$:Kt&&Kt in Object(he)?Us(he):Jc(he)}function Fl(he){return yn(he)&&Sa(he)==s}function Bs(he,Me,pt,Ft,Nn){return he===Me?!0:he==null||Me==null||!yn(he)&&!yn(Me)?he!==he&&Me!==Me:Cd(he,Me,pt,Ft,Bs,Nn)}function Cd(he,Me,pt,Ft,Nn,sn){var Xn=ts(he),hr=ts(Me),wr=Xn?_:io(he),Wn=hr?_:io(Me);wr=wr==s?L:wr,Wn=Wn==s?L:Wn;var jr=wr==L,Ii=Wn==L,Lr=wr==Wn;if(Lr&&jl(he)){if(!jl(Me))return!1;Xn=!0,jr=!1}if(Lr&&!jr)return sn||(sn=new bn),Xn||ql(he)?Vl(he,Me,pt,Ft,Nn,sn):Yc(he,Me,wr,pt,Ft,Nn,sn);if(!(pt&c)){var Nr=jr&&Kn.call(he,"__wrapped__"),Mi=Ii&&Kn.call(Me,"__wrapped__");if(Nr||Mi){var $o=Nr?he.value():he,bo=Mi?Me.value():Me;return sn||(sn=new bn),Nn($o,bo,pt,Ft,sn)}}return Lr?(sn||(sn=new bn),na(he,Me,pt,Ft,Nn,sn)):!1}function Fs(he){if(!Hs(he)||qn(he))return!1;var Me=qs(he)?Rr:Rt;return Me.test(Oo(he))}function Ul(he){return yn(he)&&Ws(he.length)&&!!X[Sa(he)]}function Xc(he){if(!es(he))return Jt(he);var Me=[];for(var pt in Object(he))Kn.call(he,pt)&&pt!="constructor"&&Me.push(pt);return Me}function Vl(he,Me,pt,Ft,Nn,sn){var Xn=pt&c,hr=he.length,wr=Me.length;if(hr!=wr&&!(Xn&&wr>hr))return!1;var Wn=sn.get(he);if(Wn&&sn.get(Me))return Wn==Me;var jr=-1,Ii=!0,Lr=pt&d?new en:void 0;for(sn.set(he,Me),sn.set(Me,he);++jr<hr;){var Nr=he[jr],Mi=Me[jr];if(Ft)var $o=Xn?Ft(Mi,Nr,jr,Me,he,sn):Ft(Nr,Mi,jr,he,Me,sn);if($o!==void 0){if($o)continue;Ii=!1;break}if(Lr){if(!Ke(Me,function(bo,ra){if(!at(Lr,ra)&&(Nr===bo||Nn(Nr,bo,pt,Ft,sn)))return Lr.push(ra)})){Ii=!1;break}}else if(!(Nr===Mi||Nn(Nr,Mi,pt,Ft,sn))){Ii=!1;break}}return sn.delete(he),sn.delete(Me),Ii}function Yc(he,Me,pt,Ft,Nn,sn,Xn){switch(pt){case de:if(he.byteLength!=Me.byteLength||he.byteOffset!=Me.byteOffset)return!1;he=he.buffer,Me=Me.buffer;case be:return!(he.byteLength!=Me.byteLength||!sn(new ai(he),new ai(Me)));case E:case T:case U:return js(+he,+Me);case S:return he.name==Me.name&&he.message==Me.message;case V:case G:return he==Me+"";case M:var hr=on;case Z:var wr=Ft&c;if(hr||(hr=sr),he.size!=Me.size&&!wr)return!1;var Wn=Xn.get(he);if(Wn)return Wn==Me;Ft|=d,Xn.set(he,Me);var jr=Vl(hr(he),hr(Me),Ft,Nn,sn,Xn);return Xn.delete(he),jr;case W:if(ae)return ae.call(he)==ae.call(Me)}return!1}function na(he,Me,pt,Ft,Nn,sn){var Xn=pt&c,hr=ka(he),wr=hr.length,Wn=ka(Me),jr=Wn.length;if(wr!=jr&&!Xn)return!1;for(var Ii=wr;Ii--;){var Lr=hr[Ii];if(!(Xn?Lr in Me:Kn.call(Me,Lr)))return!1}var Nr=sn.get(he);if(Nr&&sn.get(Me))return Nr==Me;var Mi=!0;sn.set(he,Me),sn.set(Me,he);for(var $o=Xn;++Ii<wr;){Lr=hr[Ii];var bo=he[Lr],ra=Me[Lr];if(Ft)var Qc=Xn?Ft(ra,bo,Lr,Me,he,sn):Ft(bo,ra,Lr,he,Me,sn);if(!(Qc===void 0?bo===ra||Nn(bo,ra,pt,Ft,sn):Qc)){Mi=!1;break}$o||($o=Lr=="constructor")}if(Mi&&!$o){var Zs=he.constructor,Pa=Me.constructor;Zs!=Pa&&"constructor"in he&&"constructor"in Me&&!(typeof Zs=="function"&&Zs instanceof Zs&&typeof Pa=="function"&&Pa instanceof Pa)&&(Mi=!1)}return sn.delete(he),sn.delete(Me),Mi}function ka(he){return Bl(he,Ad,Ca)}function _o(he,Me){var pt=he.__data__;return Qa(Me)?pt[typeof Me=="string"?"string":"hash"]:pt.map}function xo(he,Me){var pt=Ot(he,Me);return Fs(pt)?pt:void 0}function Us(he){var Me=Kn.call(he,Kt),pt=he[Kt];try{he[Kt]=void 0;var Ft=!0}catch{}var Nn=cn.call(he);return Ft&&(Me?he[Kt]=pt:delete he[Kt]),Nn}var Ca=er?function(he){return he==null?[]:(he=Object(he),ue(er(he),function(Me){return xt.call(he,Me)}))}:ns,io=Sa;(Ur&&io(new Ur(new ArrayBuffer(1)))!=de||zn&&io(new zn)!=M||yi&&io(yi.resolve())!=F||Bn&&io(new Bn)!=Z||lr&&io(new lr)!=Ie)&&(io=function(he){var Me=Sa(he),pt=Me==L?he.constructor:void 0,Ft=pt?Oo(pt):"";if(Ft)switch(Ft){case Vi:return de;case Qr:return M;case Pi:return F;case Ai:return Z;case ji:return Ie}return Me});function Vs(he,Me){return Me=Me??p,!!Me&&(typeof he=="number"||zt.test(he))&&he>-1&&he%1==0&&he<Me}function Qa(he){var Me=typeof he;return Me=="string"||Me=="number"||Me=="symbol"||Me=="boolean"?he!=="__proto__":he===null}function qn(he){return!!Dr&&Dr in he}function es(he){var Me=he&&he.constructor,pt=typeof Me=="function"&&Me.prototype||xr;return he===pt}function Jc(he){return cn.call(he)}function Oo(he){if(he!=null){try{return _t.call(he)}catch{}try{return he+""}catch{}}return""}function js(he,Me){return he===Me||he!==he&&Me!==Me}var Gs=Fl(function(){return arguments}())?Fl:function(he){return yn(he)&&Kn.call(he,"callee")&&!xt.call(he,"callee")},ts=Array.isArray;function Pd(he){return he!=null&&Ws(he.length)&&!qs(he)}var jl=gi||rs;function Gl(he,Me){return Bs(he,Me)}function qs(he){if(!Hs(he))return!1;var Me=Sa(he);return Me==D||Me==O||Me==v||Me==J}function Ws(he){return typeof he=="number"&&he>-1&&he%1==0&&he<=p}function Hs(he){var Me=typeof he;return he!=null&&(Me=="object"||Me=="function")}function yn(he){return he!=null&&typeof he=="object"}var ql=dt?ct(dt):Ul;function Ad(he){return Pd(he)?Mn(he):Xc(he)}function ns(){return[]}function rs(){return!1}e.exports=Gl})(o7,v0);var r1={},a7={get exports(){return r1},set exports(e){r1=e}};(function(e,t){var n=function(){var o=function(V,Z){var G=236,W=17,le=V,Ie=d[Z],be=null,de=0,Ne=null,Ee=[],Oe={},ze=function(ve,ke){de=le*4+17,be=function(we){for(var De=new Array(we),Pe=0;Pe<we;Pe+=1){De[Pe]=new Array(we);for(var lt=0;lt<we;lt+=1)De[Pe][lt]=null}return De}(de),rt(0,0),rt(de-7,0),rt(0,de-7),He(),Ae(),Qe(ve,ke),le>=7&&ft(ve),Ne==null&&(Ne=X(le,Ie,Ee)),Rt(Ne,ke)},rt=function(ve,ke){for(var we=-1;we<=7;we+=1)if(!(ve+we<=-1||de<=ve+we))for(var De=-1;De<=7;De+=1)ke+De<=-1||de<=ke+De||(0<=we&&we<=6&&(De==0||De==6)||0<=De&&De<=6&&(we==0||we==6)||2<=we&&we<=4&&2<=De&&De<=4?be[ve+we][ke+De]=!0:be[ve+we][ke+De]=!1)},We=function(){for(var ve=0,ke=0,we=0;we<8;we+=1){ze(!0,we);var De=s.getLostPoint(Oe);(we==0||ve>De)&&(ve=De,ke=we)}return ke},Ae=function(){for(var ve=8;ve<de-8;ve+=1)be[ve][6]==null&&(be[ve][6]=ve%2==0);for(var ke=8;ke<de-8;ke+=1)be[6][ke]==null&&(be[6][ke]=ke%2==0)},He=function(){for(var ve=s.getPatternPosition(le),ke=0;ke<ve.length;ke+=1)for(var we=0;we<ve.length;we+=1){var De=ve[ke],Pe=ve[we];if(be[De][Pe]==null)for(var lt=-2;lt<=2;lt+=1)for(var dt=-2;dt<=2;dt+=1)lt==-2||lt==2||dt==-2||dt==2||lt==0&&dt==0?be[De+lt][Pe+dt]=!0:be[De+lt][Pe+dt]=!1}},ft=function(ve){for(var ke=s.getBCHTypeNumber(le),we=0;we<18;we+=1){var De=!ve&&(ke>>we&1)==1;be[Math.floor(we/3)][we%3+de-8-3]=De}for(var we=0;we<18;we+=1){var De=!ve&&(ke>>we&1)==1;be[we%3+de-8-3][Math.floor(we/3)]=De}},Qe=function(ve,ke){for(var we=Ie<<3|ke,De=s.getBCHTypeInfo(we),Pe=0;Pe<15;Pe+=1){var lt=!ve&&(De>>Pe&1)==1;Pe<6?be[Pe][8]=lt:Pe<8?be[Pe+1][8]=lt:be[de-15+Pe][8]=lt}for(var Pe=0;Pe<15;Pe+=1){var lt=!ve&&(De>>Pe&1)==1;Pe<8?be[8][de-Pe-1]=lt:Pe<9?be[8][15-Pe-1+1]=lt:be[8][15-Pe-1]=lt}be[de-8][8]=!ve},Rt=function(ve,ke){for(var we=-1,De=de-1,Pe=7,lt=0,dt=s.getMaskFunction(ke),ue=de-1;ue>0;ue-=2)for(ue==6&&(ue-=1);;){for(var Fe=0;Fe<2;Fe+=1)if(be[De][ue-Fe]==null){var Ke=!1;lt<ve.length&&(Ke=(ve[lt]>>>Pe&1)==1);var it=dt(De,ue-Fe);it&&(Ke=!Ke),be[De][ue-Fe]=Ke,Pe-=1,Pe==-1&&(lt+=1,Pe=7)}if(De+=we,De<0||de<=De){De-=we,we=-we;break}}},zt=function(ve,ke){for(var we=0,De=0,Pe=0,lt=new Array(ke.length),dt=new Array(ke.length),ue=0;ue<ke.length;ue+=1){var Fe=ke[ue].dataCount,Ke=ke[ue].totalCount-Fe;De=Math.max(De,Fe),Pe=Math.max(Pe,Ke),lt[ue]=new Array(Fe);for(var it=0;it<lt[ue].length;it+=1)lt[ue][it]=255&ve.getBuffer()[it+we];we+=Fe;var ct=s.getErrorCorrectPolynomial(Ke),at=v(lt[ue],ct.getLength()-1),Ot=at.mod(ct);dt[ue]=new Array(ct.getLength()-1);for(var it=0;it<dt[ue].length;it+=1){var on=it+Ot.getLength()-dt[ue].length;dt[ue][it]=on>=0?Ot.getAt(on):0}}for(var pn=0,it=0;it<ke.length;it+=1)pn+=ke[it].totalCount;for(var sr=new Array(pn),Qn=0,it=0;it<De;it+=1)for(var ue=0;ue<ke.length;ue+=1)it<lt[ue].length&&(sr[Qn]=lt[ue][it],Qn+=1);for(var it=0;it<Pe;it+=1)for(var ue=0;ue<ke.length;ue+=1)it<dt[ue].length&&(sr[Qn]=dt[ue][it],Qn+=1);return sr},X=function(ve,ke,we){for(var De=E.getRSBlocks(ve,ke),Pe=T(),lt=0;lt<we.length;lt+=1){var dt=we[lt];Pe.put(dt.getMode(),4),Pe.put(dt.getLength(),s.getLengthInBits(dt.getMode(),ve)),dt.write(Pe)}for(var ue=0,lt=0;lt<De.length;lt+=1)ue+=De[lt].dataCount;if(Pe.getLengthInBits()>ue*8)throw"code length overflow. ("+Pe.getLengthInBits()+">"+ue*8+")";for(Pe.getLengthInBits()+4<=ue*8&&Pe.put(0,4);Pe.getLengthInBits()%8!=0;)Pe.putBit(!1);for(;!(Pe.getLengthInBits()>=ue*8||(Pe.put(G,8),Pe.getLengthInBits()>=ue*8));)Pe.put(W,8);return zt(Pe,De)};Oe.addData=function(ve,ke){ke=ke||"Byte";var we=null;switch(ke){case"Numeric":we=S(ve);break;case"Alphanumeric":we=D(ve);break;case"Byte":we=O(ve);break;case"Kanji":we=M(ve);break;default:throw"mode:"+ke}Ee.push(we),Ne=null},Oe.isDark=function(ve,ke){if(ve<0||de<=ve||ke<0||de<=ke)throw ve+","+ke;return be[ve][ke]},Oe.getModuleCount=function(){return de},Oe.make=function(){if(le<1){for(var ve=1;ve<40;ve++){for(var ke=E.getRSBlocks(ve,Ie),we=T(),De=0;De<Ee.length;De++){var Pe=Ee[De];we.put(Pe.getMode(),4),we.put(Pe.getLength(),s.getLengthInBits(Pe.getMode(),ve)),Pe.write(we)}for(var lt=0,De=0;De<ke.length;De++)lt+=ke[De].dataCount;if(we.getLengthInBits()<=lt*8)break}le=ve}ze(!1,We())},Oe.createTableTag=function(ve,ke){ve=ve||2,ke=typeof ke>"u"?ve*4:ke;var we="";we+='<table style="',we+=" border-width: 0px; border-style: none;",we+=" border-collapse: collapse;",we+=" padding: 0px; margin: "+ke+"px;",we+='">',we+="<tbody>";for(var De=0;De<Oe.getModuleCount();De+=1){we+="<tr>";for(var Pe=0;Pe<Oe.getModuleCount();Pe+=1)we+='<td style="',we+=" border-width: 0px; border-style: none;",we+=" border-collapse: collapse;",we+=" padding: 0px; margin: 0px;",we+=" width: "+ve+"px;",we+=" height: "+ve+"px;",we+=" background-color: ",we+=Oe.isDark(De,Pe)?"#000000":"#ffffff",we+=";",we+='"/>';we+="</tr>"}return we+="</tbody>",we+="</table>",we},Oe.createSvgTag=function(ve,ke,we,De){var Pe={};typeof arguments[0]=="object"&&(Pe=arguments[0],ve=Pe.cellSize,ke=Pe.margin,we=Pe.alt,De=Pe.title),ve=ve||2,ke=typeof ke>"u"?ve*4:ke,we=typeof we=="string"?{text:we}:we||{},we.text=we.text||null,we.id=we.text?we.id||"qrcode-description":null,De=typeof De=="string"?{text:De}:De||{},De.text=De.text||null,De.id=De.text?De.id||"qrcode-title":null;var lt=Oe.getModuleCount()*ve+ke*2,dt,ue,Fe,Ke,it="",ct;for(ct="l"+ve+",0 0,"+ve+" -"+ve+",0 0,-"+ve+"z ",it+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',it+=Pe.scalable?"":' width="'+lt+'px" height="'+lt+'px"',it+=' viewBox="0 0 '+lt+" "+lt+'" ',it+=' preserveAspectRatio="xMinYMin meet"',it+=De.text||we.text?' role="img" aria-labelledby="'+tt([De.id,we.id].join(" ").trim())+'"':"",it+=">",it+=De.text?'<title id="'+tt(De.id)+'">'+tt(De.text)+"</title>":"",it+=we.text?'<description id="'+tt(we.id)+'">'+tt(we.text)+"</description>":"",it+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',it+='<path d="',Fe=0;Fe<Oe.getModuleCount();Fe+=1)for(Ke=Fe*ve+ke,dt=0;dt<Oe.getModuleCount();dt+=1)Oe.isDark(Fe,dt)&&(ue=dt*ve+ke,it+="M"+ue+","+Ke+ct);return it+='" stroke="transparent" fill="black"/>',it+="</svg>",it},Oe.createDataURL=function(ve,ke){ve=ve||2,ke=typeof ke>"u"?ve*4:ke;var we=Oe.getModuleCount()*ve+ke*2,De=ke,Pe=we-ke;return J(we,we,function(lt,dt){if(De<=lt&&lt<Pe&&De<=dt&&dt<Pe){var ue=Math.floor((lt-De)/ve),Fe=Math.floor((dt-De)/ve);return Oe.isDark(Fe,ue)?0:1}else return 1})},Oe.createImgTag=function(ve,ke,we){ve=ve||2,ke=typeof ke>"u"?ve*4:ke;var De=Oe.getModuleCount()*ve+ke*2,Pe="";return Pe+="<img",Pe+=' src="',Pe+=Oe.createDataURL(ve,ke),Pe+='"',Pe+=' width="',Pe+=De,Pe+='"',Pe+=' height="',Pe+=De,Pe+='"',we&&(Pe+=' alt="',Pe+=tt(we),Pe+='"'),Pe+="/>",Pe};var tt=function(ve){for(var ke="",we=0;we<ve.length;we+=1){var De=ve.charAt(we);switch(De){case"<":ke+="&lt;";break;case">":ke+="&gt;";break;case"&":ke+="&amp;";break;case'"':ke+="&quot;";break;default:ke+=De;break}}return ke},je=function(ve){var ke=1;ve=typeof ve>"u"?ke*2:ve;var we=Oe.getModuleCount()*ke+ve*2,De=ve,Pe=we-ve,lt,dt,ue,Fe,Ke,it={"":""," ":""," ":"","  ":" "},ct={"":""," ":""," ":" ","  ":" "},at="";for(lt=0;lt<we;lt+=2){for(ue=Math.floor((lt-De)/ke),Fe=Math.floor((lt+1-De)/ke),dt=0;dt<we;dt+=1)Ke="",De<=dt&&dt<Pe&&De<=lt&&lt<Pe&&Oe.isDark(ue,Math.floor((dt-De)/ke))&&(Ke=" "),De<=dt&&dt<Pe&&De<=lt+1&&lt+1<Pe&&Oe.isDark(Fe,Math.floor((dt-De)/ke))?Ke+=" ":Ke+="",at+=ve<1&&lt+1>=Pe?ct[Ke]:it[Ke];at+=`
`}return we%2&&ve>0?at.substring(0,at.length-we-1)+Array(we+1).join(""):at.substring(0,at.length-1)};return Oe.createASCII=function(ve,ke){if(ve=ve||1,ve<2)return je(ke);ve-=1,ke=typeof ke>"u"?ve*2:ke;var we=Oe.getModuleCount()*ve+ke*2,De=ke,Pe=we-ke,lt,dt,ue,Fe,Ke=Array(ve+1).join(""),it=Array(ve+1).join("  "),ct="",at="";for(lt=0;lt<we;lt+=1){for(ue=Math.floor((lt-De)/ve),at="",dt=0;dt<we;dt+=1)Fe=1,De<=dt&&dt<Pe&&De<=lt&&lt<Pe&&Oe.isDark(ue,Math.floor((dt-De)/ve))&&(Fe=0),at+=Fe?Ke:it;for(ue=0;ue<ve;ue+=1)ct+=at+`
`}return ct.substring(0,ct.length-1)},Oe.renderTo2dContext=function(ve,ke){ke=ke||2;for(var we=Oe.getModuleCount(),De=0;De<we;De++)for(var Pe=0;Pe<we;Pe++)ve.fillStyle=Oe.isDark(De,Pe)?"black":"white",ve.fillRect(De*ke,Pe*ke,ke,ke)},Oe};o.stringToBytesFuncs={default:function(V){for(var Z=[],G=0;G<V.length;G+=1){var W=V.charCodeAt(G);Z.push(W&255)}return Z}},o.stringToBytes=o.stringToBytesFuncs.default,o.createStringToBytes=function(V,Z){var G=function(){for(var le=L(V),Ie=function(){var Ae=le.read();if(Ae==-1)throw"eof";return Ae},be=0,de={};;){var Ne=le.read();if(Ne==-1)break;var Ee=Ie(),Oe=Ie(),ze=Ie(),rt=String.fromCharCode(Ne<<8|Ee),We=Oe<<8|ze;de[rt]=We,be+=1}if(be!=Z)throw be+" != "+Z;return de}(),W="?".charCodeAt(0);return function(le){for(var Ie=[],be=0;be<le.length;be+=1){var de=le.charCodeAt(be);if(de<128)Ie.push(de);else{var Ne=G[le.charAt(be)];typeof Ne=="number"?(Ne&255)==Ne?Ie.push(Ne):(Ie.push(Ne>>>8),Ie.push(Ne&255)):Ie.push(W)}}return Ie}};var c={MODE_NUMBER:1<<0,MODE_ALPHA_NUM:1<<1,MODE_8BIT_BYTE:1<<2,MODE_KANJI:1<<3},d={L:1,M:0,Q:3,H:2},p={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s=function(){var V=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],Z=1<<10|1<<8|1<<5|1<<4|1<<2|1<<1|1<<0,G=1<<12|1<<11|1<<10|1<<9|1<<8|1<<5|1<<2|1<<0,W=1<<14|1<<12|1<<10|1<<4|1<<1,le={},Ie=function(be){for(var de=0;be!=0;)de+=1,be>>>=1;return de};return le.getBCHTypeInfo=function(be){for(var de=be<<10;Ie(de)-Ie(Z)>=0;)de^=Z<<Ie(de)-Ie(Z);return(be<<10|de)^W},le.getBCHTypeNumber=function(be){for(var de=be<<12;Ie(de)-Ie(G)>=0;)de^=G<<Ie(de)-Ie(G);return be<<12|de},le.getPatternPosition=function(be){return V[be-1]},le.getMaskFunction=function(be){switch(be){case p.PATTERN000:return function(de,Ne){return(de+Ne)%2==0};case p.PATTERN001:return function(de,Ne){return de%2==0};case p.PATTERN010:return function(de,Ne){return Ne%3==0};case p.PATTERN011:return function(de,Ne){return(de+Ne)%3==0};case p.PATTERN100:return function(de,Ne){return(Math.floor(de/2)+Math.floor(Ne/3))%2==0};case p.PATTERN101:return function(de,Ne){return de*Ne%2+de*Ne%3==0};case p.PATTERN110:return function(de,Ne){return(de*Ne%2+de*Ne%3)%2==0};case p.PATTERN111:return function(de,Ne){return(de*Ne%3+(de+Ne)%2)%2==0};default:throw"bad maskPattern:"+be}},le.getErrorCorrectPolynomial=function(be){for(var de=v([1],0),Ne=0;Ne<be;Ne+=1)de=de.multiply(v([1,_.gexp(Ne)],0));return de},le.getLengthInBits=function(be,de){if(1<=de&&de<10)switch(be){case c.MODE_NUMBER:return 10;case c.MODE_ALPHA_NUM:return 9;case c.MODE_8BIT_BYTE:return 8;case c.MODE_KANJI:return 8;default:throw"mode:"+be}else if(de<27)switch(be){case c.MODE_NUMBER:return 12;case c.MODE_ALPHA_NUM:return 11;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 10;default:throw"mode:"+be}else if(de<41)switch(be){case c.MODE_NUMBER:return 14;case c.MODE_ALPHA_NUM:return 13;case c.MODE_8BIT_BYTE:return 16;case c.MODE_KANJI:return 12;default:throw"mode:"+be}else throw"type:"+de},le.getLostPoint=function(be){for(var de=be.getModuleCount(),Ne=0,Ee=0;Ee<de;Ee+=1)for(var Oe=0;Oe<de;Oe+=1){for(var ze=0,rt=be.isDark(Ee,Oe),We=-1;We<=1;We+=1)if(!(Ee+We<0||de<=Ee+We))for(var Ae=-1;Ae<=1;Ae+=1)Oe+Ae<0||de<=Oe+Ae||We==0&&Ae==0||rt==be.isDark(Ee+We,Oe+Ae)&&(ze+=1);ze>5&&(Ne+=3+ze-5)}for(var Ee=0;Ee<de-1;Ee+=1)for(var Oe=0;Oe<de-1;Oe+=1){var He=0;be.isDark(Ee,Oe)&&(He+=1),be.isDark(Ee+1,Oe)&&(He+=1),be.isDark(Ee,Oe+1)&&(He+=1),be.isDark(Ee+1,Oe+1)&&(He+=1),(He==0||He==4)&&(Ne+=3)}for(var Ee=0;Ee<de;Ee+=1)for(var Oe=0;Oe<de-6;Oe+=1)be.isDark(Ee,Oe)&&!be.isDark(Ee,Oe+1)&&be.isDark(Ee,Oe+2)&&be.isDark(Ee,Oe+3)&&be.isDark(Ee,Oe+4)&&!be.isDark(Ee,Oe+5)&&be.isDark(Ee,Oe+6)&&(Ne+=40);for(var Oe=0;Oe<de;Oe+=1)for(var Ee=0;Ee<de-6;Ee+=1)be.isDark(Ee,Oe)&&!be.isDark(Ee+1,Oe)&&be.isDark(Ee+2,Oe)&&be.isDark(Ee+3,Oe)&&be.isDark(Ee+4,Oe)&&!be.isDark(Ee+5,Oe)&&be.isDark(Ee+6,Oe)&&(Ne+=40);for(var ft=0,Oe=0;Oe<de;Oe+=1)for(var Ee=0;Ee<de;Ee+=1)be.isDark(Ee,Oe)&&(ft+=1);var Qe=Math.abs(100*ft/de/de-50)/5;return Ne+=Qe*10,Ne},le}(),_=function(){for(var V=new Array(256),Z=new Array(256),G=0;G<8;G+=1)V[G]=1<<G;for(var G=8;G<256;G+=1)V[G]=V[G-4]^V[G-5]^V[G-6]^V[G-8];for(var G=0;G<255;G+=1)Z[V[G]]=G;var W={};return W.glog=function(le){if(le<1)throw"glog("+le+")";return Z[le]},W.gexp=function(le){for(;le<0;)le+=255;for(;le>=256;)le-=255;return V[le]},W}();function v(V,Z){if(typeof V.length>"u")throw V.length+"/"+Z;var G=function(){for(var le=0;le<V.length&&V[le]==0;)le+=1;for(var Ie=new Array(V.length-le+Z),be=0;be<V.length-le;be+=1)Ie[be]=V[be+le];return Ie}(),W={};return W.getAt=function(le){return G[le]},W.getLength=function(){return G.length},W.multiply=function(le){for(var Ie=new Array(W.getLength()+le.getLength()-1),be=0;be<W.getLength();be+=1)for(var de=0;de<le.getLength();de+=1)Ie[be+de]^=_.gexp(_.glog(W.getAt(be))+_.glog(le.getAt(de)));return v(Ie,0)},W.mod=function(le){if(W.getLength()-le.getLength()<0)return W;for(var Ie=_.glog(W.getAt(0))-_.glog(le.getAt(0)),be=new Array(W.getLength()),de=0;de<W.getLength();de+=1)be[de]=W.getAt(de);for(var de=0;de<le.getLength();de+=1)be[de]^=_.gexp(_.glog(le.getAt(de))+Ie);return v(be,0).mod(le)},W}var E=function(){var V=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],Z=function(le,Ie){var be={};return be.totalCount=le,be.dataCount=Ie,be},G={},W=function(le,Ie){switch(Ie){case d.L:return V[(le-1)*4+0];case d.M:return V[(le-1)*4+1];case d.Q:return V[(le-1)*4+2];case d.H:return V[(le-1)*4+3];default:return}};return G.getRSBlocks=function(le,Ie){var be=W(le,Ie);if(typeof be>"u")throw"bad rs block @ typeNumber:"+le+"/errorCorrectionLevel:"+Ie;for(var de=be.length/3,Ne=[],Ee=0;Ee<de;Ee+=1)for(var Oe=be[Ee*3+0],ze=be[Ee*3+1],rt=be[Ee*3+2],We=0;We<Oe;We+=1)Ne.push(Z(ze,rt));return Ne},G}(),T=function(){var V=[],Z=0,G={};return G.getBuffer=function(){return V},G.getAt=function(W){var le=Math.floor(W/8);return(V[le]>>>7-W%8&1)==1},G.put=function(W,le){for(var Ie=0;Ie<le;Ie+=1)G.putBit((W>>>le-Ie-1&1)==1)},G.getLengthInBits=function(){return Z},G.putBit=function(W){var le=Math.floor(Z/8);V.length<=le&&V.push(0),W&&(V[le]|=128>>>Z%8),Z+=1},G},S=function(V){var Z=c.MODE_NUMBER,G=V,W={};W.getMode=function(){return Z},W.getLength=function(be){return G.length},W.write=function(be){for(var de=G,Ne=0;Ne+2<de.length;)be.put(le(de.substring(Ne,Ne+3)),10),Ne+=3;Ne<de.length&&(de.length-Ne==1?be.put(le(de.substring(Ne,Ne+1)),4):de.length-Ne==2&&be.put(le(de.substring(Ne,Ne+2)),7))};var le=function(be){for(var de=0,Ne=0;Ne<be.length;Ne+=1)de=de*10+Ie(be.charAt(Ne));return de},Ie=function(be){if("0"<=be&&be<="9")return be.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+be};return W},D=function(V){var Z=c.MODE_ALPHA_NUM,G=V,W={};W.getMode=function(){return Z},W.getLength=function(Ie){return G.length},W.write=function(Ie){for(var be=G,de=0;de+1<be.length;)Ie.put(le(be.charAt(de))*45+le(be.charAt(de+1)),11),de+=2;de<be.length&&Ie.put(le(be.charAt(de)),6)};var le=function(Ie){if("0"<=Ie&&Ie<="9")return Ie.charCodeAt(0)-"0".charCodeAt(0);if("A"<=Ie&&Ie<="Z")return Ie.charCodeAt(0)-"A".charCodeAt(0)+10;switch(Ie){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+Ie}};return W},O=function(V){var Z=c.MODE_8BIT_BYTE,G=o.stringToBytes(V),W={};return W.getMode=function(){return Z},W.getLength=function(le){return G.length},W.write=function(le){for(var Ie=0;Ie<G.length;Ie+=1)le.put(G[Ie],8)},W},M=function(V){var Z=c.MODE_KANJI,G=o.stringToBytesFuncs.SJIS;if(!G)throw"sjis not supported.";(function(Ie,be){var de=G(Ie);if(de.length!=2||(de[0]<<8|de[1])!=be)throw"sjis not supported."})("",38726);var W=G(V),le={};return le.getMode=function(){return Z},le.getLength=function(Ie){return~~(W.length/2)},le.write=function(Ie){for(var be=W,de=0;de+1<be.length;){var Ne=(255&be[de])<<8|255&be[de+1];if(33088<=Ne&&Ne<=40956)Ne-=33088;else if(57408<=Ne&&Ne<=60351)Ne-=49472;else throw"illegal char at "+(de+1)+"/"+Ne;Ne=(Ne>>>8&255)*192+(Ne&255),Ie.put(Ne,13),de+=2}if(de<be.length)throw"illegal char at "+(de+1)},le},U=function(){var V=[],Z={};return Z.writeByte=function(G){V.push(G&255)},Z.writeShort=function(G){Z.writeByte(G),Z.writeByte(G>>>8)},Z.writeBytes=function(G,W,le){W=W||0,le=le||G.length;for(var Ie=0;Ie<le;Ie+=1)Z.writeByte(G[Ie+W])},Z.writeString=function(G){for(var W=0;W<G.length;W+=1)Z.writeByte(G.charCodeAt(W))},Z.toByteArray=function(){return V},Z.toString=function(){var G="";G+="[";for(var W=0;W<V.length;W+=1)W>0&&(G+=","),G+=V[W];return G+="]",G},Z},$=function(){var V=0,Z=0,G=0,W="",le={},Ie=function(de){W+=String.fromCharCode(be(de&63))},be=function(de){if(!(de<0)){if(de<26)return 65+de;if(de<52)return 97+(de-26);if(de<62)return 48+(de-52);if(de==62)return 43;if(de==63)return 47}throw"n:"+de};return le.writeByte=function(de){for(V=V<<8|de&255,Z+=8,G+=1;Z>=6;)Ie(V>>>Z-6),Z-=6},le.flush=function(){if(Z>0&&(Ie(V<<6-Z),V=0,Z=0),G%3!=0)for(var de=3-G%3,Ne=0;Ne<de;Ne+=1)W+="="},le.toString=function(){return W},le},L=function(V){var Z=V,G=0,W=0,le=0,Ie={};Ie.read=function(){for(;le<8;){if(G>=Z.length){if(le==0)return-1;throw"unexpected end of file./"+le}var de=Z.charAt(G);if(G+=1,de=="=")return le=0,-1;if(de.match(/^\s$/))continue;W=W<<6|be(de.charCodeAt(0)),le+=6}var Ne=W>>>le-8&255;return le-=8,Ne};var be=function(de){if(65<=de&&de<=90)return de-65;if(97<=de&&de<=122)return de-97+26;if(48<=de&&de<=57)return de-48+52;if(de==43)return 62;if(de==47)return 63;throw"c:"+de};return Ie},F=function(V,Z){var G=V,W=Z,le=new Array(V*Z),Ie={};Ie.setPixel=function(Ee,Oe,ze){le[Oe*G+Ee]=ze},Ie.write=function(Ee){Ee.writeString("GIF87a"),Ee.writeShort(G),Ee.writeShort(W),Ee.writeByte(128),Ee.writeByte(0),Ee.writeByte(0),Ee.writeByte(0),Ee.writeByte(0),Ee.writeByte(0),Ee.writeByte(255),Ee.writeByte(255),Ee.writeByte(255),Ee.writeString(","),Ee.writeShort(0),Ee.writeShort(0),Ee.writeShort(G),Ee.writeShort(W),Ee.writeByte(0);var Oe=2,ze=de(Oe);Ee.writeByte(Oe);for(var rt=0;ze.length-rt>255;)Ee.writeByte(255),Ee.writeBytes(ze,rt,255),rt+=255;Ee.writeByte(ze.length-rt),Ee.writeBytes(ze,rt,ze.length-rt),Ee.writeByte(0),Ee.writeString(";")};var be=function(Ee){var Oe=Ee,ze=0,rt=0,We={};return We.write=function(Ae,He){if(Ae>>>He)throw"length over";for(;ze+He>=8;)Oe.writeByte(255&(Ae<<ze|rt)),He-=8-ze,Ae>>>=8-ze,rt=0,ze=0;rt=Ae<<ze|rt,ze=ze+He},We.flush=function(){ze>0&&Oe.writeByte(rt)},We},de=function(Ee){for(var Oe=1<<Ee,ze=(1<<Ee)+1,rt=Ee+1,We=Ne(),Ae=0;Ae<Oe;Ae+=1)We.add(String.fromCharCode(Ae));We.add(String.fromCharCode(Oe)),We.add(String.fromCharCode(ze));var He=U(),ft=be(He);ft.write(Oe,rt);var Qe=0,Rt=String.fromCharCode(le[Qe]);for(Qe+=1;Qe<le.length;){var zt=String.fromCharCode(le[Qe]);Qe+=1,We.contains(Rt+zt)?Rt=Rt+zt:(ft.write(We.indexOf(Rt),rt),We.size()<4095&&(We.size()==1<<rt&&(rt+=1),We.add(Rt+zt)),Rt=zt)}return ft.write(We.indexOf(Rt),rt),ft.write(ze,rt),ft.flush(),He.toByteArray()},Ne=function(){var Ee={},Oe=0,ze={};return ze.add=function(rt){if(ze.contains(rt))throw"dup key:"+rt;Ee[rt]=Oe,Oe+=1},ze.size=function(){return Oe},ze.indexOf=function(rt){return Ee[rt]},ze.contains=function(rt){return typeof Ee[rt]<"u"},ze};return Ie},J=function(V,Z,G){for(var W=F(V,Z),le=0;le<Z;le+=1)for(var Ie=0;Ie<V;Ie+=1)W.setPixel(Ie,le,G(Ie,le));var be=U();W.write(be);for(var de=$(),Ne=be.toByteArray(),Ee=0;Ee<Ne.length;Ee+=1)de.writeByte(Ne[Ee]);return de.flush(),"data:image/gif;base64,"+de};return o}();(function(){n.stringToBytesFuncs["UTF-8"]=function(o){function c(d){for(var p=[],s=0;s<d.length;s++){var _=d.charCodeAt(s);_<128?p.push(_):_<2048?p.push(192|_>>6,128|_&63):_<55296||_>=57344?p.push(224|_>>12,128|_>>6&63,128|_&63):(s++,_=65536+((_&1023)<<10|d.charCodeAt(s)&1023),p.push(240|_>>18,128|_>>12&63,128|_>>6&63,128|_&63))}return p}return c(o)}})(),function(o){e.exports=o()}(function(){return n})})(a7);var s7=pi&&pi.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,c){o.__proto__=c}||function(o,c){for(var d in c)c.hasOwnProperty(d)&&(o[d]=c[d])},e(t,n)};return function(t,n){e(t,n);function o(){this.constructor=t}t.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(rb,"__esModule",{value:!0});var FA=rb.QRCode=void 0,l7=v0,c7=r1,lv=P,u7=yo,d7=function(e){s7(t,e);function t(n){var o=e.call(this,n)||this;return o.canvas=lv.createRef(),o}return t.utf16to8=function(n){var o="",c,d,p=n.length;for(c=0;c<p;c++)d=n.charCodeAt(c),d>=1&&d<=127?o+=n.charAt(c):d>2047?(o+=String.fromCharCode(224|d>>12&15),o+=String.fromCharCode(128|d>>6&63),o+=String.fromCharCode(128|d>>0&63)):(o+=String.fromCharCode(192|d>>6&31),o+=String.fromCharCode(128|d>>0&63));return o},t.prototype.drawRoundedSquare=function(n,o,c,d,p,s,_,v){v.lineWidth=n,v.fillStyle=p,v.strokeStyle=p,c+=n/2,o+=n/2,d-=n,Array.isArray(s)||(s=[s,s,s,s]),s=s.map(function(O){return O=Math.min(O,d/2),O<0?0:O});var E=s[0]||0,T=s[1]||0,S=s[2]||0,D=s[3]||0;v.beginPath(),v.moveTo(o+E,c),v.lineTo(o+d-T,c),T&&v.quadraticCurveTo(o+d,c,o+d,c+T),v.lineTo(o+d,c+d-S),S&&v.quadraticCurveTo(o+d,c+d,o+d-S,c+d),v.lineTo(o+D,c+d),D&&v.quadraticCurveTo(o,c+d,o,c+d-D),v.lineTo(o,c+E),E&&v.quadraticCurveTo(o,c,o+E,c),v.closePath(),v.stroke(),_&&v.fill()},t.prototype.drawPositioningPattern=function(n,o,c,d,p,s,_){_===void 0&&(_=[0,0,0,0]);var v=Math.ceil(o),E,T;typeof _!="number"&&!Array.isArray(_)?(E=_.outer||0,T=_.inner||0):(E=_,T=E);var S,D;typeof s!="string"?(S=s.outer,D=s.inner):(S=s,D=s);var O=d*o+c,M=p*o+c,U=o*7;this.drawRoundedSquare(v,M,O,U,S,E,!1,n),U=o*3,O+=o*2,M+=o*2,this.drawRoundedSquare(v,M,O,U,D,T,!0,n)},t.prototype.isInPositioninZone=function(n,o,c){return c.some(function(d){return o>=d.row&&o<=d.row+7&&n>=d.col&&n<=d.col+7})},t.prototype.transformPixelLengthIntoNumberOfCells=function(n,o){return n/o},t.prototype.isCoordinateInImage=function(n,o,c,d,p,s,_,v){if(v){var E=2,T=this.transformPixelLengthIntoNumberOfCells(p,_),S=this.transformPixelLengthIntoNumberOfCells(s,_),D=this.transformPixelLengthIntoNumberOfCells(c,_)-1,O=this.transformPixelLengthIntoNumberOfCells(d,_)-1;return o>=T-E&&o<=T+D+E&&n>=S-E&&n<=S+O+E}else return!1},t.prototype.shouldComponentUpdate=function(n){return!l7(this.props,n)},t.prototype.componentDidMount=function(){this.update()},t.prototype.componentDidUpdate=function(){this.update()},t.prototype.update=function(){var n=this.props,o=n.value,c=n.ecLevel,d=n.enableCORS,p=n.size,s=n.quietZone,_=n.bgColor,v=n.fgColor,E=n.logoImage,T=n.logoWidth,S=n.logoHeight,D=n.logoOpacity,O=n.removeQrCodeBehindLogo,M=n.qrStyle,U=n.eyeRadius,$=n.eyeColor,L=c7(0,c);L.addData(t.utf16to8(o)),L.make();var F=u7.findDOMNode(this.canvas.current),J=F.getContext("2d"),V=+p+2*+s,Z=L.getModuleCount(),G=p/Z,W=window.devicePixelRatio||1;F.height=F.width=V*W,J.scale(W,W),J.fillStyle=_,J.fillRect(0,0,V,V);var le=+s,Ie=T||p*.2,be=S||Ie,de=(p-Ie)/2,Ne=(p-be)/2,Ee=[{row:0,col:0},{row:0,col:Z-7},{row:Z-7,col:0}];if(J.strokeStyle=v,M==="dots"){J.fillStyle=v;for(var Oe=G/2,ze=0;ze<Z;ze++)for(var rt=0;rt<Z;rt++)L.isDark(ze,rt)&&!this.isInPositioninZone(ze,rt,Ee)&&!(O&&this.isCoordinateInImage(ze,rt,Ie,be,de,Ne,G,E))&&(J.beginPath(),J.arc(Math.round(rt*G)+Oe+le,Math.round(ze*G)+Oe+le,Oe/100*75,0,2*Math.PI,!1),J.closePath(),J.fill())}else for(var ze=0;ze<Z;ze++)for(var rt=0;rt<Z;rt++)if(L.isDark(ze,rt)&&!this.isInPositioninZone(ze,rt,Ee)&&!(O&&this.isCoordinateInImage(ze,rt,Ie,be,de,Ne,G,E))){J.fillStyle=v;var We=Math.ceil((rt+1)*G)-Math.floor(rt*G),Ae=Math.ceil((ze+1)*G)-Math.floor(ze*G);J.fillRect(Math.round(rt*G)+le,Math.round(ze*G)+le,We,Ae)}for(var He=0;He<3;He++){var ft=Ee[He],ze=ft.row,rt=ft.col,Qe=U,Rt=void 0;Array.isArray(Qe)&&(Qe=Qe[He]),typeof Qe=="number"&&(Qe=[Qe,Qe,Qe,Qe]),$?Array.isArray($)?Rt=$[He]:Rt=$:Rt=v,this.drawPositioningPattern(J,G,le,ze,rt,Rt,Qe)}if(E){var zt=new Image;d&&(zt.crossOrigin="Anonymous"),zt.onload=function(){J.save(),J.globalAlpha=D,J.drawImage(zt,de+le,Ne+le,Ie,be),J.restore()},zt.src=E}},t.prototype.render=function(){var n,o=+this.props.size+2*+this.props.quietZone;return lv.createElement("canvas",{id:(n=this.props.id)!==null&&n!==void 0?n:"react-qrcode-logo",height:o,width:o,style:{height:o+"px",width:o+"px"},ref:this.canvas})},t.defaultProps={value:"https://reactjs.org/",ecLevel:"M",enableCORS:!1,size:150,quietZone:10,bgColor:"#FFFFFF",fgColor:"#000000",logoOpacity:1,removeQrCodeBehindLogo:!1,qrStyle:"squares",eyeRadius:[0,0,0]},t}(lv.Component);FA=rb.QRCode=d7;const UA="Checkbox",[h7,yU]=Ka(UA),[f7,p7]=h7(UA),m7=P.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:o,checked:c,defaultChecked:d,required:p,disabled:s,value:_="on",onCheckedChange:v,...E}=e,[T,S]=P.useState(null),D=ar(t,F=>S(F)),O=P.useRef(!1),M=T?Boolean(T.closest("form")):!0,[U=!1,$]=Ns({prop:c,defaultProp:d,onChange:v}),L=P.useRef(U);return P.useEffect(()=>{const F=T?.form;if(F){const J=()=>$(L.current);return F.addEventListener("reset",J),()=>F.removeEventListener("reset",J)}},[T,$]),P.createElement(f7,{scope:n,state:U,disabled:s},P.createElement(Tn.button,Bt({type:"button",role:"checkbox","aria-checked":Ac(U)?"mixed":U,"aria-required":p,"data-state":VA(U),"data-disabled":s?"":void 0,disabled:s,value:_},E,{ref:D,onKeyDown:ln(e.onKeyDown,F=>{F.key==="Enter"&&F.preventDefault()}),onClick:ln(e.onClick,F=>{$(J=>Ac(J)?!0:!J),M&&(O.current=F.isPropagationStopped(),O.current||F.stopPropagation())})})),M&&P.createElement(v7,{control:T,bubbles:!O.current,name:o,value:_,checked:U,required:p,disabled:s,style:{transform:"translateX(-100%)"}}))}),g7="CheckboxIndicator",y7=P.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:o,...c}=e,d=p7(g7,n);return P.createElement(Xa,{present:o||Ac(d.state)||d.state===!0},P.createElement(Tn.span,Bt({"data-state":VA(d.state),"data-disabled":d.disabled?"":void 0},c,{ref:t,style:{pointerEvents:"none",...e.style}})))}),v7=e=>{const{control:t,checked:n,bubbles:o=!0,...c}=e,d=P.useRef(null),p=Lx(n),s=Nx(t);return P.useEffect(()=>{const _=d.current,v=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(v,"checked").set;if(p!==n&&T){const S=new Event("click",{bubbles:o});_.indeterminate=Ac(n),T.call(_,Ac(n)?!1:n),_.dispatchEvent(S)}},[p,n,o]),P.createElement("input",Bt({type:"checkbox","aria-hidden":!0,defaultChecked:Ac(n)?!1:n},c,{tabIndex:-1,ref:d,style:{...e.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function Ac(e){return e==="indeterminate"}function VA(e){return Ac(e)?"indeterminate":e?"checked":"unchecked"}const jA=m7,_7=y7,ib=P.forwardRef(({className:e,...t},n)=>re(jA,{ref:n,className:En("peer h-4 w-4 shrink-0 rounded-sm border border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:text-slate-50 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900",e),...t,children:re(_7,{className:En("flex items-center justify-center"),children:re(QC,{className:"h-4 w-4"})})}));ib.displayName=jA.displayName;const x7=({open:e,onOpenChange:t,loraConfig:n,channels:o})=>{const[c,d]=P.useState([0]),[p,s]=P.useState(""),_=Array.from(o.values());return P.useEffect(()=>{const v=_.filter(S=>c.includes(S.index)).map(S=>S.settings).filter(S=>!!S),E=new T_(new T_({loraConfig:n,settings:v})),T=g3(E.toBinary()).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_");s(`https://meshtastic.org/e/#${T}`)},[o,c,n]),re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[vt(Zc,{children:[re(Kc,{children:"Generate QR Code"}),re(kd,{children:"The current LoRa configuration will also be shared."})]}),re("div",{className:"grid gap-4 py-4",children:vt("div",{className:"flex gap-3 px-4 py-5 sm:p-6",children:[re("div",{className:"flex w-40 flex-col gap-2",children:_.map(v=>vt("div",{className:"flex justify-between",children:[re(_a,{children:v.settings?.name.length?v.settings.name:v.role===Nc.PRIMARY?"Primary":`Channel: ${v.index}`}),re(ib,{checked:c.includes(v.index),onCheckedChange:()=>{c.includes(v.index)?d(c.filter(E=>E!==v.index)):d([...c,v.index])}},v.index)]},v.index))}),re(FA,{value:p,size:200,qrStyle:"dots"})]})}),vt(ag,{children:[re(_a,{children:"Sharable URL"}),re(Ha,{value:p,disabled:!0,action:{icon:QD,onClick(){navigator.clipboard.writeText(p)}}})]})]})})},b7=({open:e,onOpenChange:t})=>{const{connection:n}=In(),[o,c]=P.useState(5);return re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[vt(Zc,{children:[re(Kc,{children:"Schedule Reboot"}),re(kd,{children:"Reboot the connected node after x minutes."})]}),vt("div",{className:"flex gap-2 p-4",children:[re(Ha,{type:"number",value:o,onChange:d=>c(parseInt(d.target.value)),action:{icon:e3,onClick(){n?.reboot(o*60).then(()=>t(!1))}}}),vt(to,{className:"w-24",onClick:()=>{n?.reboot(2).then(()=>t(!1))},children:[re(S_,{className:"mr-2",size:16}),"Now"]})]})]})})},w7=({open:e,onOpenChange:t})=>{const{connection:n}=In(),[o,c]=P.useState(5);return re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[vt(Zc,{children:[re(Kc,{children:"Schedule Shutdown"}),re(kd,{children:"Turn off the connected node after x minutes."})]}),vt("div",{className:"flex gap-2 p-4",children:[re(Ha,{type:"number",value:o,onChange:d=>c(parseInt(d.target.value)),suffix:"Minutes"}),re(to,{className:"w-24",onClick:()=>{n?.shutdown(o*60).then(()=>t(!1))},children:re(e3,{size:16})}),vt(to,{className:"w-24",onClick:()=>{n?.shutdown(2).then(()=>()=>t(!1))},children:[re(o3,{className:"mr-2",size:16}),"Now"]})]})]})})},E7=({open:e,onOpenChange:t})=>{const[n,o]=P.useState(""),[c,d]=P.useState(),[p,s]=P.useState(!1),{connection:_}=In();P.useEffect(()=>{const E=n.split("e/#")[1]?.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"=");try{d(T_.fromBinary(m3(E))),s(!0)}catch{s(!1),d(void 0)}},[n]);const v=()=>{c?.settings.map((E,T)=>{_?.setChannel(new fd({index:T,role:T===0?Nc.PRIMARY:Nc.SECONDARY,settings:E}))}),c?.loraConfig&&_?.setConfig(new ba({payloadVariant:{case:"lora",value:c.loraConfig}}))};return re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[vt(Zc,{children:[re(Kc,{children:"Import Channel Set"}),re(kd,{children:"The current LoRa configuration will be overridden."})]}),vt("div",{className:"flex flex-col gap-3",children:[re(_a,{children:"Channel Set/QR Code URL"}),re(Ha,{value:n,suffix:p?"":"",onChange:E=>{o(E.target.value)}}),p&&vt("div",{className:"flex flex-col gap-3",children:[re("div",{className:"flex w-full gap-2",children:vt("div",{className:"w-36",children:[re(_a,{children:"Use Preset?"}),re(G0,{disabled:!0,checked:c?.loraConfig?.usePreset??!0})]})}),re("span",{className:"text-md block font-medium text-textPrimary",children:"Channels:"}),re("div",{className:"flex w-40 flex-col gap-1",children:c?.settings.map((E,T)=>vt("div",{className:"flex justify-between",children:[re(_a,{children:E.name.length?E.name:`Channel: ${E.id}`}),re(ib,{},T)]},T))})]})]}),re(ag,{children:re(to,{onClick:v,disabled:!p,children:"Apply"})})]})})},T7=({open:e,onOpenChange:t})=>{const{hardware:n,nodes:o,connection:c}=In(),d=o.get(n.myNodeNum),{register:p,handleSubmit:s}=Dx({values:{longName:d?.user?.longName??"Unknown",shortName:d?.user?.shortName??"Unknown"}}),_=s(v=>{c?.setOwner(new pf({...d?.user,...v})),t(!1)});return re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[vt(Zc,{children:[re(Kc,{children:"Change Device Name"}),re(kd,{children:"The Device will restart once the config is saved."})]}),re("div",{className:"gap-4",children:vt("form",{onSubmit:_,children:[re(_a,{children:"Long Name"}),re(Ha,{...p("longName")}),re(_a,{children:"Short Name"}),re(Ha,{maxLength:4,...p("shortName")})]})}),re(ag,{children:re(to,{onClick:()=>_(),children:"Save"})})]})})},S7=()=>{const{channels:e,config:t,dialog:n,setDialogOpen:o}=In();return vt(Jo,{children:[re(x7,{open:n.QR,onOpenChange:c=>{o("QR",c)},channels:e,loraConfig:t.lora}),re(E7,{open:n.import,onOpenChange:c=>{o("import",c)},loraConfig:t.lora}),re(w7,{open:n.shutdown,onOpenChange:()=>{o("shutdown",!1)}}),re(b7,{open:n.reboot,onOpenChange:()=>{o("reboot",!1)}}),re(T7,{open:n.deviceName,onOpenChange:c=>{o("deviceName",c)}})]})},kT=({children:e})=>re("h3",{className:"scroll-m-20 text-2xl font-semibold tracking-tight",children:e}),k7=()=>{const{setConnectDialogOpen:e}=$s(),{getDevices:t}=Uc(),n=P.useMemo(()=>t(),[t]);return vt("div",{className:"flex flex-col gap-3 p-3",children:[re("div",{className:"flex items-center justify-between",children:vt("div",{className:"space-y-1",children:[re(kT,{children:"Connected Devices"}),re(Rl,{children:"Manage, connect and disconnect devices"})]})}),re(y0,{}),re("div",{className:"flex h-[450px] rounded-md border border-dashed border-slate-200 p-3 dark:border-slate-700",children:n.length?re("ul",{role:"list",className:"grow divide-y divide-gray-200",children:n.map(o=>re("li",{children:vt("div",{className:"px-4 py-4 sm:px-6",children:[vt("div",{className:"flex items-center justify-between",children:[re("p",{className:"truncate text-sm font-medium text-accent",children:o.nodes.get(o.hardware.myNodeNum)?.user?.longName??"UNK"}),vt("div",{className:"inline-flex w-24 justify-center gap-2 rounded-full bg-slate-100 py-1 text-xs font-semibold text-slate-900 transition-colors hover:bg-slate-700 hover:text-slate-50",children:[o.connection?.connType==="ble"&&vt(Jo,{children:[re(ZD,{size:16}),"BLE"]}),o.connection?.connType==="serial"&&vt(Jo,{children:[re(bR,{size:16}),"Serial"]}),o.connection?.connType==="http"&&vt(Jo,{children:[re(hR,{size:16}),"Network"]})]})]}),re("div",{className:"mt-2 sm:flex sm:justify-between",children:vt("div",{className:"flex gap-2 text-sm text-gray-500",children:[re(Tx,{size:20,className:"text-gray-400","aria-hidden":"true"}),o.nodes.size===0?0:o.nodes.size-1]})})]})},o.id))}):vt("div",{className:"m-auto flex flex-col gap-3 text-center",children:[re(uR,{size:48,className:"mx-auto text-textSecondary"}),re(kT,{children:"No Devices"}),re(Rl,{children:"Connect atleast one device to get started"}),vt(to,{className:"gap-2",onClick:()=>e(!0),children:[re(wx,{size:16}),"New Connection"]})]})})]})},C7=({children:e})=>{const{darkMode:t,accent:n}=$s();return re("div",{"data-theme":t?"dark":"light","data-accent":n,children:e})},CT=({href:e,children:t})=>re("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-slate-900 underline underline-offset-4 dark:text-slate-50",children:t}),ob=(e,t)=>{let n=0;t.events.onDeviceMetadataPacket.subscribe(o=>{e.addMetadata(o.from,o.data)}),t.events.onRoutingPacket.subscribe(o=>{switch(o.data.variant.case){case"errorReason":if(o.data.variant.value===U0.NONE)return;console.log(`Routing Error: ${o.data.variant.value}`);break;case"routeReply":console.log(`Route Reply: ${o.data.variant.value}`);break;case"routeRequest":console.log(`Route Request: ${o.data.variant.value}`);break}}),t.events.onTelemetryPacket.subscribe(o=>{}),t.events.onDeviceStatus.subscribe(o=>{e.setStatus(o)}),t.events.onWaypointPacket.subscribe(o=>{const{data:c,...d}=o;e.addWaypoint(c)}),t.events.onMyNodeInfo.subscribe(o=>{e.setHardware(o),n=o.myNodeNum}),t.events.onUserPacket.subscribe(o=>{e.addUser(o)}),t.events.onPositionPacket.subscribe(o=>{e.addPosition(o)}),t.events.onNodeInfoPacket.subscribe(o=>{e.addNodeInfo(o)}),t.events.onChannelPacket.subscribe(o=>{e.addChannel(o)}),t.events.onConfigPacket.subscribe(o=>{e.setConfig(o)}),t.events.onModuleConfigPacket.subscribe(o=>{e.setModuleConfig(o)}),t.events.onMessagePacket.subscribe(o=>{e.addMessage({...o,state:o.from!==n?"ack":"waiting"})}),t.events.onPendingSettingsChange.subscribe(o=>{e.setPendingSettingsChanges(o)}),t.events.onMeshPacket.subscribe(o=>{e.processPacket({from:o.from,snr:o.rxSnr,time:o.rxTime})})},ab=()=>Math.floor(Math.random()*1e9),P7=()=>{const{addDevice:e}=Uc(),{setSelectedDevice:t}=$s(),{register:n,handleSubmit:o,control:c}=Dx({defaultValues:{ip:["client.meshtastic.org","localhost"].includes(window.location.hostname)?"meshtastic.local":window.location.hostname,tls:location.protocol==="https:"}}),d=T3({control:c,name:"tls",defaultValue:location.protocol==="https:"}),p=o(s=>{const _=ab(),v=e(_);t(_);const E=new M6(_);E.connect({address:s.ip,fetchInterval:2e3,tls:s.tls}),v.addConnection(E),ob(v,E)});return vt("form",{className:"flex w-full flex-col gap-2 p-4",onSubmit:p,children:[vt("div",{className:"flex h-48 flex-col gap-2",children:[re(_a,{children:"IP Address/Hostname"}),re(Ha,{prefix:d?"https://":"http://",placeholder:"000.000.000.000 / meshtastic.local",...n("ip")}),re(j0,{name:"tls",control:c,render:({field:{value:s,..._}})=>vt(Jo,{children:[re(_a,{children:"Use TLS"}),re(G0,{disabled:location.protocol==="https:",checked:s,..._})]})})]}),re(to,{children:re("span",{children:"Connect"})})]})},A7=()=>{const[e,t]=P.useState([]),{addDevice:n}=Uc(),{setSelectedDevice:o}=$s(),c=P.useCallback(async()=>{t(await navigator.bluetooth.getDevices())},[]);P.useEffect(()=>{c()},[c]);const d=async p=>{const s=ab(),_=n(s);o(s);const v=new I6(s);await v.connect({device:p}),_.addConnection(v),ob(_,v)};return vt("div",{className:"flex w-full flex-col gap-2 p-4",children:[vt("div",{className:"flex h-48 flex-col gap-2 overflow-y-auto",children:[e.map((p,s)=>re(to,{onClick:()=>{d(p)},children:p.name},s)),e.length===0&&re(qh,{className:"m-auto select-none",children:"No devices paired yet."})]}),re(to,{onClick:()=>{navigator.bluetooth.requestDevice({filters:[{services:[c_]}]}).then(p=>{e.findIndex(_=>_.id===p.id)===-1&&t(e.concat(p))})},children:re("span",{children:"New device"})})]})},I7=()=>{const[e,t]=P.useState([]),{addDevice:n}=Uc(),{setSelectedDevice:o}=$s(),c=P.useCallback(async()=>{t(await navigator.serial.getPorts())},[]);navigator.serial.addEventListener("connect",()=>{c()}),navigator.serial.addEventListener("disconnect",()=>{c()}),P.useEffect(()=>{c()},[c]);const d=async p=>{const s=ab(),_=n(s);o(s);const v=new R6(s);await v.connect({port:p,baudRate:void 0,concurrentLogOutput:!0}).catch(E=>console.log(`Unable to Connect: ${E.message}`)),_.addConnection(v),ob(_,v)};return vt("div",{className:"flex w-full flex-col gap-2 p-4",children:[vt("div",{className:"flex h-48 flex-col gap-2 overflow-y-auto",children:[e.map((p,s)=>re(to,{disabled:p.readable!==null,onClick:()=>{d(p)},children:`# ${s} - ${p.getInfo().usbVendorId??"UNK"} - ${p.getInfo().usbProductId??"UNK"}`},s)),e.length===0&&re(qh,{className:"m-auto select-none",children:"No devices paired yet."})]}),re(to,{onClick:()=>{navigator.serial.requestPort().then(p=>{t(e.concat(p))})},children:re("span",{children:"New device"})})]})},PT=[{label:"HTTP",element:P7,disabled:!1,disabledMessage:"Unsuported connection method"},{label:"Bluetooth",element:A7,disabled:!navigator.bluetooth,disabledMessage:"Web Bluetooth is currently only supported by Chromium-based browsers",disabledLink:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Serial_API#browser_compatibility"},{label:"Serial",element:I7,disabled:!navigator.serial,disabledMessage:"WebSerial is currently only supported by Chromium based browsers: https://developer.mozilla.org/en-US/docs/Web/API/Web_Bluetooth_API#browser_compatibility"}],M7=({open:e,onOpenChange:t})=>re(Hc,{open:e,onOpenChange:t,children:vt(zl,{children:[re(Zc,{children:re(Kc,{children:"Connect New Device"})}),vt(Y0,{defaultValue:"HTTP",children:[re(Lf,{children:PT.map(n=>re(Nf,{value:n.label,disabled:n.disabled,children:n.label},n.label))}),PT.map((n,o)=>re(Of,{value:n.label,children:n.disabled?re("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:n.disabledMessage}):re(n.element,{})},o))]}),(!navigator.bluetooth||!navigator.serial)&&vt(Jo,{children:[re(Rl,{children:"Web Bluetooth and Web Serial are currently only supported by Chromium-based browsers."}),vt(Rl,{children:["Read more:",re(CT,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Bluetooth_API#browser_compatibility",children:"Web Bluetooth"}),"",re(CT,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Serial_API#browser_compatibility",children:"Web Serial"})]})]})]})}),GA="ToastProvider",[sb,D7,R7]=Ox("Toast"),[qA,vU]=Ka("Toast",[R7]),[L7,sg]=qA(GA),WA=e=>{const{__scopeToast:t,label:n="Notification",duration:o=5e3,swipeDirection:c="right",swipeThreshold:d=50,children:p}=e,[s,_]=P.useState(null),[v,E]=P.useState(0),T=P.useRef(!1),S=P.useRef(!1);return P.createElement(sb.Provider,{scope:t},P.createElement(L7,{scope:t,label:n,duration:o,swipeDirection:c,swipeThreshold:d,toastCount:v,viewport:s,onViewportChange:_,onToastAdd:P.useCallback(()=>E(D=>D+1),[]),onToastRemove:P.useCallback(()=>E(D=>D-1),[]),isFocusedToastEscapeKeyDownRef:T,isClosePausedRef:S},p))};WA.propTypes={label(e){if(e.label&&typeof e.label=="string"&&!e.label.trim()){const t=`Invalid prop \`label\` supplied to \`${GA}\`. Expected non-empty \`string\`.`;return new Error(t)}return null}};const N7="ToastViewport",O7=["F8"],i1="toast.viewportPause",o1="toast.viewportResume",$7=P.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:o=O7,label:c="Notifications ({hotkey})",...d}=e,p=sg(N7,n),s=D7(n),_=P.useRef(null),v=P.useRef(null),E=P.useRef(null),T=P.useRef(null),S=ar(t,T,p.onViewportChange),D=o.join("+").replace(/Key/g,"").replace(/Digit/g,""),O=p.toastCount>0;P.useEffect(()=>{const U=$=>{var L;o.every(J=>$[J]||$.code===J)&&((L=T.current)===null||L===void 0||L.focus())};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[o]),P.useEffect(()=>{const U=_.current,$=T.current;if(O&&U&&$){const L=()=>{if(!p.isClosePausedRef.current){const Z=new CustomEvent(i1);$.dispatchEvent(Z),p.isClosePausedRef.current=!0}},F=()=>{if(p.isClosePausedRef.current){const Z=new CustomEvent(o1);$.dispatchEvent(Z),p.isClosePausedRef.current=!1}},J=Z=>{!U.contains(Z.relatedTarget)&&F()},V=()=>{U.contains(document.activeElement)||F()};return U.addEventListener("focusin",L),U.addEventListener("focusout",J),U.addEventListener("pointermove",L),U.addEventListener("pointerleave",V),window.addEventListener("blur",L),window.addEventListener("focus",F),()=>{U.removeEventListener("focusin",L),U.removeEventListener("focusout",J),U.removeEventListener("pointermove",L),U.removeEventListener("pointerleave",V),window.removeEventListener("blur",L),window.removeEventListener("focus",F)}}},[O,p.isClosePausedRef]);const M=P.useCallback(({tabbingDirection:U})=>{const L=s().map(F=>{const J=F.ref.current,V=[J,...Q7(J)];return U==="forwards"?V:V.reverse()});return(U==="forwards"?L.reverse():L).flat()},[s]);return P.useEffect(()=>{const U=T.current;if(U){const $=L=>{const F=L.altKey||L.ctrlKey||L.metaKey;if(L.key==="Tab"&&!F){const W=document.activeElement,le=L.shiftKey;if(L.target===U&&le){var V;(V=v.current)===null||V===void 0||V.focus();return}const de=M({tabbingDirection:le?"backwards":"forwards"}),Ne=de.findIndex(Ee=>Ee===W);if(cv(de.slice(Ne+1)))L.preventDefault();else{var Z,G;le?(Z=v.current)===null||Z===void 0||Z.focus():(G=E.current)===null||G===void 0||G.focus()}}};return U.addEventListener("keydown",$),()=>U.removeEventListener("keydown",$)}},[s,M]),P.createElement(KL,{ref:_,role:"region","aria-label":c.replace("{hotkey}",D),tabIndex:-1,style:{pointerEvents:O?void 0:"none"}},O&&P.createElement(AT,{ref:v,onFocusFromOutsideViewport:()=>{const U=M({tabbingDirection:"forwards"});cv(U)}}),P.createElement(sb.Slot,{scope:n},P.createElement(Tn.ol,Bt({tabIndex:-1},d,{ref:S}))),O&&P.createElement(AT,{ref:E,onFocusFromOutsideViewport:()=>{const U=M({tabbingDirection:"backwards"});cv(U)}}))}),z7="ToastFocusProxy",AT=P.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:o,...c}=e,d=sg(z7,n);return P.createElement(Gx,Bt({"aria-hidden":!0,tabIndex:0},c,{ref:t,style:{position:"fixed"},onFocus:p=>{var s;const _=p.relatedTarget;!((s=d.viewport)!==null&&s!==void 0&&s.contains(_))&&o()}}))}),lg="Toast",B7="toast.swipeStart",F7="toast.swipeMove",U7="toast.swipeCancel",V7="toast.swipeEnd",j7=P.forwardRef((e,t)=>{const{forceMount:n,open:o,defaultOpen:c,onOpenChange:d,...p}=e,[s=!0,_]=Ns({prop:o,defaultProp:c,onChange:d});return P.createElement(Xa,{present:n||s},P.createElement(HA,Bt({open:s},p,{ref:t,onClose:()=>_(!1),onPause:oi(e.onPause),onResume:oi(e.onResume),onSwipeStart:ln(e.onSwipeStart,v=>{v.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ln(e.onSwipeMove,v=>{const{x:E,y:T}=v.detail.delta;v.currentTarget.setAttribute("data-swipe","move"),v.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${E}px`),v.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${T}px`)}),onSwipeCancel:ln(e.onSwipeCancel,v=>{v.currentTarget.setAttribute("data-swipe","cancel"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),v.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ln(e.onSwipeEnd,v=>{const{x:E,y:T}=v.detail.delta;v.currentTarget.setAttribute("data-swipe","end"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),v.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${E}px`),v.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${T}px`),_(!1)})})))}),[G7,q7]=qA(lg,{onClose(){}}),HA=P.forwardRef((e,t)=>{const{__scopeToast:n,type:o="foreground",duration:c,open:d,onClose:p,onEscapeKeyDown:s,onPause:_,onResume:v,onSwipeStart:E,onSwipeMove:T,onSwipeCancel:S,onSwipeEnd:D,...O}=e,M=sg(lg,n),[U,$]=P.useState(null),L=ar(t,Ee=>$(Ee)),F=P.useRef(null),J=P.useRef(null),V=c||M.duration,Z=P.useRef(0),G=P.useRef(V),W=P.useRef(0),{onToastAdd:le,onToastRemove:Ie}=M,be=oi(()=>{var Ee;U?.contains(document.activeElement)&&((Ee=M.viewport)===null||Ee===void 0||Ee.focus()),p()}),de=P.useCallback(Ee=>{!Ee||Ee===1/0||(window.clearTimeout(W.current),Z.current=new Date().getTime(),W.current=window.setTimeout(be,Ee))},[be]);P.useEffect(()=>{const Ee=M.viewport;if(Ee){const Oe=()=>{de(G.current),v?.()},ze=()=>{const rt=new Date().getTime()-Z.current;G.current=G.current-rt,window.clearTimeout(W.current),_?.()};return Ee.addEventListener(i1,ze),Ee.addEventListener(o1,Oe),()=>{Ee.removeEventListener(i1,ze),Ee.removeEventListener(o1,Oe)}}},[M.viewport,V,_,v,de]),P.useEffect(()=>{d&&!M.isClosePausedRef.current&&de(V)},[d,V,M.isClosePausedRef,de]),P.useEffect(()=>(le(),()=>Ie()),[le,Ie]);const Ne=P.useMemo(()=>U?YA(U):null,[U]);return M.viewport?P.createElement(P.Fragment,null,Ne&&P.createElement(W7,{__scopeToast:n,role:"status","aria-live":o==="foreground"?"assertive":"polite","aria-atomic":!0},Ne),P.createElement(G7,{scope:n,onClose:be},yo.createPortal(P.createElement(sb.ItemSlot,{scope:n},P.createElement(ZL,{asChild:!0,onEscapeKeyDown:ln(s,()=>{M.isFocusedToastEscapeKeyDownRef.current||be(),M.isFocusedToastEscapeKeyDownRef.current=!1})},P.createElement(Tn.li,Bt({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":d?"open":"closed","data-swipe-direction":M.swipeDirection},O,{ref:L,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ln(e.onKeyDown,Ee=>{Ee.key==="Escape"&&(s?.(Ee.nativeEvent),Ee.nativeEvent.defaultPrevented||(M.isFocusedToastEscapeKeyDownRef.current=!0,be()))}),onPointerDown:ln(e.onPointerDown,Ee=>{Ee.button===0&&(F.current={x:Ee.clientX,y:Ee.clientY})}),onPointerMove:ln(e.onPointerMove,Ee=>{if(!F.current)return;const Oe=Ee.clientX-F.current.x,ze=Ee.clientY-F.current.y,rt=Boolean(J.current),We=["left","right"].includes(M.swipeDirection),Ae=["left","up"].includes(M.swipeDirection)?Math.min:Math.max,He=We?Ae(0,Oe):0,ft=We?0:Ae(0,ze),Qe=Ee.pointerType==="touch"?10:2,Rt={x:He,y:ft},zt={originalEvent:Ee,delta:Rt};rt?(J.current=Rt,lm(F7,T,zt,{discrete:!1})):IT(Rt,M.swipeDirection,Qe)?(J.current=Rt,lm(B7,E,zt,{discrete:!1}),Ee.target.setPointerCapture(Ee.pointerId)):(Math.abs(Oe)>Qe||Math.abs(ze)>Qe)&&(F.current=null)}),onPointerUp:ln(e.onPointerUp,Ee=>{const Oe=J.current,ze=Ee.target;if(ze.hasPointerCapture(Ee.pointerId)&&ze.releasePointerCapture(Ee.pointerId),J.current=null,F.current=null,Oe){const rt=Ee.currentTarget,We={originalEvent:Ee,delta:Oe};IT(Oe,M.swipeDirection,M.swipeThreshold)?lm(V7,D,We,{discrete:!0}):lm(U7,S,We,{discrete:!0}),rt.addEventListener("click",Ae=>Ae.preventDefault(),{once:!0})}})})))),M.viewport))):null});HA.propTypes={type(e){if(e.type&&!["foreground","background"].includes(e.type)){const t=`Invalid prop \`type\` supplied to \`${lg}\`. Expected \`foreground | background\`.`;return new Error(t)}return null}};const W7=e=>{const{__scopeToast:t,children:n,...o}=e,c=sg(lg,t),[d,p]=P.useState(!1),[s,_]=P.useState(!1);return Y7(()=>p(!0)),P.useEffect(()=>{const v=window.setTimeout(()=>_(!0),1e3);return()=>window.clearTimeout(v)},[]),s?null:P.createElement(jx,{asChild:!0},P.createElement(Gx,o,d&&P.createElement(P.Fragment,null,c.label," ",n)))},H7=P.forwardRef((e,t)=>{const{__scopeToast:n,...o}=e;return P.createElement(Tn.div,Bt({},o,{ref:t}))}),Z7=P.forwardRef((e,t)=>{const{__scopeToast:n,...o}=e;return P.createElement(Tn.div,Bt({},o,{ref:t}))}),K7="ToastAction",ZA=P.forwardRef((e,t)=>{const{altText:n,...o}=e;return n?P.createElement(XA,{altText:n,asChild:!0},P.createElement(KA,Bt({},o,{ref:t}))):null});ZA.propTypes={altText(e){return e.altText?null:new Error(`Missing prop \`altText\` expected on \`${K7}\``)}};const X7="ToastClose",KA=P.forwardRef((e,t)=>{const{__scopeToast:n,...o}=e,c=q7(X7,n);return P.createElement(XA,{asChild:!0},P.createElement(Tn.button,Bt({type:"button"},o,{ref:t,onClick:ln(e.onClick,c.onClose)})))}),XA=P.forwardRef((e,t)=>{const{__scopeToast:n,altText:o,...c}=e;return P.createElement(Tn.div,Bt({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":o||void 0},c,{ref:t}))});function YA(e){const t=[];return Array.from(e.childNodes).forEach(o=>{if(o.nodeType===o.TEXT_NODE&&o.textContent&&t.push(o.textContent),J7(o)){const c=o.ariaHidden||o.hidden||o.style.display==="none",d=o.dataset.radixToastAnnounceExclude==="";if(!c)if(d){const p=o.dataset.radixToastAnnounceAlt;p&&t.push(p)}else t.push(...YA(o))}}),t}function lm(e,t,n,{discrete:o}){const c=n.originalEvent.currentTarget,d=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&c.addEventListener(e,t,{once:!0}),o?D3(c,d):c.dispatchEvent(d)}const IT=(e,t,n=0)=>{const o=Math.abs(e.x),c=Math.abs(e.y),d=o>c;return t==="left"||t==="right"?d&&o>n:!d&&c>n};function Y7(e=()=>{}){const t=oi(e);fo(()=>{let n=0,o=0;return n=window.requestAnimationFrame(()=>o=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(o)}},[t])}function J7(e){return e.nodeType===e.ELEMENT_NODE}function Q7(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:o=>{const c=o.tagName==="INPUT"&&o.type==="hidden";return o.disabled||o.hidden||c?NodeFilter.FILTER_SKIP:o.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function cv(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}const eU=WA,JA=$7,QA=j7,eI=H7,tI=Z7,nI=ZA,rI=KA,tU=eU,iI=P.forwardRef(({className:e,...t},n)=>re(JA,{ref:n,className:En("fixed top-0 z-50 flex max-h-screen w-full flex-col-reverse p-4 sm:top-auto sm:bottom-0 sm:right-0 sm:flex-col md:max-w-[420px]",e),...t}));iI.displayName=JA.displayName;const nU=p3("data-[swipe=move]:transition-none grow-1 group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full mt-4 data-[state=closed]:slide-out-to-right-full dark:border-slate-700 last:mt-0 sm:last:mt-4",{variants:{variant:{default:"bg-white border-slate-200 dark:bg-slate-800 dark:border-slate-700",destructive:"group destructive bg-red-600 text-white border-red-600 dark:border-red-600"}},defaultVariants:{variant:"default"}}),oI=P.forwardRef(({className:e,variant:t,...n},o)=>re(QA,{ref:o,className:En(nU({variant:t}),e),...n}));oI.displayName=QA.displayName;const rU=P.forwardRef(({className:e,...t},n)=>re(nI,{ref:n,className:En("inline-flex h-8 shrink-0 items-center justify-center rounded-md border border-slate-200 bg-transparent px-3 text-sm font-medium transition-colors hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-red-100 group-[.destructive]:hover:border-slate-50 group-[.destructive]:hover:bg-red-100 group-[.destructive]:hover:text-red-600 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600 dark:border-slate-700 dark:text-slate-100 dark:hover:bg-slate-700 dark:hover:text-slate-100 dark:focus:ring-slate-400 dark:focus:ring-offset-slate-900 dark:data-[state=open]:bg-slate-800",e),...t}));rU.displayName=nI.displayName;const aI=P.forwardRef(({className:e,...t},n)=>re(rI,{ref:n,className:En("absolute top-2 right-2 rounded-md p-1 text-slate-500 opacity-0 transition-opacity hover:text-slate-900 focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600 dark:hover:text-slate-50",e),"toast-close":"",...t,children:re(a3,{className:"h-4 w-4"})}));aI.displayName=rI.displayName;const sI=P.forwardRef(({className:e,...t},n)=>re(eI,{ref:n,className:En("text-sm font-semibold",e),...t}));sI.displayName=eI.displayName;const lI=P.forwardRef(({className:e,...t},n)=>re(tI,{ref:n,className:En("text-sm opacity-90",e),...t}));lI.displayName=tI.displayName;function iU(){const{toasts:e}=Kx();return vt(tU,{children:[e.map(function({id:t,title:n,description:o,action:c,...d}){return vt(oI,{...d,children:[vt("div",{className:"grid gap-1",children:[n&&re(sI,{children:n}),o&&re(lI,{children:o})]}),c,re(aI,{})]},t)}),re(iI,{})]})}const oU=()=>{const{getDevice:e}=Uc(),{selectedDevice:t,setConnectDialogOpen:n,connectDialogOpen:o}=$s(),c=e(t);return vt(C7,{children:[re(M7,{open:o,onOpenChange:d=>{n(d)}}),re(iU,{}),re(VM,{children:re(jD,{device:c,children:re("div",{className:"flex h-screen flex-col overflow-hidden bg-backgroundPrimary text-textPrimary",children:vt("div",{className:"flex flex-grow",children:[re(i7,{}),re("div",{className:"flex flex-grow flex-col",children:c?vt("div",{className:"flex h-screen",children:[re(S7,{}),re(QF,{}),re(_B,{})]}):re(k7,{})})]})})})})]})},aU=document.getElementById("root"),sU=Vk(aU);A9();sU.render(re(P.StrictMode,{children:re(oU,{})}));
